/*! jQuery v1.10.1 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.1.min.map
*/
(function(e,t){var n,r,i=typeof t,o=e.location,a=e.document,s=a.documentElement,l=e.jQuery,u=e.$,c={},p=[],f="1.10.1",d=p.concat,h=p.push,g=p.slice,m=p.indexOf,y=c.toString,v=c.hasOwnProperty,b=f.trim,x=function(e,t){return new x.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^[\],:{}\s]*$/,S=/(?:^|:|,)(?:\s*\[)+/g,A=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,j=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,D=/^-ms-/,L=/-([\da-z])/gi,H=function(e,t){return t.toUpperCase()},q=function(e){(a.addEventListener||"load"===e.type||"complete"===a.readyState)&&(_(),x.ready())},_=function(){a.addEventListener?(a.removeEventListener("DOMContentLoaded",q,!1),e.removeEventListener("load",q,!1)):(a.detachEvent("onreadystatechange",q),e.detachEvent("onload",q))};x.fn=x.prototype={jquery:f,constructor:x,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:a,!0)),k.test(i[1])&&x.isPlainObject(n))for(i in n)x.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=a.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=a,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||x.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(o=arguments[l]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(x.isPlainObject(r)||(n=x.isArray(r)))?(n?(n=!1,a=e&&x.isArray(e)?e:[]):a=e&&x.isPlainObject(e)?e:{},s[i]=x.extend(c,a,r)):r!==t&&(s[i]=r));return s},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=l),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){if(e===!0?!--x.readyWait:!x.isReady){if(!a.body)return setTimeout(x.ready);x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(a,[x]),x.fn.trigger&&x(a).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray||function(e){return"array"===x.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[y.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!v.call(e,"constructor")&&!v.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(x.support.ownLast)for(n in e)return v.call(e,n);for(n in e);return n===t||v.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||a;var r=k.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=x.trim(n),n&&E.test(n.replace(A,"@").replace(j,"]").replace(S,"")))?Function("return "+n)():(x.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&x.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(D,"ms-").replace(L,H)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("\ufeff\u00a0")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(C,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return d.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),x.isFunction(e)?(r=g.call(arguments,2),i=function(){return e.apply(n||this,r.concat(g.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):t},access:function(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;if("object"===x.type(r)){o=!0;for(l in r)x.access(e,n,l,r[l],!0,a,s)}else if(i!==t&&(o=!0,x.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(x(e),n)})),n))for(;u>l;l++)n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)));return o?e:c?n.call(e):u?n(e[0],r):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),x.ready.promise=function(t){if(!n)if(n=x.Deferred(),"complete"===a.readyState)setTimeout(x.ready);else if(a.addEventListener)a.addEventListener("DOMContentLoaded",q,!1),e.addEventListener("load",q,!1);else{a.attachEvent("onreadystatechange",q),e.attachEvent("onload",q);var r=!1;try{r=null==e.frameElement&&a.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!x.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}_(),x.ready()}}()}return n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=x(a),function(e,t){var n,r,i,o,a,s,l,u,c,p,f,d,h,g,m,y,v,b="sizzle"+-new Date,w=e.document,T=0,C=0,N=lt(),k=lt(),E=lt(),S=!1,A=function(){return 0},j=typeof t,D=1<<31,L={}.hasOwnProperty,H=[],q=H.pop,_=H.push,M=H.push,O=H.slice,F=H.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=R.replace("w","w#"),$="\\["+P+"*("+R+")"+P+"*(?:([*^$|!~]?=)"+P+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+P+"*\\]",I=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),X=RegExp("^"+P+"*,"+P+"*"),U=RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),V=RegExp(P+"*[+~]"),Y=RegExp("="+P+"*([^\\]'\"]*)"+P+"*\\]","g"),J=RegExp(I),G=RegExp("^"+W+"$"),Q={ID:RegExp("^#("+R+")"),CLASS:RegExp("^\\.("+R+")"),TAG:RegExp("^("+R.replace("w","w*")+")"),ATTR:RegExp("^"+$),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:RegExp("^(?:"+B+")$","i"),needsContext:RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{M.apply(H=O.call(w.childNodes),w.childNodes),H[w.childNodes.length].nodeType}catch(ot){M={apply:H.length?function(e,t){_.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function at(e,t,n,i){var o,a,s,l,u,c,d,m,y,x;if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,n=n||[],!e||"string"!=typeof e)return n;if(1!==(l=t.nodeType)&&9!==l)return[];if(h&&!i){if(o=Z.exec(e))if(s=o[1]){if(9===l){if(a=t.getElementById(s),!a||!a.parentNode)return n;if(a.id===s)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(s))&&v(t,a)&&a.id===s)return n.push(a),n}else{if(o[2])return M.apply(n,t.getElementsByTagName(e)),n;if((s=o[3])&&r.getElementsByClassName&&t.getElementsByClassName)return M.apply(n,t.getElementsByClassName(s)),n}if(r.qsa&&(!g||!g.test(e))){if(m=d=b,y=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){c=bt(e),(d=t.getAttribute("id"))?m=d.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",u=c.length;while(u--)c[u]=m+xt(c[u]);y=V.test(e)&&t.parentNode||t,x=c.join(",")}if(x)try{return M.apply(n,y.querySelectorAll(x)),n}catch(T){}finally{d||t.removeAttribute("id")}}}return At(e.replace(z,"$1"),t,n,i)}function st(e){return K.test(e+"")}function lt(){var e=[];function t(n,r){return e.push(n+=" ")>o.cacheLength&&delete t[e.shift()],t[n]=r}return t}function ut(e){return e[b]=!0,e}function ct(e){var t=f.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function pt(e,t,n){e=e.split("|");var r,i=e.length,a=n?null:t;while(i--)(r=o.attrHandle[e[i]])&&r!==t||(o.attrHandle[e[i]]=a)}function ft(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:e[t]===!0?t.toLowerCase():null}function dt(e,t){return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}function ht(e){return"input"===e.nodeName.toLowerCase()?e.defaultValue:t}function gt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function mt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function yt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function vt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}s=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=at.support={},p=at.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.parentWindow;return n!==f&&9===n.nodeType&&n.documentElement?(f=n,d=n.documentElement,h=!s(n),i&&i.frameElement&&i.attachEvent("onbeforeunload",function(){p()}),r.attributes=ct(function(e){return e.innerHTML="<a href='#'></a>",pt("type|href|height|width",dt,"#"===e.firstChild.getAttribute("href")),pt(B,ft,null==e.getAttribute("disabled")),e.className="i",!e.getAttribute("className")}),r.input=ct(function(e){return e.innerHTML="<input>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}),pt("value",ht,r.attributes&&r.input),r.getElementsByTagName=ct(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ct(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ct(function(e){return d.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(o.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),o.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==j?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},o.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==j&&h?n.getElementsByClassName(e):t},m=[],g=[],(r.qsa=st(n.querySelectorAll))&&(ct(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||g.push("\\["+P+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||g.push(":checked")}),ct(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&g.push("[*^$]="+P+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(r.matchesSelector=st(y=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ct(function(e){r.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),m.push("!=",I)}),g=g.length&&RegExp(g.join("|")),m=m.length&&RegExp(m.join("|")),v=st(d.contains)||d.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},r.sortDetached=ct(function(e){return 1&e.compareDocumentPosition(n.createElement("div"))}),A=d.compareDocumentPosition?function(e,t){if(e===t)return S=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||v(w,e)?-1:t===n||v(w,t)?1:c?F.call(c,e)-F.call(c,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return S=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:c?F.call(c,e)-F.call(c,t):0;if(o===a)return gt(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?gt(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},n):f},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(Y,"='$1']"),!(!r.matchesSelector||!h||m&&m.test(t)||g&&g.test(t)))try{var n=y.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return at(t,f,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),v(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==f&&p(e);var i=o.attrHandle[n.toLowerCase()],a=i&&L.call(o.attrHandle,n.toLowerCase())?i(e,n,!h):t;return a===t?r.attributes||!h?e.getAttribute(n):(a=e.getAttributeNode(n))&&a.specified?a.value:null:a},at.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],i=0,o=0;if(S=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(A),S){while(t=e[o++])t===e[o]&&(i=n.push(o));while(i--)e.splice(n[i],1)}return e},a=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=a(t);return n},o=at.selectors={cacheLength:50,createPseudo:ut,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=bt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=N[e+" "];return t||(t=RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&N(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[b]||(m[b]={}),u=c[e]||[],d=u[0]===T&&u[1],f=u[0]===T&&u[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[T,d,f];break}}else if(v&&(u=(t[b]||(t[b]={}))[e])&&u[0]===T)f=u[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[b]||(p[b]={}))[e]=[T,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=F.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ut(function(e){var t=[],n=[],r=l(e.replace(z,"$1"));return r[b]?ut(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ut(function(e){return function(t){return at(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}}),lang:ut(function(e){return G.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!o.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:vt(function(){return[0]}),last:vt(function(e,t){return[t-1]}),eq:vt(function(e,t,n){return[0>n?n+t:n]}),even:vt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:vt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:vt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:vt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[n]=mt(n);for(n in{submit:!0,reset:!0})o.pseudos[n]=yt(n);function bt(e,t){var n,r,i,a,s,l,u,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,l=[],u=o.preFilter;while(s){(!n||(r=X.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length));for(a in o.filter)!(r=Q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?at.error(e):k(e,l).slice(0)}function xt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function wt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,s){var l,u,c,p=T+" "+a;if(s){while(t=t[r])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[r])if(1===t.nodeType||o)if(c=t[b]||(t[b]={}),(u=c[r])&&u[0]===p){if((l=u[1])===!0||l===i)return l===!0}else if(u=c[r]=[p],u[1]=e(t,n,s)||i,u[1]===!0)return!0}}function Tt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Ct(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=null!=t;for(;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function Nt(e,t,n,r,i,o){return r&&!r[b]&&(r=Nt(r)),i&&!i[b]&&(i=Nt(i,o)),ut(function(o,a,s,l){var u,c,p,f=[],d=[],h=a.length,g=o||St(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:Ct(g,f,e,s,l),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,l),r){u=Ct(y,d),r(u,[],s,l),c=u.length;while(c--)(p=u[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){u=[],c=y.length;while(c--)(p=y[c])&&u.push(m[c]=p);i(null,y=[],u,l)}c=y.length;while(c--)(p=y[c])&&(u=i?F.call(o,p):f[c])>-1&&(o[u]=!(a[u]=p))}}else y=Ct(y===a?y.splice(h,y.length):y),i?i(null,a,y,l):M.apply(a,y)})}function kt(e){var t,n,r,i=e.length,a=o.relative[e[0].type],s=a||o.relative[" "],l=a?1:0,c=wt(function(e){return e===t},s,!0),p=wt(function(e){return F.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;i>l;l++)if(n=o.relative[e[l].type])f=[wt(Tt(f),n)];else{if(n=o.filter[e[l].type].apply(null,e[l].matches),n[b]){for(r=++l;i>r;r++)if(o.relative[e[r].type])break;return Nt(l>1&&Tt(f),l>1&&xt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&kt(e.slice(l,r)),i>r&&kt(e=e.slice(r)),i>r&&xt(e))}f.push(n)}return Tt(f)}function Et(e,t){var n=0,r=t.length>0,a=e.length>0,s=function(s,l,c,p,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,C=u,N=s||a&&o.find.TAG("*",d&&l.parentNode||l),k=T+=null==C?1:Math.random()||.1;for(w&&(u=l!==f&&l,i=n);null!=(h=N[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,l,c)){p.push(h);break}w&&(T=k,i=++n)}r&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,r&&b!==v){g=0;while(m=t[g++])m(x,y,l,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=q.call(p));y=Ct(y)}M.apply(p,y),w&&!s&&y.length>0&&v+t.length>1&&at.uniqueSort(p)}return w&&(T=k,u=C),x};return r?ut(s):s}l=at.compile=function(e,t){var n,r=[],i=[],o=E[e+" "];if(!o){t||(t=bt(e)),n=t.length;while(n--)o=kt(t[n]),o[b]?r.push(o):i.push(o);o=E(e,Et(i,r))}return o};function St(e,t,n){var r=0,i=t.length;for(;i>r;r++)at(e,t[r],n);return n}function At(e,t,n,i){var a,s,u,c,p,f=bt(e);if(!i&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(u=s[0]).type&&r.getById&&9===t.nodeType&&h&&o.relative[s[1].type]){if(t=(o.find.ID(u.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}a=Q.needsContext.test(e)?0:s.length;while(a--){if(u=s[a],o.relative[c=u.type])break;if((p=o.find[c])&&(i=p(u.matches[0].replace(rt,it),V.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=i.length&&xt(s),!e)return M.apply(n,i),n;break}}}return l(e,f)(i,t,!h,n,V.test(e)),n}o.pseudos.nth=o.pseudos.eq;function jt(){}jt.prototype=o.filters=o.pseudos,o.setFilters=new jt,r.sortStable=b.split("").sort(A).join("")===b,p(),[0,0].sort(A),r.detectDuplicates=S,x.find=at,x.expr=at.selectors,x.expr[":"]=x.expr.pseudos,x.unique=at.uniqueSort,x.text=at.getText,x.isXMLDoc=at.isXML,x.contains=at.contains}(e);var O={};function F(e){var t=O[e]={};return x.each(e.match(T)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?O[e]||F(e):x.extend({},e);var n,r,i,o,a,s,l=[],u=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=l.length,n=!0;l&&o>a;a++)if(l[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,l&&(u?u.length&&c(u.shift()):r?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;(function i(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=l.length:r&&(s=t,c(r))}return this},remove:function(){return l&&x.each(arguments,function(e,t){var r;while((r=x.inArray(t,l,r))>-1)l.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?x.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=u=r=t,this},disabled:function(){return!l},lock:function(){return u=t,r||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!l||i&&!u||(n?u.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var a=o[0],s=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=g.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?g.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,l,u;if(r>1)for(s=Array(r),l=Array(r),u=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i;return i||o.resolveWith(u,n),o.promise()}}),x.support=function(t){var n,r,o,s,l,u,c,p,f,d=a.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],r=d.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;s=a.createElement("select"),u=s.appendChild(a.createElement("option")),o=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!o.value,t.optSelected=u.selected,t.enctype=!!a.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==a.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}o=a.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),l=a.createDocumentFragment(),l.appendChild(o),t.appendChecked=o.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;for(f in x(t))break;return t.ownLast="0"!==f,x(function(){var n,r,o,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];l&&(n=a.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=p&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",x.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(a.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(n),n=d=o=r=null)
}),n=s=l=u=r=o=null,t}({});var B=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;function R(e,n,r,i){if(x.acceptData(e)){var o,a,s=x.expando,l=e.nodeType,u=l?x.cache:e,c=l?e[s]:e[s]&&s;if(c&&u[c]&&(i||u[c].data)||r!==t||"string"!=typeof n)return c||(c=l?e[s]=p.pop()||x.guid++:s),u[c]||(u[c]=l?{}:{toJSON:x.noop}),("object"==typeof n||"function"==typeof n)&&(i?u[c]=x.extend(u[c],n):u[c].data=x.extend(u[c].data,n)),a=u[c],i||(a.data||(a.data={}),a=a.data),r!==t&&(a[x.camelCase(n)]=r),"string"==typeof n?(o=a[n],null==o&&(o=a[x.camelCase(n)])):o=a,o}}function W(e,t,n){if(x.acceptData(e)){var r,i,o=e.nodeType,a=o?x.cache:e,s=o?e[x.expando]:x.expando;if(a[s]){if(t&&(r=n?a[s]:a[s].data)){x.isArray(t)?t=t.concat(x.map(t,x.camelCase)):t in r?t=[t]:(t=x.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!I(r):!x.isEmptyObject(r))return}(n||(delete a[s].data,I(a[s])))&&(o?x.cleanData([e],!0):x.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}x.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?x.cache[e[x.expando]]:e[x.expando],!!e&&!I(e)},data:function(e,t,n){return R(e,t,n)},removeData:function(e,t){return W(e,t)},_data:function(e,t,n){return R(e,t,n,!0)},_removeData:function(e,t){return W(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&x.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),x.fn.extend({data:function(e,n){var r,i,o=null,a=0,s=this[0];if(e===t){if(this.length&&(o=x.data(s),1===s.nodeType&&!x._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>a;a++)i=r[a].name,0===i.indexOf("data-")&&(i=x.camelCase(i.slice(5)),$(s,i,o[i]));x._data(s,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){x.data(this,e)}):arguments.length>1?this.each(function(){x.data(this,e,n)}):s?$(s,e,x.data(s,e)):null},removeData:function(e){return this.each(function(){x.removeData(this,e)})}});function $(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(P,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:B.test(r)?x.parseJSON(r):r}catch(o){}x.data(e,n,r)}else r=t}return r}function I(e){var t;for(t in e)if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}x.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=x._data(e,n),r&&(!i||x.isArray(r)?i=x._data(e,n,x.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),a=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return x._data(e,n)||x._data(e,n,{empty:x.Callbacks("once memory").add(function(){x._removeData(e,t+"queue"),x._removeData(e,n)})})}}),x.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?x.queue(this[0],e):n===t?this:this.each(function(){var t=x.queue(this,e,n);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=x.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=x._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var z,X,U=/[\t\r\n\f]/g,V=/\r/g,Y=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,G=/^(?:checked|selected)$/i,Q=x.support.getSetAttribute,K=x.support.input;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,l="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=x(this),l=t,u=e.match(T)||[];while(o=u[a++])l=r?l:!s.hasClass(o),s[l?"addClass":"removeClass"](o)}else(n===i||"boolean"===n)&&(this.className&&x._data(this,"__className__",this.className),this.className=this.className||e===!1?"":x._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(U," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=x.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,x(this).val()):e,null==o?o="":"number"==typeof o?o+="":x.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""})),r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(V,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;for(;s>l;l++)if(n=r[l],!(!n.selected&&l!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),a=i.length;while(a--)r=i[a],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,r){var o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===i?x.prop(e,n,r):(1===s&&x.isXMLDoc(e)||(n=n.toLowerCase(),o=x.attrHooks[n]||(x.expr.match.bool.test(n)?X:z)),r===t?o&&"get"in o&&null!==(a=o.get(e,n))?a:(a=x.find.attr(e,n),null==a?t:a):null!==r?o&&"set"in o&&(a=o.set(e,r,n))!==t?a:(e.setAttribute(n,r+""),r):(x.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(T);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)?K&&Q||!G.test(n)?e[r]=!1:e[x.camelCase("default-"+n)]=e[r]=!1:x.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!x.isXMLDoc(e),a&&(n=x.propFix[n]||n,o=x.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):Y.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?x.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&x.propFix[n]||n,n):e[x.camelCase("default-"+n)]=e[n]=!0,n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,n){var r=x.expr.attrHandle[n]||x.find.attr;x.expr.attrHandle[n]=K&&Q||!G.test(n)?function(e,n,i){var o=x.expr.attrHandle[n],a=i?t:(x.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return x.expr.attrHandle[n]=o,a}:function(e,n,r){return r?t:e[x.camelCase("default-"+n)]?n.toLowerCase():null}}),K&&Q||(x.attrHooks.value={set:function(e,n,r){return x.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)}}),Q||(z={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},x.expr.attrHandle.id=x.expr.attrHandle.name=x.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},x.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:z.set},x.attrHooks.contenteditable={set:function(e,t,n){z.set(e,""===t?!1:t,n)}},x.each(["width","height"],function(e,n){x.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),x.support.hrefNormalized||x.each(["href","src"],function(e,t){x.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.support.enctype||(x.propFix.enctype="encoding"),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,n){return x.isArray(n)?e.checked=x.inArray(x(e).val(),n)>=0:t}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}function at(){try{return a.activeElement}catch(e){}}x.event={global:{},add:function(e,n,r,o,a){var s,l,u,c,p,f,d,h,g,m,y,v=x._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=x.guid++),(l=v.events)||(l=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof x===i||e&&x.event.triggered===e.type?t:x.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(T)||[""],u=n.length;while(u--)s=rt.exec(n[u])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),g&&(p=x.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=x.event.special[g]||{},d=x.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=l[g])||(h=l[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),x.event.global[g]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,p,f,d,h,g,m=x.hasData(e)&&x._data(e);if(m&&(c=m.events)){t=(t||"").match(T)||[""],u=t.length;while(u--)if(s=rt.exec(t[u])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=x.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));l&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||x.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)x.event.remove(e,d+t[u],n,r,!0);x.isEmptyObject(c)&&(delete m.handle,x._removeData(e,"events"))}},trigger:function(n,r,i,o){var s,l,u,c,p,f,d,h=[i||a],g=v.call(n,"type")?n.type:n,m=v.call(n,"namespace")?n.namespace.split("."):[];if(u=f=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+x.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),l=0>g.indexOf(":")&&"on"+g,n=n[x.expando]?n:new x.Event(g,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:x.makeArray(r,[n]),p=x.event.special[g]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!x.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(u=u.parentNode);u;u=u.parentNode)h.push(u),f=u;f===(i.ownerDocument||a)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((u=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(x._data(u,"events")||{})[n.type]&&x._data(u,"handle"),s&&s.apply(u,r),s=l&&u[l],s&&x.acceptData(u)&&s.apply&&s.apply(u,r)===!1&&n.preventDefault();if(n.type=g,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(h.pop(),r)===!1)&&x.acceptData(i)&&l&&i[g]&&!x.isWindow(i)){f=i[l],f&&(i[l]=null),x.event.triggered=g;try{i[g]()}catch(y){}x.event.triggered=t,f&&(i[l]=f)}return n.result}},dispatch:function(e){e=x.event.fix(e);var n,r,i,o,a,s=[],l=g.call(arguments),u=(x._data(this,"events")||{})[e.type]||[],c=x.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((x.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],l=n.delegateCount,u=e.target;if(l&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?x(r,this).index(u)>=0:x.find(r,this,null,[u]).length),o[r]&&o.push(i);o.length&&s.push({elem:u,handlers:o})}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new x.Event(o),t=r.length;while(t--)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||a),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,s=n.button,l=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||a,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?n.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===at()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return x.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=a.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},x.Event=function(e,n){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,t):new x.Event(e,n)},x.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.submitBubbles||(x.event.special.submit={setup:function(){return x.nodeName(this,"form")?!1:(x.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=x.nodeName(n,"input")||x.nodeName(n,"button")?n.form:t;r&&!x._data(r,"submitBubbles")&&(x.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),x._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return x.nodeName(this,"form")?!1:(x.event.remove(this,"._submit"),t)}}),x.support.changeBubbles||(x.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),x.event.simulate("change",this,e,!0)})),!1):(x.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!x._data(t,"changeBubbles")&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)}),x._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return x.event.remove(this,"._change"),!Z.test(this.nodeName)}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&a.addEventListener(e,r,!0)},teardown:function(){0===--n&&a.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return x().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){x.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?x.event.trigger(e,n,r,!0):t}});var st=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ut=x.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=x(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(x.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e||[],!0))},filter:function(e){return this.pushStack(ft(this,e||[],!1))},is:function(e){return!!ft(this,"string"==typeof e&&ut.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],a=ut.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(ct[e]||(i=x.unique(i)),lt.test(e)&&(i=i.reverse())),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!x(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(st.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return x.inArray(e,t)>=0!==n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Ct=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:x.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(a),Dt=jt.appendChild(a.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===t?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(Ft(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&_t(Ft(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&x.cleanData(Ft(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&x.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!x.support.htmlSerialize&&mt.test(e)||!x.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(x.cleanData(Ft(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=d.apply([],e);var r,i,o,a,s,l,u=0,c=this.length,p=this,f=c-1,h=e[0],g=x.isFunction(h);if(g||!(1>=c||"string"!=typeof h||x.support.checkClone)&&Nt.test(h))return this.each(function(r){var i=p.eq(r);g&&(e[0]=h.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(l=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=l.firstChild,1===l.childNodes.length&&(l=r),r)){for(a=x.map(Ft(l,"script"),Ht),o=a.length;c>u;u++)i=l,u!==f&&(i=x.clone(i,!0,!0),o&&x.merge(a,Ft(i,"script"))),t.call(this[u],i,u);if(o)for(s=a[a.length-1].ownerDocument,x.map(a,qt),u=0;o>u;u++)i=a[u],kt.test(i.type||"")&&!x._data(i,"globalEval")&&x.contains(s,i)&&(i.src?x._evalUrl(i.src):x.globalEval((i.text||i.textContent||i.innerHTML||"").replace(St,"")));l=r=null}return this}});function Lt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ht(e){return e.type=(null!==x.find.attr(e,"type"))+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _t(e,t){var n,r=0;for(;null!=(n=e[r]);r++)x._data(n,"globalEval",!t||x._data(t[r],"globalEval"))}function Mt(e,t){if(1===t.nodeType&&x.hasData(e)){var n,r,i,o=x._data(e),a=x._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)x.event.add(t,n,s[n][r])}a.data&&(a.data=x.extend({},a.data))}}function Ot(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!x.support.noCloneEvent&&t[x.expando]){i=x._data(t);for(r in i.events)x.removeEvent(t,r,i.handle);t.removeAttribute(x.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),x.support.html5Clone&&e.innerHTML&&!x.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ct.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=0,i=[],o=x(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),x(o[r])[t](n),h.apply(i,n.get());return this.pushStack(i)}});function Ft(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||x.nodeName(o,n)?s.push(o):x.merge(s,Ft(o,n));return n===t||n&&x.nodeName(e,n)?x.merge([e],s):s}function Bt(e){Ct.test(e.type)&&(e.defaultChecked=e.checked)}x.extend({clone:function(e,t,n){var r,i,o,a,s,l=x.contains(e.ownerDocument,e);if(x.support.html5Clone||x.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(r=Ft(o),s=Ft(e),a=0;null!=(i=s[a]);++a)r[a]&&Ot(i,r[a]);if(t)if(n)for(s=s||Ft(e),r=r||Ft(o),a=0;null!=(i=s[a]);a++)Mt(i,r[a]);else Mt(e,o);return r=Ft(o,"script"),r.length>0&&_t(r,!l&&Ft(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,l,u,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===x.type(o))x.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),l=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[l]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!x.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!x.support.tbody){o="table"!==l||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)x.nodeName(u=o.childNodes[i],"tbody")&&!u.childNodes.length&&o.removeChild(u)}x.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),x.support.appendChecked||x.grep(Ft(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===x.inArray(o,r))&&(a=x.contains(o.ownerDocument,o),s=Ft(f.appendChild(o),"script"),a&&_t(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,l=x.expando,u=x.cache,c=x.support.deleteExpando,f=x.event.special;for(;null!=(n=e[s]);s++)if((t||x.acceptData(n))&&(o=n[l],a=o&&u[o])){if(a.events)for(r in a.events)f[r]?x.event.remove(n,r):x.removeEvent(n,r,a.handle);
u[o]&&(delete u[o],c?delete n[l]:typeof n.removeAttribute!==i?n.removeAttribute(l):n[l]=null,p.push(o))}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){if(x.isFunction(e))return this.each(function(t){x(this).wrapAll(e.call(this,t))});if(this[0]){var t=x(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+w+")(.*)$","i"),Yt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+w+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=x._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=x._data(r,"olddisplay",ln(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&x._data(r,"olddisplay",i?n:x.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}x.fn.extend({css:function(e,n){return x.access(this,function(e,n,r){var i,o,a={},s=0;if(x.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=x.css(e,n[s],!1,o);return a}return r!==t?x.style(e,n,r):x.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=x.camelCase(n),u=e.style;if(n=x.cssProps[l]||(x.cssProps[l]=tn(u,l)),s=x.cssHooks[n]||x.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(x.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||x.cssNumber[l]||(r+="px"),x.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(u[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,l=x.camelCase(n);return n=x.cssProps[l]||(x.cssProps[l]=tn(e.style,l)),s=x.cssHooks[n]||x.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||x.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s.getPropertyValue(n)||s[n]:t,u=e.style;return s&&(""!==l||x.contains(e.ownerDocument,e)||(l=x.style(e,n)),Yt.test(l)&&Ut.test(n)&&(i=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=s.width,u.width=i,u.minWidth=o,u.maxWidth=a)),l}):a.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s[n]:t,u=e.style;return null==l&&u&&u[n]&&(l=u[n]),Yt.test(l)&&!zt.test(n)&&(i=u.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),u.left="fontSize"===n?"1em":l,l=u.pixelLeft+"px",u.left=i,a&&(o.left=a)),""===l?"auto":l});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=x.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=x.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=x.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=x.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=x.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function ln(e){var t=a,n=Gt[e];return n||(n=un(e,t),"none"!==n&&n||(Pt=(Pt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=un(e,t),Pt.detach()),Gt[e]=n),n}function un(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,n){x.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(x.css(e,"display"))?x.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===x.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,n){return n?x.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,n){x.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?x(e).position()[n]+"px":r):t}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(x.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Ct.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),x.param=function(e,n){var r,i=[],o=function(e,t){t=x.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,yn,vn=x.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Cn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=o.href}catch(Ln){yn=a.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(T)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(l){var u;return o[l]=!0,x.each(e[l]||[],function(e,l){var c=l(n,r,i);return"string"!=typeof c||a||o[c]?a?!(u=c):t:(n.dataTypes.unshift(c),s(c),!1)}),u}return s(n.dataTypes[0])||!o["*"]&&s("*")}function _n(e,n){var r,i,o=x.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),x.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&x.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Cn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_n(_n(e,x.ajaxSettings),t):_n(x.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,l,u,c,p=x.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?x(f):x.event,h=x.Deferred(),g=x.Callbacks("once memory"),m=p.statusCode||{},y={},v={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),k(0,t),this}};if(h.promise(C).complete=g.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=x.trim(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),qn(An,p,n,C),2===b)return C;l=p.global,l&&0===x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Nn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(x.lastModified[o]&&C.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&C.setRequestHeader("If-None-Match",x.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)C.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,C,p)===!1||2===b))return C.abort();w="abort";for(i in{success:1,error:1,complete:1})C[i](p[i]);if(u=qn(jn,p,n,C)){C.readyState=1,l&&d.trigger("ajaxSend",[C,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){C.abort("timeout")},p.timeout));try{b=1,u.send(y,k)}catch(N){if(!(2>b))throw N;k(-1,N)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,N=n;2!==b&&(b=2,s&&clearTimeout(s),u=t,a=i||"",C.readyState=e>0?4:0,c=e>=200&&300>e||304===e,r&&(w=Mn(p,C,r)),w=On(p,w,C,c),c?(p.ifModified&&(T=C.getResponseHeader("Last-Modified"),T&&(x.lastModified[o]=T),T=C.getResponseHeader("etag"),T&&(x.etag[o]=T)),204===e||"HEAD"===p.type?N="nocontent":304===e?N="notmodified":(N=w.state,y=w.data,v=w.error,c=!v)):(v=N,(e||!N)&&(N="error",0>e&&(e=0))),C.status=e,C.statusText=(n||N)+"",c?h.resolveWith(f,[y,N,C]):h.rejectWith(f,[C,N,v]),C.statusCode(m),m=t,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,p,c?y:v]),g.fireWith(f,[C,N]),l&&(d.trigger("ajaxComplete",[C,p]),--x.active||x.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,n){return x.get(e,t,n,"script")}}),x.each(["get","post"],function(e,n){x[n]=function(e,r,i,o){return x.isFunction(r)&&(o=o||i,i=r,r=t),x.ajax({url:e,type:n,dataType:o,data:r,success:i})}});function Mn(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){u.unshift(s);break}if(u[0]in r)a=u[0];else{for(s in r){if(!u[0]||e.converters[s+" "+u[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==u[0]&&u.unshift(a),r[a]):t}function On(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a)for(i in u)if(s=i.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(p){return{state:"parsererror",error:a?p:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),x.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=a.head||x("head")[0]||a.documentElement;return{send:function(t,i){n=a.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Fn=[],Bn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||x.expando+"_"+vn++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=x.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&x.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}x.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=x.ajaxSettings.xhr(),x.support.cors=!!Rn&&"withCredentials"in Rn,Rn=x.support.ajax=!!Rn,Rn&&x.ajaxTransport(function(n){if(!n.crossDomain||x.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,p;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=x.noop,$n&&delete Pn[a]),i)4!==l.readyState&&l.abort();else{p={},s=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);try{c=l.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,u)},n.async?4===l.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},x(e).unload($n)),Pn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Yn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),a=(x.cssNumber[e]||"px"!==o&&+r)&&Yn.exec(x.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;do s=s||".5",a/=s,x.style(n.elem,e,a+o);while(s!==(s=n.cur()/r)&&1!==s&&--l)}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=x.now()}function Zn(e,t,n){var r,i=(Qn[t]||[]).concat(Qn["*"]),o=0,a=i.length;for(;a>o;o++)if(r=i[o].call(n,t,e))return r}function er(e,t,n){var r,i,o=0,a=Gn.length,s=x.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,l=u.tweens.length;for(;l>a;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(tr(c,u.opts.specialEasing);a>o;o++)if(r=Gn[o].call(u,e,c,u.opts))return r;return x.map(c,Zn,u),x.isFunction(u.opts.start)&&u.opts.start.call(e,u),x.fx.timer(x.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function tr(e,t){var n,r,i,o,a;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=x.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(er,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,l,u=this,c={},p=e.style,f=e.nodeType&&nn(e),d=x._data(e,"fxshow");n.queue||(s=x._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ln(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",x.support.shrinkWrapBlocks||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Vn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show"))continue;c[r]=d&&d[r]||x.style(e,r)}if(!x.isEmptyObject(c)){d?"hidden"in d&&(f=d.hidden):d=x._data(e,"fxshow",{}),o&&(d.hidden=!f),f?x(e).show():u.done(function(){x(e).hide()}),u.done(function(){var t;x._removeData(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)a=Zn(f?d[r]:0,r,u),r in d||(d[r]=a.start,f&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}x.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),a=function(){var t=er(this,x.extend({},e),o);(i||x._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=x.timers,a=x._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=x._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,a=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=rr.prototype.init,x.fx.tick=function(){var e,n=x.timers,r=0;for(Xn=x.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||x.fx.stop(),Xn=t},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){Un||(Un=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(Un),Un=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){x.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,x.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},x.offset={setOffset:function(e,t,n){var r=x.css(e,"position");"static"===r&&(e.style.position="relative");var i=x(e),o=i.offset(),a=x.css(e,"top"),s=x.css(e,"left"),l=("absolute"===r||"fixed"===r)&&x.inArray("auto",[a,s])>-1,u={},c={},p,f;l?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),x.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(u.top=t.top-o.top+p),null!=t.left&&(u.left=t.left-o.left+f),"using"in t?t.using.call(e,u):i.css(u)}},x.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===x.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(n=e.offset()),n.top+=x.css(e[0],"borderTopWidth",!0),n.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-x.css(r,"marginTop",!0),left:t.left-n.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);x.fn[e]=function(i){return x.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?x(a).scrollLeft():o,r?o:x(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return x.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}x.each({Height:"height",Width:"width"},function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){x.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return x.access(this,function(n,r,i){var o;return x.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?x.css(n,r,s):x.style(n,r,i,s)},n,a?i:t,a,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:(e.jQuery=e.$=x,"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}))})(window);

!function(t){"use strict";function i(){this.$dom=t(document),this.$html=this.$dom.find("html"),this.isOldie=!!this.$html.hasClass("oldie"),this.click="click",this.onReady=this.onOldie=this.onTouch=!1,this.autoInit="false"===t("script[gumby-init]").attr("gumby-init")?!1:!0,this.debugMode=Boolean(t("script[gumby-debug]").length),this.touchDevice=!!(Modernizr.touch||window.navigator.userAgent.indexOf("Windows Phone")>0),this.gumbyTouch=!1,this.touchEvents="js/libs",this.breakpoint=Number(t("script[gumby-breakpoint]").attr("gumby-breakpoint"))||768,this.touchEventsLoaded=!1,this.uiModulesReady=!1,this.uiModules={},this.inits={};var i=t("script[gumby-touch]").attr("gumby-touch"),o=t("script[gumby-path]").attr("gumby-path");"false"===i?this.touchEvents=!1:i?this.touchEvents=i:o&&(this.touchEvents=o),this.touchDevice&&(this.click+=" tap"),this.touchDevice&&t(window).width()<this.breakpoint?(this.$html.addClass("gumby-touch"),this.gumbyTouch=!0):this.$html.addClass("gumby-no-touch"),this.debugMode&&this.debug("Gumby is in debug mode")}i.prototype.init=function(t){var i=this,o=t?t:{};return this.$dom.ready(function(){o.debug&&(i.debugMode=!0),i.debug("Initializing Gumby");var t=o.uiModules?o.uiModules:!1;i.initUIModules(t),i.onReady&&i.onReady(),i.isOldie&&i.onOldie&&i.onOldie(),Modernizr.touch&&i.onTouch&&i.onTouch()}),this},i.prototype.helpers=function(){this.onReady&&this.onReady(),this.isOldie&&this.onOldie&&this.onOldie(),Modernizr.touch&&this.onTouch&&this.onTouch()},i.prototype.ready=function(t){return t&&"function"==typeof t&&(this.onReady=t),this},i.prototype.oldie=function(t){return t&&"function"==typeof t&&(this.onOldie=t),this},i.prototype.touch=function(t){return t&&"function"==typeof t&&(this.onTouch=t),this},i.prototype.console=function(t,i){this.debugMode&&window.console&&console[console[t]?t:"log"](i.length>1?Array.prototype.slice.call(i):i[0])},i.prototype.log=function(){this.console("log",arguments)},i.prototype.debug=function(){this.console("debug",arguments)},i.prototype.warn=function(){this.console("warn",arguments)},i.prototype.error=function(){this.console("error",arguments)},i.prototype.dump=function(){return{$dom:this.$dom,isOldie:this.isOldie,touchEvents:this.touchEvents,debugMode:this.debugMode,autoInit:this.autoInit,uiModules:this.uiModules,click:this.click}},i.prototype.selectAttr=function(){for(var t=0;t<arguments.length;t++){var i=arguments[t],o="data-"+arguments[t],s="gumby-"+arguments[t];if(this.is("["+o+"]"))return this.attr(o)?this.attr(o):!0;if(this.is("["+s+"]"))return this.attr(s)?this.attr(s):!0;if(this.is("["+i+"]"))return this.attr(i)?this.attr(i):!0}return!1},i.prototype.addInitalisation=function(t,i){this.inits[t]=i},i.prototype.initialize=function(t,i){if("object"==typeof t){var o=0;for(o;o<t.length;o++)this.inits[t[o]]&&"function"==typeof this.inits[t[o]]?this.inits[t[o]](i):this.error("Error initializing module: "+t[o])}else this.inits[t]&&"function"==typeof this.inits[t]?this.inits[t](i):this.error("Error initializing module: "+t);return this},i.prototype.UIModule=function(t){var i=t.module;this.uiModules[i]=t},i.prototype.initUIModules=function(t){var i,o,s=this.uiModules;t&&(s=t);for(i in s)o=t?s[i]:i,this.uiModules[o].init()},window.Gumby=new i}(jQuery);
!function(t){"use strict";function i(){this.$dom=t(document),this.$html=this.$dom.find("html"),this.isOldie=!!this.$html.hasClass("oldie"),this.click="click",this.onReady=this.onOldie=this.onTouch=!1,this.autoInit="false"===t("script[gumby-init]").attr("gumby-init")?!1:!0,this.debugMode=Boolean(t("script[gumby-debug]").length),this.touchDevice=!!(Modernizr.touch||window.navigator.userAgent.indexOf("Windows Phone")>0),this.gumbyTouch=!1,this.touchEvents="js/libs",this.breakpoint=Number(t("script[gumby-breakpoint]").attr("gumby-breakpoint"))||768,this.touchEventsLoaded=!1,this.uiModulesReady=!1,this.uiModules={},this.inits={};var i=t("script[gumby-touch]").attr("gumby-touch"),e=t("script[gumby-path]").attr("gumby-path");"false"===i?this.touchEvents=!1:i?this.touchEvents=i:e&&(this.touchEvents=e),this.touchDevice&&(this.click+=" tap"),this.touchDevice&&t(window).width()<this.breakpoint?(this.$html.addClass("gumby-touch"),this.gumbyTouch=!0):this.$html.addClass("gumby-no-touch"),this.debugMode&&this.debug("Gumby is in debug mode")}i.prototype.init=function(t){var i=this,e=t?t:{};return this.$dom.ready(function(){e.debug&&(i.debugMode=!0),i.debug("Initializing Gumby");var t=e.uiModules?e.uiModules:!1;i.initUIModules(t),i.onReady&&i.onReady(),i.isOldie&&i.onOldie&&i.onOldie(),Modernizr.touch&&i.onTouch&&i.onTouch()}),this},i.prototype.helpers=function(){this.onReady&&this.onReady(),this.isOldie&&this.onOldie&&this.onOldie(),Modernizr.touch&&this.onTouch&&this.onTouch()},i.prototype.ready=function(t){return t&&"function"==typeof t&&(this.onReady=t),this},i.prototype.oldie=function(t){return t&&"function"==typeof t&&(this.onOldie=t),this},i.prototype.touch=function(t){return t&&"function"==typeof t&&(this.onTouch=t),this},i.prototype.console=function(t,i){this.debugMode&&window.console&&console[console[t]?t:"log"](i.length>1?Array.prototype.slice.call(i):i[0])},i.prototype.log=function(){this.console("log",arguments)},i.prototype.debug=function(){this.console("debug",arguments)},i.prototype.warn=function(){this.console("warn",arguments)},i.prototype.error=function(){this.console("error",arguments)},i.prototype.dump=function(){return{$dom:this.$dom,isOldie:this.isOldie,touchEvents:this.touchEvents,debugMode:this.debugMode,autoInit:this.autoInit,uiModules:this.uiModules,click:this.click}},i.prototype.selectAttr=function(){for(var t=0;t<arguments.length;t++){var i=arguments[t],e="data-"+arguments[t],n="gumby-"+arguments[t];if(this.is("["+e+"]"))return this.attr(e)?this.attr(e):!0;if(this.is("["+n+"]"))return this.attr(n)?this.attr(n):!0;if(this.is("["+i+"]"))return this.attr(i)?this.attr(i):!0}return!1},i.prototype.addInitalisation=function(t,i){this.inits[t]=i},i.prototype.initialize=function(t,i){if("object"==typeof t){var e=0;for(e;e<t.length;e++)this.inits[t[e]]&&"function"==typeof this.inits[t[e]]?this.inits[t[e]](i):this.error("Error initializing module: "+t[e])}else this.inits[t]&&"function"==typeof this.inits[t]?this.inits[t](i):this.error("Error initializing module: "+t);return this},i.prototype.UIModule=function(t){var i=t.module;this.uiModules[i]=t},i.prototype.initUIModules=function(t){var i,e,n=this.uiModules;t&&(n=t);for(i in n)e=t?n[i]:i,this.uiModules[e].init()},window.Gumby=new i}(jQuery),!function(t){"use strict";function i(t){Gumby.debug("Initializing Checkbox",t),this.$el=t,this.$input=this.$el.find("input[type=checkbox]");var i=this;this.$el.on(Gumby.click,function(t){t.preventDefault(),i.$input.is("[disabled]")||(i.$el.hasClass("checked")?i.update(!1):i.update(!0))}).on("gumby.check",function(){Gumby.debug("Check event triggered",i.$el),i.update(!0)}).on("gumby.uncheck",function(){Gumby.debug("Uncheck event triggered",i.$el),i.update(!1)}),(this.$input.prop("checked")||this.$el.hasClass("checked"))&&i.update(!0)}i.prototype.update=function(t){var i=this.$el.find("span");t?(Gumby.debug("Checking Checkbox",this.$el),i.append('<i class="icon-check" />'),this.$input.prop("checked",!0),Gumby.debug("Triggering onCheck event",this.$el),Gumby.debug("Triggering onChange event",this.$el),this.$el.addClass("checked").trigger("gumby.onCheck").trigger("gumby.onChange")):(Gumby.debug("Unchecking Checkbox",this.$el),this.$input.prop("checked",!1),i.find("i").remove(),Gumby.debug("Triggering onUncheck event",this.$el),Gumby.debug("Triggering onChange event",this.$el),this.$el.removeClass("checked").trigger("gumby.onUncheck").trigger("gumby.onChange"))},Gumby.addInitalisation("checkbox",function(){t(".checkbox").each(function(){var e=t(this);return e.data("isCheckbox")?!0:(e.data("isCheckbox",!0),new i(e),void 0)})}),Gumby.UIModule({module:"checkbox",events:["onCheck","onUncheck","onChange","check","uncheck"],init:function(){Gumby.initialize("checkbox")}})}(jQuery),!function(t){"use strict";function i(i){Gumby.debug("Initializing Fixed Position",i),this.$el=i,this.$window=t(window),this.fixedPoint="",this.pinPoint=!1,this.fixedPointjQ=!1,this.pinPointjQ=!1,this.offset=0,this.pinOffset=0,this.top=0,this.constrainEl=!0,this.state=!1,this.measurements={left:0,width:0},this.setup();var e=this;this.$window.on("scroll load",function(){e.monitorScroll()}),this.$el.on("gumby.initialize",function(){Gumby.debug("Re-initializing Fixed Position",i),e.setup(),e.monitorScroll()})}i.prototype.setup=function(){var t=this;this.fixedPoint=this.parseAttrValue(Gumby.selectAttr.apply(this.$el,["fixed"])),this.pinPoint=Gumby.selectAttr.apply(this.$el,["pin"])||!1,this.offset=Number(Gumby.selectAttr.apply(this.$el,["offset"]))||0,this.pinOffset=Number(Gumby.selectAttr.apply(this.$el,["pinoffset"]))||0,this.top=Number(Gumby.selectAttr.apply(this.$el,["top"]))||0,this.constrainEl=Gumby.selectAttr.apply(this.$el,["constrain"])||!0,"false"===this.constrainEl&&(this.constrainEl=!1),this.$parent=this.$el.parents(".columns, .column, .row"),this.$parent=this.$parent.length?this.$parent.first():!1,this.parentRow=this.$parent?!!this.$parent.hasClass("row"):!1,this.pinPoint&&(this.pinPoint=this.parseAttrValue(this.pinPoint)),this.fixedPointjQ=this.fixedPoint instanceof jQuery,this.pinPointjQ=this.pinPoint instanceof jQuery,this.$parent&&this.constrainEl&&(this.measure(),this.$window.resize(function(){t.state&&(t.measure(),t.constrain())}))},i.prototype.monitorScroll=function(){var t=this.$window.scrollTop(),i=this.fixedPointjQ?this.fixedPoint.offset().top:this.fixedPoint,e=!1;this.pinPoint&&(e=this.pinPointjQ?this.pinPoint.offset().top:this.pinPoint),this.offset&&(i-=this.offset),this.pinOffset&&(e-=this.pinOffset),t>=i&&"fixed"!==this.state?(!e||e>t)&&this.fix():i>t&&"fixed"===this.state?this.unfix():e&&t>=e&&"pinned"!==this.state&&this.pin()},i.prototype.fix=function(){Gumby.debug("Element has been fixed",this.$el),Gumby.debug("Triggering onFixed event",this.$el),this.state="fixed",this.$el.css({top:this.top}).addClass("fixed").removeClass("unfixed pinned").trigger("gumby.onFixed"),this.$parent&&this.constrain()},i.prototype.unfix=function(){Gumby.debug("Element has been unfixed",this.$el),Gumby.debug("Triggering onUnfixed event",this.$el),this.state="unfixed",this.$el.addClass("unfixed").removeClass("fixed pinned").trigger("gumby.onUnfixed")},i.prototype.pin=function(){Gumby.debug("Element has been pinned",this.$el),Gumby.debug("Triggering onPinned event",this.$el),this.state="pinned",this.$el.css({top:this.$el.offset().top}).addClass("pinned fixed").removeClass("unfixed").trigger("gumby.onPinned")},i.prototype.constrain=function(){Gumby.debug("Constraining element",this.$el),this.$el.css({left:this.measurements.left,width:this.measurements.width})},i.prototype.measure=function(){var t;this.measurements.left=this.$parent.offset().left,this.measurements.width=this.$parent.width(),this.parentRow&&(t=Number(this.$parent.css("paddingLeft").replace(/px/,"")),t&&(this.measurements.left+=t))},i.prototype.parseAttrValue=function(i){if(t.isNumeric(i))return Number(i);if("top"===i)return this.$el.offset().top;var e=t(i);return e.length?e:(Gumby.error("Cannot find Fixed target: "+i),!1)},Gumby.addInitalisation("fixed",function(e){t("[data-fixed],[gumby-fixed],[fixed]").each(function(){var n=t(this);return n.data("isFixed")&&!e?!0:n.data("isFixed")&&e?(n.trigger("gumby.initialize"),!0):(n.data("isFixed",!0),new i(n),void 0)})}),Gumby.UIModule({module:"fixed",events:["initialize","onFixed","onUnfixed"],init:function(){Gumby.initialize("fixed")}})}(jQuery),!function(t){"use strict";function i(t){Gumby.debug("Initializing Navbar",t),this.$el=t,this.$dropDowns=this.$el.find("li:has(.dropdown)");var i=this,e=this.$el.attr("gumby-persist");"undefined"==typeof e&&"false"!==e&&this.$el.find("li:not(:has(.dropdown)) a").on(Gumby.click,function(){i.$el.find("ul").removeClass("active")}),this.$dropDowns.on(Gumby.click,this.toggleDropdown).on("swiperight",this.openLink),"#"!==this.$dropDowns.children("a").attr("href")&&this.$dropDowns.children("a").append('<i class="icon-popup"></i>').children("i").on(Gumby.click,this.openLink),this.$el.find("li:not(:has(.dropdown)) a[href]").on(Gumby.click,this.openLink)}Gumby.gumbyTouch&&(i.prototype.toggleDropdown=function(i){if(i.preventDefault(),t(this).parents(".dropdown")&&i.stopImmediatePropagation(),!t(i.target).is("i")){var e=t(this);e.hasClass("active")?e.removeClass("active"):e.addClass("active")}},i.prototype.openLink=function(i){i.preventDefault();var e,n=t(this),s=n;n.is("i")?s=n.parent("a"):n.is("li")&&(s=n.children("a")),e=s.attr("href"),"blank"==s.attr("target")?window.open(e):window.location=e},Gumby.addInitalisation("navbar",function(){t(".navbar").each(function(){var e=t(this);return e.data("isNavbar")?!0:(e.data("isNavbar",!0),new i(e),void 0)})}),Gumby.UIModule({module:"navbar",events:[],init:function(){Gumby.initialize("navbar")}}))}(jQuery),!function(t){"use strict";function i(t){Gumby.debug("Initializing Radio Button",t),this.$el=t,this.$input=this.$el.find("input[type=radio]");var i=this;this.$el.on(Gumby.click,function(t){t.preventDefault(),i.$input.is("[disabled]")||i.update()}).on("gumby.check",function(){Gumby.debug("Check event triggered",i.$el),i.update()}),(this.$input.prop("checked")||this.$el.hasClass("checked"))&&i.update(!0)}i.prototype.update=function(){if(!(this.$el.hasClass("checked")&&this.$input.prop("checked")&&this.$el.find("i.icon-dot").length)){Gumby.debug("Updating Radio Button group",this.$el);var i=this.$el.find("span"),e='input[name="'+this.$input.attr("name")+'"]';t(".radio").has(e).removeClass("checked").find("input").prop("checked",!1).end().find("i").remove(),this.$input.prop("checked",!0),i.append('<i class="icon-dot" />'),Gumby.debug("Triggering onCheck event",this.$el),this.$el.addClass("checked").trigger("gumby.onCheck")}},Gumby.addInitalisation("radiobtn",function(){t(".radio").each(function(){var e=t(this);return e.data("isRadioBtn")?!0:(e.data("isRadioBtn",!0),new i(e),void 0)})}),Gumby.UIModule({module:"radiobtn",events:["onCheck","check"],init:function(){Gumby.initialize("radiobtn")}})}(jQuery),!function(t){"use strict";function i(i){Gumby.debug("Initializing Retina",i),this.$el=i,this.imageSrc=this.$el.attr("src"),this.retinaSrc=this.fetchRetinaImage(),this.$retinaImg=t(new Image);var e=this;return this.retinaSrc?(this.$retinaImg.attr("src",this.retinaSrc).load(function(){e.retinaImageLoaded()}).error(function(){Gumby.error("Couln't load retina image: "+e.retinaSrc)}),void 0):!1}i.prototype.fetchRetinaImage=function(){var t=this.imageSrc,i=this.imageSrc.search(/(\.|\/)(gif|jpe?g|png)$/i);return 0>i?!1:t.substr(0,i)+"@2x"+t.substr(i,t.length)},i.prototype.retinaImageLoaded=function(){Gumby.debug("Swapping image for retina version",this.$el),Gumby.debug("Triggering onRetina event",this.$el),this.$el.attr("src",this.$retinaImg.attr("src")).trigger("gumby.onRetina")},Gumby.addInitalisation("retina",function(){!window.devicePixelRatio||window.devicePixelRatio<=1||t("img[data-retina],img[gumby-retina],img[retina]").each(function(){var e=t(this);return e.data("isRetina")?!0:(e.data("isRetina",!0),new i(e),void 0)})}),Gumby.UIModule({module:"retina",events:["onRetina"],init:function(){Gumby.initialize("retina")}})}(jQuery),!function(t){"use strict";function i(t){Gumby.debug("Initializing Skiplink",t),this.$el=t,this.targetPos=0,this.duration=0,this.offset=!1,this.easing="",this.update=!1,this.setup();var i=this;this.$el.on(Gumby.click+" gumby.skip",function(t){t.preventDefault(),"skip"===t.namespace&&Gumby.debug("Skip event triggered",i.$el),i.update?i.calculateTarget(i.skipTo):i.skipTo()}).on("gumby.initialize",function(){Gumby.debug("Re-initializing Skiplink",i.$el),i.setup()})}i.prototype.setup=function(){this.duration=Number(Gumby.selectAttr.apply(this.$el,["duration"]))||200,this.offset=Gumby.selectAttr.apply(this.$el,["offset"])||!1,this.easing=Gumby.selectAttr.apply(this.$el,["easing"])||"swing",this.update=Gumby.selectAttr.apply(this.$el,["update"])?!0:!1,this.calculateTarget()},i.prototype.calculateTarget=function(i){var e,n=Gumby.selectAttr.apply(this.$el,["goto"]);if("top"==n)this.targetPos=0;else if(t.isNumeric(n))this.targetPos=Number(n);else{if(e=t(n),!e.length)return Gumby.error("Cannot find skiplink target: "+n),!1;this.targetPos=e.offset().top}i&&i.apply(this)},i.prototype.skipTo=function(){Gumby.debug("Skipping to target",this.$el);var i=this;t("html,body").animate({scrollTop:this.calculateOffset()},this.duration,this.easing).promise().done(function(){Gumby.debug("Triggering onComplete event",i.$el),i.$el.trigger("gumby.onComplete")})},i.prototype.calculateOffset=function(){if(!this.offset)return this.targetPos;var t=this.offset.substr(0,1),i=Number(this.offset.substr(1,this.offset.length));return"-"===t?this.targetPos-i:"+"===t?this.targetPos+i:void 0},Gumby.addInitalisation("skiplink",function(e){t(".skiplink > a, .skip").each(function(){var n=t(this);return n.data("isSkipLink")&&!e?!0:n.data("isSkipLink")&&e?(n.trigger("gumby.initialize"),!0):(n.data("isSkipLink",!0),new i(n),void 0)})}),Gumby.UIModule({module:"skiplink",events:["initialize","onComplete","skip"],init:function(){Gumby.initialize("skiplink")}})}(jQuery),!function(t){"use strict";function i(i){Gumby.debug("Initializing Tabs",i),this.$el=i,this.$nav=this.$el.find("> ul.tab-nav > li"),this.$content=this.$el.children(".tab-content");var e=this;this.$nav.children("a").on(Gumby.click,function(i){i.preventDefault(),e.click(t(this))}),this.$el.on("gumby.set",function(t,i){Gumby.debug("Set event triggered",e.$el),e.set(t,i)})}i.prototype.click=function(t){var i=t.parent().index();this.$nav.eq(i).add(this.$content.eq(i)).hasClass("active")||(Gumby.debug("Setting active tab to "+i,this.$el),this.$nav.add(this.$content).removeClass("active"),this.$nav.eq(i).add(this.$content.eq(i)).addClass("active"),Gumby.debug("Triggering onChange event",this.$el),this.$el.trigger("gumby.onChange",i))},i.prototype.set=function(t,i){this.$nav.eq(i).find("a").trigger(Gumby.click)},Gumby.addInitalisation("tabs",function(){t(".tabs").each(function(){var e=t(this);return e.data("isTabs")?!0:(e.data("isTabs",!0),new i(e),void 0)})}),Gumby.UIModule({module:"tabs",events:["onChange","set"],init:function(){Gumby.initialize("tabs")}})}(jQuery),!function(t){"use strict";function i(i){this.$el=t(i),this.targets=[],this.on="",this.className="",this.self=!1,this.$el.length&&(Gumby.debug("Initializing Toggle",i),this.init())}function e(i){this.$el=t(i),this.targets=[],this.on="",this.className="",this.self=!1,this.$el.length&&(Gumby.debug("Initializing Switch",i),this.init())}i.prototype.init=function(){var t=this;this.setup(),this.$el.on(this.on,function(i){i.preventDefault(),t.trigger(t.triggered)}).on("gumby.trigger",function(){Gumby.debug("Trigger event triggered",t.$el),t.trigger(t.triggered)}).on("gumby.initialize",function(){Gumby.debug("Re-initializing "+t.constructor,$el),t.setup()})},i.prototype.setup=function(){this.targets=this.parseTargets(),this.on=Gumby.selectAttr.apply(this.$el,["on"])||Gumby.click,this.className=Gumby.selectAttr.apply(this.$el,["classname"])||"active",this.self="false"===Gumby.selectAttr.apply(this.$el,["self"])},i.prototype.parseTargets=function(){var i=Gumby.selectAttr.apply(this.$el,["trigger"]),e=0,n=[];return i?(e=i.indexOf("|"),-1===e?this.checkTargets([i])?[t(i)]:!1:(n=i.split("|"),this.checkTargets(n)?n.length>1?[t(n[0]),t(n[1])]:[t(n[0])]:!1)):!1},i.prototype.checkTargets=function(i){var e=0;for(e;e<i.length;e++)if(i[e]&&!t(i[e]).length)return Gumby.error("Cannot find "+this.constructor.name+" target: "+i[e]),!1;return!0},i.prototype.triggered=function(){Gumby.debug("Triggering onTrigger event",this.$el),this.$el.trigger("gumby.onTrigger",[this.$el.hasClass(this.className)])},e.prototype=new i,e.prototype.constructor=e,i.prototype.trigger=function(t){Gumby.debug("Triggering Toggle",this.$el);var i;this.targets?1==this.targets.length?this.$el.add(this.targets[0]).toggleClass(this.className):this.targets.length>1&&(this.targets[0].hasClass(this.className)?(i=this.targets[0],this.self||(i=i.add(this.$el)),i.removeClass(this.className),this.targets[1].addClass(this.className)):(i=this.targets[0],this.self||(i=i.add(this.$el)),i.addClass(this.className),this.targets[1].removeClass(this.className))):this.$el.toggleClass(this.className),t&&"function"==typeof t&&t.apply(this)},e.prototype.trigger=function(t){Gumby.debug("Triggering Switch",this.$el);var i;this.targets?1==this.targets.length?(i=this.targets[0],this.self||(i=i.add(this.$el)),i.addClass(this.className)):this.targets.length>1&&(i=this.targets[0],this.self||(i=i.add(this.$el)),i.addClass(this.className),this.targets[1].removeClass(this.className)):this.$el.addClass(this.className),t&&"function"==typeof t&&t.apply(this)},Gumby.addInitalisation("toggles",function(e){t(".toggle").each(function(){var n=t(this);return n.data("isToggle")&&!e?!0:(n.data("isToggle")&&e&&n.trigger("gumby.initialize"),n.data("isToggle",!0),new i(n),void 0)})}),Gumby.addInitalisation("switches",function(i){t(".switch").each(function(){var n=t(this);return n.data("isSwitch")&&!i?!0:n.data("isSwitch")&&i?(n.trigger("gumby.initialize"),!0):(n.data("isSwitch",!0),new e(n),void 0)})}),Gumby.UIModule({module:"toggleswitch",events:["initialize","trigger","onTrigger"],init:function(){Gumby.initialize("switches"),Gumby.initialize("toggles")}})}(jQuery),!function(t){"use strict";function i(t,i){Gumby&&Gumby.debug("Initializing Validation",t),this.$this=t,this.$field=this.$this.parents(".field"),this.req=i||function(){return!!this.$this.val().length};var e=this;this.$this.is("[type=checkbox], [type=radio]")?(this.$field=this.$this.parent("label"),this.$field.on("gumby.onChange",function(){e.validate()})):this.$this.is("select")?(this.$field=this.$this.parents(".picker"),this.$field.on("change",function(){e.validate()})):this.$this.on("blur",function(t){9!==t.which&&e.validate()})}i.prototype.validate=function(){var t=this.req(this.$this);return t?this.$field.removeClass("danger").addClass("success"):this.$field.removeClass("success").addClass("danger"),t},t.fn.validation=function(e){var n=t.extend({submit:!1,fail:!1,required:[]},e),s=[];return this.each(function(){if(!n.required.length)return!1;var e,o=t(this),a=n.required.length;for(e=0;a>e;e++)s.push(new i(o.find('[name="'+n.required[e].name+'"]'),n.required[e].validate||!1));o.on("submit",function(t){var i=!1;if(!o.data("passed")){t.preventDefault();var e,a=s.length;for(e=0;a>e;e++)s[e].validate()||(i=!0);if(i){if(n.fail&&"function"==typeof n.fail)return n.fail(),void 0}else{if(n.submit&&"function"==typeof n.submit)return n.submit(o.serializeArray()),void 0;o.data("passed",!0).submit()}}})})}}(jQuery),!function(t){"use strict";Gumby.touchDevice&&Gumby.touchEvents||!Gumby.autoInit?Gumby.touchEvents&&Gumby.touchDevice&&(Gumby.debug("Loading jQuery mobile touch events"),yepnope.errorTimeout=2e3,Modernizr.load({test:Modernizr.touch,yep:"/etc/designs/cimbconsumer/clientlibs/js/libs/jquery.mobile.custom.min.js",complete:function(){t.mobile||Gumby.error("Error loading jQuery mobile touch events"),Gumby.touchEventsLoaded=!0,Gumby.autoInit?window.Gumby.init():Gumby.uiModulesReady&&Gumby.helpers()}})):window.Gumby.init(),"function"==typeof define&&define.amd&&define(window.Gumby)}(jQuery);
/**
* Gumby Init
*/

!function($) {

	'use strict';

	// auto initialize
	if(Gumby.autoInit) {
		window.Gumby.init();
	}
	
	// load jQuery mobile touch events
	if(Gumby.touchEvents && Gumby.touchDevice) {
		Gumby.debug('Loading jQuery mobile touch events');
		// set timeout to 2sec
		yepnope.errorTimeout = 2000;
		Modernizr.load({
			test: Modernizr.touch,
			yep: '/etc/designs/cimbconsumer/clientlibs/js/libs/jquery.mobile.custom.min.js',
			complete: function() {
				// error loading jQuery mobile
				if(!$.mobile) {
					Gumby.error('Error loading jQuery mobile touch events');
				}

				// if not auto initializing
				// this will allow helpers to fire when initialized
				Gumby.touchEventsLoaded = true;
				
				if(!Gumby.autoInit && Gumby.uiModulesReady) {
					Gumby.helpers();
				}
			}
		});
	}
	
	// if AMD return Gumby object to define
	if(typeof define == "function" && define.amd) {
		define(window.Gumby);
	}
}(jQuery);

/* handle IE9 console problem */
if (!window.console) { 
  window.console = {
    log: function () {},
    debug: function () {},
    info: function () {},
    warn: function () {},
    error: function () {}
  }; 
}

// Gumby is ready to go
Gumby.ready(function() {
    Gumby.log('Gumby is ready to go...', Gumby.dump());

    // placeholder polyfil
    if (Gumby.isOldie || Gumby.$dom.find('html').hasClass('ie9')) {
        $('input, textarea').placeholder();
    }

    // skip link and toggle on one element
    // when the skip link completes, trigger the switch
    $('#skip-switch').on('gumby.onComplete', function() {
        $(this).trigger('gumby.trigger');
    });

    // Oldie document loaded
}).oldie(function() {
    Gumby.warn("This is an oldie browser...");

    // Touch devices loaded
}).touch(function() {
    Gumby.log("This is a touch enabled device...");
});

$(function() {
    $(".m-nav-back-btn").click(function(e) {
        e.preventDefault();
    })
    $(".title-w-hyperlinks .inline-dropdown .cur-title").html($(".title-dropdown li.selected a").html());

    //external links    
    $(".external-links .switch").click(function() {
        $("#external-site").find(".more-link").prop("href", $(this).attr("external-link"));
    });
    $("#external-site .more-link").click(function() {
        $('#external-site .close').trigger('gumby.trigger');
    });

    $(".external, .manualswitch").click(function() {
        $("body").find("#external-site .more-link").prop("href", $(this).attr("external-link"));
    });

    $(".switch").click(function() {
        var obj = $(this)
        if (obj.attr("data-subject")) {
            $(".form-main-subject").html(obj.attr("data-subject")),
                $(".hidden-subject").val(obj.attr("data-subject"));
        }
    });

    //Grab data-category detail
    // $(".switch").click(function() {
    //     var category = $(this).data("category");
    // });

    //Refresh page after close LUCY popup

    $('#submit_success_popup a').click(function(e) {
        location.reload(true);
    });

    // Show/Hide Content
    $(".see-less-details-btn a").click(function() {
        var obj = $(this)
        var objContent = obj.parents(".show-hide-content").find(".hide-content")
        objContent.slideToggle(200, function() {
            obj.toggleClass("active");
        })

    })

    // Jill @ XM Asia
    // Adding responsiveness to the table
    $(".two-columns-answer table, .faq-listing-answer table, .text table, .loan-repayment-table-container table, .calc-mortgage-table table").wrap("<div class='table-respond'></div>");

    // Jill @ XM Asia
    // FAQ Listing Controls
    $(".faq-listing-control a").click(function() {
        $(this).parents(".faq-listing").find(".faq-listing-hide").slideToggle();
        $(this).toggleClass("active");
    });

    // Jill @ XM Asia
    // Mobile Navigation for Two Columns (FAQ & Rates & Charges)
    // $(".m-hassub i, .two-columns-mobile-nav .title-dropdown li:first-child a:first-child").click(function(){

    //     var obj = $(this)
    //     var objNext = obj.next()
    //     if(objNext.hasClass("m-sublist"))
    //     {
    //         obj.toggleClass("icon-roundl_bottom2")   
    //         .toggleClass("icon-roundl_top2")
    //     }
    //     obj.parents("li").find(".m-sublist").slideToggle()
    // })

    //modified by Shen Li for easier usability/tapping on mobile

    $(".title-dropdown li a").click(function() {
        var obj = $(this)
        var objIcon = $(this).parent().find('.m-hassub i')

        {
            objIcon.toggleClass("icon-roundl_bottom2")
                .toggleClass("icon-roundl_top2")
        }
        obj.parents("li").find(".m-sublist").slideToggle()
    })

    // Jill @ XM Asia
    // Adding a class .selected to the last-child breadcrumb
    $(".breadcrumbs-item:last-child a").addClass("selected");
    // Addon
    $(".breadcrumbs-item:last-child a.selected").parent().addClass("removearrow");

})

// For Promo Listing
$(document).ready(function() {
    setAllToMaxHeight($(".promo-item"));
})

$(window).resize(function() {

    setAllToMaxHeight($(".promo-item"))
})

function hasHorizontalScrollBar(ele) {

    if (ele[0].scrollWidth > ele.width())
        return true;
    else
        return false;
}


function setAllToMaxHeight(ele) {

    ele.css("height", "auto")
        // console.log($.map( ele , function(e){ return $(e).height() }));
    return ele.height(Math.max.apply(ele, $.map(ele, function(e) {
        return $(e).height()
    })));
}

function setAllToMaxHeightWithHiddenElements(ele) {

    ele.css("height", "auto")
        // console.log($.map( ele , function(e){ if($(e).is(':visible')) return $(e).height(); else return 0; }) );
    return ele.height(Math.max.apply(ele, $.map(ele, function(e) {
        if ($(e).is(':visible')) return $(e).height();
        else return 0;
    })));
}


function bannerResize() {
    var totalBanner = $(".banner-brief-items li").length;
    var windowWidth = $(window).width();

    if (windowWidth >= 1006)
        windowWidth = 270;

    var item_width = windowWidth;

    $(".banner-brief-panel").css("width", windowWidth)
    $(".banner-brief-items").css("width", (windowWidth * (totalBanner + 1)));
    $(".banner-brief-items li").css("width", (windowWidth - 40));
    $(".banner-brief-viewport").css("width", windowWidth);
    //$(".banner-all-promotions-link").css("width",(windowWidth - 40))
    $('.banner-brief-items').css({
        'margin-left': -(item_width)
    });

}

function resizeBannerContent() {
    // Disabled because it's cropping promotion tiles where $(".full-width-img") appears
    // $('.promotion-banner-mask-2-col').css({
    //     width: $(".full-width-img").width() + "px",
    //     height: $(".full-width-img").height() + "px"
    // })
}

function resizeMobileSecuredDropdown(windowHeight) {
    var primaryLogo = $(".header-primary-cimb-logo").height()
    var mobileSecuredNavHeight = $(".mobile-secured-nav").height()
    if (windowHeight > mobileSecuredNavHeight)
        $(".mobile-secured-nav").css("height", windowHeight + 50)
        //$(".mobile-secured-nav").css("height",windowHeight)
    else
        $(".mobile-secured-nav").css("height", ($(window).height() - primaryLogo))



}

function resizeSearch(windowHeight) {

    var obj = $(".search-container")

    var searchWrapperHeight = obj.height()


    var aHeight = $(".t-most-header").height()
    var bHeight = $(".header-primary").height()


    /*
    cHeight = parseInt(cHeight) 
    cHeight = cHeight - 40
    */

    if ($(".t-most-header").css("display") == "block")
        obj.css("height", (windowHeight - (aHeight + bHeight)))
    else
        obj.css("height", (windowHeight - (bHeight)))


    if ($(".search-popup").css("display") == "block") {
        offHTMLBodyScroll()
    }



}



function resizeMobileMainDropdown() {
    var a = $(".mobile-main-segment").height()
    var b = $(".mobile-cimb-logo").height() + parseInt($(".mobile-cimb-logo").css("padding-top")) + parseInt($(".mobile-cimb-logo").css("padding-bottom"))




    var viewportHeight = $(window).height() - (a + b)

    //lilsizzo$(".mobile-mega-sitemap-nav").css("height",viewportHeight)
    $(".mobile-mega-dropdown").css("height", $(window).height())


    //$(".mobile-mega-dropdown").css("height",($(window).height() +20))
    //$(".mobile-mega-sitemap-second-tier-menu").css("height",viewportHeight)

}

function mobileSecureSlideUp(obj, windowHeight) {
    $(".mobile-secured-dropdown").slideUp("normal", function() {
        obj.addClass("mobile-secured-opened")

        onHTMLBodyScroll()
        resizeMobileSecuredDropdown(windowHeight)
        $(".header-login-panel .icon").removeClass("bg-gray6")
    })
}

function doSearch(type) {

    $('.search-wrapper').show()

}

function openURL(url) {
    // do URL tracking AJAX here before forwarding
    window.location = url;
}

$(function() {

    $('audio,video').mediaelementplayer({
        plugins: ['flash', 'silverlight']
    });

    $(window).on("resize scroll", scrollingForSectionWithHyperLink).trigger("scroll")

    // $(".specifiy-investment-enq-input").click(function(){
    //     $(".specifiy-investment-enq").toggle()
    // })


    $(".title-right-hyperlink-nav").click(function() {

        $(this).next().slideToggle()
    })

    $('a.jumpto[href*="#"]:not([href="#"])').click(function() {

        // alert('woohoo');

        var topOffset = $(this).attr("topOffset")
        topOffset = 135


        if ($(window).width() < 1000) {
            $(".hyperlink-listing").slideUp();
            // topOffset = 45
        }

        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
            var target = $(this.hash);
            target = target.length ? target : $('[name="' + this.hash.slice(1) + '"]');
            if (target.length) {
                $('html,body').animate({
                    scrollTop: target.offset().top - topOffset
                }, 700);

            }
        }
    });

    $(".top-btn").click(function() {
        $("html, body").animate({
            scrollTop: 0
        }, "10");
    })

    var windowHeight = $(window).height();
    $(".in-page-siderbar-placeholder").click(function() {
        $(".in-page-siderbar-nav").slideToggle()
    })


    //header global site drop down
    $(".global-site-dropdown a").click(function(e) {
        $(".global-sites-nav").slideToggle();
        e.preventDefault()
    })

    //external links    
    $(".external-links.switch").click(function() {
        //console.log($(this).attr("external-link"))
        $("#external-site").find(".go-external-site").prop("href", $(this).attr("external-link"));
    });
    $("#external-site .go-external-site").click(function() {
        $('#external-site .close').trigger('gumby.trigger');
    });


    //responsive for the long list to a drop down
    $(".title-right-hyperlink-nav").click(function() {
        var obj = $(this)
        obj.next().slideToggle()

        $(".icon-class", obj).toggleClass("icon-minus4")
        $(".icon-class", obj).toggleClass("icon-plus4")

    })



    $('.two-columns-mobile-nav .dropdown-btn,.title-w-hyperlinks .dropdown-btn,.title-all .dropdown-btn').click(function(e) {

        var obj = $(this)
            //$(".hyperlink-listing").hide()
        obj.next().next().slideToggle(200);

        $(".icon-class", obj).toggleClass("icon-roundl_bottom2")
        $(".icon-class", obj).toggleClass("icon-roundl_top2")
    });



    //responsive for the pills long list to drop down
    $(".pill.tab.cur-title").html($(".tab-nav li.active a").html())
    $(".dropdown-btn2").click(function() {
        var obj = $(this)
        var obj2 = $(this).parent().next()

        obj2.slideToggle(200)

        $(".icon-class", obj).toggleClass("icon-roundl_bottom2")
        $(".icon-class", obj).toggleClass("icon-roundl_top2")
    })

    $(".dropdown-btn3").click(function() {
        var obj = $(this)
        var obj2 = $(this).parent().next().children('.tab-nav-listing')

        obj2.slideToggle(200)

        $(".icon-class", obj).toggleClass("icon-roundl_bottom2")
        $(".icon-class", obj).toggleClass("icon-roundl_top2")
    })

    var windowWidth = $(window).width();
    if (windowWidth <= 768) {
        $('.tab-nav-listing').hide();
    }

    $(window).resize(function() {
        if ($(window).width() > 1020) {
            $(".shared-nav .tab-nav").css("display", "table");
        } else {
            $(".shared-nav .tab-nav").css("display", "none");
        }
    })

    // $(window).resize(function(){
    //     if($(window).width() > 768) {
    //         $(".shared-nav-list .tab-nav-listing").css("display","block");

    //     } else {
    //         $(".shared-nav-list .tab-nav-listing").css("display","none");
    //     }
    // })



    //faq
    // Jill @ XM Asia
    // Commented out because this is intefering with the Show/Hide Content Component
    // $(".see-less-details-btn").click(function(){
    //     var obj = $(this)
    //     var iconObj = $(".icon",obj)
    //     var objContent = obj.parent().parent().prev() 
    //     objContent.slideToggle(200,function(){

    //         if(iconObj.hasClass("icon-core_solid_arrow_down"))
    //         {
    //             iconObj.removeClass("icon-core_solid_arrow_down")
    //                 .addClass("icon-core_solid_arrow_up")
    //             $(".less-more-text",obj).text("less")
    //         }
    //         else
    //         {
    //             iconObj.removeClass("icon-core_solid_arrow_up")
    //                 .addClass("icon-core_solid_arrow_down")

    //             $(".less-more-text",obj).text("more")
    //         }
    //     })


    // })


    //promo listing page and all.php
    $(".nav-hyperlink .cur-title").html($(".nav-hyperlink li.selected-nav a").html())
    $('.nav-hyperlink .dropdown-btn').click(function(e) {
        var obj = $(this)
        obj.next().next().children().slideToggle(200);

        $(".icon-class", obj).toggleClass("icon-roundl_bottom2")
        $(".icon-class", obj).toggleClass("icon-roundl_top2")


    });

    $(".nav-hyperlink-list li").click(function() {
            var obj = $(this)
            var mainObj = obj.parent().parent().parent().parent().parent()

            //promotion listing page vs all.php
            if (!obj.hasClass("nav-selected") && !obj.hasClass("non-mobile")) {
                $(".nav-hyperlink-list li", mainObj).removeClass("selected-nav")
                obj.addClass("selected-nav")
                if (!mainObj.hasClass("ajax-nav-hyperlink")) {

                    $(".nav-hyperlink-tab-content", mainObj).hide()
                    $(".nav-hyperlink-tab-content[for=" + this.id + "]", mainObj).show()

                    $(".cur-title", mainObj).html($(".nav-hyperlink-list ul li.selected-nav a", mainObj).html())
                    $(".dropdown-btn .icon-class", mainObj).toggleClass("icon-roundl_bottom2")
                        .toggleClass("icon-roundl_top2")

                    if (!$('.nav-hyperlink .dropdown-btn').is(":hidden"))
                        $(".nav-hyperlink-list ul", mainObj).slideUp()



                }
                // Disabled by Shen Li, 20140722  
                // else
                // {
                //     $(".nav-hyperlink-ajax-content",mainObj).html("ajax")

                // }                            
            }

        })
        //$(".nav-hyperlink-tab-content[for="++]")

    $(window).resize(function() {


        if ($(window).width() > 1000) {
            $(".nav-hyperlink ul").css("display", "table")
            $('.nav-hyperlink .dropdown-btn .icon-class').addClass("icon-arrow-down")
                .removeClass("icon-arrow-up")
        } else {
            $(".nav-hyperlink ul").css("display", "none")

        }

    })


    $(window).resize(function() {
        var objWin = $(window)


        var windowHeight = objWin.height();
        //console.log($(window).width())
        resizeBannerContent()
        resizeMobileSecuredDropdown(windowHeight)
        resizeMobileMainDropdown()

        mobileSecureSlideUp($(".mobile-secured-nav-close-btn"), windowHeight)
        offListDropDown()
        resizeSearch(windowHeight)
        $(".search-overlay").css("height", $("body").height())

        if (objWin.width() > 1000) {
            $(".mobile-mega-dropdown").hide()
            secondTierDefault()



        }

        $(".title-right-hyperlink-nav").next().hide()
        var objDDBtn = $(".mobile-only.dropdown-btn").parent()
        if ($(".mobile-only.dropdown-btn").css("display") == "block") {
            objDDBtn.find(".hyperlink-listing").hide()

        } else
            objDDBtn.find(".hyperlink-listing").show()



    })

    $(window).load(function() {

        var windowHeight = $(window).height();
        var windowWidth = $(window).width();
        resizeBannerContent()
        resizeMobileSecuredDropdown(windowHeight)
        resizeMobileMainDropdown()


        $(".search-overlay").css("height", $("body").height())
        $(".mobile-mega-nav-close-btn").click(function() {
            offListDropDown()
        })

        $(".list-more-btn").click(function(e) {
            hideSearchOverlay()
            if ($(".mobile-secured-dropdown").css("display") != "none") {
                //check if the login is down already, pull it back up   
                mobileSecureSlideUp($(".mobile-secured-dropdown"), windowHeight)
            }



            $(".mobile-mega-dropdown").slideDown("normal", function() {
                offHTMLBodyScroll()
            })

            mobileSecureSlideUp($(".mobile-secured-nav-close-btn"), windowHeight)
            e.preventDefault()
        })
        $(".login-btn").click(function() {

            hideSearchOverlay()

            var obj = $(window)
            var obj2 = $(".mobile-secured-dropdown")

            if (obj.width() < 1000) {
                if (obj2.css("display") == "none") {
                    // $(".header-login-panel .icon").addClass("bg-gray6")    
                    $(".mobile-secured-dropdown").slideDown("normal", function() {
                        $(".mobile-secured-nav-close-btn").addClass("mobile-secured-opened")


                        offHTMLBodyScroll()

                        resizeMobileSecuredDropdown(windowHeight)
                    })
                }
            }
        })
        $(".mobile-secured-nav-close-btn").click(function() {
            hideMobileLogin($(this), windowHeight)
        })


        $(".search-btn").click(function(e) {


            $("html, body").animate({
                scrollTop: 0
            }, "10", function() {

                $(".search-popup").show()
                $(".search-field").focus()
                $(".search-icon-bottom-blackbar").addClass("active")

                $("i.icon-core_search", this).removeClass("bg-red2")
                $("i.icon-core_search", this).addClass("active")
                    // offHTMLBodyScroll()
                    // resizeSearch(windowHeight)


            });

            var windowHeight = $(window).height();
            $("html,body").height(windowHeight).addClass("overY")
            resizeSearch(windowHeight)

            hideMobileLogin($(".mobile-secured-nav-close-btn"), windowHeight)

            e.preventDefault()

        })

        $(".search-close-btn").click(function(e) {
            //$(".search-container").css("height","auto")

            $("html,body").height(windowHeight).removeClass("overY")

            hideSearchOverlay()

            e.preventDefault();

        })


        $(".search-filter-item").click(function() {
            $(".search-filter-item").removeClass("active-filter")
            $(this).addClass("active-filter")
        })



        $(".header-secondary-nav-mega-dropdown").mouseover(function() {
                var obj = $(this)
                obj.prev().addClass("hover-active")
            })
            .mouseleave(function() {
                var obj = $(this)
                obj.prev().removeClass("hover-active")
            })


        $(".home-notices.flexslider").flexslider({
            controlsContainer: ".home-notices-nav-control",
            //manualControls: ".home-flex-control-nav li a",
            animation: "slide",
            touch: false,
            controlNav: true,
            start: function() {
                $(".search-overlay").css("height", $("body").height())
            }
        })


        $(".home-main-banner-desc.flexslider").flexslider({
            slideshowSpeed: 6000,
            animation: "slide",
            controlNav: false,
            touch: false,
            after: function() {

            },
            before: function(slider) {
                
            }
        })


        $('.home-main-banner.flexslider').flexslider({
            controlsContainer: ".banner-rounded-nav-control",
            slideshowSpeed: 6000,
            //manualControls: ".flex-control-nav li a",
            animation: "slide",
            controlNav: true,
            touch: false,
            start: function() {
                $(".search-overlay").css("height", $("body").height())
                $(".home-main-banner-desc-wrapper").show()
            },
            before: function(slider) {
                var buttonClicked = slider.animatingTo
                var currentSlide = slider.currentSlide
                $('.home-main-banner-desc.flexslider').flexslider(buttonClicked)
            }
        });


        $(".banner-arrow-nav-control .flex-buttons").click(function() {
            var obj = $(this)
            var direction = obj.attr("direction")
            $('.home-main-banner-desc.flexslider').flexslider(direction)
            $('.home-main-banner.flexslider').flexslider(direction)
        })





        $(".mmsn-main").each (function (index, item) {
                $(item).click(function(e) {

                var obj = $(this)
                var li = $(this).parents ('li');

                var tier2div = $(li).find ('.mobile-mega-sitemap-second-tier-menu');
                var tier2ul = $(tier2div).find ('.mobile-second-tier-list');
                var isempty = true;
                $(tier2ul).find ('li').each (function (lix, li) {
                    if (!$(li).is (':empty'))
                    {
                        isempty = false;
                    }
                });
                if (isempty === true) {
                    // do nothing
                }
                else
                {
                    obj.next().slideToggle();
                    e.preventDefault();
                }

                
            })

            $(document).ready(function(){
                // Hide h-m-d if no sub items
                $(".h-m-d-bottom").each (function(index, item){
                    var hmditems = $(item).find('.h-m-d-services-items');
                    if (hmditems.length == 0) {
                        $(item).hide();
                    }
                });
            })

        });




    })


    // $(".sticky-nav-dd-title").click(function(){
    //     $(".sticky-nav-dd").slideToggle()
    // })
    // $(".sticky-nav-dd li a").click(function(){
    //     $(".sticky-nav-dd-title").html($(this).html());
    //     $(".sticky-nav-dd").slideToggle()
    // })

    $(".sticky-nav-dropdown").click(function() {
        var obj = $(this);

        $("i.icon", obj).toggleClass("icon-plus3")
            .toggleClass("icon-minus3")
        $(".sticky-nav-dd", obj).slideToggle()
    })
    $(".sticky-nav-dd li a").click(function() {
        $(".sticky-nav-dd-title").html($(this).html());

    })

    $(document).click(function(e) {
        var obj = $(".sticky-nav-dd")
        if ($(e.target).closest('.sticky-nav-dropdown').length === 0 && !obj.is(":hidden") && !obj.is(":animated")) {
            obj.slideToggle()
        }
    });


})


function secondTierDefault() {
    /*
    $(".mobile-mega-sitemap-second-tier-menu").animate({
        left : "1000px"
    })
    */
    //$(".mobile-mega-sitemap-second-tier-menu").slideToggle()
}


function hideSearchOverlay() {

    $(".search-popup").hide();


    $(".search-icon-bottom-blackbar").removeClass("active")
    $('.search-wrapper').hide()
    $(".search-btn i.icon-core_search").addClass("bg-red2")
    $(".search-btn i.icon-core_search").removeClass("active")
    onHTMLBodyScroll()

}


function hideMobileLogin(obj, windowHeight) {

    var openBool = obj.hasClass("mobile-secured-opened")

    if (openBool) {
        mobileSecureSlideUp(obj, windowHeight)
    }
}

function offHTMLBodyScroll() {
    $("body,html").css("height", $(window).height())
        .css("overflow-y", "hidden")
}

function onHTMLBodyScroll() {
    $("body,html").css("height", "auto")
        .css("overflow-y", "")
}

function offListDropDown() {
    $(".mobile-mega-dropdown").slideUp("normal", function() {

        onHTMLBodyScroll()
        secondTierDefault()
    })
}

//faq
// Jill @ XM Asia
// Commented this out because we don't need this anymore
// $(document).ready(function(){
//     setAllToMaxHeight($(".faq-column"))
// })
// $(window).resize(function(){
//     setAllToMaxHeight($(".faq-column"))
// })

///investment tables
$(document).ready(function() {
    setAllToMaxHeight($(".conversion-columns"))
})
$(window).resize(function() {
    setAllToMaxHeight($(".conversion-columns"))
})

///investment tables

$(document).ready(function() {
    setAllToMaxHeight($(".share-trade-content"))
})
$(window).resize(function() {
    setAllToMaxHeight($(".share-trade-content"))
})

// Jill @ XM Asia
// Commented this out because we don't need this anymore
// $(document).ready(function(){
//     setAllToMaxHeight($(".rates-column"))
// })
// $(window).resize(function(){
//     setAllToMaxHeight($(".rates-column"))
// })


///tools
$(document).ready(function() {
    setAllToMaxHeightWithHiddenElements($(".compare-filtered-item"))
    $(window).afterResize(function() {
        setAllToMaxHeightWithHiddenElements($(".compare-filtered-item"));
    }, true, 100);
    // $(window).resize(function(){
    //     setAllToMaxHeight($(".compare-filtered-item"))
    // })
})

if ($(".two-columns-mobile-nav .sticky-nav-comp").length > 0) {
    var objCardsList = $(".two-columns-mobile-nav")

    $(".cur-title", objCardsList).html($(".title-dropdown li.selected a").html())
}

$(".two-columns-sidebar li a").click(function() {
    var obj = $(this)

    if ($("i", obj).hasClass("icon-roundl_bottom2")) {
        $(".two-columns-sidebar .leftside-comp-nav>ul>li").removeClass("selected")
        $(".two-columns-sidebar .leftside-comp-nav ul li i").removeClass("icon-roundl_top2")
            .addClass("icon-roundl_bottom2")
        $("i", obj).toggleClass("icon-roundl_top2")
        $("i", obj).toggleClass("icon-roundl_bottom2")

        $(".two-columns-sidebar .leftside-comp-nav>ul>li>ul").hide()
        obj.parent().toggleClass("selected")
        obj.next().slideToggle()
    }
})


//addedHack for first child to have icon round top
$(".two-columns-nav li.selected i").removeClass("icon-roundl_bottom2").addClass("icon-roundl_top2");


function scrollingForSectionWithHyperLink() {

    $('.section-header-small').each(function() {
        var itemOffset = Math.abs($(this).offset().top);
        var windowTop = $(window).scrollTop();
        //console.log(itemOffset + " and " +   windowTop)
        if (itemOffset > 0 && itemOffset < windowTop) {

            $(".section-header").show()
                // $(".sticky-nav-container").show()
                // edited to hide sticky nav from appearing on desktop view
            var width = $(window).width();
            if (width >= 1020) {
                $(".sticky-nav-container").hide()
            } else {
                $(".sticky-nav-container").show()
            }

        } else {

            $(".section-header").hide()
            $(".sticky-nav-container").hide()
        }
    });



}

/* SLIDER COMPONENT CONTROLLER --------------------------------------- */
var activeslider = null;
var activeSliderMin = 0;
var activeSliderMax = 0;
var activeSliderPrefix = '';
var activeSliderSufix = '';

function sliderSetvalue(sliderdiv, val) {

    if ($(sliderdiv).length) {

        var swrapper = $(sliderdiv).parent()
        var maxval = parseInt(swrapper.attr('maxval'));
        var minval = parseInt(swrapper.attr('minval'));
        var ww = parseInt(swrapper.find('.slider-bar').css('width')) - 20;
        // var ww = parseInt(swrapper.find('.slider-bar').css('width'));

        var perc = (val - minval) / (maxval - minval)
        var wpos = perc * ww

        if (wpos > ww) {
            wpos = ww
        }

        wpos -= 10;

        // label display
        var _prefix = (swrapper.attr('labelprefix') == undefined ? "" : swrapper.attr('labelprefix'));
        var _suffix = (swrapper.attr('labelsuffix') == undefined ? "" : swrapper.attr('labelsuffix'));
        var _maxvallabel = (swrapper.attr('labelmax') == undefined ? "" : swrapper.attr('labelmax'));
        var _stepval = (swrapper.attr('stepval') == undefined ? 1 : parseInt(swrapper.attr('stepval')));


        if (val < maxval) {
            _maxvallabel = '';
        }

        val = Math.round(val / _stepval) * _stepval

        swrapper.find('.slider-bar-elapsed').css('width', wpos + 'px')
        $(sliderdiv).css('margin-left', wpos + 'px')
            // Added
        $('.slider-value-move').css('margin-left', wpos + 'px')


        var labeldiv = $(sliderdiv).parent().attr('labeldiv');
        var labeldivabs = $(sliderdiv).parent().attr('labeldivabs');
        //
        if (labeldivabs != '' && labeldivabs != null) {
            $('.' + labeldivabs).html(_prefix + val + _maxvallabel + _suffix);
        } else if (labeldiv != '' && labeldiv != null) {
            $(sliderdiv).siblings('.' + labeldiv).children('span').html(_prefix + val + _maxvallabel + _suffix)
        } else {
            if ($('.find-right-card').length > 0) {
                //For Credit Card v02
                $(sliderdiv).siblings('.filter-label').children('.slider-value-disp').html(val + _maxvallabel + _suffix);
                $('.input-income').val(val + _maxvallabel + _suffix);
            } else {
                $(sliderdiv).siblings('.filter-label').children('.slider-value-disp').html(_prefix + " " + val + _maxvallabel + _suffix)
            }
        }

        // progress for red dot
        swrapper.find('.slider-bar .slider-marker').each(function() {
            if (parseInt($(this).data('perpos')) < (perc * 100)) {
                $(this).find('.slider-dot-grey').addClass('slider-dot-red')
            } else {
                $(this).find('.slider-dot-grey').removeClass('slider-dot-red')
            }
        })
    }
}



$(document).ready(function(e) {

    if ($('.slider-dot-handle').length) {

        $(document).mousemove(function(e) {
            if (activeslider != null) {
                var parentOffset = activeslider.siblings('.slider-bar').offset();
                var ww = parseInt(activeslider.siblings('.slider-bar').css('width')) - 20;
                var xx = (e.pageX - parentOffset.left);

                xx -= 5;
                if (xx > ww) {
                    xx = ww;
                } else if (xx < -5) {
                    xx = -5;
                }
                var perc = (xx + 5) / ww
                if (perc > 1) {
                    perc = 1;
                }


                var disp = Math.floor(perc * (activeSliderMax - activeSliderMin)) + activeSliderMin;
                sliderSetvalue(activeslider, disp)

                // further update related data

                activeslider.parent().attr('currentperc', perc);

                refreshForeignCurrencyFDRate()
                refreshFDrates();
                updateHomeLoanAffordability()
                updateCarLoanAffordability();
            }
        });


        $('.slider-dot-handle').mousedown(function(e) {
            activeslider = $(this);
            activeSliderMin = parseInt($(this).parent().attr('minval'));
            activeSliderMax = parseInt($(this).parent().attr('maxval'));
            activeSliderPrefix = $(this).parent().attr('labelprefix');
            activeSliderSufix = $(this).parent().attr('labelsufix');

        });

        $(document).mouseup(function(e) {
            activeslider = null
        });
    }


});

/* SLIDER COMPONENT CONTROLLER --------------------------------------- END */


var foreignfdrate_month
var foreignfdrate_currency = 0;

function refreshForeignCurrencyFDRate() {

    var obj = $('.foreigncurrency-fd-valueslider')

    if (obj.length > 0) {
        var i
        var perc = parseFloat(obj.attr('currentperc'));
        var ddata = RATES_FD_FOREIGNC[foreignfdrate_currency];

        var showdata, showtenure
        var showlabel = ddata.code

        if (perc < 0.02) {
            // day
            showdata = ddata.day
            showtenure = "1 " + durationLabelDay;
        } else if (perc < 0.07) {
            // week
            showdata = ddata.week
            showtenure = "1 " + durationLabelWeek;
        } else {
            //months
            var minperc = 0.07
            var maxperc = 1.01
            var inc = (maxperc - minperc) / 12

            for (i = ddata.month.length - 1; i >= 0; i--) {
                if (((i * inc) + minperc) < perc) {
                    showdata = ddata.month[i]
                    showtenure = (i + 1) + ' ' + durationLabelMonths;

                    if (i == 0) {
                        showtenure = "1 " + durationLabelMonth;
                    }
                    break;
                }
            }
        }

        //console.log('sss '+showdata+' | '+ddata.month[i] + ' | '+perc)

        // showing
        $('.foreign-currency-fd-label-code').html(showlabel);
        $('.foreign-currency-fd-label-tenure').html(showtenure);
        $('.foreign-currency-fd-label-data').html((showdata).toFixed(2) + '% p.a.');

    }

}
$(document).ready(function(e) {
    var i
    var output = '';

    if (!("RATES_FD_FOREIGNC" in window)) {
        RATES_FD_FOREIGNC = [];
    }
    // populate dropdown
    for (i = 0; i < RATES_FD_FOREIGNC.length; i++) {
        output += '<option class="dropdown2-opt" value="' + i + '">' + RATES_FD_FOREIGNC[i].label + '</option>';
    }
    $('.dropdown-foreigncurrency-fd').html(output);
    $('.dropdown-foreigncurrency-fd').change(function(e) {
        //console.log($(this).val());
        foreignfdrate_currency = parseInt($(this).val());
        refreshForeignCurrencyFDRate()
    });
    $('.dropdown-foreigncurrency-fd').trigger('change');

});

function refreshFDrates() {
    //console.log($('.dropdown-rates-fd').val());

    if ($('.tool-slider-fdinterestrate-val').length) {
        var themonth = parseInt($('.tool-slider-fdinterestrate').html()) - 1
        var theval = DROPDOWN_FD_RATES[parseInt($('.dropdown-rates-fd').val())].data[themonth]
            //console.log('ttt: '+themonth+' | '+theval)
        $('.tool-slider-fdinterestrate-val').html(theval);
    }
}

$(document).ready(function(e) {
    if ($('.tool-slider-fdinterestrate-val').length) {
        $('.dropdown-rates-fd').on('change', function() {
            refreshFDrates()
        })
        refreshFDrates();
    }
});



function insertComma(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function updateHomeLoanAffordability() {

    if ($('.homeloan-affordability-rate').length) {

        // $('input.homeloan-affordability-rate').autoNumeric('init', {
        //     vMax: 100
        // });

        var obj1 = $('.homeloan-affordability-netincome');
        var obj2 = $('.homeloan-affordability-monthlyinstallment');
        var obj3 = $('.homeloan-affordability-tenure');
        var obj4 = $('.homeloan-affordability-rate');
        
        if (obj1.length > 0 && obj2.length > 0 && obj3.length > 0 && obj4.length > 0) {

            var netincome = parseFloat(obj1.val().replace(/,/g, ''));
            var monthpay = parseFloat(obj2.text().replace('MYR', ''));
            var tenure = parseFloat(obj3.text());
            var rate = parseFloat(obj4.val());
            var dsr = 0;

            if (netincome > 0 && netincome < 2745) {
                dsr = 0.6;
            }
            else if (netincome >= 2745 && netincome < 3000) {
                dsr = 0.65;
            }
            else if (netincome >= 3000 && netincome < 5001) {
                dsr = 0.75;
            }
            else if (netincome >= 5001 && netincome < 7001) {
                dsr = 0.8;
            }
            else if (netincome >= 7001 && netincome < 9001) {
                dsr = 0.85;
            }
            else if (netincome >= 9001) {
                dsr = 0.9;
            }

            if (monthpay > netincome ) {
                $('.affordability-calculator-msg-error').show().text('Please enter the amount that is affordable in your monthly net income.');

                
                toolsSetCalculatedValue('.tool-affordability-result-homeloan', insertComma('0'));
                toolsSetCalculatedValue('.tool-affordability-result-max-indicative-loan-amount', insertComma('0'));
                toolsSetCalculatedValue('.tool-affordability-result-monthly-instalment-amount', insertComma('0'));
            }
            else {
                $('.affordability-calculator-msg-error').hide().text('');

                var loanTenure = tenure*12;
                var monthlyLoanInterestRate = (rate/12)/100;
                var elg = netincome * dsr;

                var RP = parseFloat(netincome*dsr).toFixed(2);
                var monthlyInstalment = parseFloat(RP-monthpay).toFixed(2);

                var pmt = monthlyInstalment / monthlyLoanInterestRate * (1 - Math.pow(1 + monthlyLoanInterestRate, -loanTenure));

                var maxIndicative = pmt.toFixed(2);

                // console.log(monthlyLoanInterestRate, loanTenure, monthlyInstalment, maxIndicative, 'monthlyInstalment: ' + monthlyInstalment);

                
                toolsSetCalculatedValue('.tool-affordability-result-homeloan', insertComma(RP));
                toolsSetCalculatedValue('.tool-affordability-result-max-indicative-loan-amount', insertComma(maxIndicative));
                toolsSetCalculatedValue('.tool-affordability-result-monthly-instalment-amount', insertComma(monthlyInstalment));

            }
        }
    }
}

$(document).ready(function(e) {

    $('.homeloan-affordability-netincome').mask("#,##0", {reverse: true});
    $('.homeloan-affordability-netincome').keyup(function(e) {
        updateHomeLoanAffordability();
    });

    // $('.homeloan-affordability-rate').mask("00.00%", {reverse: true});
    $(".homeloan-affordability-rate").inputmask("decimal", {
        radixPoint: ".",
        groupSeparator: ",",
        autoGroup: true,
        suffix: " %",
        clearMaskOnLostFocus: false
    });
    $('.homeloan-affordability-rate').keyup(function(e) {
        updateHomeLoanAffordability();
    });

    // $('.homeloan-affordability-rate').keyup(function(e) {
    //     updateHomeLoanAffordability();
    // });

    updateHomeLoanAffordability();
});


// ------------------- CAR LOAN AFFORDABILITY

function updateCarLoanAffordability() {
    if ($('.tool-affordability-result-carloan').length) {

        var obj = $('.carloan-affordability-rate-slider')
        var obj2 = $('.carloan-affordability-monthlyinstallment')
        var obj3 = $('.carloan-affordability-tenure')
        if (obj.length > 0 && obj2.length > 0 && obj3.length > 0)

        {
            var rate = parseFloat(obj.html());
            var monthpay = obj2.html();
            var tenure = parseFloat(obj3.html());
            if (rate > 10) {
                rate = rate / 100;
                $('.carloan-affordability-rate-slider').html(rate);
            }


            monthpay = parseInt(monthpay.substr(4));

            var a = (rate / 100) / 12;
            var b = 1. + a;
            b = Math.pow(b, (tenure * 12)) - 1.;
            var FC = a / b + a;
            var RP = monthpay / FC

            RP *= 100;
            RP = Math.floor(RP);
            RP /= 100;

            RP = RP.toFixed(2);

            var asnwerVal = monthpay * (tenure * 12) / (1 + ((rate / 100) * tenure));
            asnwerVal = asnwerVal.toFixed(2)


            //console.log(monthpay);
            $('.tool-affordability-result-carloan').html('MYR ' + insertComma(asnwerVal))
        }
    }
}

$(document).ready(function(e) {
    if ($('.tool-affordability-result-carloan').length) {
        updateCarLoanAffordability();
    }
});



//tools card compare select
var cc_min_income_input;
var tickedFeatures = [];
var compareSelection = [];
var urlhashstring = window.location.hash

function getURLParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

//Added new function 20141204

function refreshProductFiltered() {
    if (refreshFilterViewAllowed) {
        // loop all selected features
        var viewlist = [];
        var i, j, k, div
        var added, output, matchedfeatures, cardcheckcleared, itemtype
            // 
        var minincome = cc_min_income_input
        if ($('.slider-value-disp').html() != null) {
            minincome = parseInt($('.slider-value-disp').html().substr(4));

            // $('.redtick').css('opacity','0.1')
            $('.redtick').css('display', 'none')

            // resetCardFeatures();
            // alert('dasdsa');

        }

        var filteredtotal = 0;


        // Filter card
        $('.compare-filtered-item').each(function() {
            div = $(this)
            cardcheckcleared = false

            switch (parseInt(div.data('product-type'))) {
                case 1:
                    itemtype = 'personal';
                    break;
                case 2:
                    itemtype = 'business';
                    break;
            }

            // check item type
            if (cc_cardtype_input == 'both' || cc_cardtype_input == itemtype) {
                // check income
                if (parseInt(div.data('incomerequire')) <= minincome || div.data('incomerequire') == null) {
                    cardcheckcleared = true;

                    // check features
                    // for(i=0;i<tickedFeatures.length;i++){
                    //     if(parseInt(div.data('featureid-'+tickedFeatures[i]))!=1){
                    //         cardcheckcleared = false
                    //         break;
                    //     }
                    // }

                }

            }

            if (cardcheckcleared) {
                div.css('display', 'block')
                filteredtotal++;

                // Added

                var checkAttr1 = div.attr('data-featureid-1')
                var checkAttr2 = div.attr('data-featureid-2')
                var checkAttr3 = div.attr('data-featureid-3')
                var checkAttr4 = div.attr('data-featureid-4')
                var checkAttr5 = div.attr('data-featureid-5')
                var checkAttr6 = div.attr('data-featureid-6')
                var checkAttr7 = div.attr('data-featureid-7')
                var checkAttr8 = div.attr('data-featureid-8')
                var checkAttr9 = div.attr('data-featureid-9')
                var checkAttr10 = div.attr('data-featureid-10')

                if (checkAttr1) {
                    $('.redtick[data-tickid="1"]').css('display', 'block')
                }
                if (checkAttr2) {
                    $('.redtick[data-tickid="2"]').css('display', 'block')
                }
                if (checkAttr3) {
                    $('.redtick[data-tickid="3"]').css('display', 'block')
                }
                if (checkAttr4) {
                    $('.redtick[data-tickid="4"]').css('display', 'block')
                }
                if (checkAttr5) {
                    $('.redtick[data-tickid="5"]').css('display', 'block')
                }
                if (checkAttr6) {
                    $('.redtick[data-tickid="6"]').css('display', 'block')
                }
                if (checkAttr7) {
                    $('.redtick[data-tickid="7"]').css('display', 'block')
                }
                if (checkAttr8) {
                    $('.redtick[data-tickid="8"]').css('display', 'block')
                }
                if (checkAttr9) {
                    $('.redtick[data-tickid="9"]').css('display', 'block')
                }
                if (checkAttr10) {
                    $('.redtick[data-tickid="10"]').css('display', 'block')
                }

            } else {
                div.css('display', 'none')

            }
        })

        //
        //console.log('viewlist: '+viewlist)
        if (filteredtotal < 2) {
            $('.cc-recommendation-results-number').html(filteredtotal + ' ' + item_label)
        } else {
            $('.cc-recommendation-results-number').html(filteredtotal + ' ' + items_label)
        }

        //lilsizzonowsetAllToMaxHeight($(".cc-compare-select-item"));

        // set hash
        //updateURLhash()

    }

}

function refreshProductFiltered2() {
    if (refreshFilterViewAllowed) {
        // loop all selected features
        var viewlist = [];
        var i, j, k, div
        var added, output, matchedfeatures, cardcheckcleared, itemtype
            // 
        var minincome = cc_min_income_input
        if ($('.slider-value-disp').html() != null) {
            minincome = parseInt($('.slider-value-disp').html().substr(4));

            // $('.redtick').css('opacity','0.1')

        }

        var filteredtotal = 0;


        // Filter card
        $('.compare-filtered-item').each(function() {
            div = $(this)
            cardcheckcleared = false

            switch (parseInt(div.data('product-type'))) {
                case 1:
                    itemtype = 'personal';
                    break;
                case 2:
                    itemtype = 'business';
                    break;
            }

            // check item type
            if (cc_cardtype_input == 'both' || cc_cardtype_input == itemtype) {
                // check income
                if (parseInt(div.data('incomerequire')) <= minincome || div.data('incomerequire') == null) {
                    cardcheckcleared = true;

                    // check features
                    for (i = 0; i < tickedFeatures.length; i++) {
                        if (parseInt(div.data('featureid-' + tickedFeatures[i])) != 1) {
                            cardcheckcleared = false
                            break;
                        }
                    }

                }


            }



            if (cardcheckcleared) {
                div.css('display', 'block')
                filteredtotal++;

            } else {
                div.css('display', 'none')

            }
        })

        //
        //console.log('viewlist: '+viewlist)
        if (filteredtotal < 2) {
            $('.cc-recommendation-results-number').html(filteredtotal + ' ' + item_label)
        } else {
            $('.cc-recommendation-results-number').html(filteredtotal + ' ' + items_label)
        }

    }

}


// function updateURLhash(){
//     urlhashstring = '#';
//     urlhashstring += '/'+compareSelection.join(',');
//     urlhashstring += '/'+tickedFeatures.join(',');
//     urlhashstring += '/'+cc_min_income_input;
//     urlhashstring += '/'+cc_cardtype_input;
//     //window.location.hash = urlhashstring
// }


function selectCardType(type) {
    var obj = $('.cylinder-button-' + type)
    if (type != 'both') {

        //
        $(".cylinder-button").removeClass("cylinder-button-selected");

        $(".cylinder-button-for-both").removeClass("cylinder-button-for-both-selected")
        $(".cylinder-trigger-options").removeClass("cylinder-trigger-red")

        obj.addClass("cylinder-button-selected")
        cc_cardtype_input = obj.attr('optionval');

    } else {

        var obj2 = $(".cylinder-button")
        if (!obj.hasClass("cylinder-button-for-both-selected"))

        {
            obj2.addClass("cylinder-button-selected")
            obj.addClass("cylinder-button-for-both-selected")
            $(".cylinder-trigger-options").addClass("cylinder-trigger-red")
            cc_cardtype_input = 'both';
        }

    }

    // resetCardFeatures();
    refreshProductFiltered();
    // refreshProductFiltered2();
}

$(function() {

    //Reset Card Features when clicked
    $('.comparison-types a').click(function() {
        // alert('click');
        resetCardFeatures();
    })

})

$(function() {

    if ($(".cc-feature-tools-items").length) {


        $(".cc-feature-tools-items li div").click(function() {
            var obj = $(this)
            obj.toggleClass("selected-item")
        })



    }

})



/* TICK COMPONENT CONTROLLER --------------------------------------- */

var resetFeatureAllowed = true;
var refreshFilterViewAllowed = true;

function resetCardFeatures() {
    if (resetFeatureAllowed) {
        var out = '';
        var i
        var defaultAllSelected = false;
        tickedFeatures = [];

        if (defaultAllSelected) {
            $('.redtick').removeClass('redtick-off');
            $('.redtick').addClass('redtick-on');
            $('.redtick').data('ticked', '0')
        } else {
            $('.redtick').removeClass('redtick-on');
            $('.redtick').addClass('redtick-off');
            $('.redtick').data('ticked', '1')
        }

        refreshProductFiltered();
    }
}

$(document).ready(function(e) {
    // init for redtick items 
    if ($('.redtick').length) {
        $('.redtick').click(function(e) {
            e.preventDefault()
            var tick = $(this);
            var tgroup = parseInt(tick.data('tickgroup'))
            var tid = parseInt(tick.data('tickid'))
            var i

            //Set command to self remove class when others is clicked



            if (tick.data('ticked') == '1') {

                resetCardFeatures();

                tick.data('ticked', '0')
                tick.removeClass('redtick-off');
                tick.addClass('redtick-on');
                tickedFeatures.push(tid)

            } else {
                tick.data('ticked', '1')
                tick.removeClass('redtick-on');
                tick.addClass('redtick-off');
                for (i = 0; i < tickedFeatures.length; i++) {
                    if (tickedFeatures[i] == tid) {
                        tickedFeatures.splice(i, 1);
                        break;
                    }
                }
            }
            // refreshProductFiltered();
            refreshProductFiltered2();
        })

    }
});

function resetCardSelection__() {
    $(".cc-recommended-add-compare").each(function() {
        var obj = $(this)
        if (obj.data('itemadded') == 1) {
            obj.trigger('click');
        }
    })
    compareSelection = [];
}

$(document).ready(function(e) {
                
    $(".cc-added-list").on("click", "i.icon", function() {
        var obj = $(this).parent()
        obj.fadeOut()

        // deselecting compared item        
        $(".cc-recommended-add-compare").each(function() {
            if (obj.data('itemid') == $(this).data('itemid')) {
                $(this).trigger('click');
            }
        });


    })



    // built all products

    // assigning click for add to compare button -----------------------------------------------------------

    if ($(".cc-recommended-add-compare").length) {
        compareSelection = []


        $(".cc-recommended-add-compare").click(function() {

            var obj = $(this)
            var parentObj = obj.parents(".cc-compare-select-item") //need the class .cc-compare-select-item

            var i
            var status = parseInt(obj.data('itemadded'))

            $(this).find('.whiteround').stop();

            if (status == 1) {
                obj.data('itemadded', 0);
                $(".cc-added-list .ccal-" + obj.attr("data-itemid")).fadeOut()
                    //$(this).html('Compare')
                obj.find('.compare-circle').animate({
                    marginLeft: '5px'
                }, 300);
                // $(this).find('.compare-text').css('color', '#666666');
                obj.find('.compare-text').css('margin-left', '35px');
                obj.find('.compare-text').removeClass('active disabled');
                obj.find('.compare-circle').removeClass("active");

                for (i = 0; i < compareSelection.length; i++) {
                    if (compareSelection[i] == obj.data('itemid')) {
                        compareSelection.splice(i, 1);
                        break;
                    }
                }
                obj.toggleClass("selected-item")

                $(".cc-recommended-add-compare").each(function(index, element) {
                    var obj2 = $(this)
                    if (obj2.data('itemadded') != 1) {
                        //$(this).html('Compare')
                        obj2.find('.compare-text').removeClass('active disabled')
                        obj2.find('.compare-circle').css('margin-left', '5px')
                        obj2.find('.compare-circle').removeClass("active");
                        // $(this).find('.compare-circle').css('background', '#FFFFFF')
                        // $(this).find('.compare-circle i').css('visibility', 'hidden')
                    }
                });

            } else {
                if (compareSelection.length < 4) {

                    obj.data('itemadded', 1);
                    //$(this).html('Compare-R')
                    // $(this).find('.compare-text').css('color', '#FFFFFF');
                    obj.find('.compare-text').addClass('active')
                    obj.find('.compare-text').css('margin-left', '25px');
                    obj.find('.compare-circle').animate({
                        marginLeft: '105px'
                    }, 300);
                    obj.find('.compare-circle').removeClass("active");
                    obj.toggleClass("selected-item")
                    compareSelection.push(obj.data('itemid'));

                    $(".cc-added-list").append("<div class='cc-added-item ccal-" + obj.attr("data-itemid") + "' data-itemid='" + obj.attr("data-itemid") + "'><i class='icon icon-rounds_close'></i>" + $(".compare-thumb-small", parentObj).html() + "</div>")
                    console.log();

                }

                if (compareSelection.length >= 4) {
                    $(".cc-recommended-add-compare").each(function(index, element) {
                        var obj2 = $(this)
                        if (obj2.data('itemadded') != 1) {
                            //$(this).html('Max. selection reached.')
                            // $(this).find('.compare-text').css('color', '#666666');
                            obj2.find('.compare-text').addClass('disabled')
                            obj2.find('.compare-text').css('margin-left', '35px');
                            obj2.find('.compare-circle').css('margin-left', '5px')
                            obj2.find('.compare-circle').addClass("active");
                            // $(this).find('.compare-circle i').css('visibility', 'visible')


                        }
                    });
                }
            }
            // compare button

            $('.cc-recommended-compare-btn').css('cursor', 'pointer');

            if (compareSelection.length > 0) {
                switch (compareSelection.length) {
                    case 1:
                        $('.cc-recommended-selected').html(single_item_selected);
                        $('.compare-button button').html(init_cprbutton);
                        $('.cc-recommended-compare-btn').css('cursor', 'auto').attr('href', 'javascript:;');
                        break;
                    case 4:
                        $('.cc-recommended-selected').html(max_item_selected);
                        $('.compare-button button').html(cprbutton).attr('href', 'javascript:;');
                        break;
                    default:
                        $('.cc-recommended-selected').html(compareSelection.length + no_item_selected);
                        $('.compare-button button').html(cprbutton).attr('href', 'javascript:gotoCompareResult()');
                        // $('.compare-button button').html(cprbutton);
                        break;
                }
                $('.tool-compare-post-select').slideDown(500)

            } else {

                $('.tool-compare-post-select').slideUp(500)

            }

            // updateURLhash()
            //llilsizzonow setAllToMaxHeight($(".cc-compare-select-item"))
        })
    }

});


function gotoCompareResult() {

    if (compareSelection.length >= 2) {
        /*
        var urlstring = 'tools-card-compare.php';
        urlstring += urlhashstring
        */
        var selectionstring = compareSelection.join(',')
        var urlstring = resultsURL;
        urlstring += '?item=' + selectionstring;
        // urlstring += '&features='+tickedFeatures.join(',');
        // urlstring += '&minincome='+cc_min_income_input;
        // urlstring += '&type='+cc_cardtype_input;

        window.location.href = urlstring;
    }
    return false;

}


function gotoCompareResult2() {

    if (compareSelection.length >= 2) {
        /*
        var urlstring = 'tools-card-compare.php';
        urlstring += urlhashstring
        */
        var selectionstring = compareSelection.join(',')
        var urlstring = resultsURL;
        urlstring += '?item=' + selectionstring;
        urlstring += '&features=' + tickedFeatures.join(',');
        urlstring += '&minincome=' + cc_min_income_input;
        urlstring += '&type=' + cc_cardtype_input;

        window.location.href = urlstring;
    }
    return false;

}

function gotoCompareSelect() {
    /*
    var urlstring = 'tools-card-compare-select.php';
    urlstring += urlhashstring
    */
    var urlstring = 'template.extended-compare.php';
    urlstring += '?item=' + getURLParameterByName('item');
    urlstring += '&features=' + getURLParameterByName('features');
    urlstring += '&minincome=' + getURLParameterByName('minincome');
    urlstring += '&type=' + getURLParameterByName('type');
    window.location.href = urlstring;
}


/* TICK COMPONENT CONTROLLER ---------------------------------------  END */

/* SLIDER COMPONENT CONTROLLER --------------------------------------- */
var activeslider2 = null;
var activeslider2Min = 0;
var activeslider2Max = 0;
var activeslider2Prefix = '';
var activeslider2Sufix = '';

function prepareSliderMeta() {
    activeslider2Min = parseInt(activeslider2.parent().attr('minval'));
    activeslider2Max = parseInt(activeslider2.parent().attr('maxval'));
    activeslider2Prefix = activeslider2.parent().attr('labelprefix');
    activeslider2Sufix = activeslider2.parent().attr('labelsufix');
}

function sliderControllerMove(e) {
    if (activeslider2 != null) {
        var parentOffset = activeslider2.siblings('.slider-bar').offset();
        var ww = parseInt(activeslider2.siblings('.slider-bar').css('width')) - 20;
        var xx = ww / 2

        if (e.pageX != null) {
            xx = (e.pageX - parentOffset.left);
        }

        xx -= 5;
        if (xx > ww) {
            xx = ww;
        } else if (xx < -5) {
            xx = -5;
        }
        var perc = (xx + 5) / ww
        if (perc > 1) {
            perc = 1;
        }

        var val = Math.floor(perc * (activeslider2Max - activeslider2Min)) + activeslider2Min;
        var toround = Math.round(val / 100) * 100
        sliderSetvalue(activeslider2, toround)

        // spesific further action for individual slider
        switch (activeslider2.parent().attr('sliderid')) {
            case 'compareproductincomeslider':
                cc_min_income_input = val;
                refreshProductFiltered();
                break;
        }
    }
}


//Check for mobile browsers before running touch event script to avoid conflict in ie8

if (/iPhone/i.test(navigator.userAgent)) {

    $(document).ready(function() {
        $('.mejs-overlay-button').css('visibility', 'hidden');
        $('.promo-item').removeAttr("style");
    })

}

if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {

    function touchHandler(event) {
        var touch = event.changedTouches[0];

        var simulatedEvent = document.createEvent("MouseEvent");
        simulatedEvent.initMouseEvent({
                touchstart: "mousedown",
                touchmove: "mousemove",
                touchend: "mouseup"
            }[event.type], true, true, window, 1,
            touch.screenX, touch.screenY,
            touch.clientX, touch.clientY, false,
            false, false, false, 0, null);


        if (touch.target.classList.contains('slider-dot-handle')) {
            touch.target.dispatchEvent(simulatedEvent);
            event.preventDefault();
        }
    }

    function toucheventinit() {
        var target = document
        document.addEventListener("touchstart", touchHandler, true);
        target.addEventListener("touchmove", touchHandler, true);
        target.addEventListener("touchend", touchHandler, true);
        target.addEventListener("touchcancel", touchHandler, true);
    }

    $(document).ready(function(e) {
        if ($('.slider-dot-handle').length) {
            toucheventinit();
        }
    })

}



/* SLIDER COMPONENT CONTROLLER --------------------------------------- END */

$(document).ready(function(e) {

    if ($('.comparison-tool').length && $('.comparison-filters').length) {
        $('.slider-dot-handle-monthlyincome').mousedown(function(e) {
            activeslider2 = $(this);
            prepareSliderMeta()
            resetCardFeatures()
                // refreshCardSelection()
        });

        $(document).mouseup(function(e) {
            activeslider2 = null
        });

        $('.slider-dot-handle').bind("mousedown touchstart", function(e) {

            activeslider2 = $(this);
            prepareSliderMeta()
        }, false);

        $(document).bind("mouseup", function(e) {
            activeslider2 = null
        }, false);
        $('.slider-dot-handle').bind("touchmove", function(e) {
            sliderControllerMove(e)
        }, false);

        $(document).mousemove(function(e) {
            sliderControllerMove(e)
        });


        $('.tool-btn-clearfilter').click(function(e) {
            refreshFilterViewAllowed = false;
            activeslider2 = $('.slider-dot-handle-monthlyincome')
            prepareSliderMeta()
            $(document).trigger('mousemove');
            $(document).trigger('mouseup');


            // slider position/minimum income
            cc_min_income_input = cc_min_income_input_default;
            sliderSetvalue('.slider-dot-handle-monthlyincome', cc_min_income_input)

            selectCardType('personal')
            resetCardFeatures();

            // feature
            // Jill @ XM Asia
            // Disabled because it should not be selected initially.
            // $('.comparison-filter li:first-child .redtick').trigger('click');

            refreshFilterViewAllowed = true;
            refreshProductFiltered();
            //lilsizzonowsetAllToMaxHeight($(".cc-compare-select-item"));

        });


        // compare selection spesific init ---------------------------------------------------------

        refreshFilterViewAllowed = false;

        var i, citems
        var urlhashitem = urlhashstring.split('/')

        // compare item(s) passed by URL
        citems = getURLParameterByName('item')
            //citems=urlhashitem[1]

        if (citems != '' && citems != null) {

            citems = citems.split(',')

            // $('.compare-filtered-item').each(function(){
            //     div = $(this)
            //     for(i=0; i<citems.length;i++){
            //         if(parseInt(div.data('product-cid'))==parseInt(citems[i])){ 
            //             div.find('.cc-recommended-add-compare').trigger('click'); 
            //         }
            //     }

            // });

            //Jill @ XM Asia
            // Simplified the top function to the below
            div = $(this)
            for (j = 0; j < citems.length; j++) {
                $('.compare-filtered-item[data-product-cid=' + citems[j] + ']').find('.cc-recommended-add-compare').trigger('click');
            }

        }

        // features passed by URL        
        var storedfeatures = getURLParameterByName('features')
            //var storedfeatures = urlhashitem[2]
        if (storedfeatures == '' || storedfeatures == null) {
            if (getURLParameterByName('minincome') == null || getURLParameterByName('minincome') == '') {
                // storedfeatures = '1';
            } else {
                storedfeatures = '';
            }
        }
        tickedFeatures = []
        var inputtickedFeatures = storedfeatures.split(',');
        $('.redtick').each(function() {
            var tick = $(this)
            for (i = 0; i < inputtickedFeatures.length; i++) {
                if (parseInt(tick.data('tickid')) == parseInt(inputtickedFeatures[i])) {
                    tick.trigger('click');
                    break;
                }
            }
        });

        // minimum income
        cc_min_income_input = getURLParameterByName('minincome')
            //cc_min_income_input = urlhashitem[3]
        if (cc_min_income_input == '' || cc_min_income_input == null) {
            cc_min_income_input = cc_min_income_input_default
        }
        sliderSetvalue('.slider-dot-handle-monthlyincome', cc_min_income_input)


        // cardtype
        cc_cardtype_input = getURLParameterByName('type')
            //cc_cardtype_input = urlhashitem[4]
        if (cc_cardtype_input == '' || cc_cardtype_input == null) {
            cc_cardtype_input = 'personal';
        }
        selectCardType(cc_cardtype_input)

        // run search
        refreshFilterViewAllowed = true;
        refreshProductFiltered();
        //$('.tool-btn-clearfilter').trigger('click');
        // Jill @ XM Asia
        // Added ?item=variable functionality from the URL for normal compares
    } else if ($('.comparison-tool').length && $('.comparison-filters').length == 0) {

        var j, citems2

        citems2 = getURLParameterByName('item')

        if (citems2 != '' && citems2 != null) {
            citemsArray = citems2.split(',')
            div = $(this)
            for (j = 0; j < citemsArray.length; j++) {
                $('.compare-filtered-item[data-product-cid=' + citemsArray[j] + ']').find('.cc-recommended-add-compare').trigger('click');
            }

        }
    }
});



//tool card compare


var swipeEnabled = true;
var dataProviderObj = $(".tool-compare-selectedlist-slidable-item")
if (dataProviderObj.length < 3)
    swipeEnabled = false;


var compareToolPage = 0;
var compareToolTotalItem = 0
var compareToolSelectedOffset
var compareToolAnimationFlag = false

function compareToolDisplayReset() {
    compareToolPage = 0;
    $('.tool-compare-selectedlist-slidable').css('margin-left', '0px');
    $('.tool-compare-selectedlist-dotnav').css('display', 'none');
}


function compareToolChangeView() {
    var i
    for (i = 0; i < 4; i++) {
        $('.tool-compare-selectedlist-dotnav-dot' + i).css('background-color', '#cccccc')
    }

    compareToolSelectedOffset = -$(window).width() * compareToolPage;

    $('.tool-compare-selectedlist-dotnav-dot' + compareToolPage).css('background-color', '#ec1d23')

    compareToolAnimationFlag = true;
}

function compareToolAnimate() {

    if (compareToolAnimationFlag) {
        var xx = $('.tool-compare-selectedlist-slidable-panel0').css('margin-left');
        if (xx == null || xx == '') {
            xx = 0;
        }

        xx = parseInt(xx)

        xx += (compareToolSelectedOffset - xx) * 0.4;
        $('.tool-compare-selectedlist-slidable').css('margin-left', xx + 'px');

        if (Math.abs(compareToolSelectedOffset - xx) < 0.2) {
            compareToolAnimationFlag = false;
            $('.tool-compare-selectedlist-slidable').css('margin-left', compareToolSelectedOffset + 'px');
        }
    }

}

$.fn.outputCalcValue = function (value, options)
{
  var span = this;

  var settings = $.extend ({'roundVal' : true }, options);

  var prefix = $(span).attr ('data-prefix');
  if (prefix == undefined) prefix = "";

  var suffix = $(span).attr ('data-suffix');
  if (suffix == undefined) suffix = "";
  
  if (settings.roundVal == true)
  {
    value = Math.round (value);
  }
  
  var valstring = value.toLocaleString ();
  $(span).text (prefix + valstring + suffix);
};

$.fn.calcFormDisableButtonFirst = function (options)
{
  var element = this;
  var settings = $.extend ({}, options);
  var btn_calculate = $(element).find ('.calculator-calculate-button');
  $(btn_calculate).prop ({ 'disabled': true });
};

function refreshCompoundInterestCalculatorRdepo(yearsyntax) {
    var a = parseFloat($('.calc-compoundinterest-rdepo .principal-amount').val());
    var a2 = parseFloat($('.calc-compoundinterest-rdepo .monthly-amount').val());
    var b = parseFloat($('.calc-compoundinterest-rdepo .interest-rate').val()) / 100;
    var c = parseFloat($('.calc-compoundinterest-rdepo .loan-tenure').val());

    var totalsum = a
    var intpaid = 0
    var intpaid_total = 0;
    var month = 1;
    var totalmonth = c * 12

    var contentdiv = $('.generated-contents')
    var output = '';
    var currency = 'RM';
    var year = 0;

    while (month <= totalmonth) {
        intpaid = (b / 12) * (totalsum + a2)
        intpaid_total += intpaid;
        totalsum += intpaid + a2;
        year = Math.ceil(month / 12);
        monthVal = (month - (year - 1) * 12);

        //Generate output based on syntax by user
        var syntaxOutput = "";
        syntaxOutput = yearsyntax.replace("${year}", year);
        syntaxOutput = syntaxOutput.replace("${month}", monthVal)

        output += '<div class="row tabdata">'
        output += '    <div class="tabcol">' + syntaxOutput + '</div>'
        output += '    <div class="tabcol">' + currency + intpaid.toFixed(2) + '</div>'
        output += '    <div class="tabcol">' + currency + intpaid_total.toFixed(2) + '</div>'
        output += '    <div class="tabcol">' + currency + totalsum.toFixed(2) + '</div>'
        output += '</div>';

        month++;
    }

    $('.calc-compoundinterest-rdepo .calculated-result .generated-contents').html(output);
    $('.calc-compoundinterest-rdepo .calculated-result').slideDown()
    $('.calc-compoundinterest-rdepo .calculated-result-label').slideDown()
    $('.calc-compoundinterest-rdepo .calculator-item').slideUp();
    //alert(output)

    //toolsSetCalculatedValue('.calc-compoundinterest-rdepo .calc-result-totalinterest', parseFloat(intpaid_total).toFixed(2))
    //toolsSetCalculatedValue('.calc-compoundinterest-rdepo .calc-result-grandtotal', parseFloat(totalsum).toFixed(2))

}

function toolsSetCalculatedValue(ele, val) {
    if (val != "NaN")
        $(ele).html($(ele).data('prefix') + val + $(ele).data('suffix'))
}

function backtoCalculator(ele) {

    if (ele != undefined) {
        $(ele + ' .calculated-result-label').slideUp()
        $(ele + ' .calculated-result').slideUp()
        $(ele + ' .calculator-item').slideDown()
        $('html, body').animate({
            scrollTop: $(ele).offset().top
        }, 1000);
    }
}


/* scroll page to vertical offset */
$.fn.scrollPageToThis = function (scrollduration)
{
  function scrollPageTo (vpos, scrollduration)
  {
    if (scrollduration == undefined) { scrollduration = 999; }
    $('html, body').stop ();
    $('html, body').animate ({ scrollTop: vpos }, scrollduration);
  }

  var this_element = this;
  var vpos = $(this_element).offset ().top;
  if (scrollduration == undefined) { scrollduration = 999; }

  scrollPageTo (vpos, scrollduration);
}


$(document).ready(function(e) {

    if ($('.tool-compare-selectedlist-slidable').length) {
        setInterval('compareToolAnimate()', 30);

        var citem = getURLParameterByName('item');
        if (citem == '' || citem == undefined) {
            compareToolTotalItem = 0;
        } else {
            citem = citem.split(',');
            compareToolTotalItem = citem.length
        }

        $(window).resize(function(e) {
            var i
            compareToolDisplayReset()


            if (swipeEnabled) {
                var ww = $(window).width();
                compareToolChangeView()
                if (ww < 786) {

                    $('.tool-compare-selectedlist-slidable').css('margin-left', (-compareToolPage * ww) + 'px');
                    $('.tool-compare-selectedlist-dotnav').css('display', 'block');

                    for (i = 0; i < 4; i++) {
                        $('.tool-compare-selectedlist-dotnav-dot' + i).css('display', 'none')


                        if (ww < 400 && i < compareToolTotalItem) {
                            $('.tool-compare-selectedlist-dotnav-dot' + i).css('display', 'inline-block')
                        } else if (ww >= 400 && compareToolTotalItem > 2 && i < Math.ceil(compareToolTotalItem / 2)) {
                            //console.log('jj '+Math.ceil(compareToolTotalItem/2))
                            $('.tool-compare-selectedlist-dotnav-dot' + i).css('display', 'inline-block')
                        } else {

                        }

                    }
                }
            }


        });
        $(window).trigger('resize');

        // selected list swipe event
        var i
        for (i = 0; i < 4; i++) {
            $('.tool-compare-selectedlist-dotnav-dot' + i).attr('pageno', i)
            $('.tool-compare-selectedlist-dotnav-dot' + i).click(function() {
                compareToolPage = $(this).attr('pageno');
                compareToolChangeView();
            })
        }


        $("div.tool-compare-selectedlist-holder, .compare-tool-info").swipe({
            allowPageScroll: 'vertical',
            swipe: function(event, direction, distance, duration, fingerCount) {
                //console.log("You swiped " + direction +' | '+$(window).width());
                var ww = $(window).width()
                if (ww < 786 && swipeEnabled) {

                    if (direction == 'left') {
                        if (ww > 400 && compareToolPage < 1) {
                            compareToolPage++;
                        } else if (ww <= 400 && compareToolPage < compareToolTotalItem - 1) {
                            compareToolPage++;
                        }

                    } else {
                        if (compareToolPage > 0) {
                            compareToolPage--;
                        }
                    }

                    compareToolChangeView()

                }
            }
        });
    }

    /* INPUT CALCULATOR (CREDIT CARD INTEREST) ---------------------------- */

    function refreshCCInterestRateCalculator() {
        if ($('.interest-rate-calc-1').length) {

            // ------------------------------------------------
            var floatTotalInterest = 0.00;
            var floatTenure = 0.00;
            var floatMinPayment = 0.00;
            var floatInterestRate = $('.interest-rate-calc-1 .interest-rate').val()
            var floatCurrentBalance = $('.interest-rate-calc-1 .current-balance').val()

            // adjust interest rate to monthly
            var floatInterestRateMonthly = (floatInterestRate / 100) / 12;

            // calc the total interest payed and months if only paying minimums
            var floatTotalOutstanding = floatCurrentBalance * 1;


            while (floatTotalOutstanding > 0) {
                //strDebug += 'Month ' + floatTenure + ': ' + "<br>";

                // calc interest
                var floatThisMonthInterest = floatTotalOutstanding * floatInterestRateMonthly;
                //strDebug += 'Interest: ' + floatThisMonthInterest +  "<br>";

                // recalc min interest first
                var floatThisMonthMin = floatTotalOutstanding * 0.05;
                if (floatThisMonthMin < 50) {
                    if (floatTotalOutstanding <= 50) //last payment
                    {
                        floatThisMonthMin = floatTotalOutstanding + floatThisMonthInterest;
                    } else {
                        floatThisMonthMin = 50.00;
                    }
                }
                //strDebug += 'MinPay: ' + floatThisMonthMin +  "<br>";

                // add interest to principle
                floatTotalOutstanding = floatTotalOutstanding + floatThisMonthInterest;
                // strDebug += 'TotalOut: ' + floatTotalOutstanding +  "<br>";
                floatTotalInterest += floatThisMonthInterest
                    //strDebug += 'TotalInt: ' + floatTotalInterest +  "<br>";

                // pay minimum
                floatTotalOutstanding -= floatThisMonthMin;
                //strDebug += 'Overall: ' + floatTotalOutstanding +  "<br>";
                //strDebug += "<br>";

                // 1 more month
                floatTenure++;

            }

            // calc min payment
            floatMinPayment = floatCurrentBalance * 0.05;

            if (floatMinPayment < 50) {
                if (floatCurrentBalance <= 50) {
                    floatMinPayment = floatCurrentBalance;
                } else {
                    floatMinPayment = 50.00;
                }
            }

            // output formatting
            floatMinPayment = parseFloat(floatMinPayment).toFixed(2);
            floatTotalInterest = parseFloat(floatTotalInterest).toFixed(2);

            // update fields
            //floatTotalInterest = floatTotalInterest.toFixed(2);
            //eTotalInterest.innerHTML = 'RM ' + floatTotalInterest;
            $('.calc-result-totalinterest').html($('.calc-result-totalinterest').data('prefix') + floatTotalInterest + $('.calc-result-totalinterest').data('suffix'))
                //    eTotalInterest.innerHTML = strDebug;
                // eTenure.innerHTML = floatTenure;
            $('.calc-result-monthinterest').html($('.calc-result-monthinterest').data('prefix') + floatTenure + $('.calc-result-monthinterest').data('suffix'))
                //eMinPayment.innerHTML = 'RM ' + floatMinPayment;// + '<br>' + strDebug;
            $('.calc-result-minpayment').html($('.calc-result-minpayment').data('prefix') + floatMinPayment + $('.calc-result-minpayment').data('suffix'))
                // ------------------------------------------------
        }
    }

    if ($('.interest-rate-calc-1').length) {

        // $('.interest-rate-calc-1 .numeric-only').bind('blur', function() {
        //     refreshCCInterestRateCalculator()
        // })
        $('.interest-rate-calc-1 .numeric-only').keyup(refreshCCInterestRateCalculator);


        //init
        $('.interest-rate-calc-1 .interest-rate').val('1.8');
        $('.interest-rate-calc-1 .current-balance').val('5000');
        refreshCCInterestRateCalculator()
    }


    /* INPUT CALCULATOR (CAR LOAN) ---------------------------- */

    function refreshCarLoanCalculator() {
        var a = $('.calc-carloan .principal-amount').val();
        var b = $('.calc-carloan .interest-rate').val() / 100;
        var c = $('.calc-carloan .loan-tenure').val();

        var d = a * b * c; // total hiring charges
        var e = parseFloat(d) + parseFloat(a); // total amount payable
        var installment = e / (c * 12);

        toolsSetCalculatedValue('.calc-result-thiring', parseFloat(d).toFixed(2))
        toolsSetCalculatedValue('.calc-result-installment', parseFloat(installment).toFixed(2))
        toolsSetCalculatedValue('.calc-result-totalpayable', parseFloat(e).toFixed(2))

    }

    if ($('.calc-carloan').length) {
        // $('.calc-carloan .numeric-only').bind('blur', function() {
        //     refreshCarLoanCalculator()
        // })
        $('.calc-carloan .numeric-only').keyup(refreshCarLoanCalculator);

        // init
        $('.calc-carloan .principal-amount').val('100000');
        $('.calc-carloan .interest-rate').val('2.5');
        $('.calc-carloan .loan-tenure').val('5');
        refreshCarLoanCalculator()
    }

    /* INPUT CALCULATOR (HOME LOAN) ---------------------------- */

    function round_number(numbers, decimal) {
        return Math.round(numbers * Math.pow(10, decimal)) / Math.pow(10, decimal);
    }


    function refreshHomeLoanCalculator() {
        // var a = $('.calc-homeloan .principal-amount').val();
        // var b = $('.calc-homeloan .interest-rate').val()/100;
        // var c = $('.calc-homeloan .loan-tenure').val();

        // var d = a*b*c; // total hiring charges
        // var e = parseFloat(d)+parseFloat(a); // total amount payable
        // var installment = e/(c*12);

        var amt = $('.calc-homeloan .principal-amount').val();
        var rate = $('.calc-homeloan .interest-rate').val();
        var tenure = $('.calc-homeloan .loan-tenure').val();

        var a = rate / 100. / 12.;
        var b = 1. + a;
        b = Math.pow(b, (tenure * 12)) - 1.;
        var FC = a / b + a;
        FC = FC.toFixed(10);
        var RP = amt * FC;



        var asnwerVal = (round_number(RP, 2)).toFixed(2);
        //asnwerVal = addCommas(asnwerVal);
        //doc.txtMntPay.value = asnwerVal;


        //toolsSetCalculatedValue('.calc-homeloan .calc-result-thiring', parseFloat(d).toFixed(2))
        toolsSetCalculatedValue('.calc-homeloan .calc-result-installment', parseFloat(asnwerVal).toFixed(2))
            //toolsSetCalculatedValue('.calc-homeloan .calc-result-totalpayable', parseFloat(e).toFixed(2))
            //console.log(Math.random())
    }

    if ($('.calc-homeloan').length) {
        //$('.calc-homeloan .numeric-only').bind('blur', refreshHomeLoanCalculator)
        $('.calc-homeloan .numeric-only').keyup(refreshHomeLoanCalculator);

        // init
        $('.calc-homeloan .principal-amount').val('200000');
        $('.calc-homeloan .interest-rate').val('3.0');
        $('.calc-homeloan .loan-tenure').val('30');
        refreshHomeLoanCalculator()
    }



    /* INPUT CALCULATOR (COMPOUND INTEREST) ---------------------------- */


    if ($('.calc-compoundinterest').length) {
        // init
        $('.calc-compoundinterest .principal-amount').val('100');
        $('.calc-compoundinterest .interest-rate').val('0.50');
        $('.calc-compoundinterest .loan-tenure').val('10');
    }



    /* INPUT CALCULATOR (COMPOUND INTEREST) ---------------------------- */

    if ($('.calc-compoundinterest-rdepo').length) {
        // init
        $('.calc-compoundinterest-rdepo .principal-amount').val('100');
        $('.calc-compoundinterest-rdepo .monthly-amount').val('100');
        $('.calc-compoundinterest-rdepo .interest-rate').val('0.50');
        $('.calc-compoundinterest-rdepo .loan-tenure').val('5');

    }

    /* INPUT CALCULATOR (FOREIGN EXCHANGE) ---------------------------- */

    function refreshForeignExchangeCalculatorTHB() {
        var a = parseFloat($('.calc-exchangerate.calc-exchangerate-to-THB .principal-amount').val());
        var dto = $('.calc-exchangerate.calc-exchangerate-to-THB .dropdown-convertto').val()
        var dtype = $('.calc-exchangerate.calc-exchangerate-to-THB .dropdown-currencytype').val()

        var thb1arr = ['USD', 'USD520', 'USD501', 'EUR', 'GBP', 'JPY', 'HKD', 'SGD', 'CHF', 'CAD’, ’AUD', 'DKK', 'SEK', 'NZD', 'MYR', 'IDR', 'NOK', 'CNY', 'KRW', 'INR', 'RUB'];
        var thb1arrstr = thb1arr.join('-');

        var singlehundred = '100'
        if (thb1arrstr.indexOf(dto) != -1) {
            singlehundred = '1'
        }

        var darray = eval('thb' + singlehundred + '_' + dtype);
        var rate = parseFloat(singlehundred) / darray[dto];
        var ratetoTHB = parseFloat(darray[dto]);

        if ($('.calc-exchangerate.calc-exchangerate-to-THB .principal-amount').val() == '') {
            a = 0;
        }

        if (rate == undefined) {
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-unitrate', 'Unavailable')
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-totalsum', 'Unavailable')
        } else {
            //For RM to Foreign 
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-unitrate', dto + ' ' + rate.toFixed(5))
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-totalsum', 'THB ' + a + ' = ' + dto + ' ' + (a * rate).toFixed(5))

            //For Foreign to RM 
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-unitrate2', dto + ' ' + singlehundred)
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-exchangerate2', 'THB' + ' ' + ratetoTHB.toFixed(5))
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-THB .calc-result-totalsum2', dto + ' ' + a + ' = ' + 'THB ' + ((a / singlehundred) * ratetoTHB).toFixed(5))
        }

    }

    function refreshForeignExchangeCalculatorMY() {
        var a = parseFloat($('.calc-exchangerate.calc-exchangerate-to-RM .principal-amount').val());
        var dto = $('.calc-exchangerate.calc-exchangerate-to-RM .dropdown-convertto').val()
        var dtype = $('.calc-exchangerate.calc-exchangerate-to-RM .dropdown-currencytype').val()

        var rm1arr = ['AUD', 'BND', 'CAD', 'CHF', 'GBP', 'EUR', 'NZD', 'SGD', 'USD'];
        var rm1arrstr = rm1arr.join('-');

        var singlehundred = '100'
        if (rm1arrstr.indexOf(dto) != -1) {
            singlehundred = '1'
        }

        var darray = eval('rm' + singlehundred + '_' + dtype);
        var rate = parseFloat(singlehundred) / darray[dto];
        var ratetoRM = parseFloat(darray[dto]);

        if ($('.calc-exchangerate.calc-exchangerate-to-RM .principal-amount').val() == '') {
            a = 0;
        }

        if (rate == undefined) {
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-unitrate', 'Unavailable')
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-totalsum', 'Unavailable')
        } else {
            //For RM to Foreign 
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-unitrate', dto + ' ' + rate.toFixed(5))
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-totalsum', 'RM ' + a + ' = ' + dto + ' ' + (a * rate).toFixed(5))

            //For Foreign to RM 
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-unitrate2', dto + ' ' + singlehundred)
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-exchangerate2', 'RM' + ' ' + ratetoRM.toFixed(5))
            toolsSetCalculatedValue('.calc-exchangerate.calc-exchangerate-to-RM .calc-result-totalsum2', dto + ' ' + a + ' = ' + 'RM ' + ((a / singlehundred) * ratetoRM).toFixed(5))
        }

    }


    if ($('.calc-exchangerate.calc-exchangerate-to-RM').length) {
        $('.calc-exchangerate.calc-exchangerate-to-RM select').bind('blur change', function() {
            refreshForeignExchangeCalculatorMY();
        })

        $('.calc-exchangerate.calc-exchangerate-to-RM .numeric-only').keyup(refreshForeignExchangeCalculatorMY);

        // init
        $('.calc-exchangerate.calc-exchangerate-to-RM .principal-amount').attr('value', '100');
        refreshForeignExchangeCalculatorMY();
    }


    if ($('.calc-exchangerate.calc-exchangerate-to-THB').length) {
        $('.calc-exchangerate.calc-exchangerate-to-THB select').bind('blur change', function() {
            refreshForeignExchangeCalculatorTHB();
        })

        $('.calc-exchangerate.calc-exchangerate-to-THB .numeric-only').keyup(refreshForeignExchangeCalculatorTHB);

        // init
        $('.calc-exchangerate.calc-exchangerate-to-THB .principal-amount').attr('value', '1');
        refreshForeignExchangeCalculatorTHB();
    }

    // if($('.numeric-only')){
    //     $('.numeric-only').bind('paste propertychange change input', function() {
    //        var val = $(this).val();
    //         if(isNaN(val)){
    //              val = val.replace(/[^0-9\.]/g,'');
    //              if(val.split('.').length>2) 
    //                  val =val.replace(/\.+$/,"");
    //         }
    //         $(this).val(val); 
    //     })
    // }

    $('.numeric-only, .numeric-only2').jStepper({
        decimalSeparator: "",
        maxDecimals: 4,
        disableAutocomplete: true
    });

    $(".strictly-numbers").bind("keyup paste", function(){
    setTimeout(jQuery.proxy(function() {
        this.val(this.val().replace(/[^0-9]/g, ''));
    }, $(this)), 0);
});
  
      $(".strictly-numbersdot").bind("keyup paste", function(){
    setTimeout(jQuery.proxy(function() {
        this.val(this.val().replace(/[^0-9\.]/g, ''));
    }, $(this)), 0);
});
  

    // Disallow decimals in calculators
    $(".nodecimal").keypress(function(e) {
        if (e.which < 48 || e.which > 57) {
            return (false);
        }
    });

    // $(".nodecimal").keypress(function(e) {
    //     if (e.which < 7 || e.which > 9) {
    //         return (false);
    //     }
    // });    

    // $(".nodecimal").keyup(function(e) {
    //     if (e.keyCode == 8) {
    //         alert('ohYeah');
    //     }
    // });



    // Adding comma to value inputs 
    $('.nodecimal, .calc-financial .numeric-only').keyup(function(event) {
        // skip for arrow keys
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        $(this).val(function(index, value) {
            value = value.replace(/,/g, '');
            return numberWithCommas(value);
        });
    });

    function numberWithCommas(x) {
        var parts = x.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
    }

    // Inputmask with data-inputmask
    $(":input[data-inputmask]").inputmask();



    /* INPUT CALCULATOR (Education) ---------------------------- */
    function refreshEduLoanCalculator() {

        var amt = parseInt($('.calc-eduloan .principal-amount').val().replace(/,/g, ''), 10)
        var rate = $('.calc-eduloan .loan-rate').val();
        var tenure = $('.calc-eduloan .loan-tenure').val();

        var a = rate / 100. / 12.;
        var b = 1. + a;
        b = Math.pow(b, (tenure * 12)) - 1.;
        var FC = a / b + a;
        FC = FC.toFixed(10);
        var RP = amt * FC;

        toolsSetCalculatedValue('.calc-eduloan .calc-result-installment', Math.ceil(RP).toLocaleString().split('.')[0])
        $('.calc-eduloan .results-container').slideDown();

    }

    if ($('.calc-eduloan').length) {

        var calcSlideUpEdu = function() {
            $('.calc-eduloan .results-container').slideUp();
        }
        $('.calc-eduloan .numeric-only').keyup(function() {
            var principalAmt = parseInt($('.calc-eduloan .principal-amount').val().replace(/,/g, ''), 10)
            var minAmt = $('.calc-eduloan .min-loanamt').val();
            var maxAmt = $('.calc-eduloan .max-loanamt').val();
            var minAmtEdu = parseFloat(minAmt)
            var maxAmtEdu = parseFloat(maxAmt)

            if (principalAmt < minAmtEdu || principalAmt == "") {
                $('.calc-eduloan .error-loanamt-min').show()
            } else {
                $('.calc-eduloan .error-loanamt-min').hide()
            }
            if (principalAmt > maxAmtEdu) {
                $('.calc-eduloan .error-loanamt-max').show()
            } else {
                $('.calc-eduloan .error-loanamt-max').hide()
            }

            calcSlideUpEdu()

        });
        $('.calc-eduloan select').bind('blur change', function() {
            calcSlideUpEdu()
        })

        // Run check on loan amount to see if it fits within the min/max value
        $('.calc-eduloan .btn-calculate').click(function() {

            var errorLoanAmtMin = $('.calc-eduloan .error-loanamt-min').css('display');
            var errorLoanAmtMax = $('.calc-eduloan .error-loanamt-max').css('display');

            if (errorLoanAmtMin == 'block' || errorLoanAmtMax == 'block') {

            } else {
                refreshEduLoanCalculator()
            }
        })

        // init
        $('.calc-eduloan .principal-amount').val('10,000');

    }

    /* INPUT CALCULATOR (Renovation) ---------------------------- */

     function tenure_rates() {
        $('input.loan-rate').val( parseFloat($('.dropdown2-opt:selected').attr('data-tenure')));
      }
      $('.dropdown2.loan-tenure').on("change.tenurechange", function(){
        tenure_rates();
      });

    function refreshRenoLoanCalculator() {

        var amt = parseInt($('.calc-renoloan .principal-amount').val().replace(/,/g, ''), 10)
        console.log(amt);
        var rate = $('.calc-renoloan .loan-rate').val();
        console.log(rate);
        var tenure = $('.calc-renoloan .loan-tenure').val();
        console.log(tenure);

        var interest = rate / 12; // and here
        var foo = Math.ceil(amt * interest / (1 - (Math.pow(1 / (1 + interest), tenure * 12))));




        toolsSetCalculatedValue('.calc-renoloan .calc-result-installment', foo)
        $('.calc-renoloan .results-container').slideDown();

    }

    if ($('.calc-renoloan').length) {

        var calcSlideUpEdu = function() {
            $('.calc-renoloan .results-container').slideUp();
        }
        $('.calc-renoloan .numeric-only').keyup(function() {
            var principalAmt = parseInt($('.calc-renoloan .principal-amount').val().replace(/,/g, ''), 10)
            var minAmt = $('.calc-renoloan .min-loanamt').val();
            var maxAmt = $('.calc-renoloan .max-loanamt').val();
            var minAmtEdu = parseFloat(minAmt)
            var maxAmtEdu = parseFloat(maxAmt)

            if (principalAmt < minAmtEdu || principalAmt == "") {
                $('.calc-renoloan .error-loanamt-min').show()
            } else {
                $('.calc-renoloan .error-loanamt-min').hide()
            }
            if (principalAmt > maxAmtEdu) {
                $('.calc-renoloan .error-loanamt-max').show()
            } else {
                $('.calc-renoloan .error-loanamt-max').hide()
            }
            calcSlideUpEdu()

        });
        $('.calc-renoloan select').bind('blur change', function() {
            calcSlideUpEdu()
        })

        // Run check on loan amount to see if it fits within the min/max value
        $('.calc-renoloan .btn-calculate').click(function() {

            var errorLoanAmtMin = $('.calc-renoloan .error-loanamt-min').css('display');
            var errorLoanAmtMax = $('.calc-renoloan .error-loanamt-max').css('display');

            if (errorLoanAmtMin == 'block' || errorLoanAmtMax == 'block') {

            } else {
                refreshRenoLoanCalculator()
            }
        })

        // init
        $('.calc-renoloan .principal-amount').val('10,000');

    }

    /* INPUT CALCULATOR (Home Loan Affordability - Singapore ver) ---------------------------- */
    function refreshPropertyLoanSG() {

        var tenureString = $('.calc-homeloan-affordsg .loan-tenure').val();
        var tenure = parseInt($('.calc-homeloan-affordsg .loan-tenure').val());
        var minTenure = $('.calc-homeloan-affordsg .min-tenure').val()
        var maxTenure = $('.calc-homeloan-affordsg .max-tenure').val()

        if (tenure < minTenure || tenureString == "") {
            $('.error-tenure-min').show();
        } else {
            $('.error-tenure-min').hide();
        }

        if (tenure > maxTenure) {
            $('.error-tenure-max').show();
        } else {
            $('.error-tenure-max').hide();
        }

        // Monthly Expenses
        var carLoan = parseInt($('.calc-homeloan-affordsg .car-loan').val().replace(/,/g, ''), 10)
        var credit = parseInt($('.calc-homeloan-affordsg .credit-expense').val().replace(/,/g, ''), 10)
        var otherLoan = parseInt($('.calc-homeloan-affordsg .other-loan').val().replace(/,/g, ''), 10)


        if (isNaN(carLoan)) {
            var carLoan = 0;
        }

        if (isNaN(credit)) {
            var credit = 0;
        }

        if (isNaN(otherLoan)) {
            var otherLoan = 0;
        }

        var monthlyExpense = carLoan + credit + otherLoan;

        toolsSetCalculatedValue('.calc-homeloan-affordsg .calc-result-monthly-expense', parseFloat(monthlyExpense))

        // Recommended Monthly Instalment
        var incomeRatio = $('.recommended-ratio').val() / 100;
        var monthlyIncome = parseInt($('.calc-homeloan-affordsg .monthly-income').val().replace(/,/g, ''), 10)
        var recommendedMonthlyInstalment = (incomeRatio * monthlyIncome) - monthlyExpense

        toolsSetCalculatedValue('.calc-homeloan-affordsg .calc-result-installment', parseFloat(recommendedMonthlyInstalment).toLocaleString().split('.')[0])

        // Projected Loan Amount
        var propertyRate = $('.property-type').val() / 100
        var rate = propertyRate / 12
        var nper = tenure * 12
        var pmt = recommendedMonthlyInstalment
        var pmt = parseInt($('.calc-homeloan-affordsg .preferred-instalment').val().replace(/,/g, ''), 10)
        var recommendedAmt = $('.calc-homeloan-affordsg .recommended-amt').val();

        // Check if Total Monthly Expenses is more that Recommended Amt
        if (recommendedMonthlyInstalment < recommendedAmt || $('.calc-homeloan-affordsg .monthly-income').val() == "") {
            $('.error-expenses').show();
        } else {
            $('.error-expenses').hide();
        }


        // Check amount entered in Preferred Monthly Instalment
        if (pmt < recommendedAmt) {
            $('.instalment-error-less').show();
            $('.instalment-error-more').hide();
            var pmt = recommendedMonthlyInstalment
            var projectedLoanAmt = pmt / rate * (1 - Math.pow(1 + rate, -nper));
            // toolsSetCalculatedValue('.calc-homeloan-affordsg .calc-result-projected-loanamt', parseFloat(projectedLoanAmt).toFixed(0)) 
            $('.calc-homeloan-affordsg .calc-result-projected-loanamt').text('N/A')
        } else if (pmt > recommendedMonthlyInstalment) {
            $('.instalment-error-more').show();
            $('.instalment-error-less').hide();
            var pmt = recommendedMonthlyInstalment
            var projectedLoanAmt = pmt / rate * (1 - Math.pow(1 + rate, -nper));
            // toolsSetCalculatedValue('.calc-homeloan-affordsg .calc-result-projected-loanamt', parseFloat(projectedLoanAmt).toFixed(0))
            $('.calc-homeloan-affordsg .calc-result-projected-loanamt').text('N/A')
        } else {
            $('.instalment-error-less').hide();
            $('.instalment-error-more').hide();
            // If recommendedMonthlyInstalment is not a number
            if (isNaN(pmt)) {
                var pmt = recommendedMonthlyInstalment
            }
            var projectedLoanAmt = Math.round(pmt / rate * (1 - Math.pow(1 + rate, -nper)))

            toolsSetCalculatedValue('.calc-homeloan-affordsg .calc-result-projected-loanamt', parseFloat(projectedLoanAmt).toLocaleString().split('.')[0])
        }

    }

    if ($('.calc-homeloan-affordsg').length) {

        $('.calc-homeloan-affordsg .numeric-only').keyup(function() {
            refreshPropertyLoanSG()
            $('.calc-homeloan-affordsg .preferred-instalment').val('')
            $('.calc-homeloan-affordsg .calc-result-row1').slideUp()
            $('.calc-homeloan-affordsg .calc-result-row2').slideUp()
        });
        $('.calc-homeloan-affordsg select').bind('blur change', function() {
            refreshPropertyLoanSG()
            $('.calc-homeloan-affordsg .preferred-instalment').val('')
            $('.calc-homeloan-affordsg .calc-result-row1').slideUp()
            $('.calc-homeloan-affordsg .calc-result-row2').slideUp()
        })
        $('.calc-homeloan-affordsg .numeric-only2').keyup(function() {
            refreshPropertyLoanSG()
        });

        $('.calc-homeloan-affordsg .btn-calculate').click(function() {

            // Check Fields (Loan Tenure and Expenditure)
            var monthlyIncome = $('.calc-homeloan-affordsg .monthly-income').val()
            var tenure = parseInt($('.calc-homeloan-affordsg .loan-tenure').val())
            var minTenure = $('.calc-homeloan-affordsg .min-tenure').val()
            var maxTenure = $('.calc-homeloan-affordsg .max-tenure').val()
            var recommendedMonthlyInstalment = parseInt($('.calc-homeloan-affordsg .calc-result-installment').text().replace(/[^-\d\.]/g, ''))
            var recommendedAmt = $('.recommended-amt').val();

            if (tenure < minTenure || tenure > maxTenure || recommendedMonthlyInstalment < recommendedAmt || monthlyIncome == "") {

            } else {
                refreshPropertyLoanSG()
                $('.calc-result-row1').slideDown()
                $('.calc-result-row2').slideDown()
            }

        })

        // init
        $('.calc-homeloan-affordsg .monthly-income').val('10,000');
        $('.calc-homeloan-affordsg .loan-tenure').val('25');
        refreshPropertyLoanSG()
    }

    /* INPUT CALCULATOR (Niaga-Personal Loan) ---------------------------- */
    function refreshPersonalLoanCalculator() {
        var outstandingPrincipal = parseInt($('.calc-niaga-personal .principal-amount').val());
        var minPrincipal = parseInt($('.calc-niaga-personal .min-principal-amt').val());
        var loanTenure = parseInt($('.calc-niaga-personal .loan-tenure').val());
        var insurance = $('.calc-niaga-personal .include-insurance').val();
        var rate = $('.calc-niaga-personal .interest-year' + loanTenure).val();
        var insurancerate = $('.calc-niaga-personal .insurance-rate-year' + loanTenure).val();

        if ($('.calc-niaga-personal .include-insurance').val() == 'yes') {
            var insuranceFee = outstandingPrincipal * (insurancerate / 100);
        } else {
            insuranceFee = 0;
        }

        var adminFeeRate = $('.calc-niaga-personal .admin-fee').val()
        var adminFee = (adminFeeRate / 100) * outstandingPrincipal;
        var monthlyInstalment = Math.round(generateMonthlyInstalment(outstandingPrincipal, rate, 0, loanTenure));

        // Write results
        toolsSetCalculatedValue('.calc-niaga-personal .calc-result-proposed-limit', outstandingPrincipal.toLocaleString());
        toolsSetCalculatedValue('.calc-niaga-personal .calc-result-monthly-instalment', monthlyInstalment.toLocaleString());
        toolsSetCalculatedValue('.calc-niaga-personal .calc-result-insurance-fee', insuranceFee.toLocaleString());
        toolsSetCalculatedValue('.calc-niaga-personal .calc-result-admin-fee', adminFee.toLocaleString());

        // Error handling
        if (outstandingPrincipal < minPrincipal) {
            $('.calc-niaga-personal .min-amt-error').show();
            $('.calc-niaga-auto .calc-result-installment, .calc-niaga-personal .calc-result-monthly-instalment, .calc-niaga-personal .calc-result-insurance-fee, .calc-niaga-personal .calc-result-admin-fee').text('');
        } else {
            $('.calc-niaga-personal .min-amt-error').hide();
        }
    }

    if ($('.calc-niaga-personal').length) {

        $('.calc-niaga-personal .numeric-only').keyup(refreshPersonalLoanCalculator);
        $('.calc-niaga-personal select').bind('blur change', function() {
            refreshPersonalLoanCalculator();
        });

        // init
        $('.calc-niaga-personal .principal-amount').val('50000000');
        refreshPersonalLoanCalculator()

    }

    /* INPUT CALCULATOR (Niaga-Auto Loan) ---------------------------- */
    function refreshAutolLoanCalculator() {
        var vehiclePrice = $('.calc-niaga-auto .vehicle-price').val()
        var minVehiclePrice = $('.calc-niaga-auto .vehicle-min-amt').val()
        var vehicleDownpayment = $('.calc-niaga-auto .vehicle-downpayment-per').val()
        var vehicleDownpaymentAmt = $('.calc-niaga-auto .vehicle-downpayment').val()
        var vehicleDownpaymentAmtMin = (vehicleDownpayment / 100) * vehiclePrice
        var nominalPlafond = vehiclePrice - vehicleDownpaymentAmt
        var loanTenure = $('.calc-niaga-auto .vehicle-tenure').val()
        var loanInterest = ($('.calc-niaga-auto .interest-year' + loanTenure).val()) / 100
        var calculatedResult = (1 + (loanInterest * loanTenure)) * nominalPlafond / (loanTenure * 12)
        var result = Math.round(calculatedResult)

        // Write results
        toolsSetCalculatedValue('.calc-niaga-auto .calc-result-installment', result.toLocaleString());

        // Error handling
        if (vehicleDownpaymentAmt < vehicleDownpaymentAmtMin) {
            $('.calc-niaga-auto .vehicle-downpayment-error').show();
            $('.calc-niaga-auto .calc-result-installment').text('')
        } else {
            $('.calc-niaga-auto .vehicle-downpayment-error').hide();
        }

        if (parseInt(vehiclePrice) < parseInt(minVehiclePrice)) {
            $('.calc-niaga-auto .vehicle-min-error').show();
            $('.calc-niaga-auto .calc-result-installment').text('')
        } else {
            $('.calc-niaga-auto .vehicle-min-error').hide();
        }

    }

    if ($('.calc-niaga-auto').length) {

        $('.calc-niaga-auto .numeric-only').keyup(refreshAutolLoanCalculator);
        $('.calc-niaga-auto select').bind('blur change', function() {
            refreshAutolLoanCalculator();
        });

        // init
        $('.calc-niaga-auto .vehicle-price').val(500000000);
        $('.calc-niaga-auto .vehicle-downpayment').val(150000000);
        refreshAutolLoanCalculator();

    }

    /* INPUT CALCULATOR (Niaga-Mortgage Loan) ---------------------------- */
    function refreshMortgageCalculator() {

        // Destroy existing table
        $('.calc-mortgage-table').slideUp();
        $('.mortgage-loan-data').empty();

        // Calculation
        var principalAmt = $('.calc-niaga-mortgage .principal-amount').val();
        var downpayment = $('.calc-niaga-mortgage .mortgage-downpayment').val();
        var rate = $('.calc-niaga-mortgage .interest-rate').val();
        var tenure = $('.calc-niaga-mortgage .loan-tenure').val();
        var minDownpaymentPer = $('.calc-niaga-mortgage .mortgage-downpayment-per').val();
        var minDownpayment = (minDownpaymentPer / 100) * principalAmt
        var minPrincipalAmt = $('.calc-niaga-mortgage .min-property-price').val();

        var amt = principalAmt - downpayment

        var a = rate / 100. / 12.;
        var b = 1. + a;
        b = Math.pow(b, (tenure * 12)) - 1.;
        var FC = a / b + a;
        FC = FC.toFixed(10);
        var RP = amt * FC;
        var answerVal = Math.round(RP);

        // Write Results
        toolsSetCalculatedValue('.calc-niaga-mortgage .calc-result-installment', answerVal.toLocaleString());
        toolsSetCalculatedValue('.calc-niaga-mortgage .calc-result-proposed-limit', amt.toLocaleString());

        // Error handling

        var errorResult = function() {
            $('.calc-niaga-mortgage .calc-result-installment, .calc-niaga-mortgage .calc-result-proposed-limit').text('');
            $('.btn-calculate-mortgage-holder').slideUp();
        }

        if (downpayment < minDownpayment) {
            $('.calc-niaga-mortgage .mortgage-downpayment-error').show();
            errorResult();
        } else {
            $('.calc-niaga-mortgage .mortgage-downpayment-error').hide();
        }

        if (parseInt(principalAmt) < parseInt(minPrincipalAmt)) {
            $('.calc-niaga-mortgage .mortgage-amt-error').show();
            errorResult();
        } else {
            $('.calc-niaga-mortgage .mortgage-amt-error').hide();
        }

        var rateFixed = $('.calc-niaga-mortgage .interest-rate option:selected').attr('data-fixed');
        $('.min-tenure-txt').text(rateFixed);

        if (tenure < parseInt(rateFixed)) {
            $('.calc-niaga-mortgage .mortgage-tenure-error').show();
            errorResult();
        } else {
            $('.calc-niaga-mortgage .mortgage-tenure-error').hide();
        }

        if ($('.mortgage-downpayment-error').css('display') == "block" || $('.mortgage-amt-error').css('display') == "block" || $('.mortgage-tenure-error').css('display') == "block") {
            console.log('theres an error')
        } else {
            $('.btn-calculate-mortgage-holder').slideDown();
            toggleMortgageArrow();
        }

    }

    if ($('.calc-niaga-mortgage').length) {
        $('.calc-niaga-mortgage .numeric-only').keyup(refreshMortgageCalculator);
        $('.calc-niaga-mortgage select').bind('blur change', function() {
            refreshMortgageCalculator();
        });

        // init
        $('.calc-niaga-mortgage .principal-amount').val('300000000');
        $('.calc-niaga-mortgage .mortgage-downpayment').val('90000000');
        refreshMortgageCalculator()

        // prepare table upon click
        $('.btn-calculate-mortgage').click(function() {
            createMortgageTable();
            $('.calc-mortgage-table').slideToggle();
            toggleMortgageArrow();

        })
    }

    /* INPUT CALCULATOR (Niaga-Financial Loan) ---------------------------- */
    function refreshFinancialCalc() {

        var age = $('.calc-financial .age').val();
        var ageobj = $('.calc-financial .ageobj').val();
        var fundamt = $('.calc-financial .fundamt').val();
        // var goalyear = ageobj - age;
        var goalyear = parseInt(ageobj.replace(/,/g, ''), 10) - parseInt(age.replace(/,/g, ''), 10)
        $('.calc-financial .goalyear').val(goalyear.toLocaleString().split('.')[0]);

        var inflationrate = $('.calc-financial .inflationrate').val();
        var annualinflationrate = parseInt(fundamt.replace(/,/g, ''), 10) * (Math.pow((1 + (inflationrate / 100)), goalyear))

        $('.calc-financial .annualinflationrate').val(Math.round(annualinflationrate).toLocaleString().split('.')[0]);

        var preparationfund = $('.calc-financial .preparationfund').val();
        var preparationrate = $('.calc-financial .preparationrate').val();
        var havetoberate = parseInt(preparationfund.replace(/,/g, ''), 10) * (Math.pow((1 + (preparationrate / 100)), goalyear))

        $('.calc-financial .havetoberate').val(Math.round(havetoberate).toLocaleString().split('.')[0]);

        var lackExcess = Math.round(havetoberate - annualinflationrate)
        var lackExcessSuffix = $('.calc-financial .calc-result-lackexcess').attr('data-prefix') + lackExcess.toLocaleString().split('.')[0];

        // NaN Handling
        if (isNaN(annualinflationrate)) {
            $('.annualinflationrate').val('')
        }

        if (isNaN(havetoberate)) {
            $('.havetoberate').val('')
        }

        if (isNaN(goalyear)) {
            $('.goalyear').val('')
        }

        if (isNaN(lackExcess)) {

        } else {
            $('.calc-financial .calc-result-lackexcess').text(lackExcessSuffix);
        }

        // Error Handling

        var parseageobj = parseInt(ageobj.replace(/,/g, ''), 10)
        var parseage = parseInt(age.replace(/,/g, ''), 10)

        if (parseageobj <= parseage) {
            $('.age-error').show();
        } else {
            $('.age-error').hide();
        }

        if (parseage == '' || parseageobj == '') {
            $('.age-error').hide();
        }

    }

    if ($('.calc-financial').length) {
        $('.calc-financial .numeric-only').keyup(refreshFinancialCalc);

        // init
        refreshFinancialCalc()
    }

    /* INPUT CALCULATOR (Credit Card Repayment SG) ---------------------------- */

    function refreshCreditCalculator() {

        var balanceAmt = []
        var finalMonth = []

        // Calculate Months, Balance Amount, Interest Amount, Monthly Repayment and Final Instalment (Per Month)
        var rate = $('.card-type').val() / 100;
        var current = parseInt($('.current-balance').val().replace(/,/g, ''), 10)
        var mrepay = parseInt($('.monthly-repayment').val().replace(/,/g, ''), 10)
        var tenure = 0;

        if (mrepay / current > rate) {

            i = 1;

            interestAmt = current * rate;
            balanceAmt = (current - mrepay + interestAmt);
            monthlyRepayment = 0;

            if (interestAmt > 0) {
                monthlyRepayment = mrepay;
            } else {
                monthlyRepayment = 0;
            }

            finalInstall = 0;

            if (interestAmt > 0 && balanceAmt <= mrepay) {
                interestAmt2 = balanceAmt * rate;
                finalInstall = balanceAmt + interestAmt2;
            } else {
                finalInstall = 0;
            }

            monthlyData = [];
            monthlyData.push(i, balanceAmt, interestAmt, monthlyRepayment, finalInstall);

            monthlyRepaymentArray = [];
            monthlyRepaymentArray.push(monthlyData[3], monthlyData[4])
            monthlyData[0] = monthlyData[0] + 1 // to make up for missing row

            // template = '<tr><td>'+i+'</td><td>'+balanceAmt+'</td><td>'+interestAmt+'</td><td>'+mrepay+'</td><td>'+finalInstall+'</td></tr>'
            // $('#result').append(template)

            for (i = 2; interestAmt > 0; i++) {

                balanceAmt2 = balanceAmt - mrepay + interestAmt;
                interestAmt = balanceAmt * rate;
                balanceAmt = (balanceAmt - mrepay + interestAmt);

                if (interestAmt > 0 && balanceAmt <= mrepay) {
                    interestAmt2 = balanceAmt * rate;
                    finalInstall = balanceAmt + interestAmt2;
                } else {
                    finalInstall = 0;
                }

                if (balanceAmt < 0) {
                    break;
                }

                monthlyData = [];
                // i = i + 1 // to make up for the missing row
                monthlyData.push(i, balanceAmt, interestAmt, monthlyRepayment, finalInstall);

                monthlyRepaymentArray.push(monthlyData[3], monthlyData[4])

                monthlyData[0] = monthlyData[0] + 1 // to make up for missing row

                // template = '<tr><td>'+i+'</td><td>'+balanceAmt+'</td><td>'+interestAmt+'</td><td>'+mrepay+'</td><td>'+finalInstall+'</td></tr>'
                // $('#result').append(template)
            }
        } else {
            alert('Infinite');
        }



        // Calculate Total of Monthly Repayment + Final Instalment
        var n = monthlyRepaymentArray.length;
        var totalPaid = 0;
        while (n--)
            totalPaid += parseFloat(monthlyRepaymentArray[n]) || 0;

        toolsSetCalculatedValue('.total-paid', Math.ceil(totalPaid))
        $('.total-paid').digits();
        $('.tenure').html(monthlyData[0] + ' Month(s)');

    }

    function cardSetInterestRate() {
        var interestRate = $('.card-type').val();
        $('.interest').val(interestRate);
    }

    if ($('.calc-card-repayment').length) {

        cardSetInterestRate();

        $('.btn-calculate').click(function() {

            $('.calc-error')
                .removeClass('error-exist')
                .filter(function() {
                    // Filter
                    return $(this).css('display') === "block";
                })
                .addClass('error-exist');


            if ($('.error-exist').length === 0) {
                refreshCreditCalculator();
                $('.results-container').slideDown();
            }

        })

        $(this).find('.numeric-only').keyup(function() {
            $('.results-container').slideUp();

            // Error handling
            // var currentBalance = $('.current-balance').val();
            var currentBalance = parseFloat($('.current-balance').val());
            var monthlyRepayment = parseFloat($('.monthly-repayment').val());

            var minMonthlyPayment = $('.min-monthly-payment').val();
            var minPercentageBalance = $('.min-percent-balance').val();

            var currentBalanceInt = parseInt($('.current-balance').val().replace(/,/g, ''), 10)
            var monthlyRepaymentInt = parseInt($('.monthly-repayment').val().replace(/,/g, ''), 10)

            if (currentBalance == 0 || currentBalance == "") {
                $('.error-balance-min').show();
            } else {
                $('.error-balance-min').hide();
            }

            if (monthlyRepayment == 0 || monthlyRepayment == "") {
                $('.error-repayment-min').show();
            } else {
                $('.error-repayment-min').hide();
            }

            // If Current Credit Card Balance < Monthly Repayment
            if (currentBalanceInt < monthlyRepaymentInt) {
                $('.error-credit-scenario1').show();
                $('.error-credit-scenario1 span').html(monthlyRepayment);
            } else {
                $('.error-credit-scenario1').hide();
            }

            // Current Credit Card Balance >  Monthly Repayment AND Current Credit Card Balance < $50 
            if (currentBalanceInt > monthlyRepaymentInt && currentBalanceInt < minMonthlyPayment) {
                $('.error-credit-scenario2').show();
                $('.error-credit-scenario2 span').html(currentBalance);
            } else {
                $('.error-credit-scenario2').hide();
            }

            var newMinPayment = (minPercentageBalance / 100) * currentBalanceInt

            if (currentBalanceInt > monthlyRepaymentInt && currentBalanceInt >= minMonthlyPayment && newMinPayment < minMonthlyPayment && monthlyRepaymentInt < minMonthlyPayment) {
                $('.error-credit-scenario3').show();
                $('.error-credit-scenario3 span').html(minMonthlyPayment);
            } else {
                $('.error-credit-scenario3').hide();
            }

            // Current Credit Card Balance >  Monthly Repayment AND Current Credit Card Balance >= S$1667 AND Monthly Repayment < 3% Of Credit Card Balance
            var minUserBalance = $('.min-user-balance').val();
            // if (currentBalanceInt > monthlyRepaymentInt && newMinPayment >= minMonthlyPayment && monthlyRepaymentInt < ((minPercentageBalance / 100) * currentBalanceInt)) {
            if (currentBalanceInt > monthlyRepaymentInt && newMinPayment >= minMonthlyPayment && monthlyRepaymentInt < ((minPercentageBalance / 100) * currentBalanceInt)) {
                var mintoPay = (minPercentageBalance / 100) * currentBalanceInt;
                mintoPay = mintoPay.toFixed(2);
                $('.error-credit-scenario4').show();
                $('.error-credit-scenario4 .amt').html(mintoPay);
                $('.error-credit-scenario4 .percentage').html(minPercentageBalance);
            } else {
                $('.error-credit-scenario4').hide()
            }

        })

        $(this).find('select').change(function() {
            $('.results-container').slideUp();
        })

        // Show Interest Card based on selected cards
        $('.card-type').change(function() {
            cardSetInterestRate();
        })

    }

});

function toggleMortgageArrow() {
    if ($('.btn-calculate-mortgage-holder .icon').hasClass('icon-core_solid_arrow_down') && $('.calc-mortgage-table').css('display') == 'block') {
        $('.btn-calculate-mortgage-holder .icon').removeClass('icon-core_solid_arrow_down');
        $('.btn-calculate-mortgage-holder .icon').addClass('icon-core_solid_arrow_up');
    } else {
        $('.btn-calculate-mortgage-holder .icon').removeClass('icon-core_solid_arrow_up');
        $('.btn-calculate-mortgage-holder .icon').addClass('icon-core_solid_arrow_down');
    }
}

function createMortgageTable() {
    // Start
    var principalAmt = $('.calc-niaga-mortgage .principal-amount').val();
    var downpayment = $('.calc-niaga-mortgage .mortgage-downpayment').val();
    var rate = $('.calc-niaga-mortgage .interest-rate').val();
    var tenure = $('.calc-niaga-mortgage .loan-tenure').val();
    var minDownpaymentPer = $('.calc-niaga-mortgage .mortgage-downpayment-per').val();
    var minDownpayment = (minDownpaymentPer / 100) * principalAmt
    var minPrincipalAmt = $('.calc-niaga-mortgage .min-property-price').val();
    var amt = principalAmt - downpayment
    var defaultrate = $('.calc-niaga-mortgage .loan-tenure').val();
    var rateFixed = $('.calc-niaga-mortgage .interest-rate option:selected').attr('data-fixed');
    var defaultRate = $('.calc-niaga-mortgage .mortgage-rate-int').val();

    var a = rate / 100. / 12.;
    var b = 1. + a;
    b = Math.pow(b, (tenure * 12)) - 1.;
    var FC = a / b + a;
    FC = FC.toFixed(10);
    var RP = amt * FC;
    var answerVal = Math.round(RP);

    var month = 1
    var installmentinterest = amt * ((rate / 100) / 12);
    var principalinstall = RP - installmentinterest;
    var loanprincipal = amt - principalinstall

    var monthlyInstallment = amt * (rate / 1200) * Math.pow(1 + (rate / 1200), tenure * 12) / (Math.pow(1 + (rate / 1200), tenure * 12) - 1)

    var rowData = "<tr><td>" + month + "</td><td>" + rate + "</td><td>" + monthlyInstallment + "</td><td>" + installmentinterest + "</td><td>" + principalinstall + "</td><td>" + loanprincipal + "</td></tr>"

    $(".mortgage-loan-data").append(rowData);


    // Second row onwards
    for (i = 2; i <= tenure * 12; i++) {

        var installmentinterest = loanprincipal * ((rate / 100) / 12);
        var principalinstall = monthlyInstallment - installmentinterest;
        var loanprincipal = loanprincipal - principalinstall;
        var rowData = "<tr><td>" + i + "</td><td>" + rate + "</td><td>" + monthlyInstallment + "</td><td>" + installmentinterest + "</td><td>" + principalinstall + "</td><td>" + loanprincipal + "</td></tr>"

        if (i == rateFixed * 12) {

            rate = defaultRate;
            remainingYr = tenure - rateFixed;
            var monthlyInstallment = loanprincipal * (rate / 1200) * Math.pow(1 + (rate / 1200), remainingYr * 12) / (Math.pow(1 + (rate / 1200), remainingYr * 12) - 1)
            var installmentinterest = loanprincipal * ((rate / 100) / 12);
            var principalinstall = monthlyInstallment - installmentinterest;
        }

        // Write data
        $(".mortgage-loan-data").append(rowData);
    }

    // Aesthetic purpose
    var currencyPrefix = $('.calc-niaga-mortgage .calc-result-installment').attr('data-prefix')

    $('.mortgage-loan-data td:nth-child(3), .mortgage-loan-data td:nth-child(4), .mortgage-loan-data td:nth-child(5), .mortgage-loan-data td:nth-child(6)').each(function() {
        var value = $(this).text();
        if ($.isNumeric(value)) {
            // var final = Math.floor(value);
            var final = Math.round(value);
            $(this).text(currencyPrefix + " " + final.toLocaleString().split('.')[0])
        }
    });
}

function generateMonthlyInstalment(pOutstandingPrincipal, pInterestRate, pMonthsPassed, loanTenure) {
    var monthlyInstalmentResult = ((pInterestRate / 1200) + ((pInterestRate / 1200) / (Math.pow(1 + (pInterestRate / 1200), (loanTenure * 12) - pMonthsPassed) - 1))) * pOutstandingPrincipal;
    return (monthlyInstalmentResult);
}

function refreshCompoundInterestCalculator() {
    var a = parseFloat($('.calc-compoundinterest .principal-amount').val());
    var b = parseFloat($('.calc-compoundinterest .interest-rate').val()) / 100;
    var c = parseFloat($('.calc-compoundinterest .loan-tenure').val());

    var d = 0,
        grandTotal;

    var totalsum = a
    var intpaid = 0
    var intpaid_total = 0;
    var year = 1;

    var output = '';
    var currency = 'RM';

    while (year <= c) {

        intpaid = (totalsum * (Math.pow(1 + (b / 12), 12))) - totalsum
        intpaid_total += intpaid;
        totalsum += intpaid;

        output += '<div class="row tabdata">'
        output += '    <div class="tabcol">' + year + '</div>'
        output += '    <div class="tabcol">' + currency + intpaid.toFixed(2) + '</div>'
        output += '    <div class="tabcol">' + currency + intpaid_total.toFixed(2) + '</div>'
        output += '    <div class="tabcol">' + currency + totalsum.toFixed(2) + '</div>'
        output += '</div>';

        year++;
    }

    $('.calc-compoundinterest .calculated-result .generated-contents').html(output);
    $('.calc-compoundinterest .calculated-result').slideDown()
    $('.calc-compoundinterest .calculated-result-label').slideDown()
    $('.calc-compoundinterest .calculator-item').slideUp();

}

// Footer, auto add class

$(document).ready(function() {
    $('.f-sitemap-nav > .five:first-child  nav').addClass('first');
});

//Reset button to forcecully clear radio and checkboxes

$('#reset-btn').click(function() {
    $('i.icon-check, i.icon-dot').remove();
});

//Custom border for Merchant Listing

var executeBorderforListing = function() {
    $('.merchant-contact-container').addClass('merchant-contact-border-btm');
    var width = $(window).width();
    if (width <= 768) {
        $('.visit-us-container .merchant-row:last-child .merchant-contact-container').addClass('merchant-contact-border-btm');
        $('.visit-us-container .merchant-row:last-child .merchant-contact-container:last-child').removeClass('merchant-contact-border-btm');
    } else {
        $('.visit-us-container .merchant-row:last-child .merchant-contact-container').removeClass('merchant-contact-border-btm');
        //Set same height for merchant listing
        $('.merchant-row').each(function() {
            var highestBox = 0;
            $('.merchant-contact-container', this).each(function() {

                if ($(this).height() > highestBox)
                    highestBox = $(this).height();
            });
            $('.merchant-contact-container', this).height(highestBox);
        });
    }
};

$(document).ready(executeBorderforListing);
$(window).resize(executeBorderforListing);


// Auto calculate width of hyperlink listing for Title Component (Desktop View) 

var executeWidthFixing = function() {
    var width = $(window).width();
    if (width >= 1020) {
        $('.row').each(function() {
            var totalWidth = $(this).find('.title-all').width()
            var titleWidth = $(this).find('.title-listing').outerWidth()
            var newTitleWidth = totalWidth - titleWidth - 40

            $(this).find('.hyperlink-listing').css('width', newTitleWidth)
        });
    }
    // else{
    //     $('.row').each(function(){
    //         var defaultTitleWidth = "100%";

    //         $(this).find('.hyperlink-listing').css('width',defaultTitleWidth)
    //     });
    // }
};

$(document).ready(executeWidthFixing);
$(window).resize(executeWidthFixing);


//Forces nav to be same height as container in two column template

$(window).load(function() {
    // var twocolnavheight = $('.two-columns').height();
    // var twocolnavheight = $('.two-columns').outerHeight();
    // //$('.two-columns-nav').css('height',twocolnavheight);

    // // For Unit Trust
    // // $('.two-columns-sidebar').css('height',twocolnavheight);
    // // If inside length is longer, recalculate


    // var sidebarheight = $('.two-columns-sidebar').outerHeight();

    // console.log('twocolnavheight ' + twocolnavheight);
    // console.log('sidebarheight ' + sidebarheight);

    // if( sidebarheight < twocolnavheight ){
    //     $('.two-columns-sidebar').css('height',twocolnavheight);
    //     console.log('nav is shorter');
    // }
    // else{
    //     // $('.two-columns-sidebar').removeAttr('style');
    //     console.log('nav is longer');
    // }
    recalculateLeftHeight();

    $('.two-columns-sidebar a').click(function() {
        // $('.two-columns-sidebar').css('height','auto');
        var timer = null;
        clearTimeout(timer);
        timer = setTimeout(recalculateLeftHeight, 500);
    });

});

function recalculateLeftHeight() {

    var twocolnavheight = $('.two-columns').outerHeight();
    var leftcompnav = $('.leftside-comp-nav').outerHeight();
    var sidebarheight = $('.two-columns-sidebar').outerHeight();

    if (leftcompnav <= twocolnavheight) {
        $('.two-columns-sidebar').css('height', twocolnavheight);
    } else {
        $('.two-columns-sidebar').css('height', 'auto');
    }
}

var initialTwoColNavHeight = $('.two-columns-nav').height()

// Load more promo tile same height as the column before
var myContentHeight = $('.myContent').outerHeight();
$('.myLoadMore>.home-see-all-promotions').height(myContentHeight);
$('.myLoadMore>.home-see-all-promotions>.home-load-more-news-promotions-btn2').height(myContentHeight).css({
    'padding-top': '120px'
});

var promoItemHeight = $('.promo-item').outerHeight();
var promoItemBtn = $('.promo-item').outerHeight() - 50;
$('.nav-hyperlink-ajax-content .home-see-all-promotions a').css({
    'padding-top': promoItemBtn / 2,
    'padding-bottom': promoItemBtn / 2
});
$('.nav-hyperlink-ajax-content .home-see-all-promotions').height(promoItemHeight);


// See Details
$('.acctdetailtrigger').click(function() {
    $('.welcome').hide();
    $('#acctdetail-info').fadeIn();
});
$('.custotrigger').click(function() {
    $('.welcome').hide();
    $('#custo-info').fadeIn();
});
$('.accttrigger').click(function() {
    $('.welcome').hide();
    $('#acct-info').fadeIn();
});
$('.qttrigger').click(function() {
    $('.welcome').hide();
    $('#qt-info').fadeIn();
});
$('.fasterTtrigger').click(function() {
    $('.welcome').hide();
    $('#fasterT-info').fadeIn();
});


//Return from Details
$('.democontent .goback').click(function() {
    $(this).parents('.democontent').hide();
    $('.welcome').fadeIn();
});

// Launch popupvid
$('#acctdetail-info .launchpop').click(function() {
    $('#acctdetail').fadeIn().addClass('active');
});

$('#custo-info .launchpop').click(function() {
    $('#custo').fadeIn().addClass('active');
});

$('#acct-info .launchpop').click(function() {
    $('#acct').fadeIn().addClass('active');
});

$('#qt-info .launchpop').click(function() {
    $('#qt').fadeIn().addClass('active');
});

$('#fasterT-info .launchpop').click(function() {
    $('#fasterT').fadeIn().addClass('active');
});

// Close popupvideo
$('.popup .closepop').click(function() {
    $(this).parents('.popup').hide();
    $(this).parents('.popup').removeClass('active');
    $('video').each(function() {
        this.player.pause()
    })
});

// Visual 
$(function() {
    $(".demo1").hover(function() {
            $("#demo1-hover").fadeIn("fast");
        },
        function() {
            $("#demo1-hover").fadeOut("fast");
        });
    $(".demo1").click(function() {
        $("#demo1-hover").fadeOut("fast");
        $('.welcome,.democontent').hide();
        $('#acctdetail-info').fadeIn();
    });
    $(".demo2").hover(function() {
            $("#demo2-hover").fadeIn("fast");
        },
        function() {
            $("#demo2-hover").fadeOut("fast");
        });
    $(".demo2").click(function() {
        $("#demo2-hover").fadeOut("fast");
        $('.welcome,.democontent').hide();
        $('#qt-info').fadeIn();
    });
    $(".demo3").hover(function() {
            $("#demo3-hover").fadeIn("fast");
        },
        function() {
            $("#demo3-hover").fadeOut("fast");
        });
    $(".demo3").click(function() {
        $("#demo3-hover").fadeOut("fast");
        $('.welcome, .democontent').hide();
        $('#acct-info').fadeIn();
    });
    $(".demo4").hover(function() {
            $("#demo4-hover").fadeIn("fast");
        },
        function() {
            $("#demo4-hover").fadeOut("fast");
        });
    $(".demo4").click(function() {
        $("#demo4-hover").fadeOut("fast");
        $('.welcome,.democontent').hide();
        $('#fasterT-info').fadeIn();
    });
    $(".demo5").hover(function() {
            $("#demo5-hover").fadeIn("fast");
        },
        function() {
            $("#demo5-hover").fadeOut("fast");
        });
    $(".demo5").click(function() {
        $("#demo5-hover").fadeOut("fast");
        $('.welcome,.democontent').hide();
        $('#custo-info').fadeIn();
    });
})

// Arrange card listing based on minimum income

$(".all-item-listing>li").sort(sort_li).appendTo('.all-item-listing');

function sort_li(a, b) {
    return ($(b).find('div').data('incomerequire')) < ($(a).find('div').data('incomerequire')) ? 1 : -1;
}

// Dynamic Input for MinIncome slider

function setDynamicPositioning() {

    //Start Auto Calculate Function
    $('.dynamic-slider-marker').each(function() {

        var getMinVal = $('.tool-slider-mainwrapper').attr('minval');
        var getMaxVal = $('.tool-slider-mainwrapper').attr('maxval');
        var getStepVal = $('.tool-slider-mainwrapper').attr('stepval');

        var getLabelValue = $(this).find('.slider-marker-label').html().replace(/[^0-9]/g, '');
        var getNewValue = ((getLabelValue - getMinVal) / (getMaxVal - getMinVal)) * 100

        var newPositionLeft = Math.round(getNewValue) + '%';
        var newPerPos = Math.round(getNewValue);

        $(this).css('left', newPositionLeft).attr('data-perpos', newPerPos)

    })
}

setDynamicPositioning()

// For Unit Trust Tables (Maximizes amount of row to 5, hides the rest)
$('.expandable-table').each(function() {
    var numShown = 5; // Initial rows shown & index
    var numMore = 5; // Increment

    var $table = $(this).find('tbody'); // tbody containing all the rows
    var numRows = $table.find('tr').length; // Total # rows

    // Hide rows id more than 5
    if (numRows >= numShown) {
        // Hide rows and add clickable div
        $table.find('tr:gt(' + (numShown) + ')').hide().end()
            .after('<tbody class="more"><tr><td colspan="' +
                $table.find('tr:first th').length + '"><div>Show <span>' +
                numMore + '</span> More <i class="icon-core_solid_arrow_down"></i></div></tbody></td></tr>');

    }

    $(this).find('.more').click(function() {
        numShown = numShown + numMore;
        // no more "show more" if done
        if (numShown >= numRows) {
            $(this).remove();
        }
        // change rows remaining if less than increment
        if (numRows - numShown < numMore) {
            $(this).find('span').html(numRows - numShown);
        }
        $table.find('tr:lt(' + numShown + ')').show();
    });
})

// Disclaimer for Calculators

if ($('.calc-disclaimer').length) {
    $('.calc-disclaimer:first').fadeIn();
}

function setCalcDisclaimer() {
    var containerHeight = $('.calc-disclaimer').outerHeight();
    var titleHeight = $('.calc-disclaimer-content>h3').outerHeight();
    var buttonHeight = $('.calc-disclaimer-content .static-content').outerHeight();
    var contentheight = $('.calc-disclaimer-content').outerHeight();
    var newContentHeight = contentheight - titleHeight - buttonHeight - 60
    var newMarginTop = (containerHeight - contentheight) / 2

    $('.calc-disclaimer-content>.scrollable-content').height(newContentHeight);
    $('.calc-disclaimer-content').css('margin-top', newMarginTop)
}

$(document).ready(setCalcDisclaimer)
$(window).resize(setCalcDisclaimer)

$('.calc-agree').each(function() {
    $(this).click(function() {
        $(this).parent().parent().parent().parent().fadeOut(150);
    })
})

// Warning

function setWarningPopup(classContainer) {
    var warningContainerHeight = $('.calc-value-warning').height()
    var warningContentHeight = $('.calc-warning-content').height()
    var newMarginTop2 = (warningContainerHeight - warningContentHeight) / 2
    $(classContainer).find('.calc-warning-content').css('margin-top', newMarginTop2)
}

// Home Loan Calculator (SG Version)

function prepareLoanRepaymentTable() {

    var amt = parseInt($('.calc-homeloan-repayment .principal-amount').val().replace(/,/g, ''), 10)
    var loanTenure = $('.calc-homeloan-repayment .loan-tenure').val()
    var rate = $('.calc-homeloan-repayment .interest-yr1').val()
    var month = 1

    // Write Data
    var amtSeparated = amt.toLocaleString().split('.')[0]
        // toolsSetCalculatedValue('.calc-homeloan-repayment .loan-amt', parseFloat(amtSeparated).toFixed(0))

    toolsSetCalculatedValue('.calc-homeloan-repayment .loan-amt', (amtSeparated).toLocaleString().split('.')[0])

    // .toLocaleString().split('.')[0]

    // For every month, generate a row of data
    // First row
    var outstandingPrincipal = amt
    var monthlyInstallment = (getMonthlyInstallment(outstandingPrincipal, rate, 0))
    var paymentInterest = (amt * rate / 100 / 12)
        // var paymentInterest = (round_number((amt*rate/100/12), 2)).toFixed(2);
    var paymentPrincipal = (monthlyInstallment - paymentInterest)
    var endPrincipal = (outstandingPrincipal - paymentPrincipal)

    var rowData = "<tr><td>" + month + "</td><td>" + rate + "</td><td>" + outstandingPrincipal + "</td><td>" + monthlyInstallment + "</td><td>" + paymentInterest + "</td><td>" + paymentPrincipal + "</td><td>" + endPrincipal + "</td><td></td><td></td><td></td></tr>"

    $(".loandata").append(rowData);

    // Second Row onwards
    for (i = 2; i <= loanTenure * 12; i++) {
        var outstandingPrincipal = endPrincipal
        var paymentInterest = (outstandingPrincipal * rate / 100 / 12)
            // var paymentInterestRound = (round_number(paymentInterest, 2)).toFixed(2);
        var paymentPrincipal = (monthlyInstallment - paymentInterest)
        var endPrincipal = (outstandingPrincipal - paymentPrincipal)
            // var endPrincipalRound = (round_number(endPrincipal, 2)).toFixed(2);
        var rowData = "<tr><td>" + i + "</td><td>" + rate + "</td><td>" + outstandingPrincipal + "</td><td>" + monthlyInstallment + "</td><td>" + paymentInterest + "</td><td>" + paymentPrincipal + "</td><td>" + endPrincipal + "</td><td></td><td></td><td></td></tr>"

        if (i == 12) {
            // var rate = 3.5;
            var rate = $('.calc-homeloan-repayment .interest-yr2').val()
            var outstandingPrincipal = endPrincipal
            var monthlyInstallment = (getMonthlyInstallment(outstandingPrincipal, rate, i))
            var paymentInterest = (amt * rate / 100 / 12)
            var paymentPrincipal = (monthlyInstallment - paymentInterest)
        } else if (i == 24) {
            // var rate = 3.75;
            var rate = $('.calc-homeloan-repayment .interest-yr3').val()
            var outstandingPrincipal = endPrincipal
            var monthlyInstallment = (getMonthlyInstallment(outstandingPrincipal, rate, i))
        } else if (i == 36) {
            // var rate = 3.75;
            var rate = $('.calc-homeloan-repayment .interest-yr4').val()
            var outstandingPrincipal = endPrincipal
            var monthlyInstallment = (getMonthlyInstallment(outstandingPrincipal, rate, i))
        } else if (i == 48) {
            // var rate = 3.75;
            var rate = $('.calc-homeloan-repayment .interest-yr5').val()
            var outstandingPrincipal = endPrincipal
            var monthlyInstallment = (getMonthlyInstallment(outstandingPrincipal, rate, i))
        }
        $(".loandata").append(rowData);
    }

}


// Get Total Interest Payment Per Year

function getTotalInterestPaymentPerYear() {
    $('.loandata tr:nth-child(12n)').each(function() {
        var arr = []
        var interest12 = $(this).find('td:nth-child(5)').text()
        var interest11 = $(this).prev().find('td:nth-child(5)').text()
        var interest10 = $(this).prev().prev().find('td:nth-child(5)').text()
        var interest9 = $(this).prev().prev().prev().find('td:nth-child(5)').text()
        var interest8 = $(this).prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest7 = $(this).prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest6 = $(this).prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest5 = $(this).prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest4 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest3 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest2 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        var interest = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(5)').text()
        arr.push(interest12, interest11, interest10, interest9, interest8, interest7, interest6, interest5, interest4, interest3, interest2, interest);
        var n = arr.length;
        var sum = 0;
        while (n--)
            sum += parseFloat(arr[n]) || 0;
        // sum = (round_number(sum, 2)).toFixed(2);
        $(this).find('td:nth-child(8)').html(sum)
    })
}

// Get TotalPrincipalPaymentPrYear

function getTotalPrincipalPaymentPerYear() {
    $('.loandata tr:nth-child(12n)').each(function() {
        var arrPrincipal = []
        var principal12 = $(this).find('td:nth-child(6)').text()
        var principal11 = $(this).prev().find('td:nth-child(6)').text()
        var principal10 = $(this).prev().prev().find('td:nth-child(6)').text()
        var principal9 = $(this).prev().prev().prev().find('td:nth-child(6)').text()
        var principal8 = $(this).prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal7 = $(this).prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal6 = $(this).prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal5 = $(this).prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal4 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal3 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal2 = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        var principal = $(this).prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().find('td:nth-child(6)').text()
        arrPrincipal.push(principal12, principal11, principal10, principal9, principal8, principal7, principal6, principal5, principal4, principal3, principal2, principal);
        var n = arrPrincipal.length;
        var sum = 0;
        while (n--)
            sum += parseFloat(arrPrincipal[n]) || 0;
        // sum = (round_number(sum, 2)).toFixed(2);
        $(this).find('td:nth-child(9)').html(sum)
    })
}

// Get RemainingPrincipalPaymentPrYear
function getRemainingPrincipalPaymentPerYear() {
    $('.loandata tr:nth-child(12n)').each(function() {
        var remainingPrincipal = $(this).find('td:nth-child(7)').text()
        $(this).find('td:nth-child(10)').html(remainingPrincipal)
    })
}

// Total Interest Payable
function getTotalInterestPayable() {
    var rowAmt = $('.loandata tr').length
    var arrTotalInterest = []
    for (i = 1; i <= rowAmt; i++) {
        var getInterest = $(".loandata").find('tr:nth-child(' + i + ')').find('td:nth-child(5)').text()
        arrTotalInterest.push(getInterest);

    }
    var n = arrTotalInterest.length;
    var sumInterest = 0;
    while (n--)
        sumInterest += parseFloat(arrTotalInterest[n]) || 0;

    // toolsSetCalculatedValue('.calc-homeloan-repayment .total-interest-payable', Math.floor(sumInterest).toLocaleString().split('.')[0])
    toolsSetCalculatedValue('.calc-homeloan-repayment .total-interest-payable', Math.round(sumInterest).toLocaleString().split('.')[0]);

    sumInterestNo = sumInterest

}

// Excel functions. 
// IMPORTANT: rate is percentage in decimal (x/100);
  function FV (rate, nper, pmt, pv, type) 
  {
    if (!type) type = 0;
    var pow = Math.pow(1 + rate, nper);
    var fv = 0;

    if (rate) {
      fv = (pmt * (1 + rate * type) * (1 - pow) / rate) - pv * pow;
    } 
    else 
    {
      fv = -1 * (pv + pmt * nper);
    }

    // return fv.toFixed (2);
    return fv;
  }

  function PV (rate, periods, payment, future, type) 
  {
    // Initialize type
    var type = (typeof type === 'undefined') ? 0 : type;
    var future = (typeof future === 'undefined') ? 0 : future;

    // Return present value
    if (rate === 0) 
    {
      return - payment * periods - future;
    } 
    else 
    {
      return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 +rate * type) - future) / Math.pow(1 + rate, periods);
    }
  }

  function PMT (rate, nper, pv, fv, type) 
  {
    if (!fv) fv = 0;
    if (!type) type = 0;

    if (rate == 0) return -(pv + fv)/nper;
    
    var pvif = Math.pow(1 + rate, nper);
    var pmt = rate / (pvif - 1) * -(pv * pvif + fv);

    if (type == 1) {
      pmt /= (1 + rate);
    };

    return pmt;
  }


// Effective Interest Rate
function rateExcel(nper, pmt, pv, fv, type, estimate) {
    fv = fv || 0;
    type = type || 0;
    estimate = estimate || 0.1;

    var rate = estimate,
        y = 0,
        f = 0,
        FINANCIAL_MAX_ITERATIONS = 128,
        FINANCIAL_PRECISION = 1.0e-08,
        result;

    // if (Math.abs(rate) < FINANCIAL_PRECISION) {
    //     y = pv * (1 + nper * rate) + pmt * (1 + rate * type) * nper + fv;
    // } else {
    //     f = Math.exp(nper * Math.log(1 + rate));
    //     y = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;
    // }
    y = pv * (1 + nper * rate) + pmt * (1 + rate * type) * nper + fv;

    var y0 = pv + pmt * nper + fv,
        y1 = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;

    // find root by secant method
    var i = 0,
        x0 = 0,
        x1 = rate;
    while ((Math.abs(y0 - y1) >
            FINANCIAL_PRECISION) && (i < FINANCIAL_MAX_ITERATIONS)) {
        rate = (y1 * x0 - y0 * x1) / (y1 - y0);
        x0 = x1;
        x1 = rate;

        if (Math.abs(rate) < FINANCIAL_PRECISION) {
            y = pv * (1 + nper * rate) + pmt * (1 + rate * type) * nper + fv;
        } else {
            f = Math.exp(nper * Math.log(1 + rate));
            y = pv * f + pmt * (1 / rate + type) * (f - 1) + fv;
        }

        y0 = y1;
        y1 = y;
        ++i;
    }

    result = new Number(rate);
    // result.html = Globalize.format(rate, "p");
    return result;
}

// Total Amount Payable
function getTotalAmtPayable() {
    var amt = parseInt($('.calc-homeloan-repayment .principal-amount').val().replace(/,/g, ''), 10)
    var totalInterestPayableOri = $('.calc-homeloan-repayment .total-interest-payable').text();
    var totalInterestPayable = totalInterestPayableOri.replace(/\D/g, '');
    var totalAmtPayable = parseFloat(totalInterestPayable) + parseFloat(amt)
    toolsSetCalculatedValue('.calc-homeloan-repayment .total-amt-payable', parseFloat(totalAmtPayable).toLocaleString().split('.')[0])
    totalAmtPayableNo = amt + sumInterestNo;
}

// Calculation Function
function getMonthlyInstallment(pOutstandingPrincipal, pInterestRate, pMonthsPassed) {
    var loanTenure = $('.calc-homeloan-repayment .loan-tenure').val()
    var monthlyInstallmentResult = ((pInterestRate / 1200) + ((pInterestRate / 1200) / (Math.pow(1 + (pInterestRate / 1200), (loanTenure * 12) - pMonthsPassed) - 1))) * pOutstandingPrincipal;
    return (monthlyInstallmentResult);
}

function calculationTableLayout() {

    // Setting each results to be closest number, and adding dollar symbol
    var currencyPrefix = $('.calc-homeloan-repayment .loan-amt').attr('data-prefix')

    $('.loandata td:nth-child(4), .loandata td:nth-child(8), .loandata td:nth-child(9), .loandata td:nth-child(10)').each(function() {
        var value = $(this).text();
        if ($.isNumeric(value)) {
            // var final = Math.floor(value);
            var final = Math.round(value);
            $(this).text(currencyPrefix + " " + final.toLocaleString().split('.')[0])
        }
    });

    // Change month to year
    $('.loandata td:nth-child(1)').each(function() {
        var value = $(this).text();
        if ($.isNumeric(value)) {
            var final = value / 12
            $(this).text(final)
        }
    });

    // Add percentage to Montly Instalment
    $('.loandata td:nth-child(2)').each(function() {
        var value = $(this).text();
        if ($.isNumeric(value)) {
            var final = value + "%"
            $(this).text(final)
        }
    });

    // Hide irrelevant columns
    $('.loan-repayment-table th:nth-child(3)').hide()
    $('.loan-repayment-table td:nth-child(3)').hide()
    $('.loan-repayment-table th:nth-child(5)').hide()
    $('.loan-repayment-table td:nth-child(5)').hide()
    $('.loan-repayment-table th:nth-child(6)').hide()
    $('.loan-repayment-table td:nth-child(6)').hide()
    $('.loan-repayment-table th:nth-child(7)').hide()
    $('.loan-repayment-table td:nth-child(7)').hide()

    $('.loandata tr').hide()
    $('.loandata tr:nth-child(12n)').show()

    //Ensure Last Value is always 0
    var currencyPrefix = $('.calc-homeloan-repayment .loan-amt').attr('data-prefix')
    $('.loandata:last-child tr:last-child td:last-child').html(currencyPrefix + ' 0');

}

function getEffectiveInterestRate() {
    // Effective Interest Rate
    var amt = parseFloat($('.calc-homeloan-repayment .principal-amount').val().replace(/,/g, ''), 10)
    var loanTenure = $('.calc-homeloan-repayment .loan-tenure').val()
    var rate = $('.calc-homeloan-repayment .interest-yr1').val()
    var loanTenureMonths = loanTenure * 12

    // var pmt = -(totalPrincipalInterest / (loanTenureMonths))
    var pmt = -(totalAmtPayableNo / (loanTenureMonths))

    pmt = parseFloat(pmt);

    var fv = 0
    var type = 0
    var estimate = 0.1

    var effectiveInterestRate = (rateExcel(loanTenureMonths, pmt, amt, fv, type, estimate) * 12) * 100
    var effectiveInterestRateFinal = Math.round(effectiveInterestRate * 100) / 100

    $('.eff-rate').html(effectiveInterestRateFinal + '%');
}

// Set Interest rate to enable decimal
$(function($) {
    $('.interest-yr1, .interest-yr2, .interest-yr3, .interest-yr4, .interest-yr5').autoNumeric('init', {
        vMax: 99.99
    });;
});

if ($('.calc-homeloan-repayment').length) {
    // init
    $('.calc-homeloan-repayment .principal-amount').val('500,000');
    $('.calc-homeloan-repayment .loan-tenure').val('25');
    $('.calc-homeloan-repayment .interest-yr1').val('3.25');
    $('.calc-homeloan-repayment .interest-yr2').val('3.50');
    $('.calc-homeloan-repayment .interest-yr3').val('3.75');
    $('.calc-homeloan-repayment .interest-yr4').val('3.75');
    $('.calc-homeloan-repayment .interest-yr5').val('3.75');

    // $(".interest-yr1, .interest-yr2, .interest-yr3, .interest-yr4, .interest-yr5").keypress(function (event) {
    //     if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
    //         event.preventDefault();
    //     }

    //     var text = $(this).val();

    //     if ((text.indexOf('.') != -1) && (text.substring(text.indexOf('.')).length > 2)) {
    //         event.preventDefault();
    //     }
    // });

    $('.calc-homeloan-repayment .btn-calculate').click(function() {

        var errorLoanAmtMin = $('.error-loanamtmin').css('display');
        var errorLoanAmtMax = $('.error-loanamtmax').css('display');
        var errorLoanTenureMin = $('.error-loantenuremin').css('display');
        var errorLoanTenureMax = $('.error-loantenuremax').css('display');
        var errorInterest = $('.error-interestrateempty').css('display');

        if (errorLoanAmtMin == 'block' || errorLoanAmtMax == 'block' || errorLoanTenureMin == 'block' || errorLoanTenureMax == 'block' || errorInterest == 'block') {} else {
            $('.loandata').empty();
            $('.more').remove();
            $('.calc-homeloan-repayment .results-container').slideDown(500)
            prepareLoanRepaymentTable()
            getTotalInterestPaymentPerYear()
            getTotalPrincipalPaymentPerYear()
            getRemainingPrincipalPaymentPerYear()
            getTotalInterestPayable()
            getTotalAmtPayable()
            getEffectiveInterestRate()
            calculationTableLayout()
            expandTable()
                // console.log(sumInterestNumber);

        }

    })

    $('.calc-homeloan-repayment .numeric-only').keyup(function() {
        if ($('.results-container').css('display') == 'block') {
            $('.calc-homeloan-repayment .btn-calculate').html('Recalculate');
            $('.calc-homeloan-repayment .results-container').fadeOut(500);
        }
        calcItemChecking()
    });
}

function calcItemChecking() {
    var calcPrincipal = $('.calc-homeloan-repayment .principal-amount').val();
    var calcLoanTenure = $('.calc-homeloan-repayment .loan-tenure').val();

    var calcPrincipalMin = $('.calc-homeloan-repayment .principal-amount-min').val();
    var calcPrincipalMax = $('.calc-homeloan-repayment .principal-amount-max').val();
    var loanTenureMin = $('.calc-homeloan-repayment .loan-tenure-min').val();
    var loanTenureMax = $('.calc-homeloan-repayment .loan-tenure-max').val();

    var interestRate1 = $('.calc-homeloan-repayment .interest-yr1').val();
    var interestRate2 = $('.calc-homeloan-repayment .interest-yr2').val();
    var interestRate3 = $('.calc-homeloan-repayment .interest-yr3').val();
    var interestRate4 = $('.calc-homeloan-repayment .interest-yr4').val();
    var interestRate5 = $('.calc-homeloan-repayment .interest-yr5').val();

    // Set Checking
    if (calcPrincipal < parseInt(calcPrincipalMin)) {
        $('.calc-homeloan-repayment .error-loanamtmin').show()
    } else {
        $('.calc-homeloan-repayment .error-loanamtmin').hide()
    }
    if (calcPrincipal > parseInt(calcPrincipalMax)) {
        $('.calc-homeloan-repayment .error-loanamtmax').show()
    } else {
        $('.calc-homeloan-repayment .error-loanamtmax').hide()
    }
    if (calcLoanTenure < parseInt(loanTenureMin)) {
        $('.calc-homeloan-repayment .error-loantenuremin').show()
    } else {
        $('.calc-homeloan-repayment .error-loantenuremin').hide()
    }
    if (calcLoanTenure > parseInt(loanTenureMax)) {
        $('.calc-homeloan-repayment .error-loantenuremax').show()
    } else {
        $('.calc-homeloan-repayment .error-loantenuremax').hide()
    }
    if (interestRate1 != '') {
        $('.calc-homeloan-repayment .error-interestrateempty').hide()
    }
    emptyInterestRate($('.calc-homeloan-repayment .interest-yr1'));
    emptyInterestRate($('.calc-homeloan-repayment .interest-yr2'));
    emptyInterestRate($('.calc-homeloan-repayment .interest-yr3'));
    emptyInterestRate($('.calc-homeloan-repayment .interest-yr4'));
    emptyInterestRate($('.calc-homeloan-repayment .interest-yr5'));

    function emptyInterestRate(element) {
        if (element.val() == '') {
            $('.calc-homeloan-repayment .error-interestrateempty').show()
        }
    }
}

function expandTable() {
    $('.expandable-table').each(function() {
        var numShown = 5; // Initial rows shown & index
        var numMore = 5; // Increment
        var $table = $(this).find('tbody'); // tbody containing all the rows
        var numRows = $table.find('tr:nth-child(12n)').length; // Total # rows

        if (numRows >= numShown) {
            // Hide rows and add clickable div
            $table.find('tr:gt(' + (numShown * 12) + ')').hide().end()
                .after('<tbody class="more"><tr><td colspan="' +
                    $table.find('tr:first td').length + '"><div>Show More <i class="icon-core_solid_arrow_down"></i></div></tbody></td></tr>');
        }


        $(this).find('.more').click(function() {
            numShown = numShown + numMore;
            // no more "show more" if done
            if (numShown >= numRows) {
                $(this).remove();
            }
            // change rows remaining if less than increment
            if (numRows - numShown < numMore) {
                $(this).find('span').html(numRows - numShown);
            }
            $table.find('tr:nth-child(12n):lt(' + (numShown) + ')').show();
        });
    })
}

$(window).load(function() {
    $(".calc-disclaimer-content .scrollable-content").mCustomScrollbar();
});

// ON CLICK (FOR ANCHOR LINK SAME PAGE)
$(document).ready(function() {
    anchorLinkScroll();
})

function anchorLinkScroll() {
    $("a[href*='#']").click(function() {
        var topOffset = $(this).attr("topOffset")
        topOffset = 135
        if ($(window).width() < 1000) {
            $(".hyperlink-listing").slideUp();
            // topOffset = 45
        }
        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
            var target = $(this.hash);
            target = target.length ? target : $('[name="' + this.hash.slice(1) + '"]');
            if (target.length) {
                $('html,body').animate({
                    scrollTop: target.offset().top - topOffset
                }, 700);
            }
        }
    });
}

//slidedown button menu biz123
$( ".slidedown-btn" ).click(function() {
  $( ".hyperlink-listing-dropdown" ).slideToggle( "slow" );
});

// Check if current page has a #, if yes, scroll appropriately (desktop)
$(window).load(function() {
    if (window.location.hash) {
        var anchorName = window.location.hash.substring(1);
        var anchorEle = $('[name="' + anchorName + '"]');
        var anchorPosition;
        if (anchorEle.length) {
            anchorPosition = anchorEle.offset().top;
        }
        else {
            anchorPosition = 0;
        }
        var newTop = anchorPosition - 90

        $('html,body').animate({
            scrollTop: newTop
        }, 700);

    }
})

// For third party website popup trigger
$('.manualswitch').attr("href", "javascript:void(0)")

// Fix for faulty tiles adjustment (Singapore Site)
// NOTE: FAULTY IF ROTATING TILE IS POSITIONED IN FIRST TEN (extra parent column seem to be generated)
function readjustHalfBreakTiles() {
    var windowWidth = $(window).width();
    if (windowWidth > 480 && windowWidth < 800) {
        $('.firstten .rotatingtile').parent().parent().css("cssText", "width: 100% !important;");
        $('.lastten .rotatingtile').width(windowWidth);
    } else {
        $('.firstten .rotatingtile').parent().parent().removeAttr('style');
        $('.lastten .rotatingtile').removeAttr('style');
    }

    $('.tilecontainer').each(function() {
        if ($(this).find('.five.columns').length > 0 && $(this).find('.ten.columns').length > 0) {
            if (windowWidth > 480 && windowWidth < 800) {
                $(this).find('.ten.columns').css("cssText", "width: 100% !important;")
            } else {
                $(this).find('.ten.columns').removeAttr('style');
            }
        }
    })
}

$(document).ready(readjustHalfBreakTiles);
$(window).resize(readjustHalfBreakTiles);

// Subscribe e-Newsletter script

$(document).ready(function() {
    if ($('#popup-signup-enews').length > 0) {
        subscribeEnews()
    }
})

// Privilege.
// $(document).ready(function() {
//     setAllToMaxHeight($(".privilege-item"));
// })

// Alphabet only
var getKeyCode = function (str) {
    return str.charCodeAt(str.length - 1);
}

function alphaOnly(event) {
  // var key = event.keyCode;
  // return ((key >= 65 && key <= 90) || key == 8 || key == 8 || key == 229);

  var key = event.keyCode || event.which;
    if (key == 0 || key == 229) { //for android chrome keycode fix
        key = getKeyCode(this.value);
    }
    return ((key >= 65 && key <= 90) || key == 8 || key == 32 || key == 9);

};

function applicantName(event) {
  // var key = event.keyCode;
  // return ((key >= 65 && key <= 90) || key == 8 || key == 8 || key == 229);

  var key = event.keyCode || event.which;
  var shiftKey = event.shiftKey || event.which;
    if (key == 0 || key == 229) { //for android chrome keycode fix
        key = getKeyCode(this.value);
    }
    if (shiftKey == true){
        return (key == 50 || key >= 65 && key <= 90 );
    }
    return ((key >= 65 && key <= 90) || key == 8 || key == 32 || key == 9 || key == 191 || key == 189 || key == 37 || key == 39) ;

};

function alphaOnlyTwo(event) {
  // var key = event.keyCode;
  // return ((key >= 65 && key <= 90) || key == 8 || key == 8 || key == 229);

  var key = event.keyCode || event.which;
    if (key == 0 || key == 229) { //for android chrome keycode fix
        key = getKeyCode(this.value);
    }
    return ((key >= 65 && key <= 90) || key == 8 || key == 32 || key == 9 || key == 39 || key == 190);

};

function alphaPunct(event) {

  var key = event.keyCode || event.which;
  console.log (key);
    if (key == 0 || key == 229) { //for android chrome keycode fix
        key = getKeyCode(this.value);
    }
    return ((key >= 65 && key <= 90) || key == 8 || key == 32 || key == 9 || key == 16 || key == 50 || key == 188 || key == 191 || key == 220 || key == 189 || key == 187 || key == 222 || key == 37 || key == 39 || key == 190);

};

// Rotating banner (Cards version)
$(document).ready(function() {
    $('.cards-banner-slider').flexslider({
        controlsContainer: ".card-rounded-nav-control",
        animation: "slide",
        slideshow: true
    });

    $(".card-arrow-nav-control .flex-buttons").click(function() {
        var obj = $(this)
        var direction = obj.attr("direction")
        $('.cards-banner-slider').flexslider(direction)
    })
});

// Rotating in Property Detail page

$(document).ready(function() {
    if ($('.property-thumb-carousel').length > 0) {
        // Gallery
        $(".property-thumb-carousel").owlCarousel({
            navigation: false, // Show next and prev buttons
            pagination: true,
            slideSpeed: 300,
            paginationSpeed: 400,
            singleItem: true
        });
    }
});

// Title Image Gallery Text Component (copied over by naresh)

$(document).ready(function() {

    if ($('.titleimagegalleryandtext-container').length > 0) {
        $('.popup-gallery').magnificPopup({
            delegate: 'a',
            type: 'image',
            tLoading: 'Loading image #%curr%...',
            mainClass: 'mfp-img-mobile',
            gallery: {
                enabled: true,
                navigateByImgClick: true,
                preload: [0, 1] // Will preload 0 - before current, and 1 after the current image
            },
            image: {
                tError: '<a href="%url%">The image #%curr%</a> could not be loaded.'
            }
        });

        $('.meeting-row .btn-gallery, .meeting-row .thumb-img').click(function() {
            $(this).closest('.meeting-row').find('.popup-gallery a:nth-child(1)').click();
        });

        $('.popup-gallery-carousel').owlCarousel({
            navigation: false, // Show next and prev buttons
            pagination: true,
            slideSpeed: 300,
            paginationSpeed: 400,
            itemsCustom: [
                [0, 2],
                [480, 3],
                [768, 4]
            ]
        });

        // Close Video Popup
        $('.video-popup .btn-close').click(function() {
            $('.video-popup').fadeOut(200);
            $('video').each(function() {
                this.player.pause()
            })
        });

        $('.meeting-row .btn-video, .meeting-row .thumb-video').click(function() {
            $(this).closest('.meeting-row').find('.video-popup').fadeIn(200);
            resizeVideoContainer();
        });

        $(window).afterResize(function() {
            resizeVideoContainer();
        })

        function resizeVideoContainer() {
            $('video').each(function() {
                containerHeight = $(this).closest('.video-container').height() * 0.8;
                containerWidth = $(this).closest('.video-container').width();
                $('.mejs-container, .mejs-overlay-play').height(containerHeight).width(containerWidth);
            });

        }
    }

    

});





// Digit add commas function

(function( $ ) {
    $.fn.numberAddCommas = function() {

        /* remove all commas from string */
        function stripcommas (string) {
            return string.replace (/\,+/g, "");
        }

        /* add commas to string */
        function addcommas (string) {
            return string.replace (/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
        }

        var field = this;
        /* get field max attribute value or set to -1 */
        var fieldmaxvalue = $(field).attr ('max');
        if (fieldmaxvalue == undefined || fieldmaxvalue == "") { fieldmaxvalue = -1; }

        /* hold existing field value */
        $(field).attr ({ 'current-value': $(field).val () });

        /* start placing the commas into the string */
        $(field).on ("keyup.checkLengthForCommas", function () {
            setTimeout (function () {
                var fieldval = $(field).val ();

                /* perform the comma only if the value is different from existing value */
                if (fieldval != $(field).attr ('current-value'))
                {
                    fieldval = stripcommas (fieldval);
                    
                    /* enforce max */
                    if (fieldmaxvalue != -1 && parseInt (fieldval) > parseInt (fieldmaxvalue))
                    { 
                        fieldval = fieldmaxvalue; 
                    }

                    /* add commas */
                    $(field).val (addcommas (fieldval));

                    /* update existing value holder */
                    $(field).attr ({ 'current-value': $(field).val () });
                }
            }, 99);
        });
        $(field).addClass ('-numberAddCommas-wired-');
    }
})( jQuery );

$(document).ready (function () {
    $('.numberAddCommas').filter (':not(.-numberAddCommas-wired-)').each (function (index, item) { 
        $(item).numberAddCommas(); 
    });
});


// Input calculator for Mortgage Utilisation Loan


var reflecTimer = undefined;
    
function mortgageUtilisationCalc (waitforit)
  {
    if (reflecTimer != undefined)
    {
      clearTimeout (reflecTimer);
    }

    reflecTimer = setTimeout (function () {


        $('.ave-daily-accbalance').on('blur', function() {        
            var num = parseFloat($(this).val()) || 0;
            var cleanNum = num.toLocaleString('en');
            var splitNum = cleanNum.split('.');
            if (splitNum.length < 2) {
              // Need to append .00 if num was an integer
              cleanNum = cleanNum + '.00';
            } else {
              // Append 0 if there was only 1 decimal, otherwise trim
              // to 2 decimals
              var decimals = splitNum[1];
              decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
              cleanNum = splitNum[0] + '.' + decimals;
            }
            $(this).val(cleanNum);
     
        });

        $('.facilitylimit').on('blur', function() {  
            var num = parseFloat($(this).val()) || 0;
            var cleanNum = num.toLocaleString('en');
            var splitNum = cleanNum.split('.');
            if (splitNum.length < 2) {
              // Need to append .00 if num was an integer
              cleanNum = cleanNum + '.00';
            }
            else {
              // Append 0 if there was only 1 decimal, otherwise trim
              // to 2 decimals
              var decimals = splitNum[1];
              decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
              cleanNum = splitNum[0] + '.' + decimals;
            }
            $(this).val(cleanNum);
           
        });

        $('.month-end-balance').on('blur', function() {  
            var num = parseFloat($(this).val()) || 0;
            var cleanNum = num.toLocaleString('en');
            var splitNum = cleanNum.split('.');
            if (splitNum.length < 2) {
              // Need to append .00 if num was an integer
              cleanNum = cleanNum + '.00';
            }
            else {
              // Append 0 if there was only 1 decimal, otherwise trim
              // to 2 decimals
              var decimals = splitNum[1];
              decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
              cleanNum = splitNum[0] + '.' + decimals;
            }
            $(this).val(cleanNum);
       
        });

        $(".ave-daily-accbalance").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                var numDaysMonth = parseInt($(".numdays-month").val(), 10);
                var dailyFlexi = parseInt($(".ave-daily-accbalance").val(), 10);
                var resultDaysFlexi = numDaysMonth * dailyFlexi;
                var roundResult = Math.round(resultDaysFlexi/100)*100;

                toolsSetCalculatedValue('.calc-result-sumflexiacc', parseFloat(roundResult).toFixed(2));
              
            }
        );

        $(".ave-daily-accbalance").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                var dailyFlexi = parseInt($(".ave-daily-accbalance").val(), 10);
                var monthlyEndLimit = parseInt($(".facilitylimit").val(), 10);
                var targetutil = 0.7;

                var bank = dailyFlexi / targetutil;
                var roundBank = Math.round(bank);
                roundBank = roundBank.toLocaleString ('en');

                 var splitNum = roundBank.split('.');
                if (splitNum.length < 2) {
                  // Need to append .00 if num was an integer
                  roundBank = roundBank + '.00';
                } else {
                  // Append 0 if there was only 1 decimal, otherwise trim
                  // to 2 decimals
                  var decimals = splitNum[1];
                  decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
                  roundBank = splitNum[0] + '.' + decimals;
                }    
                toolsSetCalculatedValue('.calc-result-bank', roundBank);
            }
        );
        
        $(".facilitylimit").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                var dailyFlexi = parseInt($(".ave-daily-accbalance").val(), 10);
                var monthlyEndLimit = parseInt($(".facilitylimit").val(), 10);
                var targetutil = 0.7;

                var bank = dailyFlexi / targetutil;
                var roundBank = Math.round(bank);    
                var result = monthlyEndLimit - roundBank;
                result = result.toLocaleString ('en');

                 var splitNum = result.split('.');
                if (splitNum.length < 2) {
                  // Need to append .00 if num was an integer
                  result = result + '.00';
                } else {
                  // Append 0 if there was only 1 decimal, otherwise trim
                  // to 2 decimals
                  var decimals = splitNum[1];
                  decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
                  result = splitNum[0] + '.' + decimals;
                }    

                toolsSetCalculatedValue('.calc-result-prinreduc', result);
                
            }
        );

        $(".month-end-balance").on('keyup',
            function() {
                //$('.calc-mortg-util .results-container').slideUp();
                //var dailyFlexi = parseInt($(".ave-daily-accbalance").val(), 10);
                var facilityLimit = parseInt($(".facilitylimit").val().replace(",",""), 10);
                var monthendbalance = parseInt($(".month-end-balance").val().replace(",",""), 10);
                console.log(monthendbalance + "monthendbalance");
                var targetutil = 0.7;
                //var rate =parseFloat(dailyFlexi/facilityLimit).toFixed(2)*100;
                var withdrawalAMT = (facilityLimit * targetutil) - monthendbalance;
                withdrawalAMT = withdrawalAMT.toLocaleString ('en');

                 var splitNum = withdrawalAMT.split('.');
                if (splitNum.length < 2) {
                  // Need to append .00 if num was an integer
                  withdrawalAMT = withdrawalAMT + '.00';
                } else {
                  // Append 0 if there was only 1 decimal, otherwise trim
                  // to 2 decimals
                  var decimals = splitNum[1];
                  decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
                  withdrawalAMT = splitNum[0] + '.' + decimals;
                }
                //var roundwithdrawalAMT = Math.round(withdrawalAMT);    
                //var result = roundwithdrawalAMT - dailyFlexi
                
                if (withdrawalAMT < 0){
                    toolsSetCalculatedValue('.calc-result-withdrawal', 0);

                }
                else {
                    toolsSetCalculatedValue('.calc-result-withdrawal', withdrawalAMT);

                }

                
            }
        );


        $(".facilitylimit").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                var dailyFlexi = parseInt($(".ave-daily-accbalance").val().replace(",",""), 10);
                var monthlyEndLimit = parseInt($(".facilitylimit").val().replace(",",""), 10);
                //console.log(dailyFlexi +"dailyflexi");
                //console.log(monthlyEndLimit+"monthlylimit");
                var excessPayment = monthlyEndLimit - dailyFlexi;
                excessPayment = excessPayment.toLocaleString ('en');

                var splitNum = excessPayment.split('.');
                if (splitNum.length < 2) {
                  // Need to append .00 if num was an integer
                  excessPayment = excessPayment + '.00';
                } else {
                  // Append 0 if there was only 1 decimal, otherwise trim
                  // to 2 decimals
                  var decimals = splitNum[1];
                  decimals = decimals.length < 2 ? decimals + '0' : decimals.slice(0, 2);
                  excessPayment = splitNum[0] + '.' + decimals;
                }
                toolsSetCalculatedValue('.calc-result-excesspayment', excessPayment);
            }
        );


        //calculation for monthly utilisation rate
        $(".ave-daily-accbalance").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                 var monthlyEndLimit = parseInt($(".facilitylimit").val().replace(",",""), 10);
                 var dailyFlexi = parseInt($(".ave-daily-accbalance").val().replace(",",""), 10);
                 var monthlyutilrate = Math.round((dailyFlexi/monthlyEndLimit)*100);
                 toolsSetCalculatedValue('.calc-result-mthly-utilisationrate', parseFloat(monthlyutilrate).toFixed());
                if(monthlyutilrate>=70){
                    $("#lessthan70util").hide();
                    $("#applicable").hide();
                    $("#notapplicable").show();


                }
                else{
                    $("#lessthan70util").show();
                     $("#notapplicable").hide();
                    $("#applicable").show();


                }
            }
        );
        
        $(".facilitylimit").on('keyup',
            function() {
                $('.calc-mortg-util .results-container').slideUp();
                 var monthlyEndLimit = parseInt($(".facilitylimit").val().replace(",",""), 10); 
                 var dailyFlexi = parseInt($(".ave-daily-accbalance").val().replace(",",""), 10);
                 var monthlyutilrate = Math.round((dailyFlexi/monthlyEndLimit)*100);
                 toolsSetCalculatedValue('.calc-result-mthly-utilisationrate', parseFloat(monthlyutilrate).toFixed());
                if(monthlyutilrate>=70){
                    $("#lessthan70util").hide();
                    $("#applicable").hide();
                    $("#notapplicable").show();


                }
                else{
                    $("#lessthan70util").show();
                     $("#notapplicable").hide();
                    $("#applicable").show();


                }
            }
        );

    }, waitforit);


}


Date.prototype.parseISO8601 = function(date){
    console.log (date);
    var matches = date.match (/^\s*(\d{4})-(\d{1,2})-(\d{1,2})\s*$/);
    if(matches){
        this.setFullYear(parseInt(matches[1]));
        this.setMonth(parseInt(matches[2]) - 1);
        this.setDate(parseInt(matches[3]));
    }
    return this;
};

$(function() {

    $('.monthYear').datepicker({
        changeMonth: true,
        changeYear: true,
        showButtonPanel: true,
        dateFormat: 'MM yy'
    }).focus(function() {
        var thisCalendar = $(this);
        $('.ui-datepicker-calendar').detach();
        $('.ui-datepicker-close').click(function() {
            var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
            month = parseInt (month) + 1;
            console.log(month);
            if (month < 10) month = "0" + month;
            var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
            console.log(year);
            var selectedate = (new Date ()).parseISO8601 (year + "-" + month + "-01");
            thisCalendar.datepicker('setDate', selectedate);
        });
    });

    $(document).on('click', '.js-print-th[data-print]', function(e) {
        e.preventDefault();
        var prinArea = $(this).attr('data-print');
        // var printTitle = $(this).attr('data-title');
        // var printHeader = $('.header-primary').clone();
        // printHeader.css('border-bottom', '3px solid #ec1d23').css('padding-bottom', '10px').css('margin-bottom', '20px');
        // printHeader.find('.main-logo-wrapper').css('position', 'static');
        // printHeader.find('.header-primary-user-nav, .mobile-only, .m-language-select, .mobile-secured-dropdown').remove();
        $(prinArea).print({
            globalStyles: true,
            mediaPrint: false,
            stylesheet: null,
            noPrintSelector: ".no-print",
            iframe: true,
            append: null,
            // prepend: printHeader,
            manuallyCopyFormValues: true,
            deferred: $.Deferred(),
            timeout: 750,
            // title: printTitle,
            doctype: '<!doctype html>'
        });
    });

    $('.selectedTime').change(function() {
            $('.selectedTime option[value="' + $(this).val() + '"]').attr("selected","selected").siblings().removeAttr("selected");
    });

});   



$(document).ready(function(){
    if ($('.calc-mortg-util').length) {

        // mortgageUtilisationCalc(500);

        $('.calc-mortg-util .btn-calculate').click(function() {

            var averageDailyBalanceAmount = $.trim($('.average-daily-balance').val());
            var currentFacilityLimitAmount = $.trim($('.current-facility-limit').val());

            if(averageDailyBalanceAmount == '' || currentFacilityLimitAmount == '') {
                alert("Please fill in all the fields");
                return;
            }

            var monthlyEndLimit = parseInt($(".current-facility-limit").val().replace(",",""), 10); 
            var dailyFlexi = parseInt($(".average-daily-balance").val().replace(",",""), 10);
            var monthlyutilrate = Math.round((dailyFlexi/monthlyEndLimit)*100);

            toolsSetCalculatedValue('.calc-result-mthly-utilisationrate', parseFloat(monthlyutilrate).toFixed());

            if (monthlyutilrate > 70) {
                $('.scene-1').show();
                $('.scene-2').hide();
                $('.results-container').slideDown();
            }
            else {
                $('.scene-1').hide();
                $('.scene-2').show();
                $('.results-container').slideDown();
            }

        });

        $('.calc-mortg-util .btn-calculate2').click(function() {

            var monthlyEndLimit = parseInt($(".current-facility-limit").val().replace(",",""), 10); 
            var dailyFlexi = parseInt($(".average-daily-balance").val().replace(",",""), 10);
            var monthlyutilrate = Math.round((dailyFlexi/monthlyEndLimit)*100);

            var dayEndBalanceAmount = parseInt($('.day-end-balance').val().replace(",",""), 10);
            var currentFacilityLimit2Amount = parseInt($('.current-facility-limit-2').val().replace(",",""), 10);

            if(dayEndBalanceAmount == '' || currentFacilityLimit2Amount == '') {
                alert("Please fill in all the fields");
                return;
            }

            var withdrawalAmount = Math.round((currentFacilityLimit2Amount*(70/100))-dayEndBalanceAmount);

            if(withdrawalAmount < 1) { withdrawalAmount = 0; }

            var val = withdrawalAmount.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");

            $('.calc-result-withdrawal-amount').html($('.calc-result-withdrawal-amount').data('prefix') + val + $('.calc-result-withdrawal-amount').data('suffix'));
            

        });

        $('.money-format').mask("#,##0.00", {reverse: true});

        $('.money-format').blur(function() {
            if ($.trim($(this).val()) == '' || $.trim($(this).val()) == '0') {
                $(this).val('0.00');
            }
        });

    }
});

$.fn.digits = function(){ 
    return this.each(function(){ 
        $(this).text( $(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,") ); 
    })
};


// For find the right cards 
function hideShowBtn() {
    var windowWidth = $(window).width();
    var btnRedCardlisting = $('.card-listing>ul>li .card-details-container .button-red');
    var btnRed = $('.button-red.hide-mobile');
    var btnRed2 = $('.button-red2.hide-mobile');
    var btnRedShowMobile = $('.card-listing>ul>li .card-details-container .button-red.show-mobile');
    var btnRed2ShowMobile = $('.button-red2.show-mobile');

    $(btnRedShowMobile).hide();
    $(btnRed2ShowMobile).hide();

    if (windowWidth < 1025) {
        $(btnRedCardlisting).css('display','inline-block');
        $(btnRed).css('display','inline-block');
        $(btnRed2).hide();
        $(btnRedShowMobile).css('display','inline-block');
        $(btnRed2ShowMobile).css('display','inline-block');
    } else {
        $(btnRedCardlisting).show();
        $(btnRed).show();
        $(btnRed2).show();
        $(btnRedShowMobile).hide();
        $(btnRed2ShowMobile).hide();
    }
    
}

$(document).ready(function(){
    hideShowBtn();
});

 $(window).resize(function() {
    hideShowBtn();
});

/// detect IE version ///
var incompatibleTmpl = '<div class="incompatible-overlay-support"><p>It looks like you&rsquo;re using an insecure version of Internet Explorer. Using an outdated browser makes your computer unsafe. For the best experience on the web, please update your browser.</p><p><a href="http://browsehappy.com/?locale=en" class="button-cta">Upgrade now!</a></p></div>';
$(document).ready(function(){
    if (Modernizr) {
        $('html').addClass('modernizr');
      }
      if (cssua.ua.ie > 10.0) {
        $('html').addClass('gt-ie10');
      }
      if (cssua.ua.ie > 9.0) {
        $('html').addClass('gt-ie9 oldie');
      }
      if (cssua.ua.ie > 8.0) {
        $('html').addClass('gt-ie8');
      }
      if (cssua.ua.ie > 7.0) {
        $('html').addClass('gt-ie7');
      }
      if (cssua.ua.ie < 10.0) {
        $('html').addClass('lt-ie10');
      }
      if (cssua.ua.ie < 9.0) {
        $('html').addClass('lt-ie9');
        //$('body').prepend(incompatibleTmpl);
      }
      if (cssua.ua.ie < 8.0) {
        $('html').addClass('lt-ie8');
      }
      if (cssua.ua.ie < 7.0) {
        $('html').addClass('lt-ie7');
      }
      if (cssua.ua.ie == 10.0) {
        $('html').addClass('ie10');
      }
      if (cssua.ua.ie == 9.0) {
        $('html').addClass('ie9');
      }
      if (cssua.ua.ie == 8.0) {
        $('html').addClass('ie8');
      }
      if (cssua.ua.ie == 7.0) {
        $('html').addClass('ie7');
      }
});




$(function() {
    if ($('[data-inputautocomplete]').length > 0) {
        $('[data-inputautocomplete]').each(function (e) {
            var input = $(this),
                endpoint = input.data('inputautocomplete'),
                minchars = input.data('minchars');
                
                // console.log(endpoint);

            input.autoComplete({
                minChars: minchars,
                source: function(term, suggest){
                    term = term.toLowerCase();
                    var choices = endpoint;
                    var matches = [];
                    for (i=0; i<choices.length; i++)
                        if (~choices[i].toLowerCase().indexOf(term)) matches.push(choices[i]);
                    suggest(matches);
                }
            });
        });
    }
	$('html.gumby-touch .external').on(Gumby.click, function(e) {
        var target = $(this).attr('external-link');
        if(target) {
            $('#external-site .more-link').attr('href', target);
        }
    });
});

/**
 * CssUserAgent (cssua.js) v2.1.31
 * http://cssuseragent.org
 * 
 * Copyright (c)2006-2015 Stephen M. McKamey.
 * Licensed under The MIT License.
 */
var cssua=function(n,l,p){var q=/\s*([\-\w ]+)[\s\/\:]([\d_]+\b(?:[\-\._\/]\w+)*)/,r=/([\w\-\.]+[\s\/][v]?[\d_]+\b(?:[\-\._\/]\w+)*)/g,s=/\b(?:(blackberry\w*|bb10)|(rim tablet os))(?:\/(\d+\.\d+(?:\.\w+)*))?/,t=/\bsilk-accelerated=true\b/,u=/\bfluidapp\b/,v=/(\bwindows\b|\bmacintosh\b|\blinux\b|\bunix\b)/,w=/(\bandroid\b|\bipad\b|\bipod\b|\bwindows phone\b|\bwpdesktop\b|\bxblwp7\b|\bzunewp7\b|\bwindows ce\b|\bblackberry\w*|\bbb10\b|\brim tablet os\b|\bmeego|\bwebos\b|\bpalm|\bsymbian|\bj2me\b|\bdocomo\b|\bpda\b|\bchtml\b|\bmidp\b|\bcldc\b|\w*?mobile\w*?|\w*?phone\w*?)/,
x=/(\bxbox\b|\bplaystation\b|\bnintendo\s+\w+)/,k={parse:function(b,d){var a={};d&&(a.standalone=d);b=(""+b).toLowerCase();if(!b)return a;for(var c,e,g=b.split(/[()]/),f=0,k=g.length;f<k;f++)if(f%2){var m=g[f].split(";");c=0;for(e=m.length;c<e;c++)if(q.exec(m[c])){var h=RegExp.$1.split(" ").join("_"),l=RegExp.$2;if(!a[h]||parseFloat(a[h])<parseFloat(l))a[h]=l}}else if(m=g[f].match(r))for(c=0,e=m.length;c<e;c++)h=m[c].split(/[\/\s]+/),h.length&&"mozilla"!==h[0]&&(a[h[0].split(" ").join("_")]=h.slice(1).join("-"));
w.exec(b)?(a.mobile=RegExp.$1,s.exec(b)&&(delete a[a.mobile],a.blackberry=a.version||RegExp.$3||RegExp.$2||RegExp.$1,RegExp.$1?a.mobile="blackberry":"0.0.1"===a.version&&(a.blackberry="7.1.0.0"))):x.exec(b)?(a.game=RegExp.$1,c=a.game.split(" ").join("_"),a.version&&!a[c]&&(a[c]=a.version)):v.exec(b)&&(a.desktop=RegExp.$1);a.intel_mac_os_x?(a.mac_os_x=a.intel_mac_os_x.split("_").join("."),delete a.intel_mac_os_x):a.cpu_iphone_os?(a.ios=a.cpu_iphone_os.split("_").join("."),delete a.cpu_iphone_os):a.cpu_os?
(a.ios=a.cpu_os.split("_").join("."),delete a.cpu_os):"iphone"!==a.mobile||a.ios||(a.ios="1");a.opera&&a.version?(a.opera=a.version,delete a.blackberry):t.exec(b)?a.silk_accelerated=!0:u.exec(b)&&(a.fluidapp=a.version);a.edge&&(delete a.applewebkit,delete a.safari,delete a.chrome,delete a.android);if(a.applewebkit)a.webkit=a.applewebkit,delete a.applewebkit,a.opr&&(a.opera=a.opr,delete a.opr,delete a.chrome),a.safari&&(a.chrome||a.crios||a.fxios||a.opera||a.silk||a.fluidapp||a.phantomjs||a.mobile&&
!a.ios?(delete a.safari,a.vivaldi&&delete a.chrome):a.safari=a.version&&!a.rim_tablet_os?a.version:{419:"2.0.4",417:"2.0.3",416:"2.0.2",412:"2.0",312:"1.3",125:"1.2",85:"1.0"}[parseInt(a.safari,10)]||a.safari);else if(a.msie||a.trident)if(a.opera||(a.ie=a.msie||a.rv),delete a.msie,delete a.android,a.windows_phone_os)a.windows_phone=a.windows_phone_os,delete a.windows_phone_os;else{if("wpdesktop"===a.mobile||"xblwp7"===a.mobile||"zunewp7"===a.mobile)a.mobile="windows desktop",a.windows_phone=9>+a.ie?
"7.0":10>+a.ie?"7.5":"8.0",delete a.windows_nt}else if(a.gecko||a.firefox)a.gecko=a.rv;a.rv&&delete a.rv;a.version&&delete a.version;return a},format:function(b){var d="",a;for(a in b)if(a&&b.hasOwnProperty(a)){var c=a,e=b[a],c=c.split(".").join("-"),g=" ua-"+c;if("string"===typeof e){for(var e=e.split(" ").join("_").split(".").join("-"),f=e.indexOf("-");0<f;)g+=" ua-"+c+"-"+e.substring(0,f),f=e.indexOf("-",f+1);g+=" ua-"+c+"-"+e}d+=g}return d},encode:function(b){var d="",a;for(a in b)a&&b.hasOwnProperty(a)&&
(d&&(d+="\x26"),d+=encodeURIComponent(a)+"\x3d"+encodeURIComponent(b[a]));return d}};k.userAgent=k.ua=k.parse(l,p);l=k.format(k.ua)+" js";n.className=n.className?n.className.replace(/\bno-js\b/g,"")+l:l.substr(1);return k}(document.documentElement,navigator.userAgent,navigator.standalone);

// THIS FILE IS GENERATED - DO NOT EDIT!
/*!mobile-detect v1.4.1 2017-12-24*/
/*global module:false, define:false*/
/*jshint latedef:false*/
/*!@license Copyright 2013, Heinrich Goebl, License: MIT, see https://gb.com/hgoebl/mobile-detect.js*/
/*!@license Copyright 2013, Heinrich Goebl, License: MIT, see https://github.com/hgoebl/mobile-detect.js*/
!function(a,b){a(function(){"use strict";function a(a,b){return null!=a&&null!=b&&a.toLowerCase()===b.toLowerCase()}function c(a,b){var c,d,e=a.length;if(!e||!b)return!1;for(c=b.toLowerCase(),d=0;d<e;++d)if(c===a[d].toLowerCase())return!0;return!1}function d(a){for(var b in a)i.call(a,b)&&(a[b]=new RegExp(a[b],"i"))}function e(a){return(a||"").substr(0,500)}function f(a,b){this.ua=e(a),this._cache={},this.maxPhoneWidth=b||600}var g={};g.mobileDetectRules={phones:{iPhone:"\\biPhone\\b|\\biPod\\b",BlackBerry:"BlackBerry|\\bBB10\\b|rim[0-9]+",HTC:"HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m|Android [0-9.]+; Pixel",Nexus:"Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 6",Dell:"Dell[;]? (Streak|Aero|Venue|Venue Pro|Flash|Smoke|Mini 3iX)|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",Motorola:"Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b|XT1068|XT1092",Samsung:"\\bSamsung\\b|SM-G950F|SM-G955F|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F|SM-G920F|SM-G920V|SM-G930F|SM-N910C|SM-A310F|GT-I9190|SM-J500FN|SM-G903F",LG:"\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323)",Sony:"SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533",Asus:"Asus.*Galaxy|PadFone.*Mobile",NokiaLumia:"Lumia [0-9]{3,4}",Micromax:"Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",Palm:"PalmSource|Palm",Vertu:"Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",Pantech:"PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",Fly:"IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",Wiko:"KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",iMobile:"i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",SimValley:"\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",Wolfgang:"AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",Alcatel:"Alcatel",Nintendo:"Nintendo 3DS",Amoi:"Amoi",INQ:"INQ",GenericPhone:"Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser"},tablets:{iPad:"iPad|iPad.*Mobile",NexusTablet:"Android.*Nexus[\\s]+(7|9|10)",SamsungTablet:"SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-T116BU|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|SM-T719|SM-T813|SM-T819|SM-T580|SM-T355Y?|SM-T280|SM-T817A|SM-T820|SM-W700|SM-P580|SM-T587|SM-P350|SM-P555M|SM-P355M|SM-T113NU|SM-T815Y",Kindle:"Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI|KFFOWI|KFGIWI|KFMEWI)\\b|Android.*Silk/[0-9.]+ like Chrome/[0-9.]+ (?!Mobile)",SurfaceTablet:"Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",HPTablet:"HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",AsusTablet:"^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z|\\bP027\\b",BlackBerryTablet:"PlayBook|RIM Tablet",HTCtablet:"HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",MotorolaTablet:"xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",NookTablet:"Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",AcerTablet:"Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|\\bA3-A20\\b|\\bA3-A30",ToshibaTablet:"Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",LGTablet:"\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",FujitsuTablet:"Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",PrestigioTablet:"PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",LenovoTablet:"Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-850M|YT3-X90L|YT3-X90F|YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)|TB-X103F|TB-X304F|TB-8703F",DellTablet:"Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",YarvikTablet:"Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",MedionTablet:"Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",ArnovaTablet:"97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",IntensoTablet:"INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",IRUTablet:"M702pro",MegafonTablet:"MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",EbodaTablet:"E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",AllViewTablet:"Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",ArchosTablet:"\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|c|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",AinolTablet:"NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",NokiaLumiaTablet:"Lumia 2520",SonyTablet:"Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP612|SOT31",PhilipsTablet:"\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",CubeTablet:"Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",CobyTablet:"MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",MIDTablet:"M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10",MSITablet:"MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",SMiTTablet:"Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",RockChipTablet:"Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",FlyTablet:"IQ310|Fly Vision",bqTablet:"Android.*(bq)?.*(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris ([E|M]10|M8))|Maxwell.*Lite|Maxwell.*Plus",HuaweiTablet:"MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim|M2-A01L",NecTablet:"\\bN-06D|\\bN-08D",PantechTablet:"Pantech.*P4100",BronchoTablet:"Broncho.*(N701|N708|N802|a710)",VersusTablet:"TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",ZyncTablet:"z1000|Z99 2G|z99|z930|z999|z990|z909|Z919|z900",PositivoTablet:"TB07STA|TB10STA|TB07FTA|TB10FTA",NabiTablet:"Android.*\\bNabi",KoboTablet:"Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",DanewTablet:"DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",TexetTablet:"NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",PlaystationTablet:"Playstation.*(Portable|Vita)",TrekstorTablet:"ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",PyleAudioTablet:"\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",AdvanTablet:"Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",DanyTechTablet:"Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",GalapadTablet:"Android.*\\bG1\\b",MicromaxTablet:"Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",KarbonnTablet:"Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",AllFineTablet:"Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",PROSCANTablet:"\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",YONESTablet:"BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",ChangJiaTablet:"TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",GUTablet:"TX-A1301|TX-M9002|Q702|kf026",PointOfViewTablet:"TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",OvermaxTablet:"OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)|Qualcore 1027",HCLTablet:"HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",DPSTablet:"DPS Dream 9|DPS Dual 7",VistureTablet:"V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",CrestaTablet:"CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",MediatekTablet:"\\bMT8125|MT8389|MT8135|MT8377\\b",ConcordeTablet:"Concorde([ ]+)?Tab|ConCorde ReadMan",GoCleverTablet:"GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",ModecomTablet:"FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",VoninoTablet:"\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",ECSTablet:"V07OT2|TM105A|S10OT1|TR10CS1",StorexTablet:"eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",VodafoneTablet:"SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497",EssentielBTablet:"Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",RossMoorTablet:"RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",iMobileTablet:"i-mobile i-note",TolinoTablet:"tolino tab [0-9.]+|tolino shine",AudioSonicTablet:"\\bC-22Q|T7-QC|T-17B|T-17P\\b",AMPETablet:"Android.* A78 ",SkkTablet:"Android.* (SKYPAD|PHOENIX|CYCLOPS)",TecnoTablet:"TECNO P9",JXDTablet:"Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",iJoyTablet:"Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",FX2Tablet:"FX2 PAD7|FX2 PAD10",XoroTablet:"KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",ViewsonicTablet:"ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",VerizonTablet:"QTAQZ3|QTAIR7|QTAQTZ3|QTASUN1|QTASUN2|QTAXIA1",OdysTablet:"LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",CaptivaTablet:"CAPTIVA PAD",IconbitTablet:"NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",TeclastTablet:"T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",OndaTablet:"\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+",JaytechTablet:"TPC-PA762",BlaupunktTablet:"Endeavour 800NG|Endeavour 1010",DigmaTablet:"\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",EvolioTablet:"ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",LavaTablet:"QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",AocTablet:"MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712",MpmanTablet:"MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|\\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010",CelkonTablet:"CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",WolderTablet:"miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",MiTablet:"\\bMI PAD\\b|\\bHM NOTE 1W\\b",NibiruTablet:"Nibiru M1|Nibiru Jupiter One",NexoTablet:"NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",LeaderTablet:"TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",UbislateTablet:"UbiSlate[\\s]?7C",PocketBookTablet:"Pocketbook",KocasoTablet:"\\b(TB-1207)\\b",HisenseTablet:"\\b(F5281|E2371)\\b",Hudl:"Hudl HT7S3|Hudl 2",TelstraTablet:"T-Hub2",GenericTablet:"Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b|\\bQTAQZ3\\b"},oss:{AndroidOS:"Android",BlackBerryOS:"blackberry|\\bBB10\\b|rim tablet os",PalmOS:"PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",SymbianOS:"Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",WindowsMobileOS:"Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Window Mobile|Windows Phone [0-9.]+|WCE;",WindowsPhoneOS:"Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",iOS:"\\biPhone.*Mobile|\\biPod|\\biPad|AppleCoreMedia",MeeGoOS:"MeeGo",MaemoOS:"Maemo",JavaOS:"J2ME/|\\bMIDP\\b|\\bCLDC\\b",webOS:"webOS|hpwOS",badaOS:"\\bBada\\b",BREWOS:"BREW"},uas:{Chrome:"\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",Dolfin:"\\bDolfin\\b",Opera:"Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+|Coast/[0-9.]+",Skyfire:"Skyfire",Edge:"Mobile Safari/[.0-9]* Edge",IE:"IEMobile|MSIEMobile",Firefox:"fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile|FxiOS",Bolt:"bolt",TeaShark:"teashark",Blazer:"Blazer",Safari:"Version.*Mobile.*Safari|Safari.*Mobile|MobileSafari",UCBrowser:"UC.*Browser|UCWEB",baiduboxapp:"baiduboxapp",baidubrowser:"baidubrowser",DiigoBrowser:"DiigoBrowser",Puffin:"Puffin",Mercury:"\\bMercury\\b",ObigoBrowser:"Obigo",NetFront:"NF-Browser",GenericBrowser:"NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger",PaleMoon:"Android.*PaleMoon|Mobile.*PaleMoon"},props:{Mobile:"Mobile/[VER]",Build:"Build/[VER]",Version:"Version/[VER]",VendorID:"VendorID/[VER]",iPad:"iPad.*CPU[a-z ]+[VER]",iPhone:"iPhone.*CPU[a-z ]+[VER]",iPod:"iPod.*CPU[a-z ]+[VER]",Kindle:"Kindle/[VER]",Chrome:["Chrome/[VER]","CriOS/[VER]","CrMo/[VER]"],Coast:["Coast/[VER]"],Dolfin:"Dolfin/[VER]",Firefox:["Firefox/[VER]","FxiOS/[VER]"],Fennec:"Fennec/[VER]",Edge:"Edge/[VER]",IE:["IEMobile/[VER];","IEMobile [VER]","MSIE [VER];","Trident/[0-9.]+;.*rv:[VER]"],NetFront:"NetFront/[VER]",NokiaBrowser:"NokiaBrowser/[VER]",Opera:[" OPR/[VER]","Opera Mini/[VER]","Version/[VER]"],"Opera Mini":"Opera Mini/[VER]","Opera Mobi":"Version/[VER]",UCBrowser:["UCWEB[VER]","UC.*Browser/[VER]"],MQQBrowser:"MQQBrowser/[VER]",MicroMessenger:"MicroMessenger/[VER]",baiduboxapp:"baiduboxapp/[VER]",baidubrowser:"baidubrowser/[VER]",SamsungBrowser:"SamsungBrowser/[VER]",Iron:"Iron/[VER]",Safari:["Version/[VER]","Safari/[VER]"],Skyfire:"Skyfire/[VER]",Tizen:"Tizen/[VER]",Webkit:"webkit[ /][VER]",PaleMoon:"PaleMoon/[VER]",Gecko:"Gecko/[VER]",Trident:"Trident/[VER]",Presto:"Presto/[VER]",Goanna:"Goanna/[VER]",iOS:" \\bi?OS\\b [VER][ ;]{1}",Android:"Android [VER]",BlackBerry:["BlackBerry[\\w]+/[VER]","BlackBerry.*Version/[VER]","Version/[VER]"],BREW:"BREW [VER]",Java:"Java/[VER]","Windows Phone OS":["Windows Phone OS [VER]","Windows Phone [VER]"],"Windows Phone":"Windows Phone [VER]","Windows CE":"Windows CE/[VER]","Windows NT":"Windows NT [VER]",Symbian:["SymbianOS/[VER]","Symbian/[VER]"],webOS:["webOS/[VER]","hpwOS/[VER];"]},utils:{Bot:"Googlebot|facebookexternalhit|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|YandexMobileBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom",MobileBot:"Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",DesktopMode:"WPDesktop",TV:"SonyDTV|HbbTV",WebKit:"(webkit)[ /]([\\w.]+)",Console:"\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|PLAYSTATION|Xbox)\\b",Watch:"SM-V700"}},g.detectMobileBrowsers={fullPattern:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,shortPattern:/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
tabletPattern:/android|ipad|playbook|silk/i};var h,i=Object.prototype.hasOwnProperty;return g.FALLBACK_PHONE="UnknownPhone",g.FALLBACK_TABLET="UnknownTablet",g.FALLBACK_MOBILE="UnknownMobile",h="isArray"in Array?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},function(){var a,b,c,e,f,j,k=g.mobileDetectRules;for(a in k.props)if(i.call(k.props,a)){for(b=k.props[a],h(b)||(b=[b]),f=b.length,e=0;e<f;++e)c=b[e],j=c.indexOf("[VER]"),j>=0&&(c=c.substring(0,j)+"([\\w._\\+]+)"+c.substring(j+5)),b[e]=new RegExp(c,"i");k.props[a]=b}d(k.oss),d(k.phones),d(k.tablets),d(k.uas),d(k.utils),k.oss0={WindowsPhoneOS:k.oss.WindowsPhoneOS,WindowsMobileOS:k.oss.WindowsMobileOS}}(),g.findMatch=function(a,b){for(var c in a)if(i.call(a,c)&&a[c].test(b))return c;return null},g.findMatches=function(a,b){var c=[];for(var d in a)i.call(a,d)&&a[d].test(b)&&c.push(d);return c},g.getVersionStr=function(a,b){var c,d,e,f,h=g.mobileDetectRules.props;if(i.call(h,a))for(c=h[a],e=c.length,d=0;d<e;++d)if(f=c[d].exec(b),null!==f)return f[1];return null},g.getVersion=function(a,b){var c=g.getVersionStr(a,b);return c?g.prepareVersionNo(c):NaN},g.prepareVersionNo=function(a){var b;return b=a.split(/[a-z._ \/\-]/i),1===b.length&&(a=b[0]),b.length>1&&(a=b[0]+".",b.shift(),a+=b.join("")),Number(a)},g.isMobileFallback=function(a){return g.detectMobileBrowsers.fullPattern.test(a)||g.detectMobileBrowsers.shortPattern.test(a.substr(0,4))},g.isTabletFallback=function(a){return g.detectMobileBrowsers.tabletPattern.test(a)},g.prepareDetectionCache=function(a,c,d){if(a.mobile===b){var e,h,i;return(h=g.findMatch(g.mobileDetectRules.tablets,c))?(a.mobile=a.tablet=h,void(a.phone=null)):(e=g.findMatch(g.mobileDetectRules.phones,c))?(a.mobile=a.phone=e,void(a.tablet=null)):void(g.isMobileFallback(c)?(i=f.isPhoneSized(d),i===b?(a.mobile=g.FALLBACK_MOBILE,a.tablet=a.phone=null):i?(a.mobile=a.phone=g.FALLBACK_PHONE,a.tablet=null):(a.mobile=a.tablet=g.FALLBACK_TABLET,a.phone=null)):g.isTabletFallback(c)?(a.mobile=a.tablet=g.FALLBACK_TABLET,a.phone=null):a.mobile=a.tablet=a.phone=null)}},g.mobileGrade=function(a){var b=null!==a.mobile();return a.os("iOS")&&a.version("iPad")>=4.3||a.os("iOS")&&a.version("iPhone")>=3.1||a.os("iOS")&&a.version("iPod")>=3.1||a.version("Android")>2.1&&a.is("Webkit")||a.version("Windows Phone OS")>=7||a.is("BlackBerry")&&a.version("BlackBerry")>=6||a.match("Playbook.*Tablet")||a.version("webOS")>=1.4&&a.match("Palm|Pre|Pixi")||a.match("hp.*TouchPad")||a.is("Firefox")&&a.version("Firefox")>=12||a.is("Chrome")&&a.is("AndroidOS")&&a.version("Android")>=4||a.is("Skyfire")&&a.version("Skyfire")>=4.1&&a.is("AndroidOS")&&a.version("Android")>=2.3||a.is("Opera")&&a.version("Opera Mobi")>11&&a.is("AndroidOS")||a.is("MeeGoOS")||a.is("Tizen")||a.is("Dolfin")&&a.version("Bada")>=2||(a.is("UC Browser")||a.is("Dolfin"))&&a.version("Android")>=2.3||a.match("Kindle Fire")||a.is("Kindle")&&a.version("Kindle")>=3||a.is("AndroidOS")&&a.is("NookTablet")||a.version("Chrome")>=11&&!b||a.version("Safari")>=5&&!b||a.version("Firefox")>=4&&!b||a.version("MSIE")>=7&&!b||a.version("Opera")>=10&&!b?"A":a.os("iOS")&&a.version("iPad")<4.3||a.os("iOS")&&a.version("iPhone")<3.1||a.os("iOS")&&a.version("iPod")<3.1||a.is("Blackberry")&&a.version("BlackBerry")>=5&&a.version("BlackBerry")<6||a.version("Opera Mini")>=5&&a.version("Opera Mini")<=6.5&&(a.version("Android")>=2.3||a.is("iOS"))||a.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3")||a.version("Opera Mobi")>=11&&a.is("SymbianOS")?"B":(a.version("BlackBerry")<5||a.match("MSIEMobile|Windows CE.*Mobile")||a.version("Windows Mobile")<=5.2,"C")},g.detectOS=function(a){return g.findMatch(g.mobileDetectRules.oss0,a)||g.findMatch(g.mobileDetectRules.oss,a)},g.getDeviceSmallerSide=function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height},f.prototype={constructor:f,mobile:function(){return g.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.mobile},phone:function(){return g.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.phone},tablet:function(){return g.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.tablet},userAgent:function(){return this._cache.userAgent===b&&(this._cache.userAgent=g.findMatch(g.mobileDetectRules.uas,this.ua)),this._cache.userAgent},userAgents:function(){return this._cache.userAgents===b&&(this._cache.userAgents=g.findMatches(g.mobileDetectRules.uas,this.ua)),this._cache.userAgents},os:function(){return this._cache.os===b&&(this._cache.os=g.detectOS(this.ua)),this._cache.os},version:function(a){return g.getVersion(a,this.ua)},versionStr:function(a){return g.getVersionStr(a,this.ua)},is:function(b){return c(this.userAgents(),b)||a(b,this.os())||a(b,this.phone())||a(b,this.tablet())||c(g.findMatches(g.mobileDetectRules.utils,this.ua),b)},match:function(a){return a instanceof RegExp||(a=new RegExp(a,"i")),a.test(this.ua)},isPhoneSized:function(a){return f.isPhoneSized(a||this.maxPhoneWidth)},mobileGrade:function(){return this._cache.grade===b&&(this._cache.grade=g.mobileGrade(this)),this._cache.grade}},"undefined"!=typeof window&&window.screen?f.isPhoneSized=function(a){return a<0?b:g.getDeviceSmallerSide()<=a}:f.isPhoneSized=function(){},f._impl=g,f.version="1.4.1 2017-12-24",f})}(function(a){if("undefined"!=typeof module&&module.exports)return function(a){module.exports=a()};if("function"==typeof define&&define.amd)return define;if("undefined"!=typeof window)return function(a){window.MobileDetect=a()};throw new Error("unknown environment")}());
/*global Modernizr MobileDetect*/
(function (window, Modernizr) {
    'use strict';
    var md = new MobileDetect(navigator.userAgent),
        grade = md.mobileGrade();
    Modernizr.addTest({
        mobile: !!md.mobile(),
        phone: !!md.phone(),
        tablet: !!md.tablet(),
        mobilegradea: grade === 'A'
    });
    window.mobileDetect = md;
})(window, Modernizr);

/*! http://mths.be/placeholder v2.0.7 by @mathias */
;(function(f,h,$){var a='placeholder' in h.createElement('input'),d='placeholder' in h.createElement('textarea'),i=$.fn,c=$.valHooks,k,j;if(a&&d){j=i.placeholder=function(){return this};j.input=j.textarea=true}else{j=i.placeholder=function(){var l=this;l.filter((a?'textarea':':input')+'[placeholder]').not('.placeholder').bind({'focus.placeholder':b,'blur.placeholder':e}).data('placeholder-enabled',true).trigger('blur.placeholder');return l};j.input=a;j.textarea=d;k={get:function(m){var l=$(m);return l.data('placeholder-enabled')&&l.hasClass('placeholder')?'':m.value},set:function(m,n){var l=$(m);if(!l.data('placeholder-enabled')){return m.value=n}if(n==''){m.value=n;if(m!=h.activeElement){e.call(m)}}else{if(l.hasClass('placeholder')){b.call(m,true,n)||(m.value=n)}else{m.value=n}}return l}};a||(c.input=k);d||(c.textarea=k);$(function(){$(h).delegate('form','submit.placeholder',function(){var l=$('.placeholder',this).each(b);setTimeout(function(){l.each(e)},10)})});$(f).bind('beforeunload.placeholder',function(){$('.placeholder').each(function(){this.value=''})})}function g(m){var l={},n=/^jQuery\d+$/;$.each(m.attributes,function(p,o){if(o.specified&&!n.test(o.name)){l[o.name]=o.value}});return l}function b(m,n){var l=this,o=$(l);if(l.value==o.attr('placeholder')&&o.hasClass('placeholder')){if(o.data('placeholder-password')){o=o.hide().next().show().attr('id',o.removeAttr('id').data('placeholder-id'));if(m===true){return o[0].value=n}o.focus()}else{l.value='';o.removeClass('placeholder');l==h.activeElement&&l.select()}}}function e(){var q,l=this,p=$(l),m=p,o=this.id;if(l.value==''){if(l.type=='password'){if(!p.data('placeholder-textinput')){try{q=p.clone().attr({type:'text'})}catch(n){q=$('<input>').attr($.extend(g(this),{type:'text'}))}q.removeAttr('name').data({'placeholder-password':true,'placeholder-id':o}).bind('focus.placeholder',b);p.data({'placeholder-textinput':q,'placeholder-id':o}).before(q)}p=p.removeAttr('id').hide().prev().attr('id',o).show()}p.addClass('placeholder');p[0].value=p.attr('placeholder')}else{p.removeClass('placeholder')}}}(this,document,jQuery));

// place any jQuery/helper plugins in here, instead of separate, slower script files.

/*
 * jQuery FlexSlider v2.2.0
 * Copyright 2012 WooThemes
 * Contributing Author: Tyler Smith
 */
(function(e){e.flexslider=function(t,n){var r=e(t);r.vars=e.extend({},e.flexslider.defaults,n);var i=r.vars.namespace,s=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture,o=("ontouchstart"in window||s||window.DocumentTouch&&document instanceof DocumentTouch)&&r.vars.touch,u="click touchend MSPointerUp",a="",f,l=r.vars.direction==="vertical",c=r.vars.reverse,h=r.vars.itemWidth>0,p=r.vars.animation==="fade",d=r.vars.asNavFor!=="",v={},m=!0;e.data(t,"flexslider",r);v={init:function(){r.animating=!1;r.currentSlide=parseInt(r.vars.startAt?r.vars.startAt:0);isNaN(r.currentSlide)&&(r.currentSlide=0);r.animatingTo=r.currentSlide;r.atEnd=r.currentSlide===0||r.currentSlide===r.last;r.containerSelector=r.vars.selector.substr(0,r.vars.selector.search(" "));r.slides=e(r.vars.selector,r);r.container=e(r.containerSelector,r);r.count=r.slides.length;r.syncExists=e(r.vars.sync).length>0;r.vars.animation==="slide"&&(r.vars.animation="swing");r.prop=l?"top":"marginLeft";r.args={};r.manualPause=!1;r.stopped=!1;r.started=!1;r.startTimeout=null;r.transitions=!r.vars.video&&!p&&r.vars.useCSS&&function(){var e=document.createElement("div"),t=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var n in t)if(e.style[t[n]]!==undefined){r.pfx=t[n].replace("Perspective","").toLowerCase();r.prop="-"+r.pfx+"-transform";return!0}return!1}();r.vars.controlsContainer!==""&&(r.controlsContainer=e(r.vars.controlsContainer).length>0&&e(r.vars.controlsContainer));r.vars.manualControls!==""&&(r.manualControls=e(r.vars.manualControls).length>0&&e(r.vars.manualControls));if(r.vars.randomize){r.slides.sort(function(){return Math.round(Math.random())-.5});r.container.empty().append(r.slides)}r.doMath();r.setup("init");r.vars.controlNav&&v.controlNav.setup();r.vars.directionNav&&v.directionNav.setup();r.vars.keyboard&&(e(r.containerSelector).length===1||r.vars.multipleKeyboard)&&e(document).bind("keyup",function(e){var t=e.keyCode;if(!r.animating&&(t===39||t===37)){var n=t===39?r.getTarget("next"):t===37?r.getTarget("prev"):!1;r.flexAnimate(n,r.vars.pauseOnAction)}});r.vars.mousewheel&&r.bind("mousewheel",function(e,t,n,i){e.preventDefault();var s=t<0?r.getTarget("next"):r.getTarget("prev");r.flexAnimate(s,r.vars.pauseOnAction)});r.vars.pausePlay&&v.pausePlay.setup();r.vars.slideshow&&r.vars.pauseInvisible&&v.pauseInvisible.init();if(r.vars.slideshow){r.vars.pauseOnHover&&r.hover(function(){!r.manualPlay&&!r.manualPause&&r.pause()},function(){!r.manualPause&&!r.manualPlay&&!r.stopped&&r.play()});if(!r.vars.pauseInvisible||!v.pauseInvisible.isHidden())r.vars.initDelay>0?r.startTimeout=setTimeout(r.play,r.vars.initDelay):r.play()}d&&v.asNav.setup();o&&r.vars.touch&&v.touch();(!p||p&&r.vars.smoothHeight)&&e(window).bind("resize orientationchange focus",v.resize);r.find("img").attr("draggable","false");setTimeout(function(){r.vars.start(r)},200)},asNav:{setup:function(){r.asNav=!0;r.animatingTo=Math.floor(r.currentSlide/r.move);r.currentItem=r.currentSlide;r.slides.removeClass(i+"active-slide").eq(r.currentItem).addClass(i+"active-slide");if(!s)r.slides.click(function(t){t.preventDefault();var n=e(this),s=n.index(),o=n.offset().left-e(r).scrollLeft();if(o<=0&&n.hasClass(i+"active-slide"))r.flexAnimate(r.getTarget("prev"),!0);else if(!e(r.vars.asNavFor).data("flexslider").animating&&!n.hasClass(i+"active-slide")){r.direction=r.currentItem<s?"next":"prev";r.flexAnimate(s,r.vars.pauseOnAction,!1,!0,!0)}});else{t._slider=r;r.slides.each(function(){var t=this;t._gesture=new MSGesture;t._gesture.target=t;t.addEventListener("MSPointerDown",function(e){e.preventDefault();e.currentTarget._gesture&&e.currentTarget._gesture.addPointer(e.pointerId)},!1);t.addEventListener("MSGestureTap",function(t){t.preventDefault();var n=e(this),i=n.index();if(!e(r.vars.asNavFor).data("flexslider").animating&&!n.hasClass("active")){r.direction=r.currentItem<i?"next":"prev";r.flexAnimate(i,r.vars.pauseOnAction,!1,!0,!0)}})})}}},controlNav:{setup:function(){r.manualControls?v.controlNav.setupManual():v.controlNav.setupPaging()},setupPaging:function(){var t=r.vars.controlNav==="thumbnails"?"control-thumbs":"control-paging",n=1,s,o;r.controlNavScaffold=e('<ol class="'+i+"control-nav "+i+t+'"></ol>');if(r.pagingCount>1)for(var f=0;f<r.pagingCount;f++){o=r.slides.eq(f);s=r.vars.controlNav==="thumbnails"?'<img src="'+o.attr("data-thumb")+'"/>':"<a>"+n+"</a>";if("thumbnails"===r.vars.controlNav&&!0===r.vars.thumbCaptions){var l=o.attr("data-thumbcaption");""!=l&&undefined!=l&&(s+='<span class="'+i+'caption">'+l+"</span>")}r.controlNavScaffold.append("<li>"+s+"</li>");n++}r.controlsContainer?e(r.controlsContainer).append(r.controlNavScaffold):r.append(r.controlNavScaffold);v.controlNav.set();v.controlNav.active();r.controlNavScaffold.delegate("a, img",u,function(t){t.preventDefault();if(a===""||a===t.type){var n=e(this),s=r.controlNav.index(n);if(!n.hasClass(i+"active")){r.direction=s>r.currentSlide?"next":"prev";r.flexAnimate(s,r.vars.pauseOnAction)}}a===""&&(a=t.type);v.setToClearWatchedEvent()})},setupManual:function(){r.controlNav=r.manualControls;v.controlNav.active();r.controlNav.bind(u,function(t){t.preventDefault();if(a===""||a===t.type){var n=e(this),s=r.controlNav.index(n);if(!n.hasClass(i+"active")){s>r.currentSlide?r.direction="next":r.direction="prev";r.flexAnimate(s,r.vars.pauseOnAction)}}a===""&&(a=t.type);v.setToClearWatchedEvent()})},set:function(){var t=r.vars.controlNav==="thumbnails"?"img":"a";r.controlNav=e("."+i+"control-nav li "+t,r.controlsContainer?r.controlsContainer:r)},active:function(){r.controlNav.removeClass(i+"active").eq(r.animatingTo).addClass(i+"active")},update:function(t,n){r.pagingCount>1&&t==="add"?r.controlNavScaffold.append(e("<li><a>"+r.count+"</a></li>")):r.pagingCount===1?r.controlNavScaffold.find("li").remove():r.controlNav.eq(n).closest("li").remove();v.controlNav.set();r.pagingCount>1&&r.pagingCount!==r.controlNav.length?r.update(n,t):v.controlNav.active()}},directionNav:{setup:function(){var t=e('<ul class="'+i+'direction-nav"><li><a class="'+i+'prev" href="#">'+r.vars.prevText+'</a></li><li><a class="'+i+'next" href="#">'+r.vars.nextText+"</a></li></ul>");if(r.controlsContainer){e(r.controlsContainer).append(t);r.directionNav=e("."+i+"direction-nav li a",r.controlsContainer)}else{r.append(t);r.directionNav=e("."+i+"direction-nav li a",r)}v.directionNav.update();r.directionNav.bind(u,function(t){t.preventDefault();var n;if(a===""||a===t.type){n=e(this).hasClass(i+"next")?r.getTarget("next"):r.getTarget("prev");r.flexAnimate(n,r.vars.pauseOnAction)}a===""&&(a=t.type);v.setToClearWatchedEvent()})},update:function(){var e=i+"disabled";r.pagingCount===1?r.directionNav.addClass(e).attr("tabindex","-1"):r.vars.animationLoop?r.directionNav.removeClass(e).removeAttr("tabindex"):r.animatingTo===0?r.directionNav.removeClass(e).filter("."+i+"prev").addClass(e).attr("tabindex","-1"):r.animatingTo===r.last?r.directionNav.removeClass(e).filter("."+i+"next").addClass(e).attr("tabindex","-1"):r.directionNav.removeClass(e).removeAttr("tabindex")}},pausePlay:{setup:function(){var t=e('<div class="'+i+'pauseplay"><a></a></div>');if(r.controlsContainer){r.controlsContainer.append(t);r.pausePlay=e("."+i+"pauseplay a",r.controlsContainer)}else{r.append(t);r.pausePlay=e("."+i+"pauseplay a",r)}v.pausePlay.update(r.vars.slideshow?i+"pause":i+"play");r.pausePlay.bind(u,function(t){t.preventDefault();if(a===""||a===t.type)if(e(this).hasClass(i+"pause")){r.manualPause=!0;r.manualPlay=!1;r.pause()}else{r.manualPause=!1;r.manualPlay=!0;r.play()}a===""&&(a=t.type);v.setToClearWatchedEvent()})},update:function(e){e==="play"?r.pausePlay.removeClass(i+"pause").addClass(i+"play").html(r.vars.playText):r.pausePlay.removeClass(i+"play").addClass(i+"pause").html(r.vars.pauseText)}},touch:function(){var e,n,i,o,u,a,f=!1,d=0,v=0,m=0;if(!s){t.addEventListener("touchstart",g,!1);function g(s){if(r.animating)s.preventDefault();else if(window.navigator.msPointerEnabled||s.touches.length===1){r.pause();o=l?r.h:r.w;a=Number(new Date);d=s.touches[0].pageX;v=s.touches[0].pageY;i=h&&c&&r.animatingTo===r.last?0:h&&c?r.limit-(r.itemW+r.vars.itemMargin)*r.move*r.animatingTo:h&&r.currentSlide===r.last?r.limit:h?(r.itemW+r.vars.itemMargin)*r.move*r.currentSlide:c?(r.last-r.currentSlide+r.cloneOffset)*o:(r.currentSlide+r.cloneOffset)*o;e=l?v:d;n=l?d:v;t.addEventListener("touchmove",y,!1);t.addEventListener("touchend",b,!1)}}function y(t){d=t.touches[0].pageX;v=t.touches[0].pageY;u=l?e-v:e-d;f=l?Math.abs(u)<Math.abs(d-n):Math.abs(u)<Math.abs(v-n);var s=500;if(!f||Number(new Date)-a>s){t.preventDefault();if(!p&&r.transitions){r.vars.animationLoop||(u/=r.currentSlide===0&&u<0||r.currentSlide===r.last&&u>0?Math.abs(u)/o+2:1);r.setProps(i+u,"setTouch")}}}function b(s){t.removeEventListener("touchmove",y,!1);if(r.animatingTo===r.currentSlide&&!f&&u!==null){var l=c?-u:u,h=l>0?r.getTarget("next"):r.getTarget("prev");r.canAdvance(h)&&(Number(new Date)-a<550&&Math.abs(l)>50||Math.abs(l)>o/2)?r.flexAnimate(h,r.vars.pauseOnAction):p||r.flexAnimate(r.currentSlide,r.vars.pauseOnAction,!0)}t.removeEventListener("touchend",b,!1);e=null;n=null;u=null;i=null}}else{t.style.msTouchAction="none";t._gesture=new MSGesture;t._gesture.target=t;t.addEventListener("MSPointerDown",w,!1);t._slider=r;t.addEventListener("MSGestureChange",E,!1);t.addEventListener("MSGestureEnd",S,!1);function w(e){e.stopPropagation();if(r.animating)e.preventDefault();else{r.pause();t._gesture.addPointer(e.pointerId);m=0;o=l?r.h:r.w;a=Number(new Date);i=h&&c&&r.animatingTo===r.last?0:h&&c?r.limit-(r.itemW+r.vars.itemMargin)*r.move*r.animatingTo:h&&r.currentSlide===r.last?r.limit:h?(r.itemW+r.vars.itemMargin)*r.move*r.currentSlide:c?(r.last-r.currentSlide+r.cloneOffset)*o:(r.currentSlide+r.cloneOffset)*o}}function E(e){e.stopPropagation();var n=e.target._slider;if(!n)return;var r=-e.translationX,s=-e.translationY;m+=l?s:r;u=m;f=l?Math.abs(m)<Math.abs(-r):Math.abs(m)<Math.abs(-s);if(e.detail===e.MSGESTURE_FLAG_INERTIA){setImmediate(function(){t._gesture.stop()});return}if(!f||Number(new Date)-a>500){e.preventDefault();if(!p&&n.transitions){n.vars.animationLoop||(u=m/(n.currentSlide===0&&m<0||n.currentSlide===n.last&&m>0?Math.abs(m)/o+2:1));n.setProps(i+u,"setTouch")}}}function S(t){t.stopPropagation();var r=t.target._slider;if(!r)return;if(r.animatingTo===r.currentSlide&&!f&&u!==null){var s=c?-u:u,l=s>0?r.getTarget("next"):r.getTarget("prev");r.canAdvance(l)&&(Number(new Date)-a<550&&Math.abs(s)>50||Math.abs(s)>o/2)?r.flexAnimate(l,r.vars.pauseOnAction):p||r.flexAnimate(r.currentSlide,r.vars.pauseOnAction,!0)}e=null;n=null;u=null;i=null;m=0}}},resize:function(){if(!r.animating&&r.is(":visible")){h||r.doMath();if(p)v.smoothHeight();else if(h){r.slides.width(r.computedW);r.update(r.pagingCount);r.setProps()}else if(l){r.viewport.height(r.h);r.setProps(r.h,"setTotal")}else{r.vars.smoothHeight&&v.smoothHeight();r.newSlides.width(r.computedW);r.setProps(r.computedW,"setTotal")}}},smoothHeight:function(e){if(!l||p){var t=p?r:r.viewport;e?t.animate({height:r.slides.eq(r.animatingTo).height()},e):t.height(r.slides.eq(r.animatingTo).height())}},sync:function(t){var n=e(r.vars.sync).data("flexslider"),i=r.animatingTo;switch(t){case"animate":n.flexAnimate(i,r.vars.pauseOnAction,!1,!0);break;case"play":!n.playing&&!n.asNav&&n.play();break;case"pause":n.pause()}},pauseInvisible:{visProp:null,init:function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)e[t]+"Hidden"in document&&(v.pauseInvisible.visProp=e[t]+"Hidden");if(v.pauseInvisible.visProp){var n=v.pauseInvisible.visProp.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(n,function(){v.pauseInvisible.isHidden()?r.startTimeout?clearTimeout(r.startTimeout):r.pause():r.started?r.play():r.vars.initDelay>0?setTimeout(r.play,r.vars.initDelay):r.play()})}},isHidden:function(){return document[v.pauseInvisible.visProp]||!1}},setToClearWatchedEvent:function(){clearTimeout(f);f=setTimeout(function(){a=""},3e3)}};r.flexAnimate=function(t,n,s,u,a){!r.vars.animationLoop&&t!==r.currentSlide&&(r.direction=t>r.currentSlide?"next":"prev");d&&r.pagingCount===1&&(r.direction=r.currentItem<t?"next":"prev");if(!r.animating&&(r.canAdvance(t,a)||s)&&r.is(":visible")){if(d&&u){var f=e(r.vars.asNavFor).data("flexslider");r.atEnd=t===0||t===r.count-1;f.flexAnimate(t,!0,!1,!0,a);r.direction=r.currentItem<t?"next":"prev";f.direction=r.direction;if(Math.ceil((t+1)/r.visible)-1===r.currentSlide||t===0){r.currentItem=t;r.slides.removeClass(i+"active-slide").eq(t).addClass(i+"active-slide");return!1}r.currentItem=t;r.slides.removeClass(i+"active-slide").eq(t).addClass(i+"active-slide");t=Math.floor(t/r.visible)}r.animating=!0;r.animatingTo=t;n&&r.pause();r.vars.before(r);r.syncExists&&!a&&v.sync("animate");r.vars.controlNav&&v.controlNav.active();h||r.slides.removeClass(i+"active-slide").eq(t).addClass(i+"active-slide");r.atEnd=t===0||t===r.last;r.vars.directionNav&&v.directionNav.update();if(t===r.last){r.vars.end(r);r.vars.animationLoop||r.pause()}if(!p){var m=l?r.slides.filter(":first").height():r.computedW,g,y,b;if(h){g=r.vars.itemMargin;b=(r.itemW+g)*r.move*r.animatingTo;y=b>r.limit&&r.visible!==1?r.limit:b}else r.currentSlide===0&&t===r.count-1&&r.vars.animationLoop&&r.direction!=="next"?y=c?(r.count+r.cloneOffset)*m:0:r.currentSlide===r.last&&t===0&&r.vars.animationLoop&&r.direction!=="prev"?y=c?0:(r.count+1)*m:y=c?(r.count-1-t+r.cloneOffset)*m:(t+r.cloneOffset)*m;r.setProps(y,"",r.vars.animationSpeed);if(r.transitions){if(!r.vars.animationLoop||!r.atEnd){r.animating=!1;r.currentSlide=r.animatingTo}r.container.unbind("webkitTransitionEnd transitionend");r.container.bind("webkitTransitionEnd transitionend",function(){r.wrapup(m)})}else r.container.animate(r.args,r.vars.animationSpeed,r.vars.easing,function(){r.wrapup(m)})}else if(!o){r.slides.eq(r.currentSlide).css({zIndex:1}).animate({opacity:0},r.vars.animationSpeed,r.vars.easing);r.slides.eq(t).css({zIndex:2}).animate({opacity:1},r.vars.animationSpeed,r.vars.easing,r.wrapup)}else{r.slides.eq(r.currentSlide).css({opacity:0,zIndex:1});r.slides.eq(t).css({opacity:1,zIndex:2});r.wrapup(m)}r.vars.smoothHeight&&v.smoothHeight(r.vars.animationSpeed)}};r.wrapup=function(e){!p&&!h&&(r.currentSlide===0&&r.animatingTo===r.last&&r.vars.animationLoop?r.setProps(e,"jumpEnd"):r.currentSlide===r.last&&r.animatingTo===0&&r.vars.animationLoop&&r.setProps(e,"jumpStart"));r.animating=!1;r.currentSlide=r.animatingTo;r.vars.after(r)};r.animateSlides=function(){!r.animating&&m&&r.flexAnimate(r.getTarget("next"))};r.pause=function(){clearInterval(r.animatedSlides);r.animatedSlides=null;r.playing=!1;r.vars.pausePlay&&v.pausePlay.update("play");r.syncExists&&v.sync("pause")};r.play=function(){r.playing&&clearInterval(r.animatedSlides);r.animatedSlides=r.animatedSlides||setInterval(r.animateSlides,r.vars.slideshowSpeed);r.started=r.playing=!0;r.vars.pausePlay&&v.pausePlay.update("pause");r.syncExists&&v.sync("play")};r.stop=function(){r.pause();r.stopped=!0};r.canAdvance=function(e,t){var n=d?r.pagingCount-1:r.last;return t?!0:d&&r.currentItem===r.count-1&&e===0&&r.direction==="prev"?!0:d&&r.currentItem===0&&e===r.pagingCount-1&&r.direction!=="next"?!1:e===r.currentSlide&&!d?!1:r.vars.animationLoop?!0:r.atEnd&&r.currentSlide===0&&e===n&&r.direction!=="next"?!1:r.atEnd&&r.currentSlide===n&&e===0&&r.direction==="next"?!1:!0};r.getTarget=function(e){r.direction=e;return e==="next"?r.currentSlide===r.last?0:r.currentSlide+1:r.currentSlide===0?r.last:r.currentSlide-1};r.setProps=function(e,t,n){var i=function(){var n=e?e:(r.itemW+r.vars.itemMargin)*r.move*r.animatingTo,i=function(){if(h)return t==="setTouch"?e:c&&r.animatingTo===r.last?0:c?r.limit-(r.itemW+r.vars.itemMargin)*r.move*r.animatingTo:r.animatingTo===r.last?r.limit:n;switch(t){case"setTotal":return c?(r.count-1-r.currentSlide+r.cloneOffset)*e:(r.currentSlide+r.cloneOffset)*e;case"setTouch":return c?e:e;case"jumpEnd":return c?e:r.count*e;case"jumpStart":return c?r.count*e:e;default:return e}}();return i*-1+"px"}();if(r.transitions){i=l?"translate3d(0,"+i+",0)":"translate3d("+i+",0,0)";n=n!==undefined?n/1e3+"s":"0s";r.container.css("-"+r.pfx+"-transition-duration",n)}r.args[r.prop]=i;(r.transitions||n===undefined)&&r.container.css(r.args)};r.setup=function(t){if(!p){var n,s;if(t==="init"){r.viewport=e('<div class="'+i+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(r).append(r.container);r.cloneCount=0;r.cloneOffset=0;if(c){s=e.makeArray(r.slides).reverse();r.slides=e(s);r.container.empty().append(r.slides)}}if(r.vars.animationLoop&&!h){r.cloneCount=2;r.cloneOffset=1;t!=="init"&&r.container.find(".clone").remove();r.container.append(r.slides.first().clone().addClass("clone").attr("aria-hidden","true")).prepend(r.slides.last().clone().addClass("clone").attr("aria-hidden","true"))}r.newSlides=e(r.vars.selector,r);n=c?r.count-1-r.currentSlide+r.cloneOffset:r.currentSlide+r.cloneOffset;if(l&&!h){r.container.height((r.count+r.cloneCount)*200+"%").css("position","absolute").width("100%");setTimeout(function(){r.newSlides.css({display:"block"});r.doMath();r.viewport.height(r.h);r.setProps(n*r.h,"init")},t==="init"?100:0)}else{r.container.width((r.count+r.cloneCount)*200+"%");r.setProps(n*r.computedW,"init");setTimeout(function(){r.doMath();r.newSlides.css({width:r.computedW,"float":"left",display:"block"});r.vars.smoothHeight&&v.smoothHeight()},t==="init"?100:0)}}else{r.slides.css({width:"100%","float":"left",marginRight:"-100%",position:"relative"});t==="init"&&(o?r.slides.css({opacity:0,display:"block",webkitTransition:"opacity "+r.vars.animationSpeed/1e3+"s ease",zIndex:1}).eq(r.currentSlide).css({opacity:1,zIndex:2}):r.slides.css({opacity:0,display:"block",zIndex:1}).eq(r.currentSlide).css({zIndex:2}).animate({opacity:1},r.vars.animationSpeed,r.vars.easing));r.vars.smoothHeight&&v.smoothHeight()}h||r.slides.removeClass(i+"active-slide").eq(r.currentSlide).addClass(i+"active-slide")};r.doMath=function(){var e=r.slides.first(),t=r.vars.itemMargin,n=r.vars.minItems,i=r.vars.maxItems;r.w=r.viewport===undefined?r.width():r.viewport.width();r.h=e.height();r.boxPadding=e.outerWidth()-e.width();if(h){r.itemT=r.vars.itemWidth+t;r.minW=n?n*r.itemT:r.w;r.maxW=i?i*r.itemT-t:r.w;r.itemW=r.minW>r.w?(r.w-t*(n-1))/n:r.maxW<r.w?(r.w-t*(i-1))/i:r.vars.itemWidth>r.w?r.w:r.vars.itemWidth;r.visible=Math.floor(r.w/r.itemW);r.move=r.vars.move>0&&r.vars.move<r.visible?r.vars.move:r.visible;r.pagingCount=Math.ceil((r.count-r.visible)/r.move+1);r.last=r.pagingCount-1;r.limit=r.pagingCount===1?0:r.vars.itemWidth>r.w?r.itemW*(r.count-1)+t*(r.count-1):(r.itemW+t)*r.count-r.w-t}else{r.itemW=r.w;r.pagingCount=r.count;r.last=r.count-1}r.computedW=r.itemW-r.boxPadding};r.update=function(e,t){r.doMath();if(!h){e<r.currentSlide?r.currentSlide+=1:e<=r.currentSlide&&e!==0&&(r.currentSlide-=1);r.animatingTo=r.currentSlide}if(r.vars.controlNav&&!r.manualControls)if(t==="add"&&!h||r.pagingCount>r.controlNav.length)v.controlNav.update("add");else if(t==="remove"&&!h||r.pagingCount<r.controlNav.length){if(h&&r.currentSlide>r.last){r.currentSlide-=1;r.animatingTo-=1}v.controlNav.update("remove",r.last)}r.vars.directionNav&&v.directionNav.update()};r.addSlide=function(t,n){var i=e(t);r.count+=1;r.last=r.count-1;l&&c?n!==undefined?r.slides.eq(r.count-n).after(i):r.container.prepend(i):n!==undefined?r.slides.eq(n).before(i):r.container.append(i);r.update(n,"add");r.slides=e(r.vars.selector+":not(.clone)",r);r.setup();r.vars.added(r)};r.removeSlide=function(t){var n=isNaN(t)?r.slides.index(e(t)):t;r.count-=1;r.last=r.count-1;isNaN(t)?e(t,r.slides).remove():l&&c?r.slides.eq(r.last).remove():r.slides.eq(t).remove();r.doMath();r.update(n,"remove");r.slides=e(r.vars.selector+":not(.clone)",r);r.setup();r.vars.removed(r)};v.init()};e(window).blur(function(e){focused=!1}).focus(function(e){focused=!0});e.flexslider.defaults={namespace:"flex-",selector:".slides > li",animation:"fade",easing:"swing",direction:"horizontal",reverse:!1,animationLoop:!0,smoothHeight:!1,startAt:0,slideshow:!0,slideshowSpeed:7e3,animationSpeed:600,initDelay:0,randomize:!1,thumbCaptions:!1,pauseOnAction:!0,pauseOnHover:!1,pauseInvisible:!0,useCSS:!0,touch:!0,video:!1,controlNav:!0,directionNav:!0,prevText:"Previous",nextText:"Next",keyboard:!0,multipleKeyboard:!1,mousewheel:!1,pausePlay:!1,pauseText:"Pause",playText:"Play",controlsContainer:"",manualControls:"",sync:"",asNavFor:"",itemWidth:0,itemMargin:0,minItems:1,maxItems:0,move:0,allowOneSlide:!0,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){}};e.fn.flexslider=function(t){t===undefined&&(t={});if(typeof t=="object")return this.each(function(){var n=e(this),r=t.selector?t.selector:".slides > li",i=n.find(r);if(i.length===1&&t.allowOneSlide===!0||i.length===0){i.fadeIn(400);t.start&&t.start(n)}else n.data("flexslider")===undefined&&new e.flexslider(this,t)});var n=e(this).data("flexslider");switch(t){case"play":n.play();break;case"pause":n.pause();break;case"stop":n.stop();break;case"next":n.flexAnimate(n.getTarget("next"),!0);break;case"prev":case"previous":n.flexAnimate(n.getTarget("prev"),!0);break;default:typeof t=="number"&&n.flexAnimate(t,!0)}}})(jQuery);

 /* jquery.touchSwipe.min.js */
 (function(a){if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],a)}else{a(jQuery)}}(function(e){var o="left",n="right",d="up",v="down",c="in",w="out",l="none",r="auto",k="swipe",s="pinch",x="tap",i="doubletap",b="longtap",A="horizontal",t="vertical",h="all",q=10,f="start",j="move",g="end",p="cancel",a="ontouchstart" in window,y="TouchSwipe";var m={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:true,triggerOnTouchLeave:false,allowPageScroll:"auto",fallbackToMouseEvents:true,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(D){var C=e(this),B=C.data(y);if(B&&typeof D==="string"){if(B[D]){return B[D].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+D+" does not exist on jQuery.swipe")}}else{if(!B&&(typeof D==="object"||!D)){return u.apply(this,arguments)}}return C};e.fn.swipe.defaults=m;e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:j,PHASE_END:g,PHASE_CANCEL:p};e.fn.swipe.directions={LEFT:o,RIGHT:n,UP:d,DOWN:v,IN:c,OUT:w};e.fn.swipe.pageScroll={NONE:l,HORIZONTAL:A,VERTICAL:t,AUTO:r};e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:h};function u(B){if(B&&(B.allowPageScroll===undefined&&(B.swipe!==undefined||B.swipeStatus!==undefined))){B.allowPageScroll=l}if(B.click!==undefined&&B.tap===undefined){B.tap=B.click}if(!B){B={}}B=e.extend({},e.fn.swipe.defaults,B);return this.each(function(){var D=e(this);var C=D.data(y);if(!C){C=new z(this,B);D.data(y,C)}})}function z(a0,aq){var av=(a||!aq.fallbackToMouseEvents),G=av?"touchstart":"mousedown",au=av?"touchmove":"mousemove",R=av?"touchend":"mouseup",P=av?null:"mouseleave",az="touchcancel";var ac=0,aL=null,Y=0,aX=0,aV=0,D=1,am=0,aF=0,J=null;var aN=e(a0);var W="start";var T=0;var aM=null;var Q=0,aY=0,a1=0,aa=0,K=0;var aS=null;try{aN.bind(G,aJ);aN.bind(az,a5)}catch(ag){e.error("events not supported "+G+","+az+" on jQuery.swipe")}this.enable=function(){aN.bind(G,aJ);aN.bind(az,a5);return aN};this.disable=function(){aG();return aN};this.destroy=function(){aG();aN.data(y,null);return aN};this.option=function(a8,a7){if(aq[a8]!==undefined){if(a7===undefined){return aq[a8]}else{aq[a8]=a7}}else{e.error("Option "+a8+" does not exist on jQuery.swipe.options")}return null};function aJ(a9){if(ax()){return}if(e(a9.target).closest(aq.excludedElements,aN).length>0){return}var ba=a9.originalEvent?a9.originalEvent:a9;var a8,a7=a?ba.touches[0]:ba;W=f;if(a){T=ba.touches.length}else{a9.preventDefault()}ac=0;aL=null;aF=null;Y=0;aX=0;aV=0;D=1;am=0;aM=af();J=X();O();if(!a||(T===aq.fingers||aq.fingers===h)||aT()){ae(0,a7);Q=ao();if(T==2){ae(1,ba.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}if(aq.swipeStatus||aq.pinchStatus){a8=L(ba,W)}}else{a8=false}if(a8===false){W=p;L(ba,W);return a8}else{ak(true)}return null}function aZ(ba){var bd=ba.originalEvent?ba.originalEvent:ba;if(W===g||W===p||ai()){return}var a9,a8=a?bd.touches[0]:bd;var bb=aD(a8);aY=ao();if(a){T=bd.touches.length}W=j;if(T==2){if(aX==0){ae(1,bd.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}else{aD(bd.touches[1]);aV=ap(aM[0].end,aM[1].end);aF=an(aM[0].end,aM[1].end)}D=a3(aX,aV);am=Math.abs(aX-aV)}if((T===aq.fingers||aq.fingers===h)||!a||aT()){aL=aH(bb.start,bb.end);ah(ba,aL);ac=aO(bb.start,bb.end);Y=aI();aE(aL,ac);if(aq.swipeStatus||aq.pinchStatus){a9=L(bd,W)}if(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave){var a7=true;if(aq.triggerOnTouchLeave){var bc=aU(this);a7=B(bb.end,bc)}if(!aq.triggerOnTouchEnd&&a7){W=ay(j)}else{if(aq.triggerOnTouchLeave&&!a7){W=ay(g)}}if(W==p||W==g){L(bd,W)}}}else{W=p;L(bd,W)}if(a9===false){W=p;L(bd,W)}}function I(a7){var a8=a7.originalEvent;if(a){if(a8.touches.length>0){C();return true}}if(ai()){T=aa}a7.preventDefault();aY=ao();Y=aI();if(a6()){W=p;L(a8,W)}else{if(aq.triggerOnTouchEnd||(aq.triggerOnTouchEnd==false&&W===j)){W=g;L(a8,W)}else{if(!aq.triggerOnTouchEnd&&a2()){W=g;aB(a8,W,x)}else{if(W===j){W=p;L(a8,W)}}}}ak(false);return null}function a5(){T=0;aY=0;Q=0;aX=0;aV=0;D=1;O();ak(false)}function H(a7){var a8=a7.originalEvent;if(aq.triggerOnTouchLeave){W=ay(g);L(a8,W)}}function aG(){aN.unbind(G,aJ);aN.unbind(az,a5);aN.unbind(au,aZ);aN.unbind(R,I);if(P){aN.unbind(P,H)}ak(false)}function ay(bb){var ba=bb;var a9=aw();var a8=aj();var a7=a6();if(!a9||a7){ba=p}else{if(a8&&bb==j&&(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave)){ba=g}else{if(!a8&&bb==g&&aq.triggerOnTouchLeave){ba=p}}}return ba}function L(a9,a7){var a8=undefined;if(F()||S()){a8=aB(a9,a7,k)}else{if((M()||aT())&&a8!==false){a8=aB(a9,a7,s)}}if(aC()&&a8!==false){a8=aB(a9,a7,i)}else{if(al()&&a8!==false){a8=aB(a9,a7,b)}else{if(ad()&&a8!==false){a8=aB(a9,a7,x)}}}if(a7===p){a5(a9)}if(a7===g){if(a){if(a9.touches.length==0){a5(a9)}}else{a5(a9)}}return a8}function aB(ba,a7,a9){var a8=undefined;if(a9==k){aN.trigger("swipeStatus",[a7,aL||null,ac||0,Y||0,T]);if(aq.swipeStatus){a8=aq.swipeStatus.call(aN,ba,a7,aL||null,ac||0,Y||0,T);if(a8===false){return false}}if(a7==g&&aR()){aN.trigger("swipe",[aL,ac,Y,T]);if(aq.swipe){a8=aq.swipe.call(aN,ba,aL,ac,Y,T);if(a8===false){return false}}switch(aL){case o:aN.trigger("swipeLeft",[aL,ac,Y,T]);if(aq.swipeLeft){a8=aq.swipeLeft.call(aN,ba,aL,ac,Y,T)}break;case n:aN.trigger("swipeRight",[aL,ac,Y,T]);if(aq.swipeRight){a8=aq.swipeRight.call(aN,ba,aL,ac,Y,T)}break;case d:aN.trigger("swipeUp",[aL,ac,Y,T]);if(aq.swipeUp){a8=aq.swipeUp.call(aN,ba,aL,ac,Y,T)}break;case v:aN.trigger("swipeDown",[aL,ac,Y,T]);if(aq.swipeDown){a8=aq.swipeDown.call(aN,ba,aL,ac,Y,T)}break}}}if(a9==s){aN.trigger("pinchStatus",[a7,aF||null,am||0,Y||0,T,D]);if(aq.pinchStatus){a8=aq.pinchStatus.call(aN,ba,a7,aF||null,am||0,Y||0,T,D);if(a8===false){return false}}if(a7==g&&a4()){switch(aF){case c:aN.trigger("pinchIn",[aF||null,am||0,Y||0,T,D]);if(aq.pinchIn){a8=aq.pinchIn.call(aN,ba,aF||null,am||0,Y||0,T,D)}break;case w:aN.trigger("pinchOut",[aF||null,am||0,Y||0,T,D]);if(aq.pinchOut){a8=aq.pinchOut.call(aN,ba,aF||null,am||0,Y||0,T,D)}break}}}if(a9==x){if(a7===p||a7===g){clearTimeout(aS);if(V()&&!E()){K=ao();aS=setTimeout(e.proxy(function(){K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}},this),aq.doubleTapThreshold)}else{K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}}}}else{if(a9==i){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("doubletap",[ba.target]);if(aq.doubleTap){a8=aq.doubleTap.call(aN,ba,ba.target)}}}else{if(a9==b){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("longtap",[ba.target]);if(aq.longTap){a8=aq.longTap.call(aN,ba,ba.target)}}}}}return a8}function aj(){var a7=true;if(aq.threshold!==null){a7=ac>=aq.threshold}return a7}function a6(){var a7=false;if(aq.cancelThreshold!==null&&aL!==null){a7=(aP(aL)-ac)>=aq.cancelThreshold}return a7}function ab(){if(aq.pinchThreshold!==null){return am>=aq.pinchThreshold}return true}function aw(){var a7;if(aq.maxTimeThreshold){if(Y>=aq.maxTimeThreshold){a7=false}else{a7=true}}else{a7=true}return a7}function ah(a7,a8){if(aq.allowPageScroll===l||aT()){a7.preventDefault()}else{var a9=aq.allowPageScroll===r;switch(a8){case o:if((aq.swipeLeft&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case n:if((aq.swipeRight&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case d:if((aq.swipeUp&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break;case v:if((aq.swipeDown&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break}}}function a4(){var a8=aK();var a7=U();var a9=ab();return a8&&a7&&a9}function aT(){return !!(aq.pinchStatus||aq.pinchIn||aq.pinchOut)}function M(){return !!(a4()&&aT())}function aR(){var ba=aw();var bc=aj();var a9=aK();var a7=U();var a8=a6();var bb=!a8&&a7&&a9&&bc&&ba;return bb}function S(){return !!(aq.swipe||aq.swipeStatus||aq.swipeLeft||aq.swipeRight||aq.swipeUp||aq.swipeDown)}function F(){return !!(aR()&&S())}function aK(){return((T===aq.fingers||aq.fingers===h)||!a)}function U(){return aM[0].end.x!==0}function a2(){return !!(aq.tap)}function V(){return !!(aq.doubleTap)}function aQ(){return !!(aq.longTap)}function N(){if(K==null){return false}var a7=ao();return(V()&&((a7-K)<=aq.doubleTapThreshold))}function E(){return N()}function at(){return((T===1||!a)&&(isNaN(ac)||ac===0))}function aW(){return((Y>aq.longTapThreshold)&&(ac<q))}function ad(){return !!(at()&&a2())}function aC(){return !!(N()&&V())}function al(){return !!(aW()&&aQ())}function C(){a1=ao();aa=event.touches.length+1}function O(){a1=0;aa=0}function ai(){var a7=false;if(a1){var a8=ao()-a1;if(a8<=aq.fingerReleaseThreshold){a7=true}}return a7}function ax(){return !!(aN.data(y+"_intouch")===true)}function ak(a7){if(a7===true){aN.bind(au,aZ);aN.bind(R,I);if(P){aN.bind(P,H)}}else{aN.unbind(au,aZ,false);aN.unbind(R,I,false);if(P){aN.unbind(P,H,false)}}aN.data(y+"_intouch",a7===true)}function ae(a8,a7){var a9=a7.identifier!==undefined?a7.identifier:0;aM[a8].identifier=a9;aM[a8].start.x=aM[a8].end.x=a7.pageX||a7.clientX;aM[a8].start.y=aM[a8].end.y=a7.pageY||a7.clientY;return aM[a8]}function aD(a7){var a9=a7.identifier!==undefined?a7.identifier:0;var a8=Z(a9);a8.end.x=a7.pageX||a7.clientX;a8.end.y=a7.pageY||a7.clientY;return a8}function Z(a8){for(var a7=0;a7<aM.length;a7++){if(aM[a7].identifier==a8){return aM[a7]}}}function af(){var a7=[];for(var a8=0;a8<=5;a8++){a7.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0})}return a7}function aE(a7,a8){a8=Math.max(a8,aP(a7));J[a7].distance=a8}function aP(a7){if(J[a7]){return J[a7].distance}return undefined}function X(){var a7={};a7[o]=ar(o);a7[n]=ar(n);a7[d]=ar(d);a7[v]=ar(v);return a7}function ar(a7){return{direction:a7,distance:0}}function aI(){return aY-Q}function ap(ba,a9){var a8=Math.abs(ba.x-a9.x);var a7=Math.abs(ba.y-a9.y);return Math.round(Math.sqrt(a8*a8+a7*a7))}function a3(a7,a8){var a9=(a8/a7)*1;return a9.toFixed(2)}function an(){if(D<1){return w}else{return c}}function aO(a8,a7){return Math.round(Math.sqrt(Math.pow(a7.x-a8.x,2)+Math.pow(a7.y-a8.y,2)))}function aA(ba,a8){var a7=ba.x-a8.x;var bc=a8.y-ba.y;var a9=Math.atan2(bc,a7);var bb=Math.round(a9*180/Math.PI);if(bb<0){bb=360-Math.abs(bb)}return bb}function aH(a8,a7){var a9=aA(a8,a7);if((a9<=45)&&(a9>=0)){return o}else{if((a9<=360)&&(a9>=315)){return o}else{if((a9>=135)&&(a9<=225)){return n}else{if((a9>45)&&(a9<135)){return v}else{return d}}}}}function ao(){var a7=new Date();return a7.getTime()}function aU(a7){a7=e(a7);var a9=a7.offset();var a8={left:a9.left,right:a9.left+a7.outerWidth(),top:a9.top,bottom:a9.top+a7.outerHeight()};return a8}function B(a7,a8){return(a7.x>a8.left&&a7.x<a8.right&&a7.y>a8.top&&a7.y<a8.bottom)}}}));

 // afterresize.js
 // http://pritomkumar.blogspot.com/2013/07/jquery-window-after-resize-event.html

!function(a){"use strict";var e,b={action:function(){},runOnLoad:!1,duration:500},c=b,d=!1,f={};f.init=function(){for(var b=0;b<=arguments.length;b++){var d=arguments[b];switch(typeof d){case"function":c.action=d;break;case"boolean":c.runOnLoad=d;break;case"number":c.duration=d}}return this.each(function(){c.runOnLoad&&c.action(),a(this).resize(function(){f.timedAction.call(this)})})},f.timedAction=function(a,b){var f=function(){var a=c.duration;if(d){var b=new Date-e;if(a=c.duration-b,0>=a)return clearTimeout(d),d=!1,c.action(),void 0}g(a)},g=function(a){d=setTimeout(f,a)};e=new Date,"number"==typeof b&&(c.duration=b),"function"==typeof a&&(c.action=a),d||f()},a.fn.afterResize=function(a){return f[a]?f[a].apply(this,Array.prototype.slice.call(arguments,1)):f.init.apply(this,arguments)}}(jQuery);

/*

Google maps info box
http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.5/

*/
// function InfoBox(a){a=a||{},google.maps.OverlayView.apply(this,arguments),this.content_=a.content||"",this.disableAutoPan_=a.disableAutoPan||!1,this.maxWidth_=a.maxWidth||0,this.pixelOffset_=a.pixelOffset||new google.maps.Size(0,0),this.position_=a.position||new google.maps.LatLng(0,0),this.zIndex_=a.zIndex||null,this.boxClass_=a.boxClass||"infoBox",this.boxStyle_=a.boxStyle||{},this.closeBoxMargin_=a.closeBoxMargin||"2px",this.closeBoxURL_=a.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===a.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=a.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=a.isHidden||!1,this.alignBottom_=a.alignBottom||!1,this.pane_=a.pane||"floatPane",this.enableEventPropagation_=a.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.moveListener_=null,this.contextListener_=null,this.fixedWidthSet_=null}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var a,b=this,c=function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},d=function(a){a.returnValue=!1,a.preventDefault&&a.preventDefault(),b.enableEventPropagation_||c(a)};this.div_||(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(a=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-a.left-a.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),this.enableEventPropagation_||(this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",c),this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",c),this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",c)),this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",d),google.maps.event.trigger(this,"domready"))},InfoBox.prototype.getCloseBoxImg_=function(){var a="";return""!==this.closeBoxURL_&&(a="<img",a+=" src='"+this.closeBoxURL_+"'",a+=" align=right",a+=" style='",a+=" position: relative;",a+=" cursor: pointer;",a+=" z-index: 1;",a+=" margin: "+this.closeBoxMargin_+";",a+="'>"),a="<div class='' style=' position: absolute; right: 10px; top: 10px'><i class='icon icon-core_close'></i></div>"},InfoBox.prototype.addClickHandler_=function(){var a;""!==this.closeBoxURL_?(a=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(a,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var a=this;return function(b){b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation(),a.close(),google.maps.event.trigger(a,"closeclick")}},InfoBox.prototype.panBox_=function(a){var b,c,d=0,e=0;if(!a&&(b=this.getMap(),b instanceof google.maps.Map)){b.getBounds().contains(this.position_)||b.setCenter(this.position_),c=b.getBounds();var f=b.getDiv(),g=f.offsetWidth,h=f.offsetHeight,i=this.pixelOffset_.width,j=this.pixelOffset_.height,k=this.div_.offsetWidth,l=this.div_.offsetHeight,m=this.infoBoxClearance_.width,n=this.infoBoxClearance_.height,o=this.getProjection().fromLatLngToContainerPixel(this.position_);o.x<-i+m?d=o.x+i-m:o.x+k+i+m>g&&(d=o.x+k+i+m-g),this.alignBottom_?o.y<-j+n+l?e=o.y+j-n-l:o.y+j+n>h&&(e=o.y+j+n-h):o.y<-j+n?e=o.y+j-n:o.y+l+j+n>h&&(e=o.y+l+j+n-h),(0!==d||0!==e)&&(b.getCenter(),b.panBy(d,e))}},InfoBox.prototype.setBoxStyle_=function(){var a,b;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",b=this.boxStyle_;for(a in b)b.hasOwnProperty(a)&&(this.div_.style[a]=b[a]);"undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var a,b={top:0,bottom:0,left:0,right:0},c=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(a=c.ownerDocument.defaultView.getComputedStyle(c,""),a&&(b.top=parseInt(a.borderTopWidth,10)||0,b.bottom=parseInt(a.borderBottomWidth,10)||0,b.left=parseInt(a.borderLeftWidth,10)||0,b.right=parseInt(a.borderRightWidth,10)||0)):document.documentElement.currentStyle&&c.currentStyle&&(b.top=parseInt(c.currentStyle.borderTopWidth,10)||0,b.bottom=parseInt(c.currentStyle.borderBottomWidth,10)||0,b.left=parseInt(c.currentStyle.borderLeftWidth,10)||0,b.right=parseInt(c.currentStyle.borderRightWidth,10)||0),b},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var a=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=a.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(a.y+this.pixelOffset_.height-10)+"px":this.div_.style.top=a.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},InfoBox.prototype.setOptions=function(a){"undefined"!=typeof a.boxClass&&(this.boxClass_=a.boxClass,this.setBoxStyle_()),"undefined"!=typeof a.boxStyle&&(this.boxStyle_=a.boxStyle,this.setBoxStyle_()),"undefined"!=typeof a.content&&this.setContent(a.content),"undefined"!=typeof a.disableAutoPan&&(this.disableAutoPan_=a.disableAutoPan),"undefined"!=typeof a.maxWidth&&(this.maxWidth_=a.maxWidth),"undefined"!=typeof a.pixelOffset&&(this.pixelOffset_=a.pixelOffset),"undefined"!=typeof a.position&&this.setPosition(a.position),"undefined"!=typeof a.zIndex&&this.setZIndex(a.zIndex),"undefined"!=typeof a.closeBoxMargin&&(this.closeBoxMargin_=a.closeBoxMargin),"undefined"!=typeof a.closeBoxURL&&(this.closeBoxURL_=a.closeBoxURL),"undefined"!=typeof a.infoBoxClearance&&(this.infoBoxClearance_=a.infoBoxClearance),"undefined"!=typeof a.isHidden&&(this.isHidden_=a.isHidden),"undefined"!=typeof a.enableEventPropagation&&(this.enableEventPropagation_=a.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(a){this.content_=a,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",this.div_.innerHTML=this.getCloseBoxImg_()+a),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(a){this.position_=a,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(a){this.zIndex_=a,this.div_&&(this.div_.style.zIndex=a),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(a,b){var c=this;b&&(this.position_=b.getPosition(),this.moveListener_=google.maps.event.addListener(b,"position_changed",function(){c.setPosition(this.getPosition())})),this.setMap(a),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListener1_&&(google.maps.event.removeListener(this.eventListener1_),google.maps.event.removeListener(this.eventListener2_),google.maps.event.removeListener(this.eventListener3_),this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null),this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)};

/*! Magnific Popup - v0.9.9 - 2013-12-27
* http://dimsemenov.com/plugins/magnific-popup/
* Copyright (c) 2013 Dmitry Semenov; */
(function(e){var t,n,i,o,r,a,s,l="Close",c="BeforeClose",d="AfterClose",u="BeforeAppend",p="MarkupParse",f="Open",m="Change",g="mfp",h="."+g,v="mfp-ready",C="mfp-removing",y="mfp-prevent-close",w=function(){},b=!!window.jQuery,I=e(window),x=function(e,n){t.ev.on(g+e+h,n)},k=function(t,n,i,o){var r=document.createElement("div");return r.className="mfp-"+t,i&&(r.innerHTML=i),o?n&&n.appendChild(r):(r=e(r),n&&r.appendTo(n)),r},T=function(n,i){t.ev.triggerHandler(g+n,i),t.st.callbacks&&(n=n.charAt(0).toLowerCase()+n.slice(1),t.st.callbacks[n]&&t.st.callbacks[n].apply(t,e.isArray(i)?i:[i]))},E=function(n){return n===s&&t.currTemplate.closeBtn||(t.currTemplate.closeBtn=e(t.st.closeMarkup.replace("%title%",t.st.tClose)),s=n),t.currTemplate.closeBtn},_=function(){e.magnificPopup.instance||(t=new w,t.init(),e.magnificPopup.instance=t)},S=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1};w.prototype={constructor:w,init:function(){var n=navigator.appVersion;t.isIE7=-1!==n.indexOf("MSIE 7."),t.isIE8=-1!==n.indexOf("MSIE 8."),t.isLowIE=t.isIE7||t.isIE8,t.isAndroid=/android/gi.test(n),t.isIOS=/iphone|ipad|ipod/gi.test(n),t.supportsTransition=S(),t.probablyMobile=t.isAndroid||t.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),o=e(document),t.popupsCache={}},open:function(n){i||(i=e(document.body));var r;if(n.isObj===!1){t.items=n.items.toArray(),t.index=0;var s,l=n.items;for(r=0;l.length>r;r++)if(s=l[r],s.parsed&&(s=s.el[0]),s===n.el[0]){t.index=r;break}}else t.items=e.isArray(n.items)?n.items:[n.items],t.index=n.index||0;if(t.isOpen)return t.updateItemHTML(),void 0;t.types=[],a="",t.ev=n.mainEl&&n.mainEl.length?n.mainEl.eq(0):o,n.key?(t.popupsCache[n.key]||(t.popupsCache[n.key]={}),t.currTemplate=t.popupsCache[n.key]):t.currTemplate={},t.st=e.extend(!0,{},e.magnificPopup.defaults,n),t.fixedContentPos="auto"===t.st.fixedContentPos?!t.probablyMobile:t.st.fixedContentPos,t.st.modal&&(t.st.closeOnContentClick=!1,t.st.closeOnBgClick=!1,t.st.showCloseBtn=!1,t.st.enableEscapeKey=!1),t.bgOverlay||(t.bgOverlay=k("bg").on("click"+h,function(){t.close()}),t.wrap=k("wrap").attr("tabindex",-1).on("click"+h,function(e){t._checkIfClose(e.target)&&t.close()}),t.container=k("container",t.wrap)),t.contentContainer=k("content"),t.st.preloader&&(t.preloader=k("preloader",t.container,t.st.tLoading));var c=e.magnificPopup.modules;for(r=0;c.length>r;r++){var d=c[r];d=d.charAt(0).toUpperCase()+d.slice(1),t["init"+d].call(t)}T("BeforeOpen"),t.st.showCloseBtn&&(t.st.closeBtnInside?(x(p,function(e,t,n,i){n.close_replaceWith=E(i.type)}),a+=" mfp-close-btn-in"):t.wrap.append(E())),t.st.alignTop&&(a+=" mfp-align-top"),t.fixedContentPos?t.wrap.css({overflow:t.st.overflowY,overflowX:"hidden",overflowY:t.st.overflowY}):t.wrap.css({top:I.scrollTop(),position:"absolute"}),(t.st.fixedBgPos===!1||"auto"===t.st.fixedBgPos&&!t.fixedContentPos)&&t.bgOverlay.css({height:o.height(),position:"absolute"}),t.st.enableEscapeKey&&o.on("keyup"+h,function(e){27===e.keyCode&&t.close()}),I.on("resize"+h,function(){t.updateSize()}),t.st.closeOnContentClick||(a+=" mfp-auto-cursor"),a&&t.wrap.addClass(a);var u=t.wH=I.height(),m={};if(t.fixedContentPos&&t._hasScrollBar(u)){var g=t._getScrollbarSize();g&&(m.marginRight=g)}t.fixedContentPos&&(t.isIE7?e("body, html").css("overflow","hidden"):m.overflow="hidden");var C=t.st.mainClass;return t.isIE7&&(C+=" mfp-ie7"),C&&t._addClassToMFP(C),t.updateItemHTML(),T("BuildControls"),e("html").css(m),t.bgOverlay.add(t.wrap).prependTo(t.st.prependTo||i),t._lastFocusedEl=document.activeElement,setTimeout(function(){t.content?(t._addClassToMFP(v),t._setFocus()):t.bgOverlay.addClass(v),o.on("focusin"+h,t._onFocusIn)},16),t.isOpen=!0,t.updateSize(u),T(f),n},close:function(){t.isOpen&&(T(c),t.isOpen=!1,t.st.removalDelay&&!t.isLowIE&&t.supportsTransition?(t._addClassToMFP(C),setTimeout(function(){t._close()},t.st.removalDelay)):t._close())},_close:function(){T(l);var n=C+" "+v+" ";if(t.bgOverlay.detach(),t.wrap.detach(),t.container.empty(),t.st.mainClass&&(n+=t.st.mainClass+" "),t._removeClassFromMFP(n),t.fixedContentPos){var i={marginRight:""};t.isIE7?e("body, html").css("overflow",""):i.overflow="",e("html").css(i)}o.off("keyup"+h+" focusin"+h),t.ev.off(h),t.wrap.attr("class","mfp-wrap").removeAttr("style"),t.bgOverlay.attr("class","mfp-bg"),t.container.attr("class","mfp-container"),!t.st.showCloseBtn||t.st.closeBtnInside&&t.currTemplate[t.currItem.type]!==!0||t.currTemplate.closeBtn&&t.currTemplate.closeBtn.detach(),t._lastFocusedEl&&e(t._lastFocusedEl).focus(),t.currItem=null,t.content=null,t.currTemplate=null,t.prevHeight=0,T(d)},updateSize:function(e){if(t.isIOS){var n=document.documentElement.clientWidth/window.innerWidth,i=window.innerHeight*n;t.wrap.css("height",i),t.wH=i}else t.wH=e||I.height();t.fixedContentPos||t.wrap.css("height",t.wH),T("Resize")},updateItemHTML:function(){var n=t.items[t.index];t.contentContainer.detach(),t.content&&t.content.detach(),n.parsed||(n=t.parseEl(t.index));var i=n.type;if(T("BeforeChange",[t.currItem?t.currItem.type:"",i]),t.currItem=n,!t.currTemplate[i]){var o=t.st[i]?t.st[i].markup:!1;T("FirstMarkupParse",o),t.currTemplate[i]=o?e(o):!0}r&&r!==n.type&&t.container.removeClass("mfp-"+r+"-holder");var a=t["get"+i.charAt(0).toUpperCase()+i.slice(1)](n,t.currTemplate[i]);t.appendContent(a,i),n.preloaded=!0,T(m,n),r=n.type,t.container.prepend(t.contentContainer),T("AfterChange")},appendContent:function(e,n){t.content=e,e?t.st.showCloseBtn&&t.st.closeBtnInside&&t.currTemplate[n]===!0?t.content.find(".mfp-close").length||t.content.append(E()):t.content=e:t.content="",T(u),t.container.addClass("mfp-"+n+"-holder"),t.contentContainer.append(t.content)},parseEl:function(n){var i,o=t.items[n];if(o.tagName?o={el:e(o)}:(i=o.type,o={data:o,src:o.src}),o.el){for(var r=t.types,a=0;r.length>a;a++)if(o.el.hasClass("mfp-"+r[a])){i=r[a];break}o.src=o.el.attr("data-mfp-src"),o.src||(o.src=o.el.attr("href"))}return o.type=i||t.st.type||"inline",o.index=n,o.parsed=!0,t.items[n]=o,T("ElementParse",o),t.items[n]},addGroup:function(e,n){var i=function(i){i.mfpEl=this,t._openClick(i,e,n)};n||(n={});var o="click.magnificPopup";n.mainEl=e,n.items?(n.isObj=!0,e.off(o).on(o,i)):(n.isObj=!1,n.delegate?e.off(o).on(o,n.delegate,i):(n.items=e,e.off(o).on(o,i)))},_openClick:function(n,i,o){var r=void 0!==o.midClick?o.midClick:e.magnificPopup.defaults.midClick;if(r||2!==n.which&&!n.ctrlKey&&!n.metaKey){var a=void 0!==o.disableOn?o.disableOn:e.magnificPopup.defaults.disableOn;if(a)if(e.isFunction(a)){if(!a.call(t))return!0}else if(a>I.width())return!0;n.type&&(n.preventDefault(),t.isOpen&&n.stopPropagation()),o.el=e(n.mfpEl),o.delegate&&(o.items=i.find(o.delegate)),t.open(o)}},updateStatus:function(e,i){if(t.preloader){n!==e&&t.container.removeClass("mfp-s-"+n),i||"loading"!==e||(i=t.st.tLoading);var o={status:e,text:i};T("UpdateStatus",o),e=o.status,i=o.text,t.preloader.html(i),t.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),t.container.addClass("mfp-s-"+e),n=e}},_checkIfClose:function(n){if(!e(n).hasClass(y)){var i=t.st.closeOnContentClick,o=t.st.closeOnBgClick;if(i&&o)return!0;if(!t.content||e(n).hasClass("mfp-close")||t.preloader&&n===t.preloader[0])return!0;if(n===t.content[0]||e.contains(t.content[0],n)){if(i)return!0}else if(o&&e.contains(document,n))return!0;return!1}},_addClassToMFP:function(e){t.bgOverlay.addClass(e),t.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),t.wrap.removeClass(e)},_hasScrollBar:function(e){return(t.isIE7?o.height():document.body.scrollHeight)>(e||I.height())},_setFocus:function(){(t.st.focus?t.content.find(t.st.focus).eq(0):t.wrap).focus()},_onFocusIn:function(n){return n.target===t.wrap[0]||e.contains(t.wrap[0],n.target)?void 0:(t._setFocus(),!1)},_parseMarkup:function(t,n,i){var o;i.data&&(n=e.extend(i.data,n)),T(p,[t,n,i]),e.each(n,function(e,n){if(void 0===n||n===!1)return!0;if(o=e.split("_"),o.length>1){var i=t.find(h+"-"+o[0]);if(i.length>0){var r=o[1];"replaceWith"===r?i[0]!==n[0]&&i.replaceWith(n):"img"===r?i.is("img")?i.attr("src",n):i.replaceWith('<img src="'+n+'" class="'+i.attr("class")+'" />'):i.attr(o[1],n)}}else t.find(h+"-"+e).html(n)})},_getScrollbarSize:function(){if(void 0===t.scrollbarSize){var e=document.createElement("div");e.id="mfp-sbm",e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t.scrollbarSize}},e.magnificPopup={instance:null,proto:w.prototype,modules:[],open:function(t,n){return _(),t=t?e.extend(!0,{},t):{},t.isObj=!0,t.index=n||0,this.instance.open(t)},close:function(){return e.magnificPopup.instance&&e.magnificPopup.instance.close()},registerModule:function(t,n){n.options&&(e.magnificPopup.defaults[t]=n.options),e.extend(this.proto,n.proto),this.modules.push(t)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},e.fn.magnificPopup=function(n){_();var i=e(this);if("string"==typeof n)if("open"===n){var o,r=b?i.data("magnificPopup"):i[0].magnificPopup,a=parseInt(arguments[1],10)||0;r.items?o=r.items[a]:(o=i,r.delegate&&(o=o.find(r.delegate)),o=o.eq(a)),t._openClick({mfpEl:o},i,r)}else t.isOpen&&t[n].apply(t,Array.prototype.slice.call(arguments,1));else n=e.extend(!0,{},n),b?i.data("magnificPopup",n):i[0].magnificPopup=n,t.addGroup(i,n);return i};var P,O,z,M="inline",B=function(){z&&(O.after(z.addClass(P)).detach(),z=null)};e.magnificPopup.registerModule(M,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){t.types.push(M),x(l+"."+M,function(){B()})},getInline:function(n,i){if(B(),n.src){var o=t.st.inline,r=e(n.src);if(r.length){var a=r[0].parentNode;a&&a.tagName&&(O||(P=o.hiddenClass,O=k(P),P="mfp-"+P),z=r.after(O).detach().removeClass(P)),t.updateStatus("ready")}else t.updateStatus("error",o.tNotFound),r=e("<div>");return n.inlineElement=r,r}return t.updateStatus("ready"),t._parseMarkup(i,{},n),i}}});var F,H="ajax",L=function(){F&&i.removeClass(F)},A=function(){L(),t.req&&t.req.abort()};e.magnificPopup.registerModule(H,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){t.types.push(H),F=t.st.ajax.cursor,x(l+"."+H,A),x("BeforeChange."+H,A)},getAjax:function(n){F&&i.addClass(F),t.updateStatus("loading");var o=e.extend({url:n.src,success:function(i,o,r){var a={data:i,xhr:r};T("ParseAjax",a),t.appendContent(e(a.data),H),n.finished=!0,L(),t._setFocus(),setTimeout(function(){t.wrap.addClass(v)},16),t.updateStatus("ready"),T("AjaxContentAdded")},error:function(){L(),n.finished=n.loadError=!0,t.updateStatus("error",t.st.ajax.tError.replace("%url%",n.src))}},t.st.ajax.settings);return t.req=e.ajax(o),""}}});var j,N=function(n){if(n.data&&void 0!==n.data.title)return n.data.title;var i=t.st.image.titleSrc;if(i){if(e.isFunction(i))return i.call(t,n);if(n.el)return n.el.attr(i)||""}return""};e.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var e=t.st.image,n=".image";t.types.push("image"),x(f+n,function(){"image"===t.currItem.type&&e.cursor&&i.addClass(e.cursor)}),x(l+n,function(){e.cursor&&i.removeClass(e.cursor),I.off("resize"+h)}),x("Resize"+n,t.resizeImage),t.isLowIE&&x("AfterChange",t.resizeImage)},resizeImage:function(){var e=t.currItem;if(e&&e.img&&t.st.image.verticalFit){var n=0;t.isLowIE&&(n=parseInt(e.img.css("padding-top"),10)+parseInt(e.img.css("padding-bottom"),10)),e.img.css("max-height",t.wH-n)}},_onImageHasSize:function(e){e.img&&(e.hasSize=!0,j&&clearInterval(j),e.isCheckingImgSize=!1,T("ImageHasSize",e),e.imgHidden&&(t.content&&t.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(e){var n=0,i=e.img[0],o=function(r){j&&clearInterval(j),j=setInterval(function(){return i.naturalWidth>0?(t._onImageHasSize(e),void 0):(n>200&&clearInterval(j),n++,3===n?o(10):40===n?o(50):100===n&&o(500),void 0)},r)};o(1)},getImage:function(n,i){var o=0,r=function(){n&&(n.img[0].complete?(n.img.off(".mfploader"),n===t.currItem&&(t._onImageHasSize(n),t.updateStatus("ready")),n.hasSize=!0,n.loaded=!0,T("ImageLoadComplete")):(o++,200>o?setTimeout(r,100):a()))},a=function(){n&&(n.img.off(".mfploader"),n===t.currItem&&(t._onImageHasSize(n),t.updateStatus("error",s.tError.replace("%url%",n.src))),n.hasSize=!0,n.loaded=!0,n.loadError=!0)},s=t.st.image,l=i.find(".mfp-img");if(l.length){var c=document.createElement("img");c.className="mfp-img",n.img=e(c).on("load.mfploader",r).on("error.mfploader",a),c.src=n.src,l.is("img")&&(n.img=n.img.clone()),c=n.img[0],c.naturalWidth>0?n.hasSize=!0:c.width||(n.hasSize=!1)}return t._parseMarkup(i,{title:N(n),img_replaceWith:n.img},n),t.resizeImage(),n.hasSize?(j&&clearInterval(j),n.loadError?(i.addClass("mfp-loading"),t.updateStatus("error",s.tError.replace("%url%",n.src))):(i.removeClass("mfp-loading"),t.updateStatus("ready")),i):(t.updateStatus("loading"),n.loading=!0,n.hasSize||(n.imgHidden=!0,i.addClass("mfp-loading"),t.findImageSize(n)),i)}}});var W,R=function(){return void 0===W&&(W=void 0!==document.createElement("p").style.MozTransform),W};e.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,n=t.st.zoom,i=".zoom";if(n.enabled&&t.supportsTransition){var o,r,a=n.duration,s=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),i="all "+n.duration/1e3+"s "+n.easing,o={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},r="transition";return o["-webkit-"+r]=o["-moz-"+r]=o["-o-"+r]=o[r]=i,t.css(o),t},d=function(){t.content.css("visibility","visible")};x("BuildControls"+i,function(){if(t._allowZoom()){if(clearTimeout(o),t.content.css("visibility","hidden"),e=t._getItemToZoom(),!e)return d(),void 0;r=s(e),r.css(t._getOffset()),t.wrap.append(r),o=setTimeout(function(){r.css(t._getOffset(!0)),o=setTimeout(function(){d(),setTimeout(function(){r.remove(),e=r=null,T("ZoomAnimationEnded")},16)},a)},16)}}),x(c+i,function(){if(t._allowZoom()){if(clearTimeout(o),t.st.removalDelay=a,!e){if(e=t._getItemToZoom(),!e)return;r=s(e)}r.css(t._getOffset(!0)),t.wrap.append(r),t.content.css("visibility","hidden"),setTimeout(function(){r.css(t._getOffset())},16)}}),x(l+i,function(){t._allowZoom()&&(d(),r&&r.remove(),e=null)})}},_allowZoom:function(){return"image"===t.currItem.type},_getItemToZoom:function(){return t.currItem.hasSize?t.currItem.img:!1},_getOffset:function(n){var i;i=n?t.currItem.img:t.st.zoom.opener(t.currItem.el||t.currItem);var o=i.offset(),r=parseInt(i.css("padding-top"),10),a=parseInt(i.css("padding-bottom"),10);o.top-=e(window).scrollTop()-r;var s={width:i.width(),height:(b?i.innerHeight():i[0].offsetHeight)-a-r};return R()?s["-moz-transform"]=s.transform="translate("+o.left+"px,"+o.top+"px)":(s.left=o.left,s.top=o.top),s}}});var Z="iframe",q="//about:blank",D=function(e){if(t.currTemplate[Z]){var n=t.currTemplate[Z].find("iframe");n.length&&(e||(n[0].src=q),t.isIE8&&n.css("display",e?"block":"none"))}};e.magnificPopup.registerModule(Z,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){t.types.push(Z),x("BeforeChange",function(e,t,n){t!==n&&(t===Z?D():n===Z&&D(!0))}),x(l+"."+Z,function(){D()})},getIframe:function(n,i){var o=n.src,r=t.st.iframe;e.each(r.patterns,function(){return o.indexOf(this.index)>-1?(this.id&&(o="string"==typeof this.id?o.substr(o.lastIndexOf(this.id)+this.id.length,o.length):this.id.call(this,o)),o=this.src.replace("%id%",o),!1):void 0});var a={};return r.srcAction&&(a[r.srcAction]=o),t._parseMarkup(i,a,n),t.updateStatus("ready"),i}}});var K=function(e){var n=t.items.length;return e>n-1?e-n:0>e?n+e:e},Y=function(e,t,n){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,n)};e.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var n=t.st.gallery,i=".mfp-gallery",r=Boolean(e.fn.mfpFastClick);return t.direction=!0,n&&n.enabled?(a+=" mfp-gallery",x(f+i,function(){n.navigateByImgClick&&t.wrap.on("click"+i,".mfp-img",function(){return t.items.length>1?(t.next(),!1):void 0}),o.on("keydown"+i,function(e){37===e.keyCode?t.prev():39===e.keyCode&&t.next()})}),x("UpdateStatus"+i,function(e,n){n.text&&(n.text=Y(n.text,t.currItem.index,t.items.length))}),x(p+i,function(e,i,o,r){var a=t.items.length;o.counter=a>1?Y(n.tCounter,r.index,a):""}),x("BuildControls"+i,function(){if(t.items.length>1&&n.arrows&&!t.arrowLeft){var i=n.arrowMarkup,o=t.arrowLeft=e(i.replace(/%title%/gi,n.tPrev).replace(/%dir%/gi,"left")).addClass(y),a=t.arrowRight=e(i.replace(/%title%/gi,n.tNext).replace(/%dir%/gi,"right")).addClass(y),s=r?"mfpFastClick":"click";o[s](function(){t.prev()}),a[s](function(){t.next()}),t.isIE7&&(k("b",o[0],!1,!0),k("a",o[0],!1,!0),k("b",a[0],!1,!0),k("a",a[0],!1,!0)),t.container.append(o.add(a))}}),x(m+i,function(){t._preloadTimeout&&clearTimeout(t._preloadTimeout),t._preloadTimeout=setTimeout(function(){t.preloadNearbyImages(),t._preloadTimeout=null},16)}),x(l+i,function(){o.off(i),t.wrap.off("click"+i),t.arrowLeft&&r&&t.arrowLeft.add(t.arrowRight).destroyMfpFastClick(),t.arrowRight=t.arrowLeft=null}),void 0):!1},next:function(){t.direction=!0,t.index=K(t.index+1),t.updateItemHTML()},prev:function(){t.direction=!1,t.index=K(t.index-1),t.updateItemHTML()},goTo:function(e){t.direction=e>=t.index,t.index=e,t.updateItemHTML()},preloadNearbyImages:function(){var e,n=t.st.gallery.preload,i=Math.min(n[0],t.items.length),o=Math.min(n[1],t.items.length);for(e=1;(t.direction?o:i)>=e;e++)t._preloadItem(t.index+e);for(e=1;(t.direction?i:o)>=e;e++)t._preloadItem(t.index-e)},_preloadItem:function(n){if(n=K(n),!t.items[n].preloaded){var i=t.items[n];i.parsed||(i=t.parseEl(n)),T("LazyLoad",i),"image"===i.type&&(i.img=e('<img class="mfp-img" />').on("load.mfploader",function(){i.hasSize=!0}).on("error.mfploader",function(){i.hasSize=!0,i.loadError=!0,T("LazyLoadError",i)}).attr("src",i.src)),i.preloaded=!0}}}});var U="retina";e.magnificPopup.registerModule(U,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var e=t.st.retina,n=e.ratio;n=isNaN(n)?n():n,n>1&&(x("ImageHasSize."+U,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/n,width:"100%"})}),x("ElementParse."+U,function(t,i){i.src=e.replaceSrc(i,n)}))}}}}),function(){var t=1e3,n="ontouchstart"in window,i=function(){I.off("touchmove"+r+" touchend"+r)},o="mfpFastClick",r="."+o;e.fn.mfpFastClick=function(o){return e(this).each(function(){var a,s=e(this);if(n){var l,c,d,u,p,f;s.on("touchstart"+r,function(e){u=!1,f=1,p=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],c=p.clientX,d=p.clientY,I.on("touchmove"+r,function(e){p=e.originalEvent?e.originalEvent.touches:e.touches,f=p.length,p=p[0],(Math.abs(p.clientX-c)>10||Math.abs(p.clientY-d)>10)&&(u=!0,i())}).on("touchend"+r,function(e){i(),u||f>1||(a=!0,e.preventDefault(),clearTimeout(l),l=setTimeout(function(){a=!1},t),o())})})}s.on("click"+r,function(){a||o()})})},e.fn.destroyMfpFastClick=function(){e(this).off("touchstart"+r+" click"+r),n&&I.off("touchmove"+r+" touchend"+r)}}(),_()})(window.jQuery||window.Zepto);

// JStepper
// !function(e){e.fn.jStepper=function(t){if(this.length>1)return this.each(function(){$(this).jStepper(t)}),this;var n=e.extend({},e.fn.jStepper.defaults,t);e.metadata&&(n=e.extend({},n,this.metadata())),n.disableAutocomplete&&this.attr("autocomplete","off"),e.isFunction(this.mousewheel)&&this.mousewheel(function(e,t){return t>0?(a(n,1,e,this),!1):0>t?(a(n,0,e,this),!1):void 0}),this.keydown(function(e){var t=e.keyCode;38===t&&a(n,1,e,this),40===t&&a(n,0,e,this)}),this.keyup(function(){l(n,this)});var l=function(t,n){var l=e(n),a=l.val(),i=a;t.disableNonNumeric&&(a=a.replace(/[^\d\.,\-]/gi,"")),t.allowDecimals||(a=a.replace(/[^\d\-]/gi,"")),null!==t.maxValue&&a>=t.maxValue&&(a=t.maxValue),null!==t.minValue&&a<t.minValue&&""!=a&&(a=t.minValue),i!=a&&l.val(a)},a=function(t,n,a,i){var r,u=e(i);r=a?a.ctrlKey?t.ctrlStep:a.shiftKey?t.shiftStep:t.normalStep:t.normalStep;var s=u.val(),m=s.length-i.selectionStart,f=s.length-i.selectionEnd;s=s.replace(/,/g,"."),s=s.replace(t.decimalSeparator,"."),s+="",-1!=s.indexOf(".")&&(s=s.match(new RegExp("-{0,1}[0-9]+[\\.][0-9]*"))),s+="",-1!=s.indexOf("-")&&(s=s.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*"))),s+="",s=s.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*")),(""===s||"-"==s||null===s)&&(s=t.defaultValue),s=1===n?e.fn.jStepper.AddOrSubtractTwoFloats(s,r,!0):e.fn.jStepper.AddOrSubtractTwoFloats(s,r,!1);var o=!1;if(null!==t.maxValue&&s>=t.maxValue&&(s=t.maxValue,o=!0),null!==t.minValue&&s<=t.minValue&&(s=t.minValue,o=!0),s+="",null!==t.minLength){var c=s.length;-1!=s.indexOf(".")&&(c=s.indexOf("."));var d=!1;if(-1!=s.indexOf("-")&&(d=!0,s=s.replace(/-/,"")),c<t.minLength)for(var h=1;h<=t.minLength-c;h++)s="0"+s;d&&(s="-"+s)}s+="";var p;if(t.minDecimals>0){var x;-1!=s.indexOf(".")?(p=s.length-(s.indexOf(".")+1),p<t.minDecimals&&(x=t.minDecimals-p)):(x=t.minDecimals,s+=".");for(var g=1;x>=g;g++)s+="0"}return t.maxDecimals>0&&(p=0,-1!=s.indexOf(".")&&(p=s.length-(s.indexOf(".")+1),t.maxDecimals<p&&(s=s.substring(0,s.indexOf("."))+"."+s.substring(s.indexOf(".")+1,s.indexOf(".")+1+t.maxDecimals)))),t.allowDecimals||(s+="",s=s.replace(new RegExp("[\\.].+"),"")),s=s.replace(/\./,t.decimalSeparator),u.val(s),i.selectionStart=s.length-m,i.selectionEnd=s.length-f,l(t,i),t.onStep&&t.onStep(u,n,o),!1};return this},e.fn.jStepper.AddOrSubtractTwoFloats=function(e,t,n){var l=e.toString(),a=t.toString(),i="";if(l.indexOf(".")>-1||a.indexOf(".")>-1){-1==l.indexOf(".")&&(l+=".0"),-1==a.indexOf(".")&&(a+=".0");for(var r=l.substr(l.indexOf(".")+1),u=a.substr(a.indexOf(".")+1),s=l.substr(0,l.indexOf(".")),m=a.substr(0,a.indexOf(".")),f=!0;f;)r.length!==u.length?r.length<u.length?r+="0":u+="0":f=!1;for(var o=r.length,c=0;c<=r.length-1;c++)s+=r.substr(c,1),m+=u.substr(c,1);var d,h=Number(s),p=Number(m);d=n?h+p:h-p,i=d.toString();for(var x=0;x<o-i.length+1;x++)i="0"+i;i.length>=o&&(i=i.substring(0,i.length-o)+"."+i.substring(i.length-o))}else i=n?Number(e)+Number(t):Number(e)-Number(t);return Number(i)},e.fn.jStepper.defaults={maxValue:null,minValue:null,normalStep:1,shiftStep:5,ctrlStep:10,minLength:null,disableAutocomplete:!0,defaultValue:1,decimalSeparator:",",allowDecimals:!0,minDecimals:0,maxDecimals:null,disableNonNumeric:!0,onStep:null}}(jQuery);
!function(a){a.fn.jStepper=function(b){if(this.length>1)return this.each(function(){$(this).jStepper(b)}),this;var c=a.extend({},a.fn.jStepper.defaults,b);a.metadata&&(c=a.extend({},c,this.metadata())),c.disableAutocomplete&&this.attr("autocomplete","off"),a.isFunction(),this.keydown(function(a){var b=a.keyCode;38===b&&e(c,1,a,this),40===b&&e(c,0,a,this)}),this.keyup(function(){d(c,this)});var d=function(b,c){var d=a(c),e=d.val(),f=e;b.disableNonNumeric&&(e=e.replace(/[^\d\.,\-]/gi,"")),b.allowDecimals||(e=e.replace(/[^\d\-]/gi,"")),null!==b.maxValue&&e>=b.maxValue&&(e=b.maxValue),null!==b.minValue&&e<b.minValue&&""!=e&&(e=b.minValue),f!=e&&d.val(e)},e=function(b,c,e,f){var g,h=a(f);g=e?e.ctrlKey?b.ctrlStep:e.shiftKey?b.shiftStep:b.normalStep:b.normalStep;var i=h.val(),j=i.length-f.selectionStart,k=i.length-f.selectionEnd;i=i.replace(/,/g,"."),i=i.replace(b.decimalSeparator,"."),i+="",-1!=i.indexOf(".")&&(i=i.match(new RegExp("-{0,1}[0-9]+[\\.][0-9]*"))),i+="",-1!=i.indexOf("-")&&(i=i.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*"))),i+="",i=i.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*")),(""===i||"-"==i||null===i)&&(i=b.defaultValue),i=1===c?a.fn.jStepper.AddOrSubtractTwoFloats(i,g,!0):a.fn.jStepper.AddOrSubtractTwoFloats(i,g,!1);var l=!1;if(null!==b.maxValue&&i>=b.maxValue&&(i=b.maxValue,l=!0),null!==b.minValue&&i<=b.minValue&&(i=b.minValue,l=!0),i+="",null!==b.minLength){var m=i.length;-1!=i.indexOf(".")&&(m=i.indexOf("."));var n=!1;if(-1!=i.indexOf("-")&&(n=!0,i=i.replace(/-/,"")),m<b.minLength)for(var o=1;o<=b.minLength-m;o++)i="0"+i;n&&(i="-"+i)}i+="";var p;if(b.minDecimals>0){var q;-1!=i.indexOf(".")?(p=i.length-(i.indexOf(".")+1),p<b.minDecimals&&(q=b.minDecimals-p)):(q=b.minDecimals,i+=".");for(var r=1;q>=r;r++)i+="0"}return b.maxDecimals>0&&(p=0,-1!=i.indexOf(".")&&(p=i.length-(i.indexOf(".")+1),b.maxDecimals<p&&(i=i.substring(0,i.indexOf("."))+"."+i.substring(i.indexOf(".")+1,i.indexOf(".")+1+b.maxDecimals)))),b.allowDecimals||(i+="",i=i.replace(new RegExp("[\\.].+"),"")),i=i.replace(/\./,b.decimalSeparator),h.val(i),f.selectionStart=i.length-j,f.selectionEnd=i.length-k,d(b,f),b.onStep&&b.onStep(h,c,l),!1};return this},a.fn.jStepper.AddOrSubtractTwoFloats=function(a,b,c){var d=a.toString(),e=b.toString(),f="";if(d.indexOf(".")>-1||e.indexOf(".")>-1){-1==d.indexOf(".")&&(d+=".0"),-1==e.indexOf(".")&&(e+=".0");for(var g=d.substr(d.indexOf(".")+1),h=e.substr(e.indexOf(".")+1),i=d.substr(0,d.indexOf(".")),j=e.substr(0,e.indexOf(".")),k=!0;k;)g.length!==h.length?g.length<h.length?g+="0":h+="0":k=!1;for(var l=g.length,m=0;m<=g.length-1;m++)i+=g.substr(m,1),j+=h.substr(m,1);var n,o=Number(i),p=Number(j);n=c?o+p:o-p,f=n.toString();for(var q=0;q<l-f.length+1;q++)f="0"+f;f.length>=l&&(f=f.substring(0,f.length-l)+"."+f.substring(f.length-l))}else f=c?Number(a)+Number(b):Number(a)-Number(b);return Number(f)},a.fn.jStepper.defaults={maxValue:null,minValue:null,normalStep:1,shiftStep:5,ctrlStep:10,minLength:null,disableAutocomplete:!0,defaultValue:1,decimalSeparator:",",allowDecimals:!0,minDecimals:0,maxDecimals:null,disableNonNumeric:!0,onStep:null}}(jQuery);

/* == jquery mousewheel plugin == Version: 3.1.12, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});

/* == malihu jquery custom scrollbar plugin == Version: 3.0.8, License: MIT License (MIT) */
!function(e){"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,n="https:"==document.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";o||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E"))),t()}(function(){var t,o="mCustomScrollbar",a="mCS",n=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if("off"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),"once"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null});var n=o.data(a),i=n.opt,l=o.data("mcs-axis"),s=o.data("mcs-scrollbar-position"),c=o.data("mcs-theme");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),e("#mCSB_"+n.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container"),l=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];if(!r.length)return;n.tweenRunning&&V(t),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),S.call(this),_.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",x(r.children())),n.overflowed=B.call(this),O.call(this),i.autoDraggerLength&&b.call(this),C.call(this),k.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(n.overflowed[0]?l[0].height()>l[0].parent().height()?T.call(this):(Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),n.contentReset.y=null):(T.call(this),"y"===i.axis?M.call(this):"yx"===i.axis&&n.overflowed[1]&&Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(n.overflowed[1]?l[1].width()>l[1].parent().width()?T.call(this):(Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),n.contentReset.x=null):(T.call(this),"x"===i.axis?M.call(this):"yx"===i.axis&&n.overflowed[0]&&Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),X.call(this)}})},scrollTo:function(t,o){if("undefined"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=j.call(this,c[0],"y"),c[1]=j.call(this,c[1],"x"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&i.overflowed[0]&&(s.dir="y",s.overwrite="all",Q(n,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&i.overflowed[1]&&(s.dir="x",s.overwrite="none",Q(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&V(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){{o.data(a)}X.call(this,"remove"),M.call(this),t&&T.call(this),O.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx),s=e("#mCSB_"+i.idx+"_container"),c=e(".mCSB_"+i.idx+"_scrollbar");r.live&&m(r.liveSelector||e(t).selector),X.call(this,"remove"),M.call(this),T.call(this),n.removeData(a),Z(this,"mcs"),c.remove(),s.find("img."+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+" _"+a+"_"+i.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},f=function(){return"object"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),Z(l,e))},p=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},g=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+n.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+n.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===i.axis?l[0]+l[1]:"x"===i.axis?l[1]:l[0],u="yx"===i.axis?"<div id='mCSB_"+n.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",f=i.autoHideScrollbar?" "+d[6]:"",h="x"!==i.axis&&"rtl"===n.langDir?" "+d[7]:"";i.setWidth&&t.css("width",i.setWidth),i.setHeight&&t.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===n.langDir?"989999px":i.setLeft,t.addClass(o+" _"+a+"_"+n.idx+f+h).wrapInner("<div id='mCSB_"+n.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+s+"'><div id='mCSB_"+n.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir="+n.langDir+" /></div>");var m=e("#mCSB_"+n.idx),p=e("#mCSB_"+n.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css("width",x(p.children())),"outside"===i.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(u)),w.call(this);var g=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},x=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(!0)}).get())},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx+"_container");n.advanced.autoExpandHorizontalScroll&&"y"!==n.axis&&i.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),position:"relative"}).unwrap()},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(".mCSB_"+o.idx+"_scrollbar:first"),r=tt(n.scrollButtons.tabindex)?"tabindex='"+n.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+d[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[16]+"' oncontextmenu='return false;' "+r+" />"],s=["x"===n.axis?l[2]:l[0],"x"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=t.css("max-height")||"none",r=-1!==i.indexOf("%"),l=t.css("box-sizing");if("none"!==i){var s=r?t.parent().height()*parseInt(i)/100:parseInt(i);"border-box"===l&&(s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())),n.css("max-height",Math.round(s))}},b=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},C=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},y=function(e,t,o){var a=o?d[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(d[0]+" "+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},B=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1);return[r>n.height(),l>n.width()]},T=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx),r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(V(t),("x"!==n.axis&&!o.overflowed[0]||"y"===n.axis&&o.overflowed[0])&&(l[0].add(r).css("top",0),Q(t,"_resetY")),"y"!==n.axis&&!o.overflowed[1]||"x"===n.axis&&o.overflowed[1]){var s=dx=0;"rtl"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),Q(t,"_resetX")}},k=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(R.call(this),i.contentTouchScroll&&E.call(this),D.call(this),i.mouseWheel.enable){var r;t()}P.call(this),H.call(this),i.advanced.autoScrollOnFocus&&z.call(this),i.scrollButtons.enable&&U.call(this),i.keyboard.enable&&q.call(this),n.bindEvents=!0}},M=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",l=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),o.bindEvents&&(e(document).unbind("."+i),l.each(function(){e(this).unbind("."+i)}),clearTimeout(t[0]._focusTimeout),Z(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),Z(o.sequential,"step"),clearTimeout(s[0].onCompleteTimeout),Z(s[0],"onCompleteTimeout"),o.bindEvents=!1)},O=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+n.idx+"_container"),s=[e("#mCSB_"+n.idx+"_scrollbar_vertical"),e("#mCSB_"+n.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(d[8]+" "+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(d[10])):(s[0].css("display","none"),l.addClass(d[10])),l.addClass(d[8]))),"y"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(d[9]+" "+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(d[11])):(s[1].css("display","none"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},I=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return e.target.ownerDocument!==document?[e.originalEvent.screenY,e.originalEvent.screenX,!1]:[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var o=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],a=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[o.screenY,o.screenX,a>1]:[o.pageY,o.pageX,a>1];default:return[e.pageY,e.pageX,!1]}},R=function(){function t(e){var t=m.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}}function o(e,t,o,a){if(m[0].idleTimer=u.scrollInertia<233?250:0,n.attr("id")===h[1])var i="x",r=(n[0].offsetLeft-t+a)*d.scrollRatio.x;else var i="y",r=(n[0].offsetTop-e+o)*d.scrollRatio.y;Q(l,r.toString(),{dir:i,drag:!0})}var n,i,r,l=e(this),d=l.data(a),u=d.opt,f=a+"_"+d.idx,h=["mCSB_"+d.idx+"_dragger_vertical","mCSB_"+d.idx+"_dragger_horizontal"],m=e("#mCSB_"+d.idx+"_container"),p=e("#"+h[0]+",#"+h[1]),g=u.advanced.releaseDraggableSelectors?p.add(e(u.advanced.releaseDraggableSelectors)):p;p.bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),$(o)){c=!0,s&&(document.onselectstart=function(){return!1}),t(!1),V(l),n=e(this);var a=n.offset(),d=I(o)[0]-a.top,f=I(o)[1]-a.left,h=n.height()+a.top,m=n.width()+a.left;h>d&&d>0&&m>f&&f>0&&(i=d,r=f),y(n,"active",u.autoExpandScrollbar)}}).bind("touchmove."+f,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=I(e)[0]-t.top,l=I(e)[1]-t.left;o(i,r,a,l)}),e(document).bind("mousemove."+f+" pointermove."+f+" MSPointerMove."+f,function(e){if(n){var t=n.offset(),a=I(e)[0]-t.top,l=I(e)[1]-t.left;if(i===a)return;o(i,r,a,l)}}).add(g).bind("mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f,function(){n&&(y(n,"active",u.autoExpandScrollbar),n=null),c=!1,s&&(document.onselectstart=null),t(!0)})},E=function(){function o(e){if(!et(e)||c||I(e)[2])return void(t=0);t=1,S=0,b=0;var o=M.offset();d=I(e)[0]-o.top,u=I(e)[1]-o.left,A=[I(e)[0],I(e)[1]]}function n(e){if(et(e)&&!c&&!I(e)[2]&&(e.stopImmediatePropagation(),!b||S)){p=J();var t=k.offset(),o=I(e)[0]-t.top,a=I(e)[1]-t.left,n="mcsLinearOut";if(R.push(o),E.push(a),A[2]=Math.abs(I(e)[0]-A[0]),A[3]=Math.abs(I(e)[1]-A[1]),y.overflowed[0])var i=O[0].parent().height()-O[0].height(),r=d-o>0&&o-d>-(i*y.scrollRatio.y)&&(2*A[3]<A[2]||"yx"===B.axis);if(y.overflowed[1])var l=O[1].parent().width()-O[1].width(),f=u-a>0&&a-u>-(l*y.scrollRatio.x)&&(2*A[2]<A[3]||"yx"===B.axis);r||f?(e.preventDefault(),S=1):b=1,_="yx"===B.axis?[d-o,u-a]:"x"===B.axis?[null,u-a]:[d-o,null],M[0].idleTimer=250,y.overflowed[0]&&s(_[0],D,n,"y","all",!0),y.overflowed[1]&&s(_[1],D,n,"x",W,!0)}}function i(e){if(!et(e)||c||I(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),V(C),m=J();var o=k.offset();f=I(e)[0]-o.top,h=I(e)[1]-o.left,R=[],E=[]}function r(e){if(et(e)&&!c&&!I(e)[2]){e.stopImmediatePropagation(),S=0,b=0,g=J();var t=k.offset(),o=I(e)[0]-t.top,a=I(e)[1]-t.left;if(!(g-p>30)){x=1e3/(g-m);var n="mcsEaseOut",i=2.5>x,r=i?[R[R.length-2],E[E.length-2]]:[0,0];v=i?[o-r[0],a-r[1]]:[o-f,a-h];var d=[Math.abs(v[0]),Math.abs(v[1])];x=i?[Math.abs(v[0]/4),Math.abs(v[1]/4)]:[x,x];var u=[Math.abs(M[0].offsetTop)-v[0]*l(d[0]/x[0],x[0]),Math.abs(M[0].offsetLeft)-v[1]*l(d[1]/x[1],x[1])];_="yx"===B.axis?[u[0],u[1]]:"x"===B.axis?[null,u[1]]:[u[0],null],w=[4*d[0]+B.scrollInertia,4*d[1]+B.scrollInertia];var C=parseInt(B.contentTouchScroll)||0;_[0]=d[0]>C?_[0]:0,_[1]=d[1]>C?_[1]:0,y.overflowed[0]&&s(_[0],w[0],n,"y",W,!1),y.overflowed[1]&&s(_[1],w[1],n,"x",W,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&Q(C,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C=e(this),y=C.data(a),B=y.opt,T=a+"_"+y.idx,k=e("#mCSB_"+y.idx),M=e("#mCSB_"+y.idx+"_container"),O=[e("#mCSB_"+y.idx+"_dragger_vertical"),e("#mCSB_"+y.idx+"_dragger_horizontal")],R=[],E=[],D=0,W="yx"===B.axis?"none":"all",A=[],P=M.find("iframe"),z=["touchstart."+T+" pointerdown."+T+" MSPointerDown."+T,"touchmove."+T+" pointermove."+T+" MSPointerMove."+T,"touchend."+T+" pointerup."+T+" MSPointerUp."+T];M.bind(z[0],function(e){o(e)}).bind(z[1],function(e){n(e)}),k.bind(z[0],function(e){i(e)}).bind(z[2],function(e){r(e)}),P.length&&P.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind(z[0],function(e){o(e),i(e)}).bind(z[1],function(e){n(e)}).bind(z[2],function(e){r(e)})})})},D=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?"stepped":"stepless",d.scrollAmount=10,F(r,e,t,"mcsLinearOut",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+"_"+l.idx,f=e("#mCSB_"+l.idx+"_container"),h=f.parent();f.bind("mousedown."+u,function(){t||i||(i=1,c=!0)}).add(document).bind("mousemove."+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=I(e)[0]-a.top+f[0].offsetTop,c=I(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n("off",null,"stepped"):("x"!==s.axis&&l.overflowed[0]&&(0>r?n("on",38):r>h.height()&&n("on",40)),"y"!==s.axis&&l.overflowed[1]&&(0>c?n("on",37):c>h.width()&&n("on",39)))}}).bind("mouseup."+u,function(){t||(i&&(i=0,n("off",null)),c=!1)})},W=function(){function t(t,a){if(V(o),!A(o,t.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100;if("x"===i.axis||"x"===i.mouseWheel.axis)var d="x",u=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],f="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetLeft),m=c[1][0].offsetLeft,p=c[1].parent().width()-c[1].width(),g=t.deltaX||t.deltaY||a;else var d="y",u=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],f="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetTop),m=c[0][0].offsetTop,p=c[0].parent().height()-c[0].height(),g=t.deltaY||a;"y"===d&&!n.overflowed[0]||"x"===d&&!n.overflowed[1]||(i.mouseWheel.invert&&(g=-g),i.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),Q(o,(h-g*f).toString(),{dir:d}))}}var o=e(this),n=o.data(a),i=n.opt,r=a+"_"+n.idx,l=e("#mCSB_"+n.idx),c=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")],d=e("#mCSB_"+n.idx+"_container").find("iframe");n&&(d.length&&d.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,o){t(e,o)})})}),l.bind("mousewheel."+r,function(e,o){t(e,o)}))},L=function(e){var t=null;try{var o=e.contentDocument||e.contentWindow.document;t=o.body.innerHTML}catch(a){}return null!==t},A=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(":focus"))},P=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container"),r=i.parent(),l=e(".mCSB_"+o.idx+"_scrollbar ."+d[12]);l.bind("touchstart."+n+" pointerdown."+n+" MSPointerDown."+n,function(){c=!0}).bind("touchend."+n+" pointerup."+n+" MSPointerUp."+n,function(){c=!1}).bind("click."+n,function(a){if(e(a.target).hasClass(d[12])||e(a.target).hasClass("mCSB_draggerRail")){V(t);var n=e(this),l=n.find(".mCSB_dragger");if(n.parent(".mCSB_scrollTools_horizontal").length>0){if(!o.overflowed[1])return;var s="x",c=a.pageX>l.offset().left?-1:1,u=Math.abs(i[0].offsetLeft)-.9*c*r.width()}else{if(!o.overflowed[0])return;var s="y",c=a.pageY>l.offset().top?-1:1,u=Math.abs(i[0].offsetTop)-.9*c*r.height()}Q(t,u.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},z=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),l=r.parent();r.bind("focusin."+i,function(){var o=e(document.activeElement),a=r.find(".mCustomScrollBox").length,i=0;o.is(n.advanced.autoScrollOnFocus)&&(V(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=a?(i+17)*a:0,t[0]._focusTimeout=setTimeout(function(){var e=[ot(o)[0],ot(o)[1]],a=[r[0].offsetTop,r[0].offsetLeft],s=[a[0]+e[0]>=0&&a[0]+e[0]<l.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<l.width()-o.outerWidth(!1)],c="yx"!==n.axis||s[0]||s[1]?"all":"none";"x"===n.axis||s[0]||Q(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i}),"y"===n.axis||s[1]||Q(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i})},t[0]._focusTimer))})},H=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container").parent();i.bind("scroll."+n,function(){(0!==i.scrollTop()||0!==i.scrollLeft())&&e(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},U=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e(l+">a");s.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,o){i.scrollAmount=n.snapAmount||n.scrollButtons.scrollAmount,F(t,e,o)}if(a.preventDefault(),$(a)){var l=e(this).attr("class");switch(i.type=n.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;c=!0,o.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;c=!1,i.dir&&r("off",l);break;case"click":if("stepped"!==i.type||o.tweenRunning)return;r("on",l)}}})},q=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.snapAmount||i.keyboard.scrollAmount,"stepped"===r.type&&n.tweenRunning||F(o,e,t)}switch(t.type){case"blur":n.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var l=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===l||40===l)||"y"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;"keyup"===t.type&&(s="off"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type){V(o);var f=34===l?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=Math.abs(c[0].offsetLeft)-.9*f*d.width();else var h="y",m=Math.abs(c[0].offsetTop)-.9*f*d.height();Q(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type)){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h="y",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;Q(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+"_"+n.idx,s=e("#mCSB_"+n.idx),c=e("#mCSB_"+n.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",f=c.find("iframe"),h=["blur."+l+" keydown."+l+" keyup."+l];f.length&&f.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr("tabindex","0").bind(h[0],function(e){t(e)})},F=function(t,o,n,i,r){function l(e){var o="stepped"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],u="x"===f.dir[0]?s[1]+f.dir[1]*d[1]*n:s[0]+f.dir[1]*d[0]*n,m="x"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),v="auto"!==f.scrollAmount?m:u,x=i?i:e?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",_=e?!0:!1;return e&&17>a&&(v="x"===f.dir[0]?s[1]:s[0]),Q(t,v.toString(),{dir:f.dir[0],scrollEasing:x,dur:a,onComplete:_}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),Z(f,"step"),V(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===f.type?!0:!1,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case"on":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?"x":"y",n===d[13]||n===d[15]||38===n||37===n?-1:1],V(t),tt(n)&&"stepped"===f.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return"function"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:"x"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||"x"===o.axis?null:t,n[1]=t.x?t.x:t.y||"y"===o.axis?null:t),"function"==typeof n[0]&&(n[0]=n[0]()),"function"==typeof n[1]&&(n[1]=n[1]()),n},j=function(t,o){if(null!=t&&"undefined"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx+"_container"),s=l.parent(),c=typeof t;o||(o="x"===r.axis?"x":"y");var d="x"===o?l.outerWidth(!1):l.outerHeight(!1),f="x"===o?l[0].offsetLeft:l[0].offsetTop,h="x"===o?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===o?ot(m)[1]:ot(m)[0];case"string":case"number":if(tt(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(f-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=f+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&tt(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===o?ot(m)[1]:ot(m)[0]}return e(t).length?"x"===o?ot(e(t))[1]:ot(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},X=function(t){function o(){clearTimeout(h[0].autoUpdate),h[0].autoUpdate=setTimeout(function(){return f.advanced.updateOnSelectorChange&&(m=r(),m!==w)?(l(3),void(w=m)):(f.advanced.updateOnContentResize&&(p=[h.outerHeight(!1),h.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],(p[0]!==S[0]||p[1]!==S[1]||p[2]!==S[2]||p[3]!==S[3]||p[4]!==S[4]||p[5]!==S[5])&&(l(p[0]!==S[0]||p[1]!==S[1]),S=p)),f.advanced.updateOnImageLoad&&(g=n(),g!==b&&(h.find("img").each(function(){i(this)}),b=g)),void((f.advanced.updateOnSelectorChange||f.advanced.updateOnContentResize||f.advanced.updateOnImageLoad)&&o()))},60)}function n(){var e=0;return f.advanced.updateOnImageLoad&&(e=h.find("img").length),e}function i(t){function o(e,t){return function(){return t.apply(e,arguments)}}function a(){this.onload=null,e(t).addClass(d[2]),l(2)}if(e(t).hasClass(d[2]))return void l();var n=new Image;n.onload=o(n,a),n.src=t.src}function r(){f.advanced.updateOnSelectorChange===!0&&(f.advanced.updateOnSelectorChange="*");var t=0,o=h.find(f.advanced.updateOnSelectorChange);return f.advanced.updateOnSelectorChange&&o.length>0&&o.each(function(){t+=e(this).height()+e(this).width()}),t}function l(e){clearTimeout(h[0].autoUpdate),u.update.call(null,s[0],e)}var s=e(this),c=s.data(a),f=c.opt,h=e("#mCSB_"+c.idx+"_container");if(t)return clearTimeout(h[0].autoUpdate),void Z(h[0],"autoUpdate");var m,p,g,v=h.parent(),x=[e("#mCSB_"+c.idx+"_scrollbar_vertical"),e("#mCSB_"+c.idx+"_scrollbar_horizontal")],_=function(){return[x[0].is(":visible")?x[0].outerHeight(!0):0,x[1].is(":visible")?x[1].outerWidth(!0):0]},w=r(),S=[h.outerHeight(!1),h.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],b=n();o()},N=function(e,t,o){return Math.round(e/t)*t-o},V=function(t){var o=t.data(a),n=e("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");n.each(function(){K.call(this)})},Q=function(t,o,n){function i(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||_>=w[0]+b,c.callbacks.alwaysTriggerOffsets||-C>=_]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[v[0].offsetTop,v[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];
if(s.trigger=n.trigger,(0!==m.scrollTop()||0!==m.scrollLeft())&&(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==o||s.contentReset.y||(i("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==o||s.contentReset.x||(i("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){switch(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount&&(o=N(o,c.snapAmount,c.snapOffset)),n.dir){case"x":var v=e("#mCSB_"+s.idx+"_dragger_horizontal"),x="left",_=h[0].offsetLeft,w=[f.width()-h.outerWidth(!1),v.parent().width()-v.width()],S=[o,0===o?0:o/s.scrollRatio.x],b=p[1],C=g[1],B=b>0?b/s.scrollRatio.x:0,T=C>0?C/s.scrollRatio.x:0;break;case"y":var v=e("#mCSB_"+s.idx+"_dragger_vertical"),x="top",_=h[0].offsetTop,w=[f.height()-h.outerHeight(!1),v.parent().height()-v.height()],S=[o,0===o?0:o/s.scrollRatio.y],b=p[0],C=g[0],B=b>0?b/s.scrollRatio.y:0,T=C>0?C/s.scrollRatio.y:0}S[1]<0||0===S[0]&&0===S[1]?S=[0,0]:S[1]>=w[1]?S=[w[0],w[1]]:S[0]=-S[0],t[0].mcs||(l(),i("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),(s.tweenRunning||!(0===_&&S[0]>=0||_===w[0]&&S[0]<=w[0]))&&(G(v[0],x,Math.round(S[1]),u[1],n.scrollEasing),G(h[0],x,Math.round(S[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,y(v),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),i("onTotalScroll")&&S[1]>=w[1]-B&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i("onTotalScrollBack")&&S[1]<=T&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,y(v,"hide")},e)}}}))}},G=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=J()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+"px"):w[t]=o+"px",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=J(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];"left"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,"none"!==i&&d(),c()},J=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},K=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},Z=function(e,t){try{delete e[t]}catch(o){e[t]=null}},$=function(e){return!(e.which&&1!==e.which)},et=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},tt=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ot=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).load(function(){e(n)[o](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(".mCSB_container");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+ot(n)[0]>=0&&a[0]+ot(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+ot(n)[1]>=0&&a[1]+ot(n)[1]<o.width()-n.outerWidth(!1)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});

/**
* autoNumeric.js
* @author: Bob Knothe
* @author: Sokolov Yura aka funny_falcon
* @version: 1.9.17 - 2013-12-03 GMT 9:00 PM
*
* Created by Robert J. Knothe on 2010-10-25. Please report any bugs to https://github.com/BobKnothe/autoNumeric
* Created by Sokolov Yura on 2010-11-07
*
* Copyright (c) 2011 Robert J. Knothe http://www.decorplanit.com/plugin/
*/

!function(e){"use strict";function t(e){var t={};if(void 0===e.selectionStart){e.focus();var a=document.selection.createRange();t.length=a.text.length,a.moveStart("character",-e.value.length),t.end=a.text.length,t.start=t.end-t.length}else t.start=e.selectionStart,t.end=e.selectionEnd,t.length=t.end-t.start;return t}function a(e,t,a){if(void 0===e.selectionStart){e.focus();var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",a),n.moveStart("character",t),n.select()}else e.selectionStart=t,e.selectionEnd=a}function n(t,a){e.each(a,function(e,n){"function"==typeof n?a[e]=n(t,a,e):"function"==typeof t.autoNumeric[n]&&(a[e]=t.autoNumeric[n](t,a,e))})}function i(e,t){"string"==typeof e[t]&&(e[t]*=1)}function r(e,t){n(e,t),t.oEvent=null,t.tagList=["B","CAPTION","CITE","CODE","DD","DEL","DIV","DFN","DT","EM","H1","H2","H3","H4","H5","H6","INS","KDB","LABEL","LI","OUTPUT","P","Q","S","SAMPLE","SPAN","STRONG","TD","TH","U","VAR"];var a=t.vMax.toString().split("."),r=t.vMin||0===t.vMin?t.vMin.toString().split("."):[];if(i(t,"vMax"),i(t,"vMin"),i(t,"mDec"),t.allowLeading=!0,t.aNeg=t.vMin<0?"-":"",a[0]=a[0].replace("-",""),r[0]=r[0].replace("-",""),t.mInt=Math.max(a[0].length,r[0].length,1),null===t.mDec){var o=0,s=0;a[1]&&(o=a[1].length),r[1]&&(s=r[1].length),t.mDec=Math.max(o,s)}null===t.altDec&&t.mDec>0&&("."===t.aDec&&","!==t.aSep?t.altDec=",":","===t.aDec&&"."!==t.aSep&&(t.altDec="."));var u=t.aNeg?"([-\\"+t.aNeg+"]?)":"(-?)";t.aNegRegAutoStrip=u,t.skipFirstAutoStrip=new RegExp(u+"[^-"+(t.aNeg?"\\"+t.aNeg:"")+"\\"+t.aDec+"\\d].*?(\\d|\\"+t.aDec+"\\d)"),t.skipLastAutoStrip=new RegExp("(\\d\\"+t.aDec+"?)[^\\"+t.aDec+"\\d]\\D*$");var c="-"+t.aNum+"\\"+t.aDec;return t.allowedAutoStrip=new RegExp("[^"+c+"]","gi"),t.numRegAutoStrip=new RegExp(u+"(?:\\"+t.aDec+"?(\\d+\\"+t.aDec+"\\d+)|(\\d*(?:\\"+t.aDec+"\\d*)?))"),t}function o(e,t,a){if(t.aSign)for(;e.indexOf(t.aSign)>-1;)e=e.replace(t.aSign,"");e=e.replace(t.skipFirstAutoStrip,"$1$2"),e=e.replace(t.skipLastAutoStrip,"$1"),e=e.replace(t.allowedAutoStrip,""),t.altDec&&(e=e.replace(t.altDec,t.aDec));var n=e.match(t.numRegAutoStrip);if(e=n?[n[1],n[2],n[3]].join(""):"",("allow"===t.lZero||"keep"===t.lZero)&&"strip"!==a){var i=[],r="";i=e.split(t.aDec),-1!==i[0].indexOf("-")&&(r="-",i[0]=i[0].replace("-","")),i[0].length>t.mInt&&"0"===i[0].charAt(0)&&(i[0]=i[0].slice(1)),e=r+i.join(t.aDec)}if(a&&"deny"===t.lZero||a&&"allow"===t.lZero&&t.allowLeading===!1){var o="^"+t.aNegRegAutoStrip+"0*(\\d"+("leading"===a?")":"|$)");o=new RegExp(o),e=e.replace(o,"$1$2")}return e}function s(e,t,a){return t=t.split(","),"set"===a||"focusout"===a?(e=e.replace("-",""),e=t[0]+e+t[1]):"get"!==a&&"focusin"!==a&&"pageLoad"!==a||e.charAt(0)!==t[0]||(e=e.replace(t[0],"-"),e=e.replace(t[1],"")),e}function u(e,t,a){if(t&&a){var n=e.split(t);n[1]&&n[1].length>a&&(a>0?(n[1]=n[1].substring(0,a),e=n.join(t)):e=n[0])}return e}function c(e,t,a){return t&&"."!==t&&(e=e.replace(t,".")),a&&"-"!==a&&(e=e.replace(a,"-")),e.match(/\d/)||(e+="0"),e}function l(e,t){var a=e.indexOf("."),n=+e;if(-1!==a)if(1e-6>n&&n>-1)e=+e,1e-6>e&&e>0&&(e=(e+10).toString(),e=e.substring(1)),0>e&&e>-1&&(e=(e-10).toString(),e="-"+e.substring(2)),e=e.toString();else{var i=e.split(".");void 0!==i[1]&&(0===+i[1]?e=i[0]:(i[1]=i[1].replace(/0*$/,""),e=i.join(".")))}return"keep"===t.lZero?e:e.replace(/^0*(\d)/,"$1")}function h(e,t,a){return a&&"-"!==a&&(e=e.replace("-",a)),t&&"."!==t&&(e=e.replace(".",t)),e}function p(t,a){t=o(t,a),t=u(t,a.aDec,a.mDec),t=c(t,a.aDec,a.aNeg);var n=+t;return"set"===a.oEvent&&(n<a.vMin||n>a.vMax)&&e.error("The value ("+n+") from the 'set' method falls outside of the vMin / vMax range"),n>=a.vMin&&n<=a.vMax}function g(e,t,a){return""===e||e===t.aNeg?"zero"===t.wEmpty?e+"0":"sign"===t.wEmpty||a?e+t.aSign:e:null}function d(e,t){e=o(e,t);var a=e.replace(",","."),n=g(e,t,!0);if(null!==n)return n;var i="";i=2===t.dGroup?/(\d)((\d)(\d{2}?)+)$/:4===t.dGroup?/(\d)((\d{4}?)+)$/:/(\d)((\d{3}?)+)$/;var r=e.split(t.aDec);t.altDec&&1===r.length&&(r=e.split(t.altDec));var u=r[0];if(t.aSep)for(;i.test(u);)u=u.replace(i,"$1"+t.aSep+"$2");if(0!==t.mDec&&r.length>1?(r[1].length>t.mDec&&(r[1]=r[1].substring(0,t.mDec)),e=u+t.aDec+r[1]):e=u,t.aSign){var c=-1!==e.indexOf(t.aNeg);e=e.replace(t.aNeg,""),e="p"===t.pSign?t.aSign+e:e+t.aSign,c&&(e=t.aNeg+e)}return"set"===t.oEvent&&0>a&&null!==t.nBracket&&(e=s(e,t.nBracket,t.oEvent)),e}function f(e,t){e=""===e?"0":e.toString(),i(t,"mDec");var a="",n=0,r="",o="boolean"==typeof t.aPad||null===t.aPad?t.aPad?t.mDec:0:+t.aPad,s=function(e){var t=0===o?/(\.[1-9]*)0*$/:1===o?/(\.\d[1-9]*)0*$/:new RegExp("(\\.\\d{"+o+"}[1-9]*)0*$");return e=e.replace(t,"$1"),0===o&&(e=e.replace(/\.$/,"")),e};"-"===e.charAt(0)&&(r="-",e=e.replace("-","")),e.match(/^\d/)||(e="0"+e),"-"===r&&0===+e&&(r=""),(+e>0&&"keep"!==t.lZero||e.length>0&&"allow"===t.lZero)&&(e=e.replace(/^0*(\d)/,"$1"));var u=e.lastIndexOf("."),c=-1===u?e.length-1:u,l=e.length-1-c;if(l<=t.mDec){if(a=e,o>l)for(-1===u&&(a+=".");o>l;){var h="000000".substring(0,o-l);a+=h,l+=h.length}else l>o?a=s(a):0===l&&0===o&&(a=a.replace(/\.$/,""));return r+a}var p=u+t.mDec,g=+e.charAt(p+1),d=e.substring(0,p+1).split(""),f="."===e.charAt(p)?e.charAt(p-1)%2:e.charAt(p)%2;if(g>4&&"S"===t.mRound||g>4&&"A"===t.mRound&&""===r||g>5&&"A"===t.mRound&&"-"===r||g>5&&"s"===t.mRound||g>5&&"a"===t.mRound&&""===r||g>4&&"a"===t.mRound&&"-"===r||g>5&&"B"===t.mRound||5===g&&"B"===t.mRound&&1===f||g>0&&"C"===t.mRound&&""===r||g>0&&"F"===t.mRound&&"-"===r||g>0&&"U"===t.mRound)for(n=d.length-1;n>=0;n-=1)if("."!==d[n]){if(d[n]=+d[n]+1,d[n]<10)break;n>0&&(d[n]="0")}return d=d.slice(0,p+1),a=s(d.join("")),0===+a?a:r+a}function v(t,a){this.settings=a,this.that=t,this.$that=e(t),this.formatted=!1,this.settingsClone=r(this.$that,this.settings),this.value=t.value}function m(t){return"string"==typeof t&&(t=t.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),t="#"+t.replace(/(:|\.)/g,"\\$1")),e(t)}function y(e,t,a){var n=e.data("autoNumeric");n||(n={},e.data("autoNumeric",n));var i=n.holder;return(void 0===i&&t||a)&&(i=new v(e.get(0),t),n.holder=i),i}v.prototype={init:function(e){this.value=this.that.value,this.settingsClone=r(this.$that,this.settings),this.ctrlKey=e.ctrlKey,this.cmdKey=e.metaKey,this.shiftKey=e.shiftKey,this.selection=t(this.that),("keydown"===e.type||"keyup"===e.type)&&(this.kdCode=e.keyCode),this.which=e.which,this.processed=!1,this.formatted=!1},setSelection:function(e,t,n){e=Math.max(e,0),t=Math.min(t,this.that.value.length),this.selection={start:e,end:t,length:t-e},(void 0===n||n)&&a(this.that,e,t)},setPosition:function(e,t){this.setSelection(e,e,t)},getBeforeAfter:function(){var e=this.value,t=e.substring(0,this.selection.start),a=e.substring(this.selection.end,e.length);return[t,a]},getBeforeAfterStriped:function(){var e=this.getBeforeAfter();return e[0]=o(e[0],this.settingsClone),e[1]=o(e[1],this.settingsClone),e},normalizeParts:function(e,t){var a=this.settingsClone;t=o(t,a);var n=t.match(/^\d/)?!0:"leading";e=o(e,a,n),""!==e&&e!==a.aNeg||"deny"!==a.lZero||t>""&&(t=t.replace(/^0*(\d)/,"$1"));var i=e+t;if(a.aDec){var r=i.match(new RegExp("^"+a.aNegRegAutoStrip+"\\"+a.aDec));r&&(e=e.replace(r[1],r[1]+"0"),i=e+t)}return"zero"!==a.wEmpty||i!==a.aNeg&&""!==i||(e+="0"),[e,t]},setValueParts:function(e,t){var a=this.settingsClone,n=this.normalizeParts(e,t),i=n.join(""),r=n[0].length;return p(i,a)?(i=u(i,a.aDec,a.mDec),r>i.length&&(r=i.length),this.value=i,this.setPosition(r,!1),!0):!1},signPosition:function(){var e=this.settingsClone,t=e.aSign,a=this.that;if(t){var n=t.length;if("p"===e.pSign){var i=e.aNeg&&a.value&&a.value.charAt(0)===e.aNeg;return i?[1,n+1]:[0,n]}var r=a.value.length;return[r-n,r]}return[1e3,-1]},expandSelectionOnSign:function(e){var t=this.signPosition(),a=this.selection;a.start<t[1]&&a.end>t[0]&&((a.start<t[0]||a.end>t[1])&&this.value.substring(Math.max(a.start,t[0]),Math.min(a.end,t[1])).match(/^\s*$/)?a.start<t[0]?this.setSelection(a.start,t[0],e):this.setSelection(t[1],a.end,e):this.setSelection(Math.min(a.start,t[0]),Math.max(a.end,t[1]),e))},checkPaste:function(){if(void 0!==this.valuePartsBeforePaste){var e=this.getBeforeAfter(),t=this.valuePartsBeforePaste;delete this.valuePartsBeforePaste,e[0]=e[0].substr(0,t[0].length)+o(e[0].substr(t[0].length),this.settingsClone),this.setValueParts(e[0],e[1])||(this.value=t.join(""),this.setPosition(t[0].length,!1))}},skipAllways:function(e){var t=this.kdCode,a=this.which,n=this.ctrlKey,i=this.cmdKey,r=this.shiftKey;if((n||i)&&"keyup"===e.type&&void 0!==this.valuePartsBeforePaste||r&&45===t)return this.checkPaste(),!1;if(t>=112&&123>=t||t>=91&&93>=t||t>=9&&31>=t||8>t&&(0===a||a===t)||144===t||145===t||45===t)return!0;if((n||i)&&65===t)return!0;if((n||i)&&(67===t||86===t||88===t))return"keydown"===e.type&&this.expandSelectionOnSign(),(86===t||45===t)&&("keydown"===e.type||"keypress"===e.type?void 0===this.valuePartsBeforePaste&&(this.valuePartsBeforePaste=this.getBeforeAfter()):this.checkPaste()),"keydown"===e.type||"keypress"===e.type||67===t;if(n||i)return!0;if(37===t||39===t){var o=this.settingsClone.aSep,s=this.selection.start,u=this.that.value;return"keydown"===e.type&&o&&!this.shiftKey&&(37===t&&u.charAt(s-2)===o?this.setPosition(s-1):39===t&&u.charAt(s+1)===o&&this.setPosition(s+1)),!0}return t>=34&&40>=t?!0:!1},processAllways:function(){var e;return 8===this.kdCode||46===this.kdCode?(this.selection.length?(this.expandSelectionOnSign(!1),e=this.getBeforeAfterStriped(),this.setValueParts(e[0],e[1])):(e=this.getBeforeAfterStriped(),8===this.kdCode?e[0]=e[0].substring(0,e[0].length-1):e[1]=e[1].substring(1,e[1].length),this.setValueParts(e[0],e[1])),!0):!1},processKeypress:function(){var e=this.settingsClone,t=String.fromCharCode(this.which),a=this.getBeforeAfterStriped(),n=a[0],i=a[1];return t===e.aDec||e.altDec&&t===e.altDec||("."===t||","===t)&&110===this.kdCode?e.mDec&&e.aDec?e.aNeg&&i.indexOf(e.aNeg)>-1?!0:n.indexOf(e.aDec)>-1?!0:i.indexOf(e.aDec)>0?!0:(0===i.indexOf(e.aDec)&&(i=i.substr(1)),this.setValueParts(n+e.aDec,i),!0):!0:"-"===t||"+"===t?e.aNeg?(""===n&&i.indexOf(e.aNeg)>-1&&(n=e.aNeg,i=i.substring(1,i.length)),n=n.charAt(0)===e.aNeg?n.substring(1,n.length):"-"===t?e.aNeg+n:n,this.setValueParts(n,i),!0):!0:t>="0"&&"9">=t?(e.aNeg&&""===n&&i.indexOf(e.aNeg)>-1&&(n=e.aNeg,i=i.substring(1,i.length)),e.vMax<=0&&e.vMin<e.vMax&&-1===this.value.indexOf(e.aNeg)&&"0"!==t&&(n=e.aNeg+n),this.setValueParts(n+t,i),!0):!0},formatQuick:function(){var e=this.settingsClone,t=this.getBeforeAfterStriped(),a=this.value;if((""===e.aSep||""!==e.aSep&&-1===a.indexOf(e.aSep))&&(""===e.aSign||""!==e.aSign&&-1===a.indexOf(e.aSign))){var n=[],i="";n=a.split(e.aDec),n[0].indexOf("-")>-1&&(i="-",n[0]=n[0].replace("-",""),t[0]=t[0].replace("-","")),n[0].length>e.mInt&&"0"===t[0].charAt(0)&&(t[0]=t[0].slice(1)),t[0]=i+t[0]}var r=d(this.value,this.settingsClone),o=r.length;if(r){var s=t[0].split(""),u=0;for(u;u<s.length;u+=1)s[u].match("\\d")||(s[u]="\\"+s[u]);var c=new RegExp("^.*?"+s.join(".*?")),l=r.match(c);l?(o=l[0].length,(0===o&&r.charAt(0)!==e.aNeg||1===o&&r.charAt(0)===e.aNeg)&&e.aSign&&"p"===e.pSign&&(o=this.settingsClone.aSign.length+("-"===r.charAt(0)?1:0))):e.aSign&&"s"===e.pSign&&(o-=e.aSign.length)}this.that.value=r,this.setPosition(o),this.formatted=!0}};var S={init:function(t){return this.each(function(){var n=e(this),i=n.data("autoNumeric"),r=n.data();if("object"==typeof i)return this;var u={aNum:"0123456789",aSep:",",dGroup:"3",aDec:".",altDec:null,aSign:"",pSign:"p",vMax:"999999999.99",vMin:"0.00",mDec:null,mRound:"S",aPad:!0,nBracket:null,wEmpty:"empty",lZero:"allow",aForm:!0,onSomeEvent:function(){}};if(i=e.extend({},u,r,t),i.aDec===i.aSep)return e.error("autoNumeric will not function properly when the decimal character aDec: '"+i.aDec+"' and thousand separator aSep: '"+i.aSep+"' are the same character"),this;n.data("autoNumeric",i),i.lastSetValue="",i.runOnce=!1;var l=y(n,i);if(-1===e.inArray(n.prop("tagName"),i.tagList)&&"INPUT"!==n.prop("tagName"))return e.error("The <"+n.prop("tagName")+"> is not supported by autoNumeric()"),this;if(i.runOnce===!1&&i.aForm){if(n.is("input[type=text], input[type=hidden], input:not([type])")){var v=!0;""===n[0].value&&"empty"===i.wEmpty&&(n[0].value="",v=!1),""===n[0].value&&"sign"===i.wEmpty&&(n[0].value=i.aSign,v=!1),v&&n.autoNumeric("set",n.val())}-1!==e.inArray(n.prop("tagName"),i.tagList)&&""!==n.text()&&n.autoNumeric("set",n.text())}i.runOnce=!0,n.is("input[type=text], input[type=hidden], input:not([type])")&&(n.on("keydown.autoNumeric",function(t){return l=y(n),l.settings.aDec===l.settings.aSep?(e.error("autoNumeric will not function properly when the decimal character aDec: '"+l.settings.aDec+"' and thousand separator aSep: '"+l.settings.aSep+"' are the same character"),this):l.that.readOnly?(l.processed=!0,!0):(l.init(t),l.settings.oEvent="keydown",l.skipAllways(t)?(l.processed=!0,!0):l.processAllways()?(l.processed=!0,l.formatQuick(),t.preventDefault(),!1):(l.formatted=!1,!0))}),n.on("keypress.autoNumeric",function(e){var t=y(n),a=t.processed;return t.init(e),t.settings.oEvent="keypress",t.skipAllways(e)?!0:a?(e.preventDefault(),!1):t.processAllways()||t.processKeypress()?(t.formatQuick(),e.preventDefault(),!1):void(t.formatted=!1)}),n.on("keyup.autoNumeric",function(e){var t=y(n);t.init(e),t.settings.oEvent="keyup";var i=t.skipAllways(e);return t.kdCode=0,delete t.valuePartsBeforePaste,n[0].value===t.settings.aSign&&("s"===t.settings.pSign?a(this,0,0):a(this,t.settings.aSign.length,t.settings.aSign.length)),i?!0:""===this.value?!0:void(t.formatted||t.formatQuick())}),n.on("focusin.autoNumeric",function(){var e=y(n);if(e.settingsClone.oEvent="focusin",null!==e.settingsClone.nBracket){var t=n.val();n.val(s(t,e.settingsClone.nBracket,e.settingsClone.oEvent))}e.inVal=n.val();var i=g(e.inVal,e.settingsClone,!0);null!==i&&(n.val(i),"s"===e.settings.pSign?a(this,0,0):a(this,e.settings.aSign.length,e.settings.aSign.length))}),n.on("focusout.autoNumeric",function(){var e=y(n),t=e.settingsClone,a=n.val(),i=a;e.settingsClone.oEvent="focusout";var r="";"allow"===t.lZero&&(t.allowLeading=!1,r="leading"),""!==a&&(a=o(a,t,r),null===g(a,t)&&p(a,t,n[0])?(a=c(a,t.aDec,t.aNeg),a=f(a,t),a=h(a,t.aDec,t.aNeg)):a="");var u=g(a,t,!1);null===u&&(u=d(a,t)),u!==i&&n.val(u),u!==e.inVal&&(n.change(),delete e.inVal),null!==t.nBracket&&n.autoNumeric("get")<0&&(e.settingsClone.oEvent="focusout",n.val(s(n.val(),t.nBracket,t.oEvent)))}))})},destroy:function(){return e(this).each(function(){var t=e(this);t.off(".autoNumeric"),t.removeData("autoNumeric")})},update:function(t){return e(this).each(function(){var a=m(e(this)),n=a.data("autoNumeric");if("object"!=typeof n)return e.error("You must initialize autoNumeric('init', {options}) prior to calling the 'update' method"),this;var i=a.autoNumeric("get");return n=e.extend(n,t),y(a,n,!0),n.aDec===n.aSep?(e.error("autoNumeric will not function properly when the decimal character aDec: '"+n.aDec+"' and thousand separator aSep: '"+n.aSep+"' are the same character"),this):(a.data("autoNumeric",n),""!==a.val()||""!==a.text()?a.autoNumeric("set",i):void 0)})},set:function(t){return e(this).each(function(){var a=m(e(this)),n=a.data("autoNumeric"),i=t.toString(),r=t.toString();return"object"!=typeof n?(e.error("You must initialize autoNumeric('init', {options}) prior to calling the 'set' method"),this):(r!==a.attr("value")&&r!==a.text()||n.runOnce!==!1||(i=i.replace(",",".")),r!==a.attr("value")&&"INPUT"===a.prop("tagName")&&n.runOnce===!1&&(i=o(i,n)),e.isNumeric(+i)?(i=l(i,n),n.oEvent="set",n.lastSetValue=i,i.toString(),""!==i&&(i=f(i,n)),i=h(i,n.aDec,n.aNeg),p(i,n)||(i=f("",n)),i=d(i,n),a.is("input[type=text], input[type=hidden], input:not([type])")?a.val(i):-1!==e.inArray(a.prop("tagName"),n.tagList)?a.text(i):(e.error("The <"+a.prop("tagName")+"> is not supported by autoNumeric()"),!1)):"")})},get:function(){var t=m(e(this)),a=t.data("autoNumeric");if("object"!=typeof a)return e.error("You must initialize autoNumeric('init', {options}) prior to calling the 'get' method"),this;a.oEvent="get";var n="";if(t.is("input[type=text], input[type=hidden], input:not([type])"))n=t.eq(0).val();else{if(-1===e.inArray(t.prop("tagName"),a.tagList))return e.error("The <"+t.prop("tagName")+"> is not supported by autoNumeric()"),!1;n=t.eq(0).text()}return""===n&&"empty"===a.wEmpty||n===a.aSign&&("sign"===a.wEmpty||"empty"===a.wEmpty)?"":(null!==a.nBracket&&""!==n&&(n=s(n,a.nBracket,a.oEvent)),(a.runOnce||a.aForm===!1)&&(n=o(n,a)),n=c(n,a.aDec,a.aNeg),0===+n&&"keep"!==a.lZero&&(n="0"),"keep"===a.lZero?n:n=l(n,a))},getString:function(){var t=!1,a=m(e(this)),n=a.serialize(),i=n.split("&"),r=0;for(r;r<i.length;r+=1){var o=i[r].split("="),s=e('*[name="'+decodeURIComponent(o[0])+'"]').data("autoNumeric");"object"==typeof s&&null!==o[1]&&void 0!==e('*[name="'+decodeURIComponent(o[0])+'"]').data("autoNumeric")&&(o[1]=e('input[name="'+decodeURIComponent(o[0])+'"]').autoNumeric("get"),i[r]=o.join("="),t=!0)}return t===!0?i.join("&"):(e.error("You must initialize autoNumeric('init', {options}) prior to calling the 'getString' method"),this)},getArray:function(){var t=!1,a=m(e(this)),n=a.serializeArray();return e.each(n,function(a,n){var i=e('*[name="'+decodeURIComponent(n.name)+'"]').data("autoNumeric");"object"==typeof i&&(""!==n.value&&void 0!==e('*[name="'+decodeURIComponent(n.name)+'"]').data("autoNumeric")&&(n.value=e('input[name="'+decodeURIComponent(n.name)+'"]').autoNumeric("get").toString()),t=!0)}),t===!0?n:(e.error("You must initialize autoNumeric('init', {options}) prior to calling the 'getArray' method"),this)},getSettings:function(){var t=m(e(this));return t.eq(0).data("autoNumeric")}};e.fn.autoNumeric=function(t){return S[t]?S[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error('Method "'+t+'" is not supported by autoNumeric()'):S.init.apply(this,arguments)}}(jQuery);

/*! jQuery Validation Plugin - v1.13.1 - 10/14/2014
 * http://jqueryvalidation.org/
 * Copyright (c) 2014 JÃ¶rn Zaefferer; Licensed MIT */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){a.extend(a.fn,{validate:function(b){if(!this.length)return void(b&&b.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var c=a.data(this[0],"validator");return c?c:(this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.validateDelegate(":submit","click",function(b){c.settings.submitHandler&&(c.submitButton=b.target),a(b.target).hasClass("cancel")&&(c.cancelSubmit=!0),void 0!==a(b.target).attr("formnovalidate")&&(c.cancelSubmit=!0)}),this.submit(function(b){function d(){var d,e;return c.settings.submitHandler?(c.submitButton&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(a(c.submitButton).val()).appendTo(c.currentForm)),e=c.settings.submitHandler.call(c,c.currentForm,b),c.submitButton&&d.remove(),void 0!==e?e:!1):!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})),c)},valid:function(){var b,c;return a(this[0]).is("form")?b=this.validate().form():(b=!0,c=a(this[0].form).validate(),this.each(function(){b=c.element(this)&&b})),b},removeAttrs:function(b){var c={},d=this;return a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)}),c},rules:function(b,c){var d,e,f,g,h,i,j=this[0];if(b)switch(d=a.data(j.form,"validator").settings,e=d.rules,f=a.validator.staticRules(j),b){case"add":a.extend(f,a.validator.normalizeRule(c)),delete f.messages,e[j.name]=f,c.messages&&(d.messages[j.name]=a.extend(d.messages[j.name],c.messages));break;case"remove":return c?(i={},a.each(c.split(/\s/),function(b,c){i[c]=f[c],delete f[c],"required"===c&&a(j).removeAttr("aria-required")}),i):(delete e[j.name],f)}return g=a.validator.normalizeRules(a.extend({},a.validator.classRules(j),a.validator.attributeRules(j),a.validator.dataRules(j),a.validator.staticRules(j)),j),g.required&&(h=g.required,delete g.required,g=a.extend({required:h},g),a(j).attr("aria-required","true")),g.remote&&(h=g.remote,delete g.remote,g=a.extend(g,{remote:h})),g}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+a(b).val())},filled:function(b){return!!a.trim(""+a(b).val())},unchecked:function(b){return!a(b).prop("checked")}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return 1===arguments.length?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:(arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),function(){return c})}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(a)))},onfocusout:function(a){this.checkable(a)||!(a.name in this.submitted)&&this.optional(a)||this.element(a)},onkeyup:function(a,b){(9!==b.which||""!==this.elementValue(a))&&(a.name in this.submitted||a===this.lastElement)&&this.element(a)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function b(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,""),e=c.settings;e[d]&&!this.is(e.ignore)&&e[d].call(c,this[0],b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var c,d=this.groups={};a.each(this.settings.groups,function(b,c){"string"==typeof c&&(c=c.split(/\s/)),a.each(c,function(a,c){d[c]=b})}),c=this.settings.rules,a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",b).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",b),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),a(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){var c=this.clean(b),d=this.validationTargetFor(c),e=!0;return this.lastElement=d,void 0===d?delete this.invalid[c.name]:(this.prepareElement(d),this.currentElements=a(d),e=this.check(d)!==!1,e?delete this.invalid[d.name]:this.invalid[d.name]=!0),a(b).attr("aria-invalid",!e),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b,c=0;for(b in a)c++;return c},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(a){a.not(this.containers).text(""),this.addWrapper(a).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&1===a.grep(this.errorList,function(a){return a.element.name===b.name}).length&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled], [readonly]").not(this.settings.ignore).filter(function(){return!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in c||!b.objectLength(a(this).rules())?!1:(c[this.name]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.split(" ").join(".");return a(this.settings.errorElement+"."+b,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){var c,d=a(b),e=b.type;return"radio"===e||"checkbox"===e?a("input[name='"+b.name+"']:checked").val():"number"===e&&"undefined"!=typeof b.validity?b.validity.badInput?!1:d.val():(c=d.val(),"string"==typeof c?c.replace(/\r/g,""):c)},check:function(b){b=this.validationTargetFor(this.clean(b));var c,d,e,f=a(b).rules(),g=a.map(f,function(a,b){return b}).length,h=!1,i=this.elementValue(b);for(d in f){e={method:d,parameters:f[d]};try{if(c=a.validator.methods[d].call(this,i,b,e.parameters),"dependency-mismatch"===c&&1===g){h=!0;continue}if(h=!1,"pending"===c)return void(this.toHide=this.toHide.not(this.errorsFor(b)));if(!c)return this.formatAndAdd(b,e),!1}catch(j){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+b.id+", check the '"+e.method+"' method.",j),j}}if(!h)return this.objectLength(f)&&this.successList.push(b),!0},customDataMessage:function(b,c){return a(b).data("msg"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase())||a(b).data("msg")},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a];return void 0},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customDataMessage(b,c),!this.settings.ignoreTitle&&b.title||void 0,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(b,c){var d=this.defaultMessage(b,c.method),e=/\$?\{(\d+)\}/g;"function"==typeof d?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),this.errorList.push({message:d,element:b,method:c.method}),this.errorMap[b.name]=d,this.submitted[b.name]=d},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){var a,b,c;for(a=0;this.errorList[a];a++)c=this.errorList[a],this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d,e,f,g=this.errorsFor(b),h=this.idOrName(b),i=a(b).attr("aria-describedby");g.length?(g.removeClass(this.settings.validClass).addClass(this.settings.errorClass),g.html(c)):(g=a("<"+this.settings.errorElement+">").attr("id",h+"-error").addClass(this.settings.errorClass).html(c||""),d=g,this.settings.wrapper&&(d=g.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(d):this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b),g.is("label")?g.attr("for",h):0===g.parents("label[for='"+h+"']").length&&(f=g.attr("id").replace(/(:|\.|\[|\])/g,"\\$1"),i?i.match(new RegExp("\\b"+f+"\\b"))||(i+=" "+f):i=f,a(b).attr("aria-describedby",i),e=this.groups[b.name],e&&a.each(this.groups,function(b,c){c===e&&a("[name='"+b+"']",this.currentForm).attr("aria-describedby",g.attr("id"))}))),!c&&this.settings.success&&(g.text(""),"string"==typeof this.settings.success?g.addClass(this.settings.success):this.settings.success(g,b)),this.toShow=this.toShow.add(g)},errorsFor:function(b){var c=this.idOrName(b),d=a(b).attr("aria-describedby"),e="label[for='"+c+"'], label[for='"+c+"'] *";return d&&(e=e+", #"+d.replace(/\s+/g,", #")),this.errors().filter(e)},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(b){return this.checkable(b)&&(b=this.findByName(b.name)),a(b).not(this.settings.ignore)[0]},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){return a(this.currentForm).find("[name='"+b+"']")},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&0===this.pendingRequest&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},attributeRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)"required"===c?(d=b.getAttribute(c),""===d&&(d=!0),d=!!d):d=f.attr(c),/min|max/.test(c)&&(null===g||/number|range|text/.test(g))&&(d=Number(d)),d||0===d?e[c]=d:g===c&&"range"!==g&&(e[c]=!0);return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(b){var c,d,e={},f=a(b);for(c in a.validator.methods)d=f.data("rule"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase()),void 0!==d&&(e[c]=d);return e},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1)return void delete b[d];if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=void 0!==e.param?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){var c;b[this]&&(a.isArray(b[this])?b[this]=[Number(b[this][0]),Number(b[this][1])]:"string"==typeof b[this]&&(c=b[this].replace(/[\[\]]/g,"").split(/[\s,]+/),b[this]=[Number(c[0]),Number(c[1])]))}),a.validator.autoCreateRanges&&(null!=b.min&&null!=b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),null!=b.minlength&&null!=b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b},normalizeRule:function(b){if("string"==typeof b){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=void 0!==d?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if("select"===c.nodeName.toLowerCase()){var e=a(c).val();return e&&e.length>0}return this.checkable(c)?this.getLength(b,c)>0:a.trim(b).length>0},email:function(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)},url:function(a,b){return this.optional(b)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a).toString())},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 \-]+/.test(a))return!1;var c,d,e=0,f=0,g=!1;if(a=a.replace(/\D/g,""),a.length<13||a.length>19)return!1;for(c=a.length-1;c>=0;c--)d=a.charAt(c),f=parseInt(d,10),g&&(f*=2)>9&&(f-=9),e+=f,g=!g;return e%10===0},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||d>=e},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||c>=a},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e,f,g=this.previousValue(c);return this.settings.messages[c.name]||(this.settings.messages[c.name]={}),g.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=g.message,d="string"==typeof d&&{url:d}||d,g.old===b?g.valid:(g.old=b,e=this,this.startRequest(c),f={},f[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:f,context:e.currentForm,success:function(d){var f,h,i,j=d===!0||"true"===d;e.settings.messages[c.name].remote=g.originalMessage,j?(i=e.formSubmitted,e.prepareElement(c),e.formSubmitted=i,e.successList.push(c),delete e.invalid[c.name],e.showErrors()):(f={},h=d||e.defaultMessage(c,"remote"),f[c.name]=g.message=a.isFunction(h)?h(b):h,e.invalid[c.name]=!0,e.showErrors(f)),g.valid=j,e.stopRequest(c,j)}},d)),"pending")}}}),a.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."};var b,c={};a.ajaxPrefilter?a.ajaxPrefilter(function(a,b,d){var e=a.port;"abort"===a.mode&&(c[e]&&c[e].abort(),c[e]=d)}):(b=a.ajax,a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return"abort"===e?(c[f]&&c[f].abort(),c[f]=b.apply(this,arguments),c[f]):b.apply(this,arguments)}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);return e.is(b)?d.apply(e,arguments):void 0})}})});

/*! jQuery UI - v1.11.4 - 2016-01-19
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, datepicker.js
* Copyright 2016 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(d.inline?d.dpDiv.parent()[0]:d.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var h=0,l=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=l.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=l.call(arguments,1),r=this;return a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):(o.length&&(n=e.widget.extend.apply(null,[n].concat(o))),this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))})),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var u=!1;e(document).mouseup(function(){u=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!u){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),u=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),u=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,N=e.extend({},y),M=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?N.left-=d:"center"===n.my[0]&&(N.left-=d/2),"bottom"===n.my[1]?N.top-=c:"center"===n.my[1]&&(N.top-=c/2),N.left+=M[0],N.top+=M[1],a||(N.left=h(N.left),N.top=h(N.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](N,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+M[0],p[1]+M[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-N.left,i=t+m-d,s=v.top-N.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:N.left,top:N.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(N,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var d;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),d===n&&(d=null))},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))
}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,d=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,N,M,C,P,A,I,H,z,F,E,W,O,L,j=new Date,R=this._daylightSavingAdjust(new Date(j.getFullYear(),j.getMonth(),j.getDate())),Y=this._get(e,"isRTL"),J=this._get(e,"showButtonPanel"),B=this._get(e,"hideIfNoPrevNext"),K=this._get(e,"navigationAsDateFormat"),U=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),q=this._get(e,"stepMonths"),G=1!==U[0]||1!==U[1],X=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),t=Q&&Q>t?Q:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-q,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":B?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+q,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":B?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?X:R,o=K?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=J?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;U[0]>w;w++){for(k="",this.maxRows=4,T=0;U[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",N="",G){if(N+="<div class='ui-datepicker-group",U[1]>1)switch(T){case 0:N+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case U[1]-1:N+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:N+=" ui-datepicker-group-middle",S=""}N+="'>"}for(N+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,Q,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",M=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)C=(x+u)%7,M+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[C]+"'>"+p[C]+"</span></th>";for(N+=M+"</tr></thead><tbody>",P=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,P)),A=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((A+P)/7),H=G?this.maxRows>I?this.maxRows:I:I,this.maxRows=H,z=this._daylightSavingAdjust(new Date(et,Z,1-A)),F=0;H>F;F++){for(N+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(z)+"</td>":"",x=0;7>x;x++)W=g?g.apply(e.input?e.input[0]:null,[z]):[!0,""],O=z.getMonth()!==Z,L=O&&!y||!W[0]||Q&&Q>z||$&&z>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(O?" ui-datepicker-other-month":"")+(z.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===z.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(O&&!v?"":" "+W[1]+(z.getTime()===X.getTime()?" "+this._currentClass:"")+(z.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(O&&!v||!W[2]?"":" title='"+W[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+z.getMonth()+"' data-year='"+z.getFullYear()+"'")+">"+(O&&!v?"&#xa0;":L?"<span class='ui-state-default'>"+z.getDate()+"</span>":"<a class='ui-state-default"+(z.getTime()===R.getTime()?" ui-state-highlight":"")+(z.getTime()===X.getTime()?" ui-state-active":"")+(O?" ui-priority-secondary":"")+"' href='#'>"+z.getDate()+"</a>")+"</td>",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);N+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),N+="</tbody></table>"+(G?"</div>"+(U[0]>0&&T===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=N}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker});

// Comma to Digits
$.fn.digits = function(){ 
    return this.each(function(){ 
        $(this).text( $(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,") ); 
    })
}

//OwlCarousel
"function"!==typeof Object.create&&(Object.create=function(f){function g(){}g.prototype=f;return new g});
(function(f,g,k){var l={init:function(a,b){this.$elem=f(b);this.options=f.extend({},f.fn.owlCarousel.options,this.$elem.data(),a);this.userOptions=a;this.loadContent()},loadContent:function(){function a(a){var d,e="";if("function"===typeof b.options.jsonSuccess)b.options.jsonSuccess.apply(this,[a]);else{for(d in a.owl)a.owl.hasOwnProperty(d)&&(e+=a.owl[d].item);b.$elem.html(e)}b.logIn()}var b=this,e;"function"===typeof b.options.beforeInit&&b.options.beforeInit.apply(this,[b.$elem]);"string"===typeof b.options.jsonPath?
(e=b.options.jsonPath,f.getJSON(e,a)):b.logIn()},logIn:function(){this.$elem.data("owl-originalStyles",this.$elem.attr("style"));this.$elem.data("owl-originalClasses",this.$elem.attr("class"));this.$elem.css({opacity:0});this.orignalItems=this.options.items;this.checkBrowser();this.wrapperWidth=0;this.checkVisible=null;this.setVars()},setVars:function(){if(0===this.$elem.children().length)return!1;this.baseClass();this.eventTypes();this.$userItems=this.$elem.children();this.itemsAmount=this.$userItems.length;
this.wrapItems();this.$owlItems=this.$elem.find(".owl-item");this.$owlWrapper=this.$elem.find(".owl-wrapper");this.playDirection="next";this.prevItem=0;this.prevArr=[0];this.currentItem=0;this.customEvents();this.onStartup()},onStartup:function(){this.updateItems();this.calculateAll();this.buildControls();this.updateControls();this.response();this.moveEvents();this.stopOnHover();this.owlStatus();!1!==this.options.transitionStyle&&this.transitionTypes(this.options.transitionStyle);!0===this.options.autoPlay&&
(this.options.autoPlay=5E3);this.play();this.$elem.find(".owl-wrapper").css("display","block");this.$elem.is(":visible")?this.$elem.css("opacity",1):this.watchVisibility();this.onstartup=!1;this.eachMoveUpdate();"function"===typeof this.options.afterInit&&this.options.afterInit.apply(this,[this.$elem])},eachMoveUpdate:function(){!0===this.options.lazyLoad&&this.lazyLoad();!0===this.options.autoHeight&&this.autoHeight();this.onVisibleItems();"function"===typeof this.options.afterAction&&this.options.afterAction.apply(this,
[this.$elem])},updateVars:function(){"function"===typeof this.options.beforeUpdate&&this.options.beforeUpdate.apply(this,[this.$elem]);this.watchVisibility();this.updateItems();this.calculateAll();this.updatePosition();this.updateControls();this.eachMoveUpdate();"function"===typeof this.options.afterUpdate&&this.options.afterUpdate.apply(this,[this.$elem])},reload:function(){var a=this;g.setTimeout(function(){a.updateVars()},0)},watchVisibility:function(){var a=this;if(!1===a.$elem.is(":visible"))a.$elem.css({opacity:0}),
g.clearInterval(a.autoPlayInterval),g.clearInterval(a.checkVisible);else return!1;a.checkVisible=g.setInterval(function(){a.$elem.is(":visible")&&(a.reload(),a.$elem.animate({opacity:1},200),g.clearInterval(a.checkVisible))},500)},wrapItems:function(){this.$userItems.wrapAll('<div class="owl-wrapper">').wrap('<div class="owl-item"></div>');this.$elem.find(".owl-wrapper").wrap('<div class="owl-wrapper-outer">');this.wrapperOuter=this.$elem.find(".owl-wrapper-outer");this.$elem.css("display","block")},
baseClass:function(){var a=this.$elem.hasClass(this.options.baseClass),b=this.$elem.hasClass(this.options.theme);a||this.$elem.addClass(this.options.baseClass);b||this.$elem.addClass(this.options.theme)},updateItems:function(){var a,b;if(!1===this.options.responsive)return!1;if(!0===this.options.singleItem)return this.options.items=this.orignalItems=1,this.options.itemsCustom=!1,this.options.itemsDesktop=!1,this.options.itemsDesktopSmall=!1,this.options.itemsTablet=!1,this.options.itemsTabletSmall=
!1,this.options.itemsMobile=!1;a=f(this.options.responsiveBaseWidth).width();a>(this.options.itemsDesktop[0]||this.orignalItems)&&(this.options.items=this.orignalItems);if(!1!==this.options.itemsCustom)for(this.options.itemsCustom.sort(function(a,b){return a[0]-b[0]}),b=0;b<this.options.itemsCustom.length;b+=1)this.options.itemsCustom[b][0]<=a&&(this.options.items=this.options.itemsCustom[b][1]);else a<=this.options.itemsDesktop[0]&&!1!==this.options.itemsDesktop&&(this.options.items=this.options.itemsDesktop[1]),
a<=this.options.itemsDesktopSmall[0]&&!1!==this.options.itemsDesktopSmall&&(this.options.items=this.options.itemsDesktopSmall[1]),a<=this.options.itemsTablet[0]&&!1!==this.options.itemsTablet&&(this.options.items=this.options.itemsTablet[1]),a<=this.options.itemsTabletSmall[0]&&!1!==this.options.itemsTabletSmall&&(this.options.items=this.options.itemsTabletSmall[1]),a<=this.options.itemsMobile[0]&&!1!==this.options.itemsMobile&&(this.options.items=this.options.itemsMobile[1]);this.options.items>this.itemsAmount&&
!0===this.options.itemsScaleUp&&(this.options.items=this.itemsAmount)},response:function(){var a=this,b,e;if(!0!==a.options.responsive)return!1;e=f(g).width();a.resizer=function(){f(g).width()!==e&&(!1!==a.options.autoPlay&&g.clearInterval(a.autoPlayInterval),g.clearTimeout(b),b=g.setTimeout(function(){e=f(g).width();a.updateVars()},a.options.responsiveRefreshRate))};f(g).resize(a.resizer)},updatePosition:function(){this.jumpTo(this.currentItem);!1!==this.options.autoPlay&&this.checkAp()},appendItemsSizes:function(){var a=
this,b=0,e=a.itemsAmount-a.options.items;a.$owlItems.each(function(c){var d=f(this);d.css({width:a.itemWidth}).data("owl-item",Number(c));if(0===c%a.options.items||c===e)c>e||(b+=1);d.data("owl-roundPages",b)})},appendWrapperSizes:function(){this.$owlWrapper.css({width:this.$owlItems.length*this.itemWidth*2,left:0});this.appendItemsSizes()},calculateAll:function(){this.calculateWidth();this.appendWrapperSizes();this.loops();this.max()},calculateWidth:function(){this.itemWidth=Math.round(this.$elem.width()/
this.options.items)},max:function(){var a=-1*(this.itemsAmount*this.itemWidth-this.options.items*this.itemWidth);this.options.items>this.itemsAmount?this.maximumPixels=a=this.maximumItem=0:(this.maximumItem=this.itemsAmount-this.options.items,this.maximumPixels=a);return a},min:function(){return 0},loops:function(){var a=0,b=0,e,c;this.positionsInArray=[0];this.pagesInArray=[];for(e=0;e<this.itemsAmount;e+=1)b+=this.itemWidth,this.positionsInArray.push(-b),!0===this.options.scrollPerPage&&(c=f(this.$owlItems[e]),
c=c.data("owl-roundPages"),c!==a&&(this.pagesInArray[a]=this.positionsInArray[e],a=c))},buildControls:function(){if(!0===this.options.navigation||!0===this.options.pagination)this.owlControls=f('<div class="owl-controls"/>').toggleClass("clickable",!this.browser.isTouch).appendTo(this.$elem);!0===this.options.pagination&&this.buildPagination();!0===this.options.navigation&&this.buildButtons()},buildButtons:function(){var a=this,b=f('<div class="owl-buttons"/>');a.owlControls.append(b);a.buttonPrev=
f("<div/>",{"class":"owl-prev",html:a.options.navigationText[0]||""});a.buttonNext=f("<div/>",{"class":"owl-next",html:a.options.navigationText[1]||""});b.append(a.buttonPrev).append(a.buttonNext);b.on("touchstart.owlControls mousedown.owlControls",'div[class^="owl"]',function(a){a.preventDefault()});b.on("touchend.owlControls mouseup.owlControls",'div[class^="owl"]',function(b){b.preventDefault();f(this).hasClass("owl-next")?a.next():a.prev()})},buildPagination:function(){var a=this;a.paginationWrapper=
f('<div class="owl-pagination"/>');a.owlControls.append(a.paginationWrapper);a.paginationWrapper.on("touchend.owlControls mouseup.owlControls",".owl-page",function(b){b.preventDefault();Number(f(this).data("owl-page"))!==a.currentItem&&a.goTo(Number(f(this).data("owl-page")),!0)})},updatePagination:function(){var a,b,e,c,d,g;if(!1===this.options.pagination)return!1;this.paginationWrapper.html("");a=0;b=this.itemsAmount-this.itemsAmount%this.options.items;for(c=0;c<this.itemsAmount;c+=1)0===c%this.options.items&&
(a+=1,b===c&&(e=this.itemsAmount-this.options.items),d=f("<div/>",{"class":"owl-page"}),g=f("<span></span>",{text:!0===this.options.paginationNumbers?a:"","class":!0===this.options.paginationNumbers?"owl-numbers":""}),d.append(g),d.data("owl-page",b===c?e:c),d.data("owl-roundPages",a),this.paginationWrapper.append(d));this.checkPagination()},checkPagination:function(){var a=this;if(!1===a.options.pagination)return!1;a.paginationWrapper.find(".owl-page").each(function(){f(this).data("owl-roundPages")===
f(a.$owlItems[a.currentItem]).data("owl-roundPages")&&(a.paginationWrapper.find(".owl-page").removeClass("active"),f(this).addClass("active"))})},checkNavigation:function(){if(!1===this.options.navigation)return!1;!1===this.options.rewindNav&&(0===this.currentItem&&0===this.maximumItem?(this.buttonPrev.addClass("disabled"),this.buttonNext.addClass("disabled")):0===this.currentItem&&0!==this.maximumItem?(this.buttonPrev.addClass("disabled"),this.buttonNext.removeClass("disabled")):this.currentItem===
this.maximumItem?(this.buttonPrev.removeClass("disabled"),this.buttonNext.addClass("disabled")):0!==this.currentItem&&this.currentItem!==this.maximumItem&&(this.buttonPrev.removeClass("disabled"),this.buttonNext.removeClass("disabled")))},updateControls:function(){this.updatePagination();this.checkNavigation();this.owlControls&&(this.options.items>=this.itemsAmount?this.owlControls.hide():this.owlControls.show())},destroyControls:function(){this.owlControls&&this.owlControls.remove()},next:function(a){if(this.isTransition)return!1;
this.currentItem+=!0===this.options.scrollPerPage?this.options.items:1;if(this.currentItem>this.maximumItem+(!0===this.options.scrollPerPage?this.options.items-1:0))if(!0===this.options.rewindNav)this.currentItem=0,a="rewind";else return this.currentItem=this.maximumItem,!1;this.goTo(this.currentItem,a)},prev:function(a){if(this.isTransition)return!1;this.currentItem=!0===this.options.scrollPerPage&&0<this.currentItem&&this.currentItem<this.options.items?0:this.currentItem-(!0===this.options.scrollPerPage?
this.options.items:1);if(0>this.currentItem)if(!0===this.options.rewindNav)this.currentItem=this.maximumItem,a="rewind";else return this.currentItem=0,!1;this.goTo(this.currentItem,a)},goTo:function(a,b,e){var c=this;if(c.isTransition)return!1;"function"===typeof c.options.beforeMove&&c.options.beforeMove.apply(this,[c.$elem]);a>=c.maximumItem?a=c.maximumItem:0>=a&&(a=0);c.currentItem=c.owl.currentItem=a;if(!1!==c.options.transitionStyle&&"drag"!==e&&1===c.options.items&&!0===c.browser.support3d)return c.swapSpeed(0),
!0===c.browser.support3d?c.transition3d(c.positionsInArray[a]):c.css2slide(c.positionsInArray[a],1),c.afterGo(),c.singleItemTransition(),!1;a=c.positionsInArray[a];!0===c.browser.support3d?(c.isCss3Finish=!1,!0===b?(c.swapSpeed("paginationSpeed"),g.setTimeout(function(){c.isCss3Finish=!0},c.options.paginationSpeed)):"rewind"===b?(c.swapSpeed(c.options.rewindSpeed),g.setTimeout(function(){c.isCss3Finish=!0},c.options.rewindSpeed)):(c.swapSpeed("slideSpeed"),g.setTimeout(function(){c.isCss3Finish=!0},
c.options.slideSpeed)),c.transition3d(a)):!0===b?c.css2slide(a,c.options.paginationSpeed):"rewind"===b?c.css2slide(a,c.options.rewindSpeed):c.css2slide(a,c.options.slideSpeed);c.afterGo()},jumpTo:function(a){"function"===typeof this.options.beforeMove&&this.options.beforeMove.apply(this,[this.$elem]);a>=this.maximumItem||-1===a?a=this.maximumItem:0>=a&&(a=0);this.swapSpeed(0);!0===this.browser.support3d?this.transition3d(this.positionsInArray[a]):this.css2slide(this.positionsInArray[a],1);this.currentItem=
this.owl.currentItem=a;this.afterGo()},afterGo:function(){this.prevArr.push(this.currentItem);this.prevItem=this.owl.prevItem=this.prevArr[this.prevArr.length-2];this.prevArr.shift(0);this.prevItem!==this.currentItem&&(this.checkPagination(),this.checkNavigation(),this.eachMoveUpdate(),!1!==this.options.autoPlay&&this.checkAp());"function"===typeof this.options.afterMove&&this.prevItem!==this.currentItem&&this.options.afterMove.apply(this,[this.$elem])},stop:function(){this.apStatus="stop";g.clearInterval(this.autoPlayInterval)},
checkAp:function(){"stop"!==this.apStatus&&this.play()},play:function(){var a=this;a.apStatus="play";if(!1===a.options.autoPlay)return!1;g.clearInterval(a.autoPlayInterval);a.autoPlayInterval=g.setInterval(function(){a.next(!0)},a.options.autoPlay)},swapSpeed:function(a){"slideSpeed"===a?this.$owlWrapper.css(this.addCssSpeed(this.options.slideSpeed)):"paginationSpeed"===a?this.$owlWrapper.css(this.addCssSpeed(this.options.paginationSpeed)):"string"!==typeof a&&this.$owlWrapper.css(this.addCssSpeed(a))},
addCssSpeed:function(a){return{"-webkit-transition":"all "+a+"ms ease","-moz-transition":"all "+a+"ms ease","-o-transition":"all "+a+"ms ease",transition:"all "+a+"ms ease"}},removeTransition:function(){return{"-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""}},doTranslate:function(a){return{"-webkit-transform":"translate3d("+a+"px, 0px, 0px)","-moz-transform":"translate3d("+a+"px, 0px, 0px)","-o-transform":"translate3d("+a+"px, 0px, 0px)","-ms-transform":"translate3d("+
a+"px, 0px, 0px)",transform:"translate3d("+a+"px, 0px,0px)"}},transition3d:function(a){this.$owlWrapper.css(this.doTranslate(a))},css2move:function(a){this.$owlWrapper.css({left:a})},css2slide:function(a,b){var e=this;e.isCssFinish=!1;e.$owlWrapper.stop(!0,!0).animate({left:a},{duration:b||e.options.slideSpeed,complete:function(){e.isCssFinish=!0}})},checkBrowser:function(){var a=k.createElement("div");a.style.cssText="  -moz-transform:translate3d(0px, 0px, 0px); -ms-transform:translate3d(0px, 0px, 0px); -o-transform:translate3d(0px, 0px, 0px); -webkit-transform:translate3d(0px, 0px, 0px); transform:translate3d(0px, 0px, 0px)";
a=a.style.cssText.match(/translate3d\(0px, 0px, 0px\)/g);this.browser={support3d:null!==a&&1===a.length,isTouch:"ontouchstart"in g||g.navigator.msMaxTouchPoints}},moveEvents:function(){if(!1!==this.options.mouseDrag||!1!==this.options.touchDrag)this.gestures(),this.disabledEvents()},eventTypes:function(){var a=["s","e","x"];this.ev_types={};!0===this.options.mouseDrag&&!0===this.options.touchDrag?a=["touchstart.owl mousedown.owl","touchmove.owl mousemove.owl","touchend.owl touchcancel.owl mouseup.owl"]:
!1===this.options.mouseDrag&&!0===this.options.touchDrag?a=["touchstart.owl","touchmove.owl","touchend.owl touchcancel.owl"]:!0===this.options.mouseDrag&&!1===this.options.touchDrag&&(a=["mousedown.owl","mousemove.owl","mouseup.owl"]);this.ev_types.start=a[0];this.ev_types.move=a[1];this.ev_types.end=a[2]},disabledEvents:function(){this.$elem.on("dragstart.owl",function(a){a.preventDefault()});this.$elem.on("mousedown.disableTextSelect",function(a){return f(a.target).is("input, textarea, select, option")})},
gestures:function(){function a(a){if(void 0!==a.touches)return{x:a.touches[0].pageX,y:a.touches[0].pageY};if(void 0===a.touches){if(void 0!==a.pageX)return{x:a.pageX,y:a.pageY};if(void 0===a.pageX)return{x:a.clientX,y:a.clientY}}}function b(a){"on"===a?(f(k).on(d.ev_types.move,e),f(k).on(d.ev_types.end,c)):"off"===a&&(f(k).off(d.ev_types.move),f(k).off(d.ev_types.end))}function e(b){b=b.originalEvent||b||g.event;d.newPosX=a(b).x-h.offsetX;d.newPosY=a(b).y-h.offsetY;d.newRelativeX=d.newPosX-h.relativePos;
"function"===typeof d.options.startDragging&&!0!==h.dragging&&0!==d.newRelativeX&&(h.dragging=!0,d.options.startDragging.apply(d,[d.$elem]));(8<d.newRelativeX||-8>d.newRelativeX)&&!0===d.browser.isTouch&&(void 0!==b.preventDefault?b.preventDefault():b.returnValue=!1,h.sliding=!0);(10<d.newPosY||-10>d.newPosY)&&!1===h.sliding&&f(k).off("touchmove.owl");d.newPosX=Math.max(Math.min(d.newPosX,d.newRelativeX/5),d.maximumPixels+d.newRelativeX/5);!0===d.browser.support3d?d.transition3d(d.newPosX):d.css2move(d.newPosX)}
function c(a){a=a.originalEvent||a||g.event;var c;a.target=a.target||a.srcElement;h.dragging=!1;!0!==d.browser.isTouch&&d.$owlWrapper.removeClass("grabbing");d.dragDirection=0>d.newRelativeX?d.owl.dragDirection="left":d.owl.dragDirection="right";0!==d.newRelativeX&&(c=d.getNewPosition(),d.goTo(c,!1,"drag"),h.targetElement===a.target&&!0!==d.browser.isTouch&&(f(a.target).on("click.disable",function(a){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();f(a.target).off("click.disable")}),
a=f._data(a.target,"events").click,c=a.pop(),a.splice(0,0,c)));b("off")}var d=this,h={offsetX:0,offsetY:0,baseElWidth:0,relativePos:0,position:null,minSwipe:null,maxSwipe:null,sliding:null,dargging:null,targetElement:null};d.isCssFinish=!0;d.$elem.on(d.ev_types.start,".owl-wrapper",function(c){c=c.originalEvent||c||g.event;var e;if(3===c.which)return!1;if(!(d.itemsAmount<=d.options.items)){if(!1===d.isCssFinish&&!d.options.dragBeforeAnimFinish||!1===d.isCss3Finish&&!d.options.dragBeforeAnimFinish)return!1;
!1!==d.options.autoPlay&&g.clearInterval(d.autoPlayInterval);!0===d.browser.isTouch||d.$owlWrapper.hasClass("grabbing")||d.$owlWrapper.addClass("grabbing");d.newPosX=0;d.newRelativeX=0;f(this).css(d.removeTransition());e=f(this).position();h.relativePos=e.left;h.offsetX=a(c).x-e.left;h.offsetY=a(c).y-e.top;b("on");h.sliding=!1;h.targetElement=c.target||c.srcElement}})},getNewPosition:function(){var a=this.closestItem();a>this.maximumItem?a=this.currentItem=this.maximumItem:0<=this.newPosX&&(this.currentItem=
a=0);return a},closestItem:function(){var a=this,b=!0===a.options.scrollPerPage?a.pagesInArray:a.positionsInArray,e=a.newPosX,c=null;f.each(b,function(d,g){e-a.itemWidth/20>b[d+1]&&e-a.itemWidth/20<g&&"left"===a.moveDirection()?(c=g,a.currentItem=!0===a.options.scrollPerPage?f.inArray(c,a.positionsInArray):d):e+a.itemWidth/20<g&&e+a.itemWidth/20>(b[d+1]||b[d]-a.itemWidth)&&"right"===a.moveDirection()&&(!0===a.options.scrollPerPage?(c=b[d+1]||b[b.length-1],a.currentItem=f.inArray(c,a.positionsInArray)):
(c=b[d+1],a.currentItem=d+1))});return a.currentItem},moveDirection:function(){var a;0>this.newRelativeX?(a="right",this.playDirection="next"):(a="left",this.playDirection="prev");return a},customEvents:function(){var a=this;a.$elem.on("owl.next",function(){a.next()});a.$elem.on("owl.prev",function(){a.prev()});a.$elem.on("owl.play",function(b,e){a.options.autoPlay=e;a.play();a.hoverStatus="play"});a.$elem.on("owl.stop",function(){a.stop();a.hoverStatus="stop"});a.$elem.on("owl.goTo",function(b,e){a.goTo(e)});
a.$elem.on("owl.jumpTo",function(b,e){a.jumpTo(e)})},stopOnHover:function(){var a=this;!0===a.options.stopOnHover&&!0!==a.browser.isTouch&&!1!==a.options.autoPlay&&(a.$elem.on("mouseover",function(){a.stop()}),a.$elem.on("mouseout",function(){"stop"!==a.hoverStatus&&a.play()}))},lazyLoad:function(){var a,b,e,c,d;if(!1===this.options.lazyLoad)return!1;for(a=0;a<this.itemsAmount;a+=1)b=f(this.$owlItems[a]),"loaded"!==b.data("owl-loaded")&&(e=b.data("owl-item"),c=b.find(".lazyOwl"),"string"!==typeof c.data("src")?
b.data("owl-loaded","loaded"):(void 0===b.data("owl-loaded")&&(c.hide(),b.addClass("loading").data("owl-loaded","checked")),(d=!0===this.options.lazyFollow?e>=this.currentItem:!0)&&e<this.currentItem+this.options.items&&c.length&&this.lazyPreload(b,c)))},lazyPreload:function(a,b){function e(){a.data("owl-loaded","loaded").removeClass("loading");b.removeAttr("data-src");"fade"===d.options.lazyEffect?b.fadeIn(400):b.show();"function"===typeof d.options.afterLazyLoad&&d.options.afterLazyLoad.apply(this,
[d.$elem])}function c(){f+=1;d.completeImg(b.get(0))||!0===k?e():100>=f?g.setTimeout(c,100):e()}var d=this,f=0,k;"DIV"===b.prop("tagName")?(b.css("background-image","url("+b.data("src")+")"),k=!0):b[0].src=b.data("src");c()},autoHeight:function(){function a(){var a=f(e.$owlItems[e.currentItem]).height();e.wrapperOuter.css("height",a+"px");e.wrapperOuter.hasClass("autoHeight")||g.setTimeout(function(){e.wrapperOuter.addClass("autoHeight")},0)}function b(){d+=1;e.completeImg(c.get(0))?a():100>=d?g.setTimeout(b,
100):e.wrapperOuter.css("height","")}var e=this,c=f(e.$owlItems[e.currentItem]).find("img"),d;void 0!==c.get(0)?(d=0,b()):a()},completeImg:function(a){return!a.complete||"undefined"!==typeof a.naturalWidth&&0===a.naturalWidth?!1:!0},onVisibleItems:function(){var a;!0===this.options.addClassActive&&this.$owlItems.removeClass("active");this.visibleItems=[];for(a=this.currentItem;a<this.currentItem+this.options.items;a+=1)this.visibleItems.push(a),!0===this.options.addClassActive&&f(this.$owlItems[a]).addClass("active");
this.owl.visibleItems=this.visibleItems},transitionTypes:function(a){this.outClass="owl-"+a+"-out";this.inClass="owl-"+a+"-in"},singleItemTransition:function(){var a=this,b=a.outClass,e=a.inClass,c=a.$owlItems.eq(a.currentItem),d=a.$owlItems.eq(a.prevItem),f=Math.abs(a.positionsInArray[a.currentItem])+a.positionsInArray[a.prevItem],g=Math.abs(a.positionsInArray[a.currentItem])+a.itemWidth/2;a.isTransition=!0;a.$owlWrapper.addClass("owl-origin").css({"-webkit-transform-origin":g+"px","-moz-perspective-origin":g+
"px","perspective-origin":g+"px"});d.css({position:"relative",left:f+"px"}).addClass(b).on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){a.endPrev=!0;d.off("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend");a.clearTransStyle(d,b)});c.addClass(e).on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){a.endCurrent=!0;c.off("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend");a.clearTransStyle(c,e)})},clearTransStyle:function(a,
b){a.css({position:"",left:""}).removeClass(b);this.endPrev&&this.endCurrent&&(this.$owlWrapper.removeClass("owl-origin"),this.isTransition=this.endCurrent=this.endPrev=!1)},owlStatus:function(){this.owl={userOptions:this.userOptions,baseElement:this.$elem,userItems:this.$userItems,owlItems:this.$owlItems,currentItem:this.currentItem,prevItem:this.prevItem,visibleItems:this.visibleItems,isTouch:this.browser.isTouch,browser:this.browser,dragDirection:this.dragDirection}},clearEvents:function(){this.$elem.off(".owl owl mousedown.disableTextSelect");
f(k).off(".owl owl");f(g).off("resize",this.resizer)},unWrap:function(){0!==this.$elem.children().length&&(this.$owlWrapper.unwrap(),this.$userItems.unwrap().unwrap(),this.owlControls&&this.owlControls.remove());this.clearEvents();this.$elem.attr("style",this.$elem.data("owl-originalStyles")||"").attr("class",this.$elem.data("owl-originalClasses"))},destroy:function(){this.stop();g.clearInterval(this.checkVisible);this.unWrap();this.$elem.removeData()},reinit:function(a){a=f.extend({},this.userOptions,
a);this.unWrap();this.init(a,this.$elem)},addItem:function(a,b){var e;if(!a)return!1;if(0===this.$elem.children().length)return this.$elem.append(a),this.setVars(),!1;this.unWrap();e=void 0===b||-1===b?-1:b;e>=this.$userItems.length||-1===e?this.$userItems.eq(-1).after(a):this.$userItems.eq(e).before(a);this.setVars()},removeItem:function(a){if(0===this.$elem.children().length)return!1;a=void 0===a||-1===a?-1:a;this.unWrap();this.$userItems.eq(a).remove();this.setVars()}};f.fn.owlCarousel=function(a){return this.each(function(){if(!0===
f(this).data("owl-init"))return!1;f(this).data("owl-init",!0);var b=Object.create(l);b.init(a,this);f.data(this,"owlCarousel",b)})};f.fn.owlCarousel.options={items:5,itemsCustom:!1,itemsDesktop:[1199,4],itemsDesktopSmall:[979,3],itemsTablet:[768,2],itemsTabletSmall:!1,itemsMobile:[479,1],singleItem:!1,itemsScaleUp:!1,slideSpeed:200,paginationSpeed:800,rewindSpeed:1E3,autoPlay:!1,stopOnHover:!1,navigation:!1,navigationText:["prev","next"],rewindNav:!0,scrollPerPage:!1,pagination:!0,paginationNumbers:!1,
responsive:!0,responsiveRefreshRate:200,responsiveBaseWidth:g,baseClass:"owl-carousel",theme:"owl-theme",lazyLoad:!1,lazyFollow:!0,lazyEffect:"fade",autoHeight:!1,jsonPath:!1,jsonSuccess:!1,dragBeforeAnimFinish:!0,mouseDrag:!0,touchDrag:!0,addClassActive:!1,transitionStyle:!1,beforeUpdate:!1,afterUpdate:!1,beforeInit:!1,afterInit:!1,beforeMove:!1,afterMove:!1,afterAction:!1,startDragging:!1,afterLazyLoad:!1}})(jQuery,window,document);

// jQuery Mask Plugin v1.13.4
// github.com/igorescobar/jQuery-Mask-Plugin
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?module.exports=b(require("jquery")):b(jQuery||Zepto)})(function(b){var y=function(a,c,d){a=b(a);var g=this,k=a.val(),l;c="function"===typeof c?c(a.val(),void 0,a,d):c;var e={invalid:[],getCaret:function(){try{var q,b=0,e=a.get(0),f=document.selection,c=e.selectionStart;if(f&&-1===navigator.appVersion.indexOf("MSIE 10"))q=f.createRange(),q.moveStart("character",a.is("input")?-a.val().length:-a.text().length),
b=q.text.length;else if(c||"0"===c)b=c;return b}catch(d){}},setCaret:function(q){try{if(a.is(":focus")){var b,c=a.get(0);c.setSelectionRange?c.setSelectionRange(q,q):c.createTextRange&&(b=c.createTextRange(),b.collapse(!0),b.moveEnd("character",q),b.moveStart("character",q),b.select())}}catch(f){}},events:function(){a.on("input.mask keyup.mask",e.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){a.keydown().keyup()},100)}).on("change.mask",function(){a.data("changed",!0)}).on("blur.mask",
function(){k===a.val()||a.data("changed")||a.triggerHandler("change");a.data("changed",!1)}).on("blur.mask",function(){k=a.val()}).on("focus.mask",function(a){!0===d.selectOnFocus&&b(a.target).select()}).on("focusout.mask",function(){d.clearIfNotMatch&&!l.test(e.val())&&e.val("")})},getRegexMask:function(){for(var a=[],b,e,f,d,h=0;h<c.length;h++)(b=g.translation[c.charAt(h)])?(e=b.pattern.toString().replace(/.{1}$|^.{1}/g,""),f=b.optional,(b=b.recursive)?(a.push(c.charAt(h)),d={digit:c.charAt(h),
pattern:e}):a.push(f||b?e+"?":e)):a.push(c.charAt(h).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));a=a.join("");d&&(a=a.replace(new RegExp("("+d.digit+"(.*"+d.digit+")?)"),"($1)?").replace(new RegExp(d.digit,"g"),d.pattern));return new RegExp(a)},destroyEvents:function(){a.off("input keydown keyup paste drop blur focusout ".split(" ").join(".mask "))},val:function(b){var c=a.is("input")?"val":"text";if(0<arguments.length){if(a[c]()!==b)a[c](b);c=a}else c=a[c]();return c},getMCharsBeforeCount:function(a,
b){for(var e=0,f=0,d=c.length;f<d&&f<a;f++)g.translation[c.charAt(f)]||(a=b?a+1:a,e++);return e},caretPos:function(a,b,d,f){return g.translation[c.charAt(Math.min(a-1,c.length-1))]?Math.min(a+d-b-f,d):e.caretPos(a+1,b,d,f)},behaviour:function(a){a=a||window.event;e.invalid=[];var c=a.keyCode||a.which;if(-1===b.inArray(c,g.byPassKeys)){var d=e.getCaret(),f=e.val().length,n=d<f,h=e.getMasked(),k=h.length,m=e.getMCharsBeforeCount(k-1)-e.getMCharsBeforeCount(f-1);e.val(h);!n||65===c&&a.ctrlKey||(8!==
c&&46!==c&&(d=e.caretPos(d,f,k,m)),e.setCaret(d));return e.callbacks(a)}},getMasked:function(a){var b=[],k=e.val(),f=0,n=c.length,h=0,l=k.length,m=1,p="push",u=-1,t,w;d.reverse?(p="unshift",m=-1,t=0,f=n-1,h=l-1,w=function(){return-1<f&&-1<h}):(t=n-1,w=function(){return f<n&&h<l});for(;w();){var x=c.charAt(f),v=k.charAt(h),r=g.translation[x];if(r)v.match(r.pattern)?(b[p](v),r.recursive&&(-1===u?u=f:f===t&&(f=u-m),t===u&&(f-=m)),f+=m):r.optional?(f+=m,h-=m):r.fallback?(b[p](r.fallback),f+=m,h-=m):e.invalid.push({p:h,
v:v,e:r.pattern}),h+=m;else{if(!a)b[p](x);v===x&&(h+=m);f+=m}}a=c.charAt(t);n!==l+1||g.translation[a]||b.push(a);return b.join("")},callbacks:function(b){var g=e.val(),l=g!==k,f=[g,b,a,d],n=function(a,b,c){"function"===typeof d[a]&&b&&d[a].apply(this,c)};n("onChange",!0===l,f);n("onKeyPress",!0===l,f);n("onComplete",g.length===c.length,f);n("onInvalid",0<e.invalid.length,[g,b,a,e.invalid,d])}};g.mask=c;g.options=d;g.remove=function(){var b=e.getCaret();e.destroyEvents();e.val(g.getCleanVal());e.setCaret(b-
e.getMCharsBeforeCount(b));return a};g.getCleanVal=function(){return e.getMasked(!0)};g.init=function(c){c=c||!1;d=d||{};g.byPassKeys=b.jMaskGlobals.byPassKeys;g.translation=b.jMaskGlobals.translation;g.translation=b.extend({},g.translation,d.translation);g=b.extend(!0,{},g,d);l=e.getRegexMask();!1===c?(d.placeholder&&a.attr("placeholder",d.placeholder),b("input").length&&!1==="oninput"in b("input")[0]&&"on"===a.attr("autocomplete")&&a.attr("autocomplete","off"),e.destroyEvents(),e.events(),c=e.getCaret(),
e.val(e.getMasked()),e.setCaret(c+e.getMCharsBeforeCount(c,!0))):(e.events(),e.val(e.getMasked()))};g.init(!a.is("input"))};b.maskWatchers={};var A=function(){var a=b(this),c={},d=a.attr("data-mask");a.attr("data-mask-reverse")&&(c.reverse=!0);a.attr("data-mask-clearifnotmatch")&&(c.clearIfNotMatch=!0);"true"===a.attr("data-mask-selectonfocus")&&(c.selectOnFocus=!0);if(z(a,d,c))return a.data("mask",new y(this,d,c))},z=function(a,c,d){d=d||{};var g=b(a).data("mask"),k=JSON.stringify;a=b(a).val()||
b(a).text();try{return"function"===typeof c&&(c=c(a)),"object"!==typeof g||k(g.options)!==k(d)||g.mask!==c}catch(l){}};b.fn.mask=function(a,c){c=c||{};var d=this.selector,g=b.jMaskGlobals,k=b.jMaskGlobals.watchInterval,l=function(){if(z(this,a,c))return b(this).data("mask",new y(this,a,c))};b(this).each(l);d&&""!==d&&g.watchInputs&&(clearInterval(b.maskWatchers[d]),b.maskWatchers[d]=setInterval(function(){b(document).find(d).each(l)},k));return this};b.fn.unmask=function(){clearInterval(b.maskWatchers[this.selector]);
delete b.maskWatchers[this.selector];return this.each(function(){var a=b(this).data("mask");a&&a.remove().removeData("mask")})};b.fn.cleanVal=function(){return this.data("mask").getCleanVal()};b.applyDataMask=function(a){a=a||b.jMaskGlobals.maskElements;(a instanceof b?a:b(a)).filter(b.jMaskGlobals.dataMaskAttr).each(A)};var p={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},
9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};b.jMaskGlobals=b.jMaskGlobals||{};p=b.jMaskGlobals=b.extend(!0,{},p,b.jMaskGlobals);p.dataMask&&b.applyDataMask();setInterval(function(){b.jMaskGlobals.watchDataMask&&b.applyDataMask()},p.watchInterval)});

/*!
* jquery.inputmask.bundle.js
* https://github.com/RobinHerbots/Inputmask
* Copyright (c) 2010 - 2018 Robin Herbots
* Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
* Version: 4.0.0-beta.48
*/
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";var i,a,r,o;"function"==typeof Symbol&&Symbol.iterator;o=function(e){return e},a=[n(2)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t,n){"use strict";var i,a,r,o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o=function(e,t,n,i){var a=navigator.userAgent,r=f("touchstart"),o=/iemobile/i.test(a),l=/iphone/i.test(a)&&!o;function u(t,n,a){if(!(this instanceof u))return new u(t,n,a);this.el=i,this.events={},this.maskset=i,this.refreshValue=!1,!0!==a&&(e.isPlainObject(t)?n=t:(n=n||{},t&&(n.alias=t)),this.opts=e.extend(!0,{},this.defaults,n),this.noMasksCache=n&&n.definitions!==i,this.userOptions=n||{},this.isRTL=this.opts.numericInput,c(this.opts.alias,n,this.opts))}function c(t,n,a){var r=u.prototype.aliases[t];return r?(r.alias&&c(r.alias,i,a),e.extend(!0,a,r),e.extend(!0,a,n),!0):(null===a.mask&&(a.mask=t),!1)}function p(t,n){function a(t,a,r){var o=!1;if(null!==t&&""!==t||((o=null!==r.regex)?t=(t=r.regex).replace(/^(\^)(.*)(\$)$/,"$2"):(o=!0,t=".*")),1===t.length&&!1===r.greedy&&0!==r.repeat&&(r.placeholder=""),r.repeat>0||"*"===r.repeat||"+"===r.repeat){var s="*"===r.repeat?0:"+"===r.repeat?1:r.repeat;t=r.groupmarker[0]+t+r.groupmarker[1]+r.quantifiermarker[0]+s+","+r.repeat+r.quantifiermarker[1]}var l,c=o?"regex_"+r.regex:r.numericInput?t.split("").reverse().join(""):t;return u.prototype.masksCache[c]===i||!0===n?(l={mask:t,maskToken:u.prototype.analyseMask(t,o,r),validPositions:{},_buffer:i,buffer:i,tests:{},excludes:{},metadata:a,maskLength:i},!0!==n&&(u.prototype.masksCache[c]=l,l=e.extend(!0,{},u.prototype.masksCache[c]))):l=e.extend(!0,{},u.prototype.masksCache[c]),l}if(e.isFunction(t.mask)&&(t.mask=t.mask(t)),e.isArray(t.mask)){if(t.mask.length>1){if(null===t.keepStatic){t.keepStatic="auto";for(var r=0;r<t.mask.length;r++)if(t.mask[r].charAt(0)!==t.mask[0].charAt(0)){t.keepStatic=!0;break}}var o=t.groupmarker[0];return e.each(t.isRTL?t.mask.reverse():t.mask,function(n,a){o.length>1&&(o+=t.groupmarker[1]+t.alternatormarker+t.groupmarker[0]),a.mask===i||e.isFunction(a.mask)?o+=a:o+=a.mask}),a(o+=t.groupmarker[1],t.mask,t)}t.mask=t.mask.pop()}return t.mask&&t.mask.mask!==i&&!e.isFunction(t.mask.mask)?a(t.mask.mask,t.mask,t):a(t.mask,t.mask,t)}function f(e){var t=n.createElement("input"),i="on"+e,a=i in t;return a||(t.setAttribute(i,"return;"),a="function"==typeof t[i]),t=null,a}function m(a,c,p){c=c||this.maskset,p=p||this.opts;var d,h,g,v,k=this,y=this.el,b=this.isRTL,x=!1,P=!1,S=!1,A=!1,C=!1;function E(e,t,n,a){t=t||0;var r,o,s,l=[],u=0,c=O();do{if(!0===e&&M().validPositions[u])o=(s=M().validPositions[u]).match,r=s.locator.slice(),l.push(!0===n?s.input:!1===n?o.nativeDef:$(u,o));else{o=(s=F(u,r,u-1)).match,r=s.locator.slice();var f=!0!==a&&(!1!==p.jitMasking?p.jitMasking:o.jit);(!1===f||f===i||u<c||"number"==typeof f&&isFinite(f)&&f>u)&&l.push(!1===n?o.nativeDef:$(u,o))}"auto"===p.keepStatic&&o.newBlockMarker&&null!==o.fn&&(p.keepStatic=u-1),u++}while((g===i||u<g)&&(null!==o.fn||""!==o.def)||t>u);return""===l[l.length-1]&&l.pop(),!1===n&&M().maskLength!==i||(M().maskLength=u-1),l}function M(){return c}function w(e){var t=M();t.buffer=i,!0!==e&&(t.validPositions={},t.p=0)}function O(e,t,n){var a=-1,r=-1,o=n||M().validPositions;for(var s in e===i&&(e=-1),o){var l=parseInt(s);o[l]&&(t||!0!==o[l].generatedInput)&&(l<=e&&(a=l),l>=e&&(r=l))}return-1===a||a==e?r:-1==r?a:e-a<r-e?a:r}function D(e,t,n){for(var a,r=T(e=e>0?e-1:0,t),o=r.alternation!==i?r.locator[r.alternation].toString().split(","):[],s=0;s<t.length&&(!((a=t[s]).match&&(p.greedy&&!0!==a.match.optionalQuantifier||(!1===a.match.optionality||!1===a.match.newBlockMarker)&&!0!==a.match.optionalQuantifier)&&(r.alternation===i||r.alternation!==a.alternation||a.locator[r.alternation]!==i&&L(a.locator[r.alternation].toString().split(","),o)))||!0===n&&(null!==a.match.fn||/[0-9a-bA-Z]/.test(a.match.def)));s++);return a}function _(e){var t=e.locator[e.alternation];return"string"==typeof t&&t.length>0&&(t=t.split(",")[0]),t!==i?t.toString():""}function j(e,t){for(var n=(e.alternation!=i?e.mloc[_(e)]:e.locator).join("");n.length<t;)n+="0";return n}function F(e,t,n){return M().validPositions[e]||D(e,N(e,t?t.slice():t,n))}function T(e,t){return M().validPositions[e]?M().validPositions[e]:(t||N(e))[0]}function R(e,t){for(var n=!1,i=N(e),a=0;a<i.length;a++)if(i[a].match&&i[a].match.def===t){n=!0;break}return n}function N(t,n,a){var r,o,s,l,u=M().maskToken,c=n?a:0,f=n?n.slice():[0],m=[],d=!1,h=n?n.join(""):"";function g(n,a,o,s){function l(o,s,u){function f(t,n){var i=0===e.inArray(t,n.matches);return i||e.each(n.matches,function(e,a){if(!0===a.isQuantifier?i=f(t,n.matches[e-1]):!0===a.isOptional?i=f(t,a):!0===a.isAlternate&&(i=f(t,a)),i)return!1}),i}function v(t,n,a){var r,o;if((M().tests[t]||M().validPositions[t])&&e.each(M().tests[t]||[M().validPositions[t]],function(e,t){if(t.mloc[n])return r=t,!1;var s=a!==i?a:t.alternation,l=t.locator[s]!==i?t.locator[s].toString().indexOf(n):-1;(o===i||l<o)&&-1!==l&&(r=t,o=l)}),r){var s=r.locator[r.alternation];return(r.mloc[n]||r.mloc[s]||r.locator).slice((a!==i?a:r.alternation)+1)}return a!==i?v(t,n):i}function k(e,t){function n(e){for(var t,n,i=[],a=0,r=e.length;a<r;a++)if("-"===e.charAt(a))for(n=e.charCodeAt(a+1);++t<n;)i.push(String.fromCharCode(t));else t=e.charCodeAt(a),i.push(e.charAt(a));return i.join("")}return p.regex&&null!==e.match.fn&&null!==t.match.fn?-1!==n(t.match.def.replace(/[\[\]]/g,"")).indexOf(n(e.match.def.replace(/[\[\]]/g,""))):e.match.def===t.match.nativeDef}function y(e,t){if(t===i||e.alternation===t.alternation&&-1===e.locator[e.alternation].toString().indexOf(t.locator[t.alternation])){e.mloc=e.mloc||{};var n=e.locator[e.alternation];if(n!==i){if("string"==typeof n&&(n=n.split(",")[0]),e.mloc[n]===i&&(e.mloc[n]=e.locator.slice()),t!==i){for(var a in t.mloc)"string"==typeof a&&(a=a.split(",")[0]),e.mloc[a]===i&&(e.mloc[a]=t.mloc[a]);e.locator[e.alternation]=Object.keys(e.mloc).join(",")}return!0}e.alternation=i}return!1}if(c>5e3)throw"Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+M().mask;if(c===t&&o.matches===i)return m.push({match:o,locator:s.reverse(),cd:h,mloc:{}}),!0;if(o.matches!==i){if(o.isGroup&&u!==o){if(o=l(n.matches[e.inArray(o,n.matches)+1],s))return!0}else if(o.isOptional){var b=o;if(o=g(o,a,s,u)){if(r=m[m.length-1].match,u!==i||!f(r,b))return!0;d=!0,c=t}}else if(o.isAlternator){var x,P=o,S=[],A=m.slice(),C=s.length,E=a.length>0?a.shift():-1;if(-1===E||"string"==typeof E){var w,O=c,D=a.slice(),_=[];if("string"==typeof E)_=E.split(",");else for(w=0;w<P.matches.length;w++)_.push(w.toString());if(M().excludes[t]){for(var j=_.slice(),F=0,T=M().excludes[t].length;F<T;F++)_.splice(_.indexOf(M().excludes[t][F].toString()),1);0===_.length&&(M().excludes[t]=i,_=j)}(!0===p.keepStatic||isFinite(parseInt(p.keepStatic))&&O>=p.keepStatic)&&(_=_.slice(0,1));for(var R=!1,N=0;N<_.length;N++){w=parseInt(_[N]),m=[],a="string"==typeof E&&v(c,w,C)||D.slice(),P.matches[w]&&l(P.matches[w],[w].concat(s),u)?o=!0:0===N&&(R=!0),x=m.slice(),c=O,m=[];for(var G=0;G<x.length;G++){var I=x[G],B=!1;I.match.jit=I.match.jit||R,I.alternation=I.alternation||C,y(I);for(var L=0;L<S.length;L++){var H=S[L];if("string"!=typeof E||I.alternation!==i&&-1!==e.inArray(I.locator[I.alternation].toString(),_)){if(I.match.nativeDef===H.match.nativeDef){B=!0,y(H,I);break}if(k(I,H)){y(I,H)&&(B=!0,S.splice(S.indexOf(H),0,I));break}if(k(H,I)){y(H,I);break}if(Q=H,null===(z=I).match.fn&&null!==Q.match.fn&&Q.match.fn.test(z.match.def,M(),t,!1,p,!1)){y(I,H)&&(B=!0,S.splice(S.indexOf(H),0,I));break}}}B||S.push(I)}}m=A.concat(S),c=t,d=m.length>0,o=S.length>0,a=D.slice()}else o=l(P.matches[E]||n.matches[E],[E].concat(s),u);if(o)return!0}else if(o.isQuantifier&&u!==n.matches[e.inArray(o,n.matches)-1])for(var V=o,K=a.length>0?a.shift():0;K<(isNaN(V.quantifier.max)?K+1:V.quantifier.max)&&c<=t;K++){var U=n.matches[e.inArray(V,n.matches)-1];if(o=l(U,[K].concat(s),U)){if((r=m[m.length-1].match).optionalQuantifier=K>V.quantifier.min-1,r.jit=K+U.matches.indexOf(r)>=V.quantifier.jit,f(r,U)&&K>V.quantifier.min-1){d=!0,c=t;break}if(V.quantifier.jit!==i&&isNaN(V.quantifier.max)&&r.optionalQuantifier&&M().validPositions[t-1]===i){m.pop(),d=!0,c=t,h=i;break}return!0}}else if(o=g(o,a,s,u))return!0}else c++;var z,Q}for(var u=a.length>0?a.shift():0;u<n.matches.length;u++)if(!0!==n.matches[u].isQuantifier){var f=l(n.matches[u],[u].concat(o),s);if(f&&c===t)return f;if(c>t)break}}if(t>-1){if(n===i){for(var v,k=t-1;(v=M().validPositions[k]||M().tests[k])===i&&k>-1;)k--;v!==i&&k>-1&&(o=k,s=v,l=[],e.isArray(s)||(s=[s]),s.length>0&&(s[0].alternation===i?0===(l=D(o,s.slice()).locator.slice()).length&&(l=s[0].locator.slice()):e.each(s,function(e,t){if(""!==t.def)if(0===l.length)l=t.locator.slice();else for(var n=0;n<l.length;n++)t.locator[n]&&-1===l[n].toString().indexOf(t.locator[n])&&(l[n]+=","+t.locator[n])})),h=(f=l).join(""),c=k)}if(M().tests[t]&&M().tests[t][0].cd===h)return M().tests[t];for(var y=f.shift();y<u.length;y++){if(g(u[y],f,[y])&&c===t||c>t)break}}return(0===m.length||d)&&m.push({match:{fn:null,optionality:!0,casing:null,def:"",placeholder:""},locator:[],mloc:{},cd:h}),n!==i&&M().tests[t]?e.extend(!0,[],m):(M().tests[t]=e.extend(!0,[],m),M().tests[t])}function G(){return M()._buffer===i&&(M()._buffer=E(!1,1),M().buffer===i&&(M().buffer=M()._buffer.slice())),M()._buffer}function I(e){return M().buffer!==i&&!0!==e||(M().buffer=E(!0,O(),!0)),M().buffer}function B(e,t,n){var a,r;if(!0===e)w(),e=0,t=n.length;else for(a=e;a<t;a++)delete M().validPositions[a];for(r=e,a=e;a<t;a++)if(w(!0),n[a]!==p.skipOptionalPartCharacter){var o=V(r,n[a],!0,!0);!1!==o&&(w(!0),r=o.caret!==i?o.caret:o.pos+1)}}function L(t,n,a){for(var r,o=p.greedy?n:n.slice(0,1),s=!1,l=a!==i?a.split(","):[],u=0;u<l.length;u++)-1!==(r=t.indexOf(l[u]))&&t.splice(r,1);for(var c=0;c<t.length;c++)if(-1!==e.inArray(t[c],o)){s=!0;break}return s}function H(t,n,a,r,o){var s,l,u,c,p,f,m,d=e.extend(!0,{},M().validPositions),h=!1,g=o!==i?o:O();if(-1===g&&o===i)l=(c=T(s=0)).alternation;else for(;g>=0;g--)if((u=M().validPositions[g])&&u.alternation!==i){if(c&&c.locator[u.alternation]!==u.locator[u.alternation])break;s=g,l=M().validPositions[s].alternation,c=u}if(l!==i){m=parseInt(s),M().excludes[m]=M().excludes[m]||[],!0!==t&&M().excludes[m].push(_(c));var v=[],k=0;for(p=m;p<O(i,!0)+1;p++)(f=M().validPositions[p])&&!0!==f.generatedInput?v.push(f.input):p<t&&k++,delete M().validPositions[p];for(;M().excludes[m]&&M().excludes[m].length<10;){var y=-1*k,b=v.slice();for(M().tests[m]=i,w(!0),h=!0;b.length>0;){var x=b.shift();if(!(h=V(O(i,!0)+1,x,!1,r,!0)))break}if(h&&n!==i){var P=O(t)+1;for(p=m;p<O()+1;p++)((f=M().validPositions[p])===i||null==f.match.fn)&&p<t+y&&y++;h=V((t+=y)>P?P:t,n,a,r,!0)}if(h)break;if(w(),c=T(m),M().validPositions=e.extend(!0,{},d),!M().excludes[m]){h=H(t,n,a,r,m-1);break}var S=_(c);if(-1!==M().excludes[m].indexOf(S)){h=H(t,n,a,r,m-1);break}for(M().excludes[m].push(S),p=m;p<O(i,!0)+1;p++)delete M().validPositions[p]}}return M().excludes[m]=i,h}function V(t,n,a,r,o,s){function l(e){return b?e.begin-e.end>1||e.begin-e.end==1:e.end-e.begin>1||e.end-e.begin==1}a=!0===a;var c=t;function f(n,a,o){var s=!1;return e.each(N(n),function(c,f){var m=f.match;if(I(!0),!1!==(s=null!=m.fn?m.fn.test(a,M(),n,o,p,l(t)):(a===m.def||a===p.skipOptionalPartCharacter)&&""!==m.def&&{c:$(n,m,!0)||m.def,pos:n})){var d=s.c!==i?s.c:a,h=n;return d=d===p.skipOptionalPartCharacter&&null===m.fn?$(n,m,!0)||m.def:d,s.remove!==i&&(e.isArray(s.remove)||(s.remove=[s.remove]),e.each(s.remove.sort(function(e,t){return t-e}),function(e,t){U({begin:t,end:t+1})})),s.insert!==i&&(e.isArray(s.insert)||(s.insert=[s.insert]),e.each(s.insert.sort(function(e,t){return e-t}),function(e,t){V(t.pos,t.c,!0,r)})),!0!==s&&s.pos!==i&&s.pos!==n&&(h=s.pos),!0!==s&&s.pos===i&&s.c===i?!1:(U(t,e.extend({},f,{input:function(t,n,i){switch(p.casing||n.casing){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break;case"title":var a=M().validPositions[i-1];t=0===i||a&&a.input===String.fromCharCode(u.keyCode.SPACE)?t.toUpperCase():t.toLowerCase();break;default:if(e.isFunction(p.casing)){var r=Array.prototype.slice.call(arguments);r.push(M().validPositions),t=p.casing.apply(this,r)}}return t}(d,m,h)}),r,h)||(s=!1),!1)}}),s}t.begin!==i&&(c=b?t.end:t.begin);var m=!0,d=e.extend(!0,{},M().validPositions);if(e.isFunction(p.preValidation)&&!a&&!0!==r&&!0!==s&&(m=p.preValidation(I(),c,n,l(t),p,M())),!0===m){if(K(i,c,!0),(g===i||c<g)&&(m=f(c,n,a),(!a||!0===r)&&!1===m&&!0!==s)){var h=M().validPositions[c];if(!h||null!==h.match.fn||h.match.def!==n&&n!==p.skipOptionalPartCharacter){if((p.insertMode||M().validPositions[Q(c)]===i)&&!z(c,!0))for(var v=c+1,k=Q(c);v<=k;v++)if(!1!==(m=f(v,n,a))){m=K(c,m.pos!==i?m.pos:v)||m,c=v;break}}else m={caret:Q(c)}}!1!==m||!1===p.keepStatic||null!=p.regex&&!re(I())||a||!0===o||(m=H(c,n,a,r)),!0===m&&(m={pos:c})}if(e.isFunction(p.postValidation)&&!1!==m&&!a&&!0!==r&&!0!==s){var y=p.postValidation(I(!0),m,p);if(y!==i){if(y.refreshFromBuffer&&y.buffer){var x=y.refreshFromBuffer;B(!0===x?x:x.start,x.end,y.buffer)}m=!0===y?m:y}}return m&&m.pos===i&&(m.pos=c),!1!==m&&!0!==s||(w(!0),M().validPositions=e.extend(!0,{},d)),m}function K(t,n,a){var r;if(t===i)for(t=n-1;t>0&&!M().validPositions[t];t--);for(var o=t;o<n;o++)if(M().validPositions[o]===i&&!z(o,!0)){var s=0==o?T(o):M().validPositions[o-1];if(s){var l,u=j(s),c=N(o).slice(),p=i,f=T(o);if(""===c[c.length-1].match.def&&c.pop(),e.each(c,function(e,t){l=j(t,u.length);var n=Math.abs(l-u);(p===i||n<p)&&null===t.match.fn&&!0!==t.match.optionality&&!0!==t.match.optionalQuantifier&&(p=n,f=t)}),(f=e.extend({},f,{input:$(o,f.match,!0)||f.match.def})).generatedInput=!0,U(o,f,!0),!0!==a){var m=M().validPositions[n].input;M().validPositions[n]=i,r=V(n,m,!0,!0)}}}return r}function U(t,n,a,r){function o(e,t,n){var a=t[e];if(a!==i&&(null===a.match.fn&&!0!==a.match.optionality||a.input===p.radixPoint)){var r=n.begin<=e-1?t[e-1]&&null===t[e-1].match.fn&&t[e-1]:t[e-1],o=n.end>e+1?t[e+1]&&null===t[e+1].match.fn&&t[e+1]:t[e+1];return r&&o}return!1}var s=t.begin!==i?t.begin:t,l=t.end!==i?t.end:t;if(t.begin>t.end&&(s=t.end,l=t.begin),r=r!==i?r:s,s!==l||p.insertMode&&M().validPositions[r]!==i&&a===i){var u=e.extend(!0,{},M().validPositions),c=O(i,!0);for(M().p=s,g=c;g>=s;g--)M().validPositions[g]&&"+"===M().validPositions[g].match.nativeDef&&(p.isNegative=!1),delete M().validPositions[g];var f=!0,m=r,d=(M().validPositions,!1),h=m,g=m;for(n&&(M().validPositions[r]=e.extend(!0,{},n),h++,m++,s<l&&g++);g<=c;g++){var v=u[g];if(v!==i&&(g>=l||g>=s&&!0!==v.generatedInput&&o(g,u,{begin:s,end:l}))){for(;""!==T(h).match.def;){if(!1===d&&u[h]&&u[h].match.nativeDef===v.match.nativeDef)M().validPositions[h]=e.extend(!0,{},u[h]),M().validPositions[h].input=v.input,K(i,h,!0),m=h+1,f=!0;else if(R(h,v.match.def)){var k=V(h,v.input,!0,!0);f=!1!==k,m=k.caret||k.insert?O():h+1,d=!0}else if(!(f=!0===v.generatedInput||v.input===p.radixPoint&&!0===p.numericInput)&&""===T(h).match.def)break;if(f)break;h++}""==T(h).match.def&&(f=!1),h=m}if(!f)break}if(!f)return M().validPositions=e.extend(!0,{},u),w(!0),!1}else n&&(M().validPositions[r]=e.extend(!0,{},n));return w(!0),!0}function z(e,t){var n=F(e).match;if(""===n.def&&(n=T(e).match),null!=n.fn)return n.fn;if(!0!==t&&e>-1){var i=N(e);return i.length>1+(""===i[i.length-1].match.def?1:0)}return!1}function Q(e,t){for(var n=e+1;""!==T(n).match.def&&(!0===t&&(!0!==T(n).match.newBlockMarker||!z(n))||!0!==t&&!z(n));)n++;return n}function q(e,t){var n,i=e;if(i<=0)return 0;for(;--i>0&&(!0===t&&!0!==T(i).match.newBlockMarker||!0!==t&&!z(i)&&((n=N(i)).length<2||2===n.length&&""===n[1].match.def)););return i}function W(t,n,a,r,o){if(r&&e.isFunction(p.onBeforeWrite)){var s=p.onBeforeWrite.call(k,r,n,a,p);if(s){if(s.refreshFromBuffer){var l=s.refreshFromBuffer;B(!0===l?l:l.start,l.end,s.buffer||n),n=I(!0)}a!==i&&(a=s.caret!==i?s.caret:a)}}if(t!==i&&(t.inputmask._valueSet(n.join("")),a===i||r!==i&&"blur"===r.type?le(t,a,0===n.length):ne(t,a),!0===o)){var u=e(t),c=t.inputmask._valueGet();P=!0,u.trigger("input"),setTimeout(function(){c===G().join("")?u.trigger("cleared"):!0===re(n)&&u.trigger("complete")},0)}}function $(t,n,a){if((n=n||T(t).match).placeholder!==i||!0===a)return e.isFunction(n.placeholder)?n.placeholder(p):n.placeholder;if(null===n.fn){if(t>-1&&M().validPositions[t]===i){var r,o=N(t),s=[];if(o.length>1+(""===o[o.length-1].match.def?1:0))for(var l=0;l<o.length;l++)if(!0!==o[l].match.optionality&&!0!==o[l].match.optionalQuantifier&&(null===o[l].match.fn||r===i||!1!==o[l].match.fn.test(r.match.def,M(),t,!0,p))&&(s.push(o[l]),null===o[l].match.fn&&(r=o[l]),s.length>1&&/[0-9a-bA-Z]/.test(s[0].match.def)))return p.placeholder.charAt(t%p.placeholder.length)}return n.def}return p.placeholder.charAt(t%p.placeholder.length)}var Z,J={on:function(t,n,a){var s=function(t){var n=this;if(n.inputmask===i&&"FORM"!==this.nodeName){var s=e.data(n,"_inputmask_opts");s?new u(s).mask(n):J.off(n)}else{if("setvalue"===t.type||"FORM"===this.nodeName||!(n.disabled||n.readOnly&&!("keydown"===t.type&&t.ctrlKey&&67===t.keyCode||!1===p.tabThrough&&t.keyCode===u.keyCode.TAB))){switch(t.type){case"input":if(!0===P)return P=!1,t.preventDefault();r&&(C=!0);break;case"keydown":x=!1,P=!1;break;case"keypress":if(!0===x)return t.preventDefault();x=!0;break;case"click":if(o||l){var c=arguments;return setTimeout(function(){a.apply(n,c)},0),!1}}var f=a.apply(n,arguments);return C&&(C=!1,setTimeout(function(){ne(n,n.inputmask.caretPos,i,!0)})),!1===f&&(t.preventDefault(),t.stopPropagation()),f}t.preventDefault()}};t.inputmask.events[n]=t.inputmask.events[n]||[],t.inputmask.events[n].push(s),-1!==e.inArray(n,["submit","reset"])?null!==t.form&&e(t.form).on(n,s):e(t).on(n,s)},off:function(t,n){var i;t.inputmask&&t.inputmask.events&&(n?(i=[])[n]=t.inputmask.events[n]:i=t.inputmask.events,e.each(i,function(n,i){for(;i.length>0;){var a=i.pop();-1!==e.inArray(n,["submit","reset"])?null!==t.form&&e(t.form).off(n,a):e(t).off(n,a)}delete t.inputmask.events[n]}))}},Y={keydownEvent:function(t){var n=this,i=e(n),a=t.keyCode,r=ne(n);if(a===u.keyCode.BACKSPACE||a===u.keyCode.DELETE||l&&a===u.keyCode.BACKSPACE_SAFARI||t.ctrlKey&&a===u.keyCode.X&&!f("cut"))t.preventDefault(),oe(n,a,r),W(n,I(!0),M().p,t,n.inputmask._valueGet()!==I().join(""));else if(a===u.keyCode.END||a===u.keyCode.PAGE_DOWN){t.preventDefault();var o=Q(O());p.insertMode||o!==M().maskLength||t.shiftKey||o--,ne(n,t.shiftKey?r.begin:o,o,!0)}else a===u.keyCode.HOME&&!t.shiftKey||a===u.keyCode.PAGE_UP?(t.preventDefault(),ne(n,0,t.shiftKey?r.begin:0,!0)):(p.undoOnEscape&&a===u.keyCode.ESCAPE||90===a&&t.ctrlKey)&&!0!==t.altKey?(X(n,!0,!1,d.split("")),i.trigger("click")):a!==u.keyCode.INSERT||t.shiftKey||t.ctrlKey?!0===p.tabThrough&&a===u.keyCode.TAB?(!0===t.shiftKey?(null===T(r.begin).match.fn&&(r.begin=Q(r.begin)),r.end=q(r.begin,!0),r.begin=q(r.end,!0)):(r.begin=Q(r.begin,!0),r.end=Q(r.begin,!0),r.end<M().maskLength&&r.end--),r.begin<M().maskLength&&(t.preventDefault(),ne(n,r.begin,r.end))):t.shiftKey||!1===p.insertMode&&(a===u.keyCode.RIGHT?setTimeout(function(){var e=ne(n);ne(n,e.begin)},0):a===u.keyCode.LEFT&&setTimeout(function(){var e=ne(n);ne(n,b?e.begin+1:e.begin-1)},0)):(p.insertMode=!p.insertMode,ne(n,p.insertMode||r.begin!==M().maskLength?r.begin:r.begin-1));p.onKeyDown.call(this,t,I(),ne(n).begin,p),S=-1!==e.inArray(a,p.ignorables)},keypressEvent:function(t,n,a,r,o){var s=this,l=e(s),c=t.which||t.charCode||t.keyCode;if(!(!0===n||t.ctrlKey&&t.altKey)&&(t.ctrlKey||t.metaKey||S))return c===u.keyCode.ENTER&&d!==I().join("")&&(d=I().join(""),setTimeout(function(){l.trigger("change")},0)),!0;if(c){46===c&&!1===t.shiftKey&&""!==p.radixPoint&&(c=p.radixPoint.charCodeAt(0));var f,m=n?{begin:o,end:o}:ne(s),h=String.fromCharCode(c),g=0;if(p._radixDance&&p.numericInput){var v=I().indexOf(p.radixPoint.charAt(0))+1;m.begin<=v&&(c===p.radixPoint.charCodeAt(0)&&(g=1),m.begin-=1,m.end-=1)}M().writeOutBuffer=!0;var k=V(m,h,r);if(!1!==k&&(w(!0),f=k.caret!==i?k.caret:Q(k.pos.begin?k.pos.begin:k.pos),M().p=f),f=(p.numericInput&&k.caret===i?q(f):f)+g,!1!==a&&(setTimeout(function(){p.onKeyValidation.call(s,c,k,p)},0),M().writeOutBuffer&&!1!==k)){var y=I();W(s,y,f,t,!0!==n)}if(t.preventDefault(),n)return!1!==k&&(k.forwardPosition=f),k}},pasteEvent:function(n){var i,a=this,r=n.originalEvent||n,o=(e(a),a.inputmask._valueGet(!0)),s=ne(a);b&&(i=s.end,s.end=s.begin,s.begin=i);var l=o.substr(0,s.begin),u=o.substr(s.end,o.length);if(l===(b?G().reverse():G()).slice(0,s.begin).join("")&&(l=""),u===(b?G().reverse():G()).slice(s.end).join("")&&(u=""),b&&(i=l,l=u,u=i),t.clipboardData&&t.clipboardData.getData)o=l+t.clipboardData.getData("Text")+u;else{if(!r.clipboardData||!r.clipboardData.getData)return!0;o=l+r.clipboardData.getData("text/plain")+u}var c=o;if(e.isFunction(p.onBeforePaste)){if(!1===(c=p.onBeforePaste.call(k,o,p)))return n.preventDefault();c||(c=o)}return X(a,!1,!1,b?c.split("").reverse():c.toString().split("")),W(a,I(),Q(O()),n,d!==I().join("")),n.preventDefault()},inputFallBackEvent:function(t){var n,i,a=this,r=a.inputmask._valueGet();if(I().join("")!==r){var s=ne(a);if(i=s,"."===(n=r).charAt(i.begin-1)&&""!==p.radixPoint&&((n=n.split(""))[i.begin-1]=p.radixPoint.charAt(0),n=n.join("")),r=function(e,t,n){if(o){var i=t.replace(I().join(""),"");if(1===i.length){var a=t.split("");a.splice(n.begin,0,i),t=a.join("")}}return t}(0,r=n,s),I().join("")!==r){var l=I().join(""),c=!p.numericInput&&r.length>l.length?-1:0,f=r.substr(0,s.begin),m=r.substr(s.begin),d=l.substr(0,s.begin+c),h=l.substr(s.begin+c),g=s,v="",k=!1;if(f!==d){for(var y=(k=f.length>=d.length)?f.length:d.length,b=0;f.charAt(b)===d.charAt(b)&&b<y;b++);k&&(0===c&&(g.begin=b),v+=f.slice(b,g.end))}if(m!==h&&(m.length>h.length?v+=m.slice(0,1):m.length<h.length&&(g.end+=h.length-m.length,k||""===p.radixPoint||""!==m||f.charAt(g.begin+c-1)!==p.radixPoint||(g.begin--,v=p.radixPoint))),W(a,I(),{begin:g.begin+c,end:g.end+c}),v.length>0)e.each(v.split(""),function(t,n){var i=new e.Event("keypress");i.which=n.charCodeAt(0),S=!1,Y.keypressEvent.call(a,i)});else{g.begin===g.end-1&&(g.begin=q(g.begin+1),g.begin===g.end-1?ne(a,g.begin):ne(a,g.begin,g.end));var x=new e.Event("keydown");x.keyCode=p.numericInput?u.keyCode.BACKSPACE:u.keyCode.DELETE,Y.keydownEvent.call(a,x),!1===p.insertMode&&ne(a,ne(a).begin-1)}t.preventDefault()}}},setValueEvent:function(t){this.inputmask.refreshValue=!1;var n=(n=t&&t.detail?t.detail[0]:arguments[1])||this.inputmask._valueGet(!0);e.isFunction(p.onBeforeMask)&&(n=p.onBeforeMask.call(k,n,p)||n),n=n.split(""),X(this,!0,!1,b?n.reverse():n),d=I().join(""),(p.clearMaskOnLostFocus||p.clearIncomplete)&&this.inputmask._valueGet()===G().join("")&&this.inputmask._valueSet("")},focusEvent:function(e){var t=this,n=t.inputmask._valueGet();p.showMaskOnFocus&&(!p.showMaskOnHover||p.showMaskOnHover&&""===n)&&(t.inputmask._valueGet()!==I().join("")?W(t,I(),Q(O())):!1===A&&ne(t,Q(O()))),!0===p.positionCaretOnTab&&!1===A&&Y.clickEvent.apply(t,[e,!0]),d=I().join("")},mouseleaveEvent:function(e){if(A=!1,p.clearMaskOnLostFocus&&n.activeElement!==this){var t=I().slice(),i=this.inputmask._valueGet();i!==this.getAttribute("placeholder")&&""!==i&&(-1===O()&&i===G().join("")?t=[]:ae(t),W(this,t))}},clickEvent:function(t,a){var r=this;setTimeout(function(){if(n.activeElement===r){var t=ne(r);if(a&&(b?t.end=t.begin:t.begin=t.end),t.begin===t.end)switch(p.positionCaretOnClick){case"none":break;case"select":ne(r,0,I().length);break;case"radixFocus":if(function(t){if(""!==p.radixPoint){var n=M().validPositions;if(n[t]===i||n[t].input===$(t)){if(t<Q(-1))return!0;var a=e.inArray(p.radixPoint,I());if(-1!==a){for(var r in n)if(a<r&&n[r].input!==$(r))return!1;return!0}}}return!1}(t.begin)){var o=I().join("").indexOf(p.radixPoint);ne(r,p.numericInput?Q(o):o);break}case"ignore":ne(r,Q(O()));break;default:var s=t.begin,l=O(s,!0),u=Q(l);if(s<u)ne(r,z(s,!0)||z(s-1,!0)?s:Q(s));else{var c=M().validPositions[l],f=F(u,c?c.match.locator:i,c),m=$(u,f.match);if(""!==m&&I()[u]!==m&&!0!==f.match.optionalQuantifier&&!0!==f.match.newBlockMarker||!z(u,p.keepStatic)&&f.match.def===m){var d=Q(u);(s>=d||s===u)&&(u=d)}ne(r,u)}}}},0)},dblclickEvent:function(e){var t=this;setTimeout(function(){ne(t,0,Q(O()))},0)},cutEvent:function(i){e(this);var a=ne(this),r=i.originalEvent||i,o=t.clipboardData||r.clipboardData,s=b?I().slice(a.end,a.begin):I().slice(a.begin,a.end);o.setData("text",b?s.reverse().join(""):s.join("")),n.execCommand&&n.execCommand("copy"),oe(this,u.keyCode.DELETE,a),W(this,I(),M().p,i,d!==I().join(""))},blurEvent:function(t){var n=e(this);if(this.inputmask){var a=this.inputmask._valueGet(),r=I().slice();""===a&&v===i||(p.clearMaskOnLostFocus&&(-1===O()&&a===G().join("")?r=[]:ae(r)),!1===re(r)&&(setTimeout(function(){n.trigger("incomplete")},0),p.clearIncomplete&&(w(),r=p.clearMaskOnLostFocus?[]:G().slice())),W(this,r,i,t)),d!==I().join("")&&(d=r.join(""),n.trigger("change"))}},mouseenterEvent:function(e){A=!0,n.activeElement!==this&&p.showMaskOnHover&&this.inputmask._valueGet()!==I().join("")&&W(this,I())},submitEvent:function(e){d!==I().join("")&&h.trigger("change"),p.clearMaskOnLostFocus&&-1===O()&&y.inputmask._valueGet&&y.inputmask._valueGet()===G().join("")&&y.inputmask._valueSet(""),p.clearIncomplete&&!1===re(I())&&y.inputmask._valueSet(""),p.removeMaskOnSubmit&&(y.inputmask._valueSet(y.inputmask.unmaskedvalue(),!0),setTimeout(function(){W(y,I())},0))},resetEvent:function(e){y.inputmask.refreshValue=!0,setTimeout(function(){h.trigger("setvalue")},0)}};function X(t,n,a,r,o){var s=r.slice(),l="",c=-1,f=i;if(w(),a||!0===p.autoUnmask)c=Q(c);else{var m=G().slice(0,Q(-1)).join(""),d=s.join("").match(new RegExp("^"+u.escapeRegex(m),"g"));d&&d.length>0&&(s.splice(0,d.length*m.length),c=Q(c))}-1===c?(M().p=Q(c),c=0):M().p=c,e.each(s,function(n,r){if(r!==i)if(M().validPositions[n]===i&&s[n]===$(n)&&z(n,!0)&&!1===V(n,s[n],!0,i,i,!0))M().p++;else{var o=new e.Event("_checkval");o.which=r.charCodeAt(0),l+=r;var u=O(i,!0),m=T(u),d=F(u+1,m?m.locator.slice():i,u);if(g=c,v=l,-1===E(!0,0,!1).slice(g,Q(g)).join("").indexOf(v)||z(g)||T(g).match.nativeDef!==v.charAt(0)&&(" "!==T(g).match.nativeDef||T(g+1).match.nativeDef!==v.charAt(0))||a||p.autoUnmask){var h=a?n:null==d.match.fn&&d.match.optionality&&u+1<M().p?u+1:M().p;(f=Y.keypressEvent.call(t,o,!0,!1,a,h))&&(c=h+1,l="")}else f=Y.keypressEvent.call(t,o,!0,!1,!0,u+1);W(i,I(),f.forwardPosition,o,!1)}var g,v}),n&&W(t,I(),f?f.forwardPosition:i,o||new e.Event("checkval"),o&&"input"===o.type)}function ee(t){if(t){if(t.inputmask===i)return t.value;t.inputmask&&t.inputmask.refreshValue&&Y.setValueEvent.call(t)}var n=[],a=M().validPositions;for(var r in a)a[r].match&&null!=a[r].match.fn&&n.push(a[r].input);var o=0===n.length?"":(b?n.reverse():n).join("");if(e.isFunction(p.onUnMask)){var s=(b?I().slice().reverse():I()).join("");o=p.onUnMask.call(k,s,o,p)}return o}function te(e){return!b||"number"!=typeof e||p.greedy&&""===p.placeholder||(e=y.inputmask._valueGet().length-e),e}function ne(a,r,o,s){var u;if(r===i)return a.setSelectionRange?(r=a.selectionStart,o=a.selectionEnd):t.getSelection?(u=t.getSelection().getRangeAt(0)).commonAncestorContainer.parentNode!==a&&u.commonAncestorContainer!==a||(r=u.startOffset,o=u.endOffset):n.selection&&n.selection.createRange&&(o=(r=0-(u=n.selection.createRange()).duplicate().moveStart("character",-a.inputmask._valueGet().length))+u.text.length),{begin:s?r:te(r),end:s?o:te(o)};if(e.isArray(r)&&(o=b?r[0]:r[1],r=b?r[1]:r[0]),r.begin!==i&&(o=b?r.begin:r.end,r=b?r.end:r.begin),"number"==typeof r){r=s?r:te(r),o="number"==typeof(o=s?o:te(o))?o:r;var c=parseInt(((a.ownerDocument.defaultView||t).getComputedStyle?(a.ownerDocument.defaultView||t).getComputedStyle(a,null):a.currentStyle).fontSize)*o;if(a.scrollLeft=c>a.scrollWidth?c:0,l||!1!==p.insertMode||r!==o||o++,a.inputmask.caretPos={begin:r,end:o},a.setSelectionRange)a.selectionStart=r,a.selectionEnd=o;else if(t.getSelection){if(u=n.createRange(),a.firstChild===i||null===a.firstChild){var f=n.createTextNode("");a.appendChild(f)}u.setStart(a.firstChild,r<a.inputmask._valueGet().length?r:a.inputmask._valueGet().length),u.setEnd(a.firstChild,o<a.inputmask._valueGet().length?o:a.inputmask._valueGet().length),u.collapse(!0);var m=t.getSelection();m.removeAllRanges(),m.addRange(u)}else a.createTextRange&&((u=a.createTextRange()).collapse(!0),u.moveEnd("character",o),u.moveStart("character",r),u.select());le(a,{begin:r,end:o})}}function ie(t){var n,a,r=E(!0,O(),!0,!0),o=r.length,s=O(),l={},u=M().validPositions[s],c=u!==i?u.locator.slice():i;for(n=s+1;n<r.length;n++)c=(a=F(n,c,n-1)).locator.slice(),l[n]=e.extend(!0,{},a);var p=u&&u.alternation!==i?u.locator[u.alternation]:i;for(n=o-1;n>s&&(((a=l[n]).match.optionality||a.match.optionalQuantifier&&a.match.newBlockMarker||p&&(p!==l[n].locator[u.alternation]&&null!=a.match.fn||null===a.match.fn&&a.locator[u.alternation]&&L(a.locator[u.alternation].toString().split(","),p.toString().split(","))&&""!==N(n)[0].def))&&r[n]===$(n,a.match));n--)o--;return t?{l:o,def:l[o]?l[o].match:i}:o}function ae(e){for(var t,n=ie(),a=e.length,r=M().validPositions[O()];n<a&&!z(n,!0)&&(t=r!==i?F(n,r.locator.slice(""),r):T(n))&&!0!==t.match.optionality&&(!0!==t.match.optionalQuantifier&&!0!==t.match.newBlockMarker||n+1===a&&""===(r!==i?F(n+1,r.locator.slice(""),r):T(n+1)).match.def);)n++;for(;(t=M().validPositions[n-1])&&t&&t.match.optionality&&t.input===p.skipOptionalPartCharacter;)n--;return e.splice(n),e}function re(t){if(e.isFunction(p.isComplete))return p.isComplete(t,p);if("*"===p.repeat)return i;var n=!1,a=ie(!0),r=q(a.l);if(a.def===i||a.def.newBlockMarker||a.def.optionality||a.def.optionalQuantifier){n=!0;for(var o=0;o<=r;o++){var s=F(o).match;if(null!==s.fn&&M().validPositions[o]===i&&!0!==s.optionality&&!0!==s.optionalQuantifier||null===s.fn&&t[o]!==$(o,s)){n=!1;break}}}return n}function oe(e,t,n,a,r){if((p.numericInput||b)&&(t===u.keyCode.BACKSPACE?t=u.keyCode.DELETE:t===u.keyCode.DELETE&&(t=u.keyCode.BACKSPACE),b)){var o=n.end;n.end=n.begin,n.begin=o}if(t===u.keyCode.BACKSPACE&&(n.end-n.begin<1||!1===p.insertMode)?(n.begin=q(n.begin),M().validPositions[n.begin]!==i&&M().validPositions[n.begin].input===p.groupSeparator&&n.begin--,!1===p.insertMode&&n.end!==M().maskLength&&n.end--):t===u.keyCode.DELETE&&n.begin===n.end&&(n.end=z(n.end,!0)&&M().validPositions[n.end]&&M().validPositions[n.end].input!==p.radixPoint?n.end+1:Q(n.end)+1,M().validPositions[n.begin]!==i&&M().validPositions[n.begin].input===p.groupSeparator&&n.end++),U(n),!0!==a&&!1!==p.keepStatic||null!==p.regex){var s=H(!0);if(s){var l=s.caret!==i?s.caret:s.pos?Q(s.pos.begin?s.pos.begin:s.pos):O(-1,!0);(t!==u.keyCode.DELETE||n.begin>l)&&n.begin}}var c=O(n.begin,!0);if(c<n.begin||-1===n.begin)M().p=Q(c);else if(!0!==a&&(M().p=n.begin,!0!==r))for(;M().p<c&&M().validPositions[M().p]===i;)M().p++}function se(i){var a=(i.ownerDocument.defaultView||t).getComputedStyle(i,null);var r=n.createElement("div");r.style.width=a.width,r.style.textAlign=a.textAlign,v=n.createElement("div"),i.inputmask.colorMask=v,v.className="im-colormask",i.parentNode.insertBefore(v,i),i.parentNode.removeChild(i),v.appendChild(i),v.appendChild(r),i.style.left=r.offsetLeft+"px",e(v).on("mouseleave",function(e){return Y.mouseleaveEvent.call(i,[e])}),e(v).on("mouseenter",function(e){return Y.mouseenterEvent.call(i,[e])}),e(v).on("click",function(e){return ne(i,function(e){var t,r=n.createElement("span");for(var o in a)isNaN(o)&&-1!==o.indexOf("font")&&(r.style[o]=a[o]);r.style.textTransform=a.textTransform,r.style.letterSpacing=a.letterSpacing,r.style.position="absolute",r.style.height="auto",r.style.width="auto",r.style.visibility="hidden",r.style.whiteSpace="nowrap",n.body.appendChild(r);var s,l=i.inputmask._valueGet(),u=0;for(t=0,s=l.length;t<=s;t++){if(r.innerHTML+=l.charAt(t)||"_",r.offsetWidth>=e){var c=e-u,p=r.offsetWidth-e;r.innerHTML=l.charAt(t),t=(c-=r.offsetWidth/3)<p?t-1:t;break}u=r.offsetWidth}return n.body.removeChild(r),t}(e.clientX)),Y.clickEvent.call(i,[e])}),e(i).on("keydown",function(e){e.shiftKey||!1===p.insertMode||setTimeout(function(){le(i)},0)})}function le(e,t,a){var r,o,s,l=[],u=!1,c=0;function f(e){if(e===i&&(e=""),u||null!==r.fn&&o.input!==i)if(u&&(null!==r.fn&&o.input!==i||""===r.def)){u=!1;var t=l.length;l[t-1]=l[t-1]+"</span>",l.push(e)}else l.push(e);else u=!0,l.push("<span class='im-static'>"+e)}if(v!==i){var m=I();if(t===i?t=ne(e):t.begin===i&&(t={begin:t,end:t}),!0!==a){var d=O();do{M().validPositions[c]?(o=M().validPositions[c],r=o.match,s=o.locator.slice(),f(m[c])):(o=F(c,s,c-1),r=o.match,s=o.locator.slice(),!1===p.jitMasking||c<d||"number"==typeof p.jitMasking&&isFinite(p.jitMasking)&&p.jitMasking>c?f($(c,r)):u=!1),c++}while((g===i||c<g)&&(null!==r.fn||""!==r.def)||d>c||u);u&&f(),n.activeElement===e&&(l.splice(t.begin,0,t.begin===t.end||t.end>M().maskLength?'<mark class="im-caret" style="border-right-width: 1px;border-right-style: solid;">':'<mark class="im-caret-select">'),l.splice(t.end+1,0,"</mark>"))}var h=v.getElementsByTagName("div")[0];h.innerHTML=l.join(""),e.inputmask.positionColorMask(e,h)}}if(u.prototype.positionColorMask=function(e,t){e.style.left=t.offsetLeft+"px"},a!==i)switch(a.action){case"isComplete":return y=a.el,re(I());case"unmaskedvalue":return y!==i&&a.value===i||(Z=a.value,Z=(e.isFunction(p.onBeforeMask)&&p.onBeforeMask.call(k,Z,p)||Z).split(""),X(i,!1,!1,b?Z.reverse():Z),e.isFunction(p.onBeforeWrite)&&p.onBeforeWrite.call(k,i,I(),0,p)),ee(y);case"mask":!function(t){J.off(t);var a=function(t,a){var r=t.getAttribute("type"),o="INPUT"===t.tagName&&-1!==e.inArray(r,a.supportsInputType)||t.isContentEditable||"TEXTAREA"===t.tagName;if(!o)if("INPUT"===t.tagName){var l=n.createElement("input");l.setAttribute("type",r),o="text"===l.type,l=null}else o="partial";return!1!==o?function(t){var r,o,l;function u(){return this.inputmask?this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():-1!==O()||!0!==a.nullable?n.activeElement===this&&a.clearMaskOnLostFocus?(b?ae(I().slice()).reverse():ae(I().slice())).join(""):r.call(this):"":r.call(this)}function c(t){o.call(this,t),this.inputmask&&e(this).trigger("setvalue",[t])}if(!t.inputmask.__valueGet){if(!0!==a.noValuePatching){if(Object.getOwnPropertyDescriptor){"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===s("test".__proto__)?function(e){return e.__proto__}:function(e){return e.constructor.prototype});var p=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"value"):i;p&&p.get&&p.set?(r=p.get,o=p.set,Object.defineProperty(t,"value",{get:u,set:c,configurable:!0})):"INPUT"!==t.tagName&&(r=function(){return this.textContent},o=function(e){this.textContent=e},Object.defineProperty(t,"value",{get:u,set:c,configurable:!0}))}else n.__lookupGetter__&&t.__lookupGetter__("value")&&(r=t.__lookupGetter__("value"),o=t.__lookupSetter__("value"),t.__defineGetter__("value",u),t.__defineSetter__("value",c));t.inputmask.__valueGet=r,t.inputmask.__valueSet=o}t.inputmask._valueGet=function(e){return b&&!0!==e?r.call(this.el).split("").reverse().join(""):r.call(this.el)},t.inputmask._valueSet=function(e,t){o.call(this.el,null===e||e===i?"":!0!==t&&b?e.split("").reverse().join(""):e)},r===i&&(r=function(){return this.value},o=function(e){this.value=e},function(t){if(e.valHooks&&(e.valHooks[t]===i||!0!==e.valHooks[t].inputmaskpatch)){var n=e.valHooks[t]&&e.valHooks[t].get?e.valHooks[t].get:function(e){return e.value},r=e.valHooks[t]&&e.valHooks[t].set?e.valHooks[t].set:function(e,t){return e.value=t,e};e.valHooks[t]={get:function(e){if(e.inputmask){if(e.inputmask.opts.autoUnmask)return e.inputmask.unmaskedvalue();var t=n(e);return-1!==O(i,i,e.inputmask.maskset.validPositions)||!0!==a.nullable?t:""}return n(e)},set:function(t,n){var i,a=e(t);return i=r(t,n),t.inputmask&&a.trigger("setvalue",[n]),i},inputmaskpatch:!0}}}(t.type),l=t,J.on(l,"mouseenter",function(t){var n=e(this);this.inputmask._valueGet()!==I().join("")&&n.trigger("setvalue")}))}}(t):t.inputmask=i,o}(t,p);if(!1!==a&&(h=e(y=t),-1===(g=y!==i?y.maxLength:i)&&(g=i),!0===p.colorMask&&se(y),r&&("inputmode"in y&&(y.inputmode=p.inputmode,y.setAttribute("inputmode",p.inputmode)),!0===p.disablePredictiveText&&("autocorrect"in y?y.autocorrect=!1:(!0!==p.colorMask&&se(y),y.type="password"))),!0===a&&(J.on(y,"submit",Y.submitEvent),J.on(y,"reset",Y.resetEvent),J.on(y,"blur",Y.blurEvent),J.on(y,"focus",Y.focusEvent),!0!==p.colorMask&&(J.on(y,"click",Y.clickEvent),J.on(y,"mouseleave",Y.mouseleaveEvent),J.on(y,"mouseenter",Y.mouseenterEvent)),J.on(y,"dblclick",Y.dblclickEvent),J.on(y,"paste",Y.pasteEvent),J.on(y,"dragdrop",Y.pasteEvent),J.on(y,"drop",Y.pasteEvent),J.on(y,"cut",Y.cutEvent),J.on(y,"complete",p.oncomplete),J.on(y,"incomplete",p.onincomplete),J.on(y,"cleared",p.oncleared),r||!0===p.inputEventOnly?y.removeAttribute("maxLength"):(J.on(y,"keydown",Y.keydownEvent),J.on(y,"keypress",Y.keypressEvent)),J.on(y,"compositionstart",e.noop),J.on(y,"compositionupdate",e.noop),J.on(y,"compositionend",e.noop),J.on(y,"keyup",e.noop),J.on(y,"input",Y.inputFallBackEvent),J.on(y,"beforeinput",e.noop)),J.on(y,"setvalue",Y.setValueEvent),d=G().join(""),""!==y.inputmask._valueGet(!0)||!1===p.clearMaskOnLostFocus||n.activeElement===y)){var o=e.isFunction(p.onBeforeMask)&&p.onBeforeMask.call(k,y.inputmask._valueGet(!0),p)||y.inputmask._valueGet(!0);""!==o&&X(y,!0,!1,b?o.split("").reverse():o.split(""));var l=I().slice();d=l.join(""),!1===re(l)&&p.clearIncomplete&&w(),p.clearMaskOnLostFocus&&n.activeElement!==y&&(-1===O()?l=[]:ae(l)),(!1===p.clearMaskOnLostFocus||p.showMaskOnFocus&&n.activeElement===y||""!==y.inputmask._valueGet(!0))&&W(y,l),n.activeElement===y&&ne(y,Q(O()))}}(y);break;case"format":return Z=(e.isFunction(p.onBeforeMask)&&p.onBeforeMask.call(k,a.value,p)||a.value).split(""),X(i,!0,!1,b?Z.reverse():Z),a.metadata?{value:b?I().slice().reverse().join(""):I().join(""),metadata:m.call(this,{action:"getmetadata"},c,p)}:b?I().slice().reverse().join(""):I().join("");case"isValid":a.value?(Z=a.value.split(""),X(i,!0,!0,b?Z.reverse():Z)):a.value=I().join("");for(var ue=I(),ce=ie(),pe=ue.length-1;pe>ce&&!z(pe);pe--);return ue.splice(ce,pe+1-ce),re(ue)&&a.value===I().join("");case"getemptymask":return G().join("");case"remove":if(y&&y.inputmask)e.data(y,"_inputmask_opts",null),h=e(y),y.inputmask._valueSet(p.autoUnmask?ee(y):y.inputmask._valueGet(!0)),J.off(y),y.inputmask.colorMask&&((v=y.inputmask.colorMask).removeChild(y),v.parentNode.insertBefore(y,v),v.parentNode.removeChild(v)),Object.getOwnPropertyDescriptor&&Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(y),"value")&&y.inputmask.__valueGet&&Object.defineProperty(y,"value",{get:y.inputmask.__valueGet,set:y.inputmask.__valueSet,configurable:!0}):n.__lookupGetter__&&y.__lookupGetter__("value")&&y.inputmask.__valueGet&&(y.__defineGetter__("value",y.inputmask.__valueGet),y.__defineSetter__("value",y.inputmask.__valueSet)),y.inputmask=i;return y;case"getmetadata":if(e.isArray(c.metadata)){var fe=E(!0,0,!1).join("");return e.each(c.metadata,function(e,t){if(t.mask===fe)return fe=t,!1}),fe}return c.metadata}}return u.prototype={dataAttribute:"data-inputmask",defaults:{placeholder:"_",optionalmarker:["[","]"],quantifiermarker:["{","}"],groupmarker:["(",")"],alternatormarker:"|",escapeChar:"\\",mask:null,regex:null,oncomplete:e.noop,onincomplete:e.noop,oncleared:e.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,alias:null,onKeyDown:e.noop,onBeforeMask:null,onBeforePaste:function(t,n){return e.isFunction(n.onBeforeMask)?n.onBeforeMask.call(this,t,n):t},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:e.noop,skipOptionalPartCharacter:" ",numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",_radixDance:!1,groupSeparator:"",keepStatic:null,positionCaretOnTab:!0,tabThrough:!1,supportsInputType:["text","tel","password","search"],ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123,0,229],isComplete:null,preValidation:null,postValidation:null,staticDefinitionSymbol:i,jitMasking:!1,nullable:!0,inputEventOnly:!1,noValuePatching:!1,positionCaretOnClick:"lvp",casing:null,inputmode:"verbatim",colorMask:!1,disablePredictiveText:!1,importDataAttributes:!0},definitions:{9:{validator:"[0-9ï¼‘-ï¼™]",definitionSymbol:"*"},a:{validator:"[A-Za-zÐ-ÑÐÑ‘Ã€-Ã¿Âµ]",definitionSymbol:"*"},"*":{validator:"[0-9ï¼‘-ï¼™A-Za-zÐ-ÑÐÑ‘Ã€-Ã¿Âµ]"}},aliases:{},masksCache:{},mask:function(a){var r=this;return"string"==typeof a&&(a=n.getElementById(a)||n.querySelectorAll(a)),a=a.nodeName?[a]:a,e.each(a,function(n,a){var o=e.extend(!0,{},r.opts);if(function(n,a,r,o){if(!0===a.importDataAttributes){var s,l,u,p,f=function(e,a){null!==(a=a!==i?a:n.getAttribute(o+"-"+e))&&("string"==typeof a&&(0===e.indexOf("on")?a=t[a]:"false"===a?a=!1:"true"===a&&(a=!0)),r[e]=a)},m=n.getAttribute(o);if(m&&""!==m&&(m=m.replace(/'/g,'"'),l=JSON.parse("{"+m+"}")),l)for(p in u=i,l)if("alias"===p.toLowerCase()){u=l[p];break}for(s in f("alias",u),r.alias&&c(r.alias,r,a),a){if(l)for(p in u=i,l)if(p.toLowerCase()===s.toLowerCase()){u=l[p];break}f(s,u)}}return e.extend(!0,a,r),("rtl"===n.dir||a.rightAlign)&&(n.style.textAlign="right"),("rtl"===n.dir||a.numericInput)&&(n.dir="ltr",n.removeAttribute("dir"),a.isRTL=!0),Object.keys(r).length}(a,o,e.extend(!0,{},r.userOptions),r.dataAttribute)){var s=p(o,r.noMasksCache);s!==i&&(a.inputmask!==i&&(a.inputmask.opts.autoUnmask=!0,a.inputmask.remove()),a.inputmask=new u(i,i,!0),a.inputmask.opts=o,a.inputmask.noMasksCache=r.noMasksCache,a.inputmask.userOptions=e.extend(!0,{},r.userOptions),a.inputmask.isRTL=o.isRTL||o.numericInput,a.inputmask.el=a,a.inputmask.maskset=s,e.data(a,"_inputmask_opts",o),m.call(a.inputmask,{action:"mask"}))}}),a&&a[0]&&a[0].inputmask||this},option:function(t,n){return"string"==typeof t?this.opts[t]:"object"===(void 0===t?"undefined":s(t))?(e.extend(this.userOptions,t),this.el&&!0!==n&&this.mask(this.el),this):void 0},unmaskedvalue:function(e){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"unmaskedvalue",value:e})},remove:function(){return m.call(this,{action:"remove"})},getemptymask:function(){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"getemptymask"})},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"isComplete"})},getmetadata:function(){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"getmetadata"})},isValid:function(e){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"isValid",value:e})},format:function(e,t){return this.maskset=this.maskset||p(this.opts,this.noMasksCache),m.call(this,{action:"format",value:e,metadata:t})},setValue:function(t){this.el&&e(this.el).trigger("setvalue",[t])},analyseMask:function(t,n,a){var r,o,s,l,c,p,f=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?(?:\|[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,m=/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,d=!1,h=new k,g=[],v=[];function k(e,t,n,i){this.matches=[],this.openGroup=e||!1,this.alternatorGroup=!1,this.isGroup=e||!1,this.isOptional=t||!1,this.isQuantifier=n||!1,this.isAlternator=i||!1,this.quantifier={min:1,max:1}}function y(t,r,o){o=o!==i?o:t.matches.length;var s=t.matches[o-1];if(n)0===r.indexOf("[")||d&&/\\d|\\s|\\w]/i.test(r)||"."===r?t.matches.splice(o++,0,{fn:new RegExp(r,a.casing?"i":""),optionality:t.isOptional,newBlockMarker:s===i||s.def!==r,casing:null,def:r,placeholder:i,nativeDef:r}):(d&&(r=r[r.length-1]),e.each(r.split(""),function(e,n){s=t.matches[o-1],t.matches.splice(o++,0,{fn:null,optionality:t.isOptional,newBlockMarker:s===i||s.def!==n&&null!==s.fn,casing:null,def:a.staticDefinitionSymbol||n,placeholder:a.staticDefinitionSymbol!==i?n:i,nativeDef:n})})),d=!1;else{var l=(a.definitions?a.definitions[r]:i)||u.prototype.definitions[r];l&&!d?t.matches.splice(o++,0,{fn:l.validator?"string"==typeof l.validator?new RegExp(l.validator,a.casing?"i":""):new function(){this.test=l.validator}:new RegExp("."),optionality:t.isOptional,newBlockMarker:s===i||s.def!==(l.definitionSymbol||r),casing:l.casing,def:l.definitionSymbol||r,placeholder:l.placeholder,nativeDef:r}):(t.matches.splice(o++,0,{fn:null,optionality:t.isOptional,newBlockMarker:s===i||s.def!==r&&null!==s.fn,casing:null,def:a.staticDefinitionSymbol||r,placeholder:a.staticDefinitionSymbol!==i?r:i,nativeDef:r}),d=!1)}}function b(){if(g.length>0){if(y(l=g[g.length-1],o),l.isAlternator){c=g.pop();for(var e=0;e<c.matches.length;e++)c.matches[e].isGroup&&(c.matches[e].isGroup=!1);g.length>0?(l=g[g.length-1]).matches.push(c):h.matches.push(c)}}else y(h,o)}function x(e){var t=new k(!0);return t.openGroup=!1,t.matches=e,t}for(n&&(a.optionalmarker[0]=i,a.optionalmarker[1]=i);r=n?m.exec(t):f.exec(t);){if(o=r[0],n)switch(o.charAt(0)){case"?":o="{0,1}";break;case"+":case"*":o="{"+o+"}"}if(d)b();else switch(o.charAt(0)){case a.escapeChar:d=!0,n&&b();break;case a.optionalmarker[1]:case a.groupmarker[1]:if((s=g.pop()).openGroup=!1,s!==i)if(g.length>0){if((l=g[g.length-1]).matches.push(s),l.isAlternator){c=g.pop();for(var P=0;P<c.matches.length;P++)c.matches[P].isGroup=!1,c.matches[P].alternatorGroup=!1;g.length>0?(l=g[g.length-1]).matches.push(c):h.matches.push(c)}}else h.matches.push(s);else b();break;case a.optionalmarker[0]:g.push(new k(!1,!0));break;case a.groupmarker[0]:g.push(new k(!0));break;case a.quantifiermarker[0]:var S=new k(!1,!1,!0),A=(o=o.replace(/[{}]/g,"")).split("|"),C=A[0].split(","),E=isNaN(C[0])?C[0]:parseInt(C[0]),M=1===C.length?E:isNaN(C[1])?C[1]:parseInt(C[1]);"*"!==M&&"+"!==M||(E="*"===M?0:1),S.quantifier={min:E,max:M,jit:A[1]};var w=g.length>0?g[g.length-1].matches:h.matches;if((r=w.pop()).isAlternator){w.push(r),w=r.matches;var O=new k(!0),D=w.pop();w.push(O),w=O.matches,r=D}r.isGroup||(r=x([r])),w.push(r),w.push(S);break;case a.alternatormarker:var _=function(e){var t=e.pop();return t.isQuantifier&&(t=x([e.pop(),t])),t};if(g.length>0){var j=(l=g[g.length-1]).matches[l.matches.length-1];p=l.openGroup&&(j.matches===i||!1===j.isGroup&&!1===j.isAlternator)?g.pop():_(l.matches)}else p=_(h.matches);if(p.isAlternator)g.push(p);else if(p.alternatorGroup?(c=g.pop(),p.alternatorGroup=!1):c=new k(!1,!1,!1,!0),c.matches.push(p),g.push(c),p.openGroup){p.openGroup=!1;var F=new k(!0);F.alternatorGroup=!0,g.push(F)}break;default:b()}}for(;g.length>0;)s=g.pop(),h.matches.push(s);return h.matches.length>0&&(!function t(r){r&&r.matches&&e.each(r.matches,function(e,o){var s=r.matches[e+1];(s===i||s.matches===i||!1===s.isQuantifier)&&o&&o.isGroup&&(o.isGroup=!1,n||(y(o,a.groupmarker[0],0),!0!==o.openGroup&&y(o,a.groupmarker[1]))),t(o)})}(h),v.push(h)),(a.numericInput||a.isRTL)&&function e(t){for(var n in t.matches=t.matches.reverse(),t.matches)if(t.matches.hasOwnProperty(n)){var r=parseInt(n);if(t.matches[n].isQuantifier&&t.matches[r+1]&&t.matches[r+1].isGroup){var o=t.matches[n];t.matches.splice(n,1),t.matches.splice(r+1,0,o)}t.matches[n].matches!==i?t.matches[n]=e(t.matches[n]):t.matches[n]=((s=t.matches[n])===a.optionalmarker[0]?s=a.optionalmarker[1]:s===a.optionalmarker[1]?s=a.optionalmarker[0]:s===a.groupmarker[0]?s=a.groupmarker[1]:s===a.groupmarker[1]&&(s=a.groupmarker[0]),s)}var s;return t}(v[0]),v}},u.extendDefaults=function(t){e.extend(!0,u.prototype.defaults,t)},u.extendDefinitions=function(t){e.extend(!0,u.prototype.definitions,t)},u.extendAliases=function(t){e.extend(!0,u.prototype.aliases,t)},u.format=function(e,t,n){return u(t).format(e,n)},u.unmask=function(e,t){return u(t).unmaskedvalue(e)},u.isValid=function(e,t){return u(t).isValid(e)},u.remove=function(t){"string"==typeof t&&(t=n.getElementById(t)||n.querySelectorAll(t)),t=t.nodeName?[t]:t,e.each(t,function(e,t){t.inputmask&&t.inputmask.remove()})},u.setValue=function(t,i){"string"==typeof t&&(t=n.getElementById(t)||n.querySelectorAll(t)),t=t.nodeName?[t]:t,e.each(t,function(t,n){n.inputmask?n.inputmask.setValue(i):e(n).trigger("setvalue",[i])})},u.escapeRegex=function(e){return e.replace(new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"].join("|\\")+")","gim"),"\\$1")},u.keyCode={BACKSPACE:8,BACKSPACE_SAFARI:127,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,SPACE:32,TAB:9,UP:38,X:88,CONTROL:17},u},a=[n(0),n(5),n(6)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";n(4),n(7),n(8),n(9);var i=o(n(1)),a=o(n(0)),r=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}a.default===r.default&&n(10),window.Inputmask=i.default},function(e,t,n){"use strict";var i,a,r,o;"function"==typeof Symbol&&Symbol.iterator;o=function(e,t){var n={d:["[1-9]|[12][0-9]|3[01]",Date.prototype.setDate,"day",Date.prototype.getDate],dd:["0[1-9]|[12][0-9]|3[01]",Date.prototype.setDate,"day",function(){return o(Date.prototype.getDate.call(this),2)}],ddd:[""],dddd:[""],m:["[1-9]|1[012]",Date.prototype.setMonth,"month",function(){return Date.prototype.getMonth.call(this)+1}],mm:["0[1-9]|1[012]",Date.prototype.setMonth,"month",function(){return o(Date.prototype.getMonth.call(this)+1,2)}],mmm:[""],mmmm:[""],yy:["[0-9]{2}",Date.prototype.setFullYear,"year",function(){return o(Date.prototype.getFullYear.call(this),2)}],yyyy:["[0-9]{4}",Date.prototype.setFullYear,"year",function(){return o(Date.prototype.getFullYear.call(this),4)}],h:["[1-9]|1[0-2]",Date.prototype.setHours,"hours",Date.prototype.getHours],hh:["0[1-9]|1[0-2]",Date.prototype.setHours,"hours",function(){return o(Date.prototype.getHours.call(this),2)}],hhh:["[0-9]+",Date.prototype.setHours,"hours",Date.prototype.getHours],H:["1?[0-9]|2[0-3]",Date.prototype.setHours,"hours",Date.prototype.getHours],HH:["[01][0-9]|2[0-3]",Date.prototype.setHours,"hours",function(){return o(Date.prototype.getHours.call(this),2)}],HHH:["[0-9]+",Date.prototype.setHours,"hours",Date.prototype.getHours],M:["[1-5]?[0-9]",Date.prototype.setMinutes,"minutes",Date.prototype.getMinutes],MM:["[0-5][0-9]",Date.prototype.setMinutes,"minutes",function(){return o(Date.prototype.getMinutes.call(this),2)}],s:["[1-5]?[0-9]",Date.prototype.setSeconds,"seconds",Date.prototype.getSeconds],ss:["[0-5][0-9]",Date.prototype.setSeconds,"seconds",function(){return o(Date.prototype.getSeconds.call(this),2)}],l:["[0-9]{3}",Date.prototype.setMilliseconds,"milliseconds",function(){return o(Date.prototype.getMilliseconds.call(this),3)}],L:["[0-9]{2}",Date.prototype.setMilliseconds,"milliseconds",function(){return o(Date.prototype.getMilliseconds.call(this),2)}],t:["[ap]"],tt:["[ap]m"],T:["[AP]"],TT:["[AP]M"],Z:[""],o:[""],S:[""]},i={isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};function a(e){if(!e.tokenizer){var t=[];for(var i in n)-1===t.indexOf(i[0])&&t.push(i[0]);e.tokenizer="("+t.join("+|")+")+?|.",e.tokenizer=new RegExp(e.tokenizer,"g")}return e.tokenizer}function r(e,i,r){for(var o,s="";o=a(r).exec(e);){if(void 0===i)s+=n[o[0]]?"("+n[o[0]][0]+")":t.escapeRegex(o[0]);else if(n[o[0]])s+=n[o[0]][3].call(i.date);else s+=o[0]}return s}function o(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function s(e,t,i){var r,o,s,l={date:new Date(1,0,1)},u=e;function c(e,t,n){var a,o;"year"===r?(e[r]=(o=4===(a=t).length?a:(new Date).getFullYear().toString().substr(0,4-a.length)+a,i.min&&i.min.year&&i.max&&i.max.year?(o=o.replace(/[^0-9]/g,""),o+=i.min.year==i.max.year?i.min.year.substr(o.length):(""!==o&&0==i.max.year.indexOf(o)?parseInt(i.max.year)-1:parseInt(i.min.year)+1).toString().substr(o.length)):o=o.replace(/[^0-9]/g,"0"),o),e["raw"+r]=t):e[r]=n.min&&t.match(/[^0-9]/)?n.min[r]:t,void 0!==s&&s.call(e.date,"month"==r?parseInt(e[r])-1:e[r])}if("string"==typeof u){for(;o=a(i).exec(t);){var p=u.slice(0,o[0].length);n.hasOwnProperty(o[0])&&(r=n[o[0]][2],s=n[o[0]][1],c(l,p,i)),u=u.slice(p.length)}return l}}return t.extendAliases({datetime:{mask:function(e){return n.S=e.i18n.ordinalSuffix.join("|"),e.inputFormat=i[e.inputFormat]||e.inputFormat,e.displayFormat=i[e.displayFormat]||e.displayFormat||e.inputFormat,e.outputFormat=i[e.outputFormat]||e.outputFormat||e.inputFormat,e.placeholder=""!==e.placeholder?e.placeholder:e.inputFormat,e.min=s(e.min,e.inputFormat,e),e.max=s(e.max,e.inputFormat,e),e.regex=r(e.inputFormat,void 0,e),null},placeholder:"",inputFormat:"isoDateTime",displayFormat:void 0,outputFormat:void 0,min:null,max:null,i18n:{dayNames:["Mon","Tue","Wed","Thu","Fri","Sat","Sun","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],ordinalSuffix:["st","nd","rd","th"]},postValidation:function(e,t,n){var i,a,r,o,l,u=t,c=s(e.join(""),n.inputFormat,n);return u&&c.date.getTime()==c.date.getTime()&&(o=c,l=u,u=(u=(!isFinite(o.day)||"29"==o.day&&!isFinite(o.rawyear)||new Date(o.date.getFullYear(),isFinite(o.month)?o.month:o.date.getMonth()+1,0).getDate()>=o.day)&&l)&&(i=c,r=!0,(a=n).min&&a.min.date.getTime()==a.min.date.getTime()&&(r=a.min.date.getTime()<=i.date.getTime()),r&&a.max&&a.max.date.getTime()==a.max.date.getTime()&&(r=a.max.date.getTime()>=i.date.getTime()),r)),u},onKeyDown:function(n,i,r,s){if(n.ctrlKey&&n.keyCode===t.keyCode.RIGHT){for(var l,u=new Date,c="";l=a(s).exec(s.inputFormat);)"d"===l[0].charAt(0)?c+=o(u.getDate(),l[0].length):"m"===l[0].charAt(0)?c+=o(u.getMonth()+1,l[0].length):"yyyy"===l[0]?c+=u.getFullYear().toString():"y"===l[0].charAt(0)&&(c+=o(u.getYear(),l[0].length));this.inputmask._valueSet(c),e(this).trigger("setvalue")}},onUnMask:function(e,t,n){return r(n.outputFormat,s(e,n.inputFormat,n),n)},casing:function(e,t,n,i){return 0==t.nativeDef.indexOf("[ap]")?e.toLowerCase():0==t.nativeDef.indexOf("[AP]")?e.toUpperCase():e},insertMode:!1}}),t},a=[n(0),n(1)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t,n){"use strict";var i;"function"==typeof Symbol&&Symbol.iterator;void 0===(i=function(){return window}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i;"function"==typeof Symbol&&Symbol.iterator;void 0===(i=function(){return document}.call(t,n,t,e))||(e.exports=i)},function(e,t,n){"use strict";var i,a,r,o;"function"==typeof Symbol&&Symbol.iterator;o=function(e,t){return t.extendDefinitions({A:{validator:"[A-Za-zÐ-ÑÐÑ‘Ã€-Ã¿Âµ]",casing:"upper"},"&":{validator:"[0-9A-Za-zÐ-ÑÐÑ‘Ã€-Ã¿Âµ]",casing:"upper"},"#":{validator:"[0-9A-Fa-f]",casing:"upper"}}),t.extendAliases({cssunit:{regex:"[+-]?[0-9]+\\.?([0-9]+)?(px|em|rem|ex|%|in|cm|mm|pt|pc)"},url:{regex:"(https?|ftp)//.*",autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(e,t,n,i,a){return n-1>-1&&"."!==t.buffer[n-1]?(e=t.buffer[n-1]+e,e=n-2>-1&&"."!==t.buffer[n-2]?t.buffer[n-2]+e:"0"+e):e="00"+e,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(e)}}},onUnMask:function(e,t,n){return e},inputmode:"numeric"},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,63}]@-{1,63}.-{1,63}[.-{1,63}][.-{1,63}]",greedy:!1,casing:"lower",onBeforePaste:function(e,t){return(e=e.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9ï¼‘-ï¼™A-Za-zÐ-ÑÐÑ‘Ã€-Ã¿Âµ!#$%&'*+/=?^_`{|}~-]"},"-":{validator:"[0-9A-Za-z-]"}},onUnMask:function(e,t,n){return e},inputmode:"email"},mac:{mask:"##:##:##:##:##:##"},vin:{mask:"V{13}9{4}",definitions:{V:{validator:"[A-HJ-NPR-Za-hj-npr-z\\d]",casing:"upper"}},clearIncomplete:!0,autoUnmask:!0}}),t},a=[n(0),n(1)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t,n){"use strict";var i,a,r,o;"function"==typeof Symbol&&Symbol.iterator;o=function(e,t,n){function i(e,n){for(var i="",a=0;a<e.length;a++)t.prototype.definitions[e.charAt(a)]||n.definitions[e.charAt(a)]||n.optionalmarker.start===e.charAt(a)||n.optionalmarker.end===e.charAt(a)||n.quantifiermarker.start===e.charAt(a)||n.quantifiermarker.end===e.charAt(a)||n.groupmarker.start===e.charAt(a)||n.groupmarker.end===e.charAt(a)||n.alternatormarker===e.charAt(a)?i+="\\"+e.charAt(a):i+=e.charAt(a);return i}return t.extendAliases({numeric:{mask:function(e){if(0!==e.repeat&&isNaN(e.integerDigits)&&(e.integerDigits=e.repeat),e.repeat=0,e.groupSeparator===e.radixPoint&&e.digits&&"0"!==e.digits&&("."===e.radixPoint?e.groupSeparator=",":","===e.radixPoint?e.groupSeparator=".":e.groupSeparator="")," "===e.groupSeparator&&(e.skipOptionalPartCharacter=n),e.autoGroup=e.autoGroup&&""!==e.groupSeparator,e.autoGroup&&("string"==typeof e.groupSize&&isFinite(e.groupSize)&&(e.groupSize=parseInt(e.groupSize)),isFinite(e.integerDigits))){var t=Math.floor(e.integerDigits/e.groupSize),a=e.integerDigits%e.groupSize;e.integerDigits=parseInt(e.integerDigits)+(0===a?t-1:t),e.integerDigits<1&&(e.integerDigits="*")}e.placeholder.length>1&&(e.placeholder=e.placeholder.charAt(0)),"radixFocus"===e.positionCaretOnClick&&""===e.placeholder&&!1===e.integerOptional&&(e.positionCaretOnClick="lvp"),e.definitions[";"]=e.definitions["~"],e.definitions[";"].definitionSymbol="~",!0===e.numericInput&&(e.positionCaretOnClick="radixFocus"===e.positionCaretOnClick?"lvp":e.positionCaretOnClick,e.digitsOptional=!1,isNaN(e.digits)&&(e.digits=2),e.decimalProtect=!1);var r="[+]";if(r+=i(e.prefix,e),!0===e.integerOptional?r+="~{1,"+e.integerDigits+"}":r+="~{"+e.integerDigits+"}",e.digits!==n){var o=e.decimalProtect?":":e.radixPoint,s=e.digits.toString().split(",");isFinite(s[0])&&s[1]&&isFinite(s[1])?r+=o+";{"+e.digits+"}":(isNaN(e.digits)||parseInt(e.digits)>0)&&(e.digitsOptional?r+="["+o+";{1,"+e.digits+"}]":r+=o+";{"+e.digits+"}")}return r+=i(e.suffix,e),r+="[-]",e.greedy=!1,r},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,enforceDigitsOnBlur:!1,radixPoint:".",positionCaretOnClick:"radixFocus",groupSize:3,groupSeparator:"",autoGroup:!1,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",integerOptional:!0,prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:null,max:null,step:1,insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,inputmode:"numeric",preValidation:function(t,i,a,r,o,s){if("-"===a||a===o.negationSymbol.front)return!0===o.allowMinus&&(o.isNegative=o.isNegative===n||!o.isNegative,""===t.join("")||{caret:i,dopost:!0});if(!1===r&&a===o.radixPoint&&o.digits!==n&&(isNaN(o.digits)||parseInt(o.digits)>0)){var l=e.inArray(o.radixPoint,t);if(-1!==l&&s.validPositions[l]!==n)return!0===o.numericInput?i===l:{caret:l+1}}return!0},postValidation:function(i,a,r){var o=r.suffix.split(""),s=r.prefix.split("");if(a.pos===n&&a.caret!==n&&!0!==a.dopost)return a;var l=a.caret!==n?a.caret:a.pos,u=i.slice();r.numericInput&&(l=u.length-l-1,u=u.reverse());var c=u[l];if(c===r.groupSeparator&&(c=u[l+=1]),l===u.length-r.suffix.length-1&&c===r.radixPoint)return a;c!==n&&c!==r.radixPoint&&c!==r.negationSymbol.front&&c!==r.negationSymbol.back&&(u[l]="?",r.prefix.length>0&&l>=(!1===r.isNegative?1:0)&&l<r.prefix.length-1+(!1===r.isNegative?1:0)?s[l-(!1===r.isNegative?1:0)]="?":r.suffix.length>0&&l>=u.length-r.suffix.length-(!1===r.isNegative?1:0)&&(o[l-(u.length-r.suffix.length-(!1===r.isNegative?1:0))]="?")),s=s.join(""),o=o.join("");var p=u.join("").replace(s,"");if(p=(p=(p=(p=p.replace(o,"")).replace(new RegExp(t.escapeRegex(r.groupSeparator),"g"),"")).replace(new RegExp("[-"+t.escapeRegex(r.negationSymbol.front)+"]","g"),"")).replace(new RegExp(t.escapeRegex(r.negationSymbol.back)+"$"),""),isNaN(r.placeholder)&&(p=p.replace(new RegExp(t.escapeRegex(r.placeholder),"g"),"")),p.length>1&&1!==p.indexOf(r.radixPoint)&&("0"===c&&(p=p.replace(/^\?/g,"")),p=p.replace(/^0/g,"")),p.charAt(0)===r.radixPoint&&""!==r.radixPoint&&!0!==r.numericInput&&(p="0"+p),""!==p){if(p=p.split(""),(!r.digitsOptional||r.enforceDigitsOnBlur&&"blur"===a.event)&&isFinite(r.digits)){var f=e.inArray(r.radixPoint,p),m=e.inArray(r.radixPoint,u);-1===f&&(p.push(r.radixPoint),f=p.length-1);for(var d=1;d<=r.digits;d++)r.digitsOptional&&(!r.enforceDigitsOnBlur||"blur"!==a.event)||p[f+d]!==n&&p[f+d]!==r.placeholder.charAt(0)?-1!==m&&u[m+d]!==n&&(p[f+d]=p[f+d]||u[m+d]):p[f+d]=a.placeholder||r.placeholder.charAt(0)}if(!0!==r.autoGroup||""===r.groupSeparator||c===r.radixPoint&&a.pos===n&&!a.dopost)p=p.join("");else{var h=p[p.length-1]===r.radixPoint&&a.c===r.radixPoint;p=t(function(e,t){var n="";if(n+="("+t.groupSeparator+"*{"+t.groupSize+"}){*}",""!==t.radixPoint){var i=e.join("").split(t.radixPoint);i[1]&&(n+=t.radixPoint+"*{"+i[1].match(/^\d*\??\d*/)[0].length+"}")}return n}(p,r),{numericInput:!0,jitMasking:!0,definitions:{"*":{validator:"[0-9?]",cardinality:1}}}).format(p.join("")),h&&(p+=r.radixPoint),p.charAt(0)===r.groupSeparator&&p.substr(1)}}if(r.isNegative&&"blur"===a.event&&(r.isNegative="0"!==p),p=s+p,p+=o,r.isNegative&&(p=r.negationSymbol.front+p,p+=r.negationSymbol.back),p=p.split(""),c!==n)if(c!==r.radixPoint&&c!==r.negationSymbol.front&&c!==r.negationSymbol.back)(l=e.inArray("?",p))>-1?p[l]=c:l=a.caret||0;else if(c===r.radixPoint||c===r.negationSymbol.front||c===r.negationSymbol.back){var g=e.inArray(c,p);-1!==g&&(l=g)}r.numericInput&&(l=p.length-l-1,p=p.reverse());var v={caret:c===n||a.pos!==n?l+(r.numericInput?-1:1):l,buffer:p,refreshFromBuffer:a.dopost||i.join("")!==p.join("")};return v.refreshFromBuffer?v:a},onBeforeWrite:function(i,a,r,o){if(i)switch(i.type){case"keydown":return o.postValidation(a,{caret:r,dopost:!0},o);case"blur":case"checkval":var s;if((l=o).parseMinMaxOptions===n&&(null!==l.min&&(l.min=l.min.toString().replace(new RegExp(t.escapeRegex(l.groupSeparator),"g"),""),","===l.radixPoint&&(l.min=l.min.replace(l.radixPoint,".")),l.min=isFinite(l.min)?parseFloat(l.min):NaN,isNaN(l.min)&&(l.min=Number.MIN_VALUE)),null!==l.max&&(l.max=l.max.toString().replace(new RegExp(t.escapeRegex(l.groupSeparator),"g"),""),","===l.radixPoint&&(l.max=l.max.replace(l.radixPoint,".")),l.max=isFinite(l.max)?parseFloat(l.max):NaN,isNaN(l.max)&&(l.max=Number.MAX_VALUE)),l.parseMinMaxOptions="done"),null!==o.min||null!==o.max){if(s=o.onUnMask(a.join(""),n,e.extend({},o,{unmaskAsNumber:!0})),null!==o.min&&s<o.min)return o.isNegative=o.min<0,o.postValidation(o.min.toString().replace(".",o.radixPoint).split(""),{caret:r,dopost:!0,placeholder:"0"},o);if(null!==o.max&&s>o.max)return o.isNegative=o.max<0,o.postValidation(o.max.toString().replace(".",o.radixPoint).split(""),{caret:r,dopost:!0,placeholder:"0"},o)}return o.postValidation(a,{caret:r,placeholder:"0",event:"blur"},o);case"_checkval":return{caret:r}}var l},regex:{integerPart:function(e,n){return n?new RegExp("["+t.escapeRegex(e.negationSymbol.front)+"+]?"):new RegExp("["+t.escapeRegex(e.negationSymbol.front)+"+]?\\d+")},integerNPart:function(e){return new RegExp("[\\d"+t.escapeRegex(e.groupSeparator)+t.escapeRegex(e.placeholder.charAt(0))+"]+")}},definitions:{"~":{validator:function(e,i,a,r,o,s){var l;if("k"===e||"m"===e){l={insert:[],c:0};for(var u=0,c="k"===e?2:5;u<c;u++)l.insert.push({pos:a+u,c:0});return l.pos=a+c,l}if(!0===(l=r?new RegExp("[0-9"+t.escapeRegex(o.groupSeparator)+"]").test(e):new RegExp("[0-9]").test(e))){if(!0!==o.numericInput&&i.validPositions[a]!==n&&"~"===i.validPositions[a].match.def&&!s){var p=i.buffer.join(""),f=(p=(p=p.replace(new RegExp("[-"+t.escapeRegex(o.negationSymbol.front)+"]","g"),"")).replace(new RegExp(t.escapeRegex(o.negationSymbol.back)+"$"),"")).split(o.radixPoint);f.length>1&&(f[1]=f[1].replace(/0/g,o.placeholder.charAt(0))),"0"===f[0]&&(f[0]=f[0].replace(/0/g,o.placeholder.charAt(0))),p=f[0]+o.radixPoint+f[1]||"";var m=i._buffer.join("");for(p===o.radixPoint&&(p=m);null===p.match(t.escapeRegex(m)+"$");)m=m.slice(1);l=(p=(p=p.replace(m,"")).split(""))[a]===n?{pos:a,remove:a}:{pos:a}}}else r||e!==o.radixPoint||i.validPositions[a-1]!==n||(l={insert:{pos:a,c:0},pos:a+1});return l},cardinality:1},"+":{validator:function(e,t,n,i,a){return a.allowMinus&&("-"===e||e===a.negationSymbol.front)},cardinality:1,placeholder:""},"-":{validator:function(e,t,n,i,a){return a.allowMinus&&e===a.negationSymbol.back},cardinality:1,placeholder:""},":":{validator:function(e,n,i,a,r){var o="["+t.escapeRegex(r.radixPoint)+"]",s=new RegExp(o).test(e);return s&&n.validPositions[i]&&n.validPositions[i].match.placeholder===r.radixPoint&&(s={caret:i+1}),s},cardinality:1,placeholder:function(e){return e.radixPoint}}},onUnMask:function(e,n,i){if(""===n&&!0===i.nullable)return n;var a=e.replace(i.prefix,"");return a=(a=a.replace(i.suffix,"")).replace(new RegExp(t.escapeRegex(i.groupSeparator),"g"),""),""!==i.placeholder.charAt(0)&&(a=a.replace(new RegExp(i.placeholder.charAt(0),"g"),"0")),i.unmaskAsNumber?(""!==i.radixPoint&&-1!==a.indexOf(i.radixPoint)&&(a=a.replace(t.escapeRegex.call(this,i.radixPoint),".")),a=(a=a.replace(new RegExp("^"+t.escapeRegex(i.negationSymbol.front)),"-")).replace(new RegExp(t.escapeRegex(i.negationSymbol.back)+"$"),""),Number(a)):a},isComplete:function(e,n){var i=e.join("");if(e.slice().join("")!==i)return!1;var a=i.replace(new RegExp("^"+t.escapeRegex(n.negationSymbol.front)),"-");return a=(a=(a=(a=a.replace(new RegExp(t.escapeRegex(n.negationSymbol.back)+"$"),"")).replace(n.prefix,"")).replace(n.suffix,"")).replace(new RegExp(t.escapeRegex(n.groupSeparator)+"([0-9]{3})","g"),"$1"),","===n.radixPoint&&(a=a.replace(t.escapeRegex(n.radixPoint),".")),isFinite(a)},onBeforeMask:function(e,i){if(i.isNegative=n,"number"==typeof e&&""!==i.radixPoint&&(e=e.toString().replace(".",i.radixPoint)),e=e.toString().charAt(e.length-1)===i.radixPoint?e.toString().substr(0,e.length-1):e.toString(),""!==i.radixPoint&&isFinite(e)){var a=e.split("."),r=""!==i.groupSeparator?parseInt(i.groupSize):0;2===a.length&&(a[0].length>r||a[1].length>r||a[0].length<=r&&a[1].length<r)&&(e=e.replace(".",i.radixPoint))}var o=e.match(/,/g),s=e.match(/\./g);if(e=s&&o?s.length>o.length?(e=e.replace(/\./g,"")).replace(",",i.radixPoint):o.length>s.length?(e=e.replace(/,/g,"")).replace(".",i.radixPoint):e.indexOf(".")<e.indexOf(",")?e.replace(/\./g,""):e.replace(/,/g,""):e.replace(new RegExp(t.escapeRegex(i.groupSeparator),"g"),""),0===i.digits&&(-1!==e.indexOf(".")?e=e.substring(0,e.indexOf(".")):-1!==e.indexOf(",")&&(e=e.substring(0,e.indexOf(",")))),""!==i.radixPoint&&isFinite(i.digits)&&-1!==e.indexOf(i.radixPoint)){var l=e.split(i.radixPoint)[1].match(new RegExp("\\d*"))[0];if(parseInt(i.digits)<l.toString().length){var u=Math.pow(10,parseInt(i.digits));e=e.replace(t.escapeRegex(i.radixPoint),"."),e=(e=Math.round(parseFloat(e)*u)/u).toString().replace(".",i.radixPoint)}}return e},onKeyDown:function(n,i,a,r){var o=e(this);if(n.ctrlKey)switch(n.keyCode){case t.keyCode.UP:o.val(parseFloat(this.inputmask.unmaskedvalue())+parseInt(r.step)),o.trigger("setvalue");break;case t.keyCode.DOWN:o.val(parseFloat(this.inputmask.unmaskedvalue())-parseInt(r.step)),o.trigger("setvalue")}}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:0,radixPoint:""},percentage:{alias:"numeric",digits:2,digitsOptional:!0,radixPoint:".",placeholder:"0",autoGroup:!1,min:0,max:100,suffix:" %",allowMinus:!1}}),t},a=[n(0),n(1)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t,n){"use strict";var i,a,r,o;"function"==typeof Symbol&&Symbol.iterator;o=function(e,t){function n(e,t){var n=(e.mask||e).replace(/#/g,"0").replace(/\)/,"0").replace(/[+()#-]/g,""),i=(t.mask||t).replace(/#/g,"0").replace(/\)/,"0").replace(/[+()#-]/g,"");return n.localeCompare(i)}var i=t.prototype.analyseMask;return t.prototype.analyseMask=function(t,n,a){var r={};return a.phoneCodes&&(a.phoneCodes&&a.phoneCodes.length>1e3&&(function e(n,i,a){i=i||"",a=a||r,""!==i&&(a[i]={});for(var o="",s=a[i]||a,l=n.length-1;l>=0;l--)s[o=(t=n[l].mask||n[l]).substr(0,1)]=s[o]||[],s[o].unshift(t.substr(1)),n.splice(l,1);for(var u in s)s[u].length>500&&e(s[u].slice(),u,s)}((t=t.substr(1,t.length-2)).split(a.groupmarker[1]+a.alternatormarker+a.groupmarker[0])),t=function t(n){var i="",r=[];for(var o in n)e.isArray(n[o])?1===n[o].length?r.push(o+n[o]):r.push(o+a.groupmarker[0]+n[o].join(a.groupmarker[1]+a.alternatormarker+a.groupmarker[0])+a.groupmarker[1]):r.push(o+t(n[o]));return 1===r.length?i+=r[0]:i+=a.groupmarker[0]+r.join(a.groupmarker[1]+a.alternatormarker+a.groupmarker[0])+a.groupmarker[1],i}(r)),t=t.replace(/9/g,"\\9")),i.call(this,t,n,a)},t.extendAliases({abstractphone:{groupmarker:["<",">"],countrycode:"",phoneCodes:[],keepStatic:"auto",mask:function(e){return e.definitions={"#":t.prototype.definitions[9]},e.phoneCodes.sort(n)},onBeforeMask:function(e,t){var n=e.replace(/^0{1,2}/,"").replace(/[\s]/g,"");return(n.indexOf(t.countrycode)>1||-1===n.indexOf(t.countrycode))&&(n="+"+t.countrycode+n),n},onUnMask:function(e,t,n){return e.replace(/[()#-]/g,"")},inputmode:"tel"}}),t},a=[n(0),n(1)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)},function(e,t,n){"use strict";var i,a,r,o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o=function(e,t){return void 0===e.fn.inputmask&&(e.fn.inputmask=function(n,i){var a,r=this[0];if(void 0===i&&(i={}),"string"==typeof n)switch(n){case"unmaskedvalue":return r&&r.inputmask?r.inputmask.unmaskedvalue():e(r).val();case"remove":return this.each(function(){this.inputmask&&this.inputmask.remove()});case"getemptymask":return r&&r.inputmask?r.inputmask.getemptymask():"";case"hasMaskedValue":return!(!r||!r.inputmask)&&r.inputmask.hasMaskedValue();case"isComplete":return!r||!r.inputmask||r.inputmask.isComplete();case"getmetadata":return r&&r.inputmask?r.inputmask.getmetadata():void 0;case"setvalue":t.setValue(r,i);break;case"option":if("string"!=typeof i)return this.each(function(){if(void 0!==this.inputmask)return this.inputmask.option(i)});if(r&&void 0!==r.inputmask)return r.inputmask.option(i);break;default:return i.alias=n,a=new t(i),this.each(function(){a.mask(this)})}else{if("object"==(void 0===n?"undefined":s(n)))return a=new t(n),void 0===n.mask&&void 0===n.alias?this.each(function(){if(void 0!==this.inputmask)return this.inputmask.option(n);a.mask(this)}):this.each(function(){a.mask(this)});if(void 0===n)return this.each(function(){(a=new t(i)).mask(this)})}}),e.fn.inputmask},a=[n(2),n(1)],void 0===(r="function"==typeof(i=o)?i.apply(t,a):i)||(e.exports=r)}]);

// wNumb.js
(function(){function k(b,d){return b.substring(0,d.length)===d}function r(b,d,e){if((b[d]||b[e])&&b[d]===b[e])throw Error(d);}function v(b,d,e,c,f,p,q,l,m,h,n,a){q=a;var g=n="";p&&(a=p(a));if("number"!==typeof a||!isFinite(a))return!1;!1!==b&&0===parseFloat(a.toFixed(b))&&(a=0);if(0>a){var k=!0;a=Math.abs(a)}!1!==b&&(p=Math.pow(10,b),a=(Math.round(a*p)/p).toFixed(b));a=a.toString();-1!==a.indexOf(".")&&(b=a.split("."),a=b[0],e&&(n=e+b[1]));d&&(a=a.split("").reverse().join("").match(/.{1,3}/g),a=a.join(d.split("").reverse().join("")).split("").reverse().join(""));
k&&l&&(g+=l);c&&(g+=c);k&&m&&(g+=m);g=g+a+n;f&&(g+=f);h&&(g=h(g,q));return g}function w(b,d,e,c,f,h,q,l,m,r,n,a){b="";n&&(a=n(a));if(!a||"string"!==typeof a)return!1;if(l&&k(a,l)){a=a.replace(l,"");var g=!0}c&&k(a,c)&&(a=a.replace(c,""));m&&k(a,m)&&(a=a.replace(m,""),g=!0);if(c=f)c=a.slice(-1*f.length)===f;c&&(a=a.slice(0,-1*f.length));d&&(a=a.split(d).join(""));e&&(a=a.replace(e,"."));g&&(b+="-");b=(b+a).replace(/[^0-9\.\-.]/g,"");if(""===b)return!1;b=Number(b);q&&(b=q(b));return"number"===typeof b&&
isFinite(b)?b:!1}function x(b){var d,e={};for(d=0;d<h.length;d+=1){var c=h[d];var f=b[c];if(void 0===f)e[c]="negative"!==c||e.negativeBefore?"mark"===c&&"."!==e.thousand?".":!1:"-";else if("decimals"===c)if(0<=f&&8>f)e[c]=f;else throw Error(c);else if("encoder"===c||"decoder"===c||"edit"===c||"undo"===c)if("function"===typeof f)e[c]=f;else throw Error(c);else if("string"===typeof f)e[c]=f;else throw Error(c);}r(e,"mark","thousand");r(e,"prefix","negative");r(e,"prefix","negativeBefore");return e}
function u(b,d,e){var c,f=[];for(c=0;c<h.length;c+=1)f.push(b[h[c]]);f.push(e);return d.apply("",f)}function t(b){if(!(this instanceof t))return new t(b);"object"===typeof b&&(b=x(b),this.to=function(d){return u(b,v,d)},this.from=function(d){return u(b,w,d)})}var h="decimals thousand mark prefix postfix encoder decoder negativeBefore negative edit undo".split(" ");window.wNumb=t})();

/*! nouislider - 10.0.0 - 2017-05-28 14:52:49 */
!function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.noUiSlider=a()}(function(){"use strict";function a(a){return"object"==typeof a&&"function"==typeof a.to&&"function"==typeof a.from}function b(a){a.parentElement.removeChild(a)}function c(a){a.preventDefault()}function d(a){return a.filter(function(a){return this[a]?!1:this[a]=!0},{})}function e(a,b){return Math.round(a/b)*b}function f(a,b){var c=a.getBoundingClientRect(),d=a.ownerDocument,e=d.documentElement,f=o(d);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(f.x=0),b?c.top+f.y-e.clientTop:c.left+f.x-e.clientLeft}function g(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)}function h(a,b,c){c>0&&(l(a,b),setTimeout(function(){m(a,b)},c))}function i(a){return Math.max(Math.min(a,100),0)}function j(a){return Array.isArray(a)?a:[a]}function k(a){a=String(a);var b=a.split(".");return b.length>1?b[1].length:0}function l(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function m(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function n(a,b){return a.classList?a.classList.contains(b):new RegExp("\\b"+b+"\\b").test(a.className)}function o(a){var b=void 0!==window.pageXOffset,c="CSS1Compat"===(a.compatMode||""),d=b?window.pageXOffset:c?a.documentElement.scrollLeft:a.body.scrollLeft,e=b?window.pageYOffset:c?a.documentElement.scrollTop:a.body.scrollTop;return{x:d,y:e}}function p(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function q(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b)}catch(c){}return a}function r(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function s(a,b){return 100/(b-a)}function t(a,b){return 100*b/(a[1]-a[0])}function u(a,b){return t(a,a[0]<0?b+Math.abs(a[0]):b-a[0])}function v(a,b){return b*(a[1]-a[0])/100+a[0]}function w(a,b){for(var c=1;a>=b[c];)c+=1;return c}function x(a,b,c){if(c>=a.slice(-1)[0])return 100;var d,e,f,g,h=w(c,a);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],f+u([d,e],c)/s(f,g)}function y(a,b,c){if(c>=100)return a.slice(-1)[0];var d,e,f,g,h=w(c,b);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],v([d,e],(c-f)*s(f,g))}function z(a,b,c,d){if(100===d)return d;var f,g,h=w(d,a);return c?(f=a[h-1],g=a[h],d-f>(g-f)/2?g:f):b[h-1]?a[h-1]+e(d-a[h-1],b[h-1]):d}function A(a,b,c){var d;if("number"==typeof b&&(b=[b]),"[object Array]"!==Object.prototype.toString.call(b))throw new Error("noUiSlider ("+$+"): 'range' contains invalid value.");if(d="min"===a?0:"max"===a?100:parseFloat(a),!g(d)||!g(b[0]))throw new Error("noUiSlider ("+$+"): 'range' value isn't numeric.");c.xPct.push(d),c.xVal.push(b[0]),d?c.xSteps.push(isNaN(b[1])?!1:b[1]):isNaN(b[1])||(c.xSteps[0]=b[1]),c.xHighestCompleteStep.push(0)}function B(a,b,c){if(!b)return!0;c.xSteps[a]=t([c.xVal[a],c.xVal[a+1]],b)/s(c.xPct[a],c.xPct[a+1]);var d=(c.xVal[a+1]-c.xVal[a])/c.xNumSteps[a],e=Math.ceil(Number(d.toFixed(3))-1),f=c.xVal[a]+c.xNumSteps[a]*e;c.xHighestCompleteStep[a]=f}function C(a,b,c){this.xPct=[],this.xVal=[],this.xSteps=[c||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=b;var d,e=[];for(d in a)a.hasOwnProperty(d)&&e.push([a[d],d]);for(e.sort(e.length&&"object"==typeof e[0][0]?function(a,b){return a[0][0]-b[0][0]}:function(a,b){return a[0]-b[0]}),d=0;d<e.length;d++)A(e[d][1],e[d][0],this);for(this.xNumSteps=this.xSteps.slice(0),d=0;d<this.xNumSteps.length;d++)B(d,this.xNumSteps[d],this)}function D(b){if(a(b))return!0;throw new Error("noUiSlider ("+$+"): 'format' requires 'to' and 'from' methods.")}function E(a,b){if(!g(b))throw new Error("noUiSlider ("+$+"): 'step' is not numeric.");a.singleStep=b}function F(a,b){if("object"!=typeof b||Array.isArray(b))throw new Error("noUiSlider ("+$+"): 'range' is not an object.");if(void 0===b.min||void 0===b.max)throw new Error("noUiSlider ("+$+"): Missing 'min' or 'max' in 'range'.");if(b.min===b.max)throw new Error("noUiSlider ("+$+"): 'range' 'min' and 'max' cannot be equal.");a.spectrum=new C(b,a.snap,a.singleStep)}function G(a,b){if(b=j(b),!Array.isArray(b)||!b.length)throw new Error("noUiSlider ("+$+"): 'start' option is incorrect.");a.handles=b.length,a.start=b}function H(a,b){if(a.snap=b,"boolean"!=typeof b)throw new Error("noUiSlider ("+$+"): 'snap' option must be a boolean.")}function I(a,b){if(a.animate=b,"boolean"!=typeof b)throw new Error("noUiSlider ("+$+"): 'animate' option must be a boolean.")}function J(a,b){if(a.animationDuration=b,"number"!=typeof b)throw new Error("noUiSlider ("+$+"): 'animationDuration' option must be a number.")}function K(a,b){var c,d=[!1];if("lower"===b?b=[!0,!1]:"upper"===b&&(b=[!1,!0]),b===!0||b===!1){for(c=1;c<a.handles;c++)d.push(b);d.push(!1)}else{if(!Array.isArray(b)||!b.length||b.length!==a.handles+1)throw new Error("noUiSlider ("+$+"): 'connect' option doesn't match handle count.");d=b}a.connect=d}function L(a,b){switch(b){case"horizontal":a.ort=0;break;case"vertical":a.ort=1;break;default:throw new Error("noUiSlider ("+$+"): 'orientation' option is invalid.")}}function M(a,b){if(!g(b))throw new Error("noUiSlider ("+$+"): 'margin' option must be numeric.");if(0!==b&&(a.margin=a.spectrum.getMargin(b),!a.margin))throw new Error("noUiSlider ("+$+"): 'margin' option is only supported on linear sliders.")}function N(a,b){if(!g(b))throw new Error("noUiSlider ("+$+"): 'limit' option must be numeric.");if(a.limit=a.spectrum.getMargin(b),!a.limit||a.handles<2)throw new Error("noUiSlider ("+$+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function O(a,b){if(!g(b))throw new Error("noUiSlider ("+$+"): 'padding' option must be numeric.");if(0!==b){if(a.padding=a.spectrum.getMargin(b),!a.padding)throw new Error("noUiSlider ("+$+"): 'padding' option is only supported on linear sliders.");if(a.padding<0)throw new Error("noUiSlider ("+$+"): 'padding' option must be a positive number.");if(a.padding>=50)throw new Error("noUiSlider ("+$+"): 'padding' option must be less than half the range.")}}function P(a,b){switch(b){case"ltr":a.dir=0;break;case"rtl":a.dir=1;break;default:throw new Error("noUiSlider ("+$+"): 'direction' option was not recognized.")}}function Q(a,b){if("string"!=typeof b)throw new Error("noUiSlider ("+$+"): 'behaviour' must be a string containing options.");var c=b.indexOf("tap")>=0,d=b.indexOf("drag")>=0,e=b.indexOf("fixed")>=0,f=b.indexOf("snap")>=0,g=b.indexOf("hover")>=0;if(e){if(2!==a.handles)throw new Error("noUiSlider ("+$+"): 'fixed' behaviour must be used with 2 handles");M(a,a.start[1]-a.start[0])}a.events={tap:c||f,drag:d,fixed:e,snap:f,hover:g}}function R(a,b){if(b!==!1)if(b===!0){a.tooltips=[];for(var c=0;c<a.handles;c++)a.tooltips.push(!0)}else{if(a.tooltips=j(b),a.tooltips.length!==a.handles)throw new Error("noUiSlider ("+$+"): must pass a formatter for all handles.");a.tooltips.forEach(function(a){if("boolean"!=typeof a&&("object"!=typeof a||"function"!=typeof a.to))throw new Error("noUiSlider ("+$+"): 'tooltips' must be passed a formatter or 'false'.")})}}function S(a,b){a.ariaFormat=b,D(b)}function T(a,b){a.format=b,D(b)}function U(a,b){if(void 0!==b&&"string"!=typeof b&&b!==!1)throw new Error("noUiSlider ("+$+"): 'cssPrefix' must be a string or `false`.");a.cssPrefix=b}function V(a,b){if(void 0!==b&&"object"!=typeof b)throw new Error("noUiSlider ("+$+"): 'cssClasses' must be an object.");if("string"==typeof a.cssPrefix){a.cssClasses={};for(var c in b)b.hasOwnProperty(c)&&(a.cssClasses[c]=a.cssPrefix+b[c])}else a.cssClasses=b}function W(a,b){if(b!==!0&&b!==!1)throw new Error("noUiSlider ("+$+"): 'useRequestAnimationFrame' option should be true (default) or false.");a.useRequestAnimationFrame=b}function X(a){var b={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:_,format:_},c={step:{r:!1,t:E},start:{r:!0,t:G},connect:{r:!0,t:K},direction:{r:!0,t:P},snap:{r:!1,t:H},animate:{r:!1,t:I},animationDuration:{r:!1,t:J},range:{r:!0,t:F},orientation:{r:!1,t:L},margin:{r:!1,t:M},limit:{r:!1,t:N},padding:{r:!1,t:O},behaviour:{r:!0,t:Q},ariaFormat:{r:!1,t:S},format:{r:!1,t:T},tooltips:{r:!1,t:R},cssPrefix:{r:!1,t:U},cssClasses:{r:!1,t:V},useRequestAnimationFrame:{r:!1,t:W}},d={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},useRequestAnimationFrame:!0};a.format&&!a.ariaFormat&&(a.ariaFormat=a.format),Object.keys(c).forEach(function(e){if(void 0===a[e]&&void 0===d[e]){if(c[e].r)throw new Error("noUiSlider ("+$+"): '"+e+"' is required.");return!0}c[e].t(b,void 0===a[e]?d[e]:a[e])}),b.pips=a.pips;var e=[["left","top"],["right","bottom"]];return b.style=e[b.dir][b.ort],b.styleOposite=e[b.dir?0:1][b.ort],b}function Y(a,e,g){function k(a,b){var c=xa.createElement("div");return b&&l(c,b),a.appendChild(c),c}function s(a,b){var c=k(a,e.cssClasses.origin),d=k(c,e.cssClasses.handle);return d.setAttribute("data-handle",b),d.setAttribute("tabindex","0"),d.setAttribute("role","slider"),d.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),0===b?l(d,e.cssClasses.handleLower):b===e.handles-1&&l(d,e.cssClasses.handleUpper),c}function t(a,b){return b?k(a,e.cssClasses.connect):!1}function u(a,b){ia=[],ja=[],ja.push(t(b,a[0]));for(var c=0;c<e.handles;c++)ia.push(s(b,c)),ra[c]=c,ja.push(t(b,a[c+1]))}function v(a){l(a,e.cssClasses.target),0===e.dir?l(a,e.cssClasses.ltr):l(a,e.cssClasses.rtl),0===e.ort?l(a,e.cssClasses.horizontal):l(a,e.cssClasses.vertical),ha=k(a,e.cssClasses.base)}function w(a,b){return e.tooltips[b]?k(a.firstChild,e.cssClasses.tooltip):!1}function x(){var a=ia.map(w);ea("update",function(b,c,d){if(a[c]){var f=b[c];e.tooltips[c]!==!0&&(f=e.tooltips[c].to(d[c])),a[c].innerHTML=f}})}function y(){ea("update",function(a,b,c,d,f){ra.forEach(function(a){var b=ia[a],d=S(qa,a,0,!0,!0,!0),g=S(qa,a,100,!0,!0,!0),h=f[a],i=e.ariaFormat.to(c[a]);b.children[0].setAttribute("aria-valuemin",d.toFixed(1)),b.children[0].setAttribute("aria-valuemax",g.toFixed(1)),b.children[0].setAttribute("aria-valuenow",h.toFixed(1)),b.children[0].setAttribute("aria-valuetext",i)})})}function z(a,b,c){if("range"===a||"steps"===a)return ta.xVal;if("count"===a){if(!b)throw new Error("noUiSlider ("+$+"): 'values' required for mode 'count'.");var d,e=100/(b-1),f=0;for(b=[];(d=f++*e)<=100;)b.push(d);a="positions"}return"positions"===a?b.map(function(a){return ta.fromStepping(c?ta.getStep(a):a)}):"values"===a?c?b.map(function(a){return ta.fromStepping(ta.getStep(ta.toStepping(a)))}):b:void 0}function A(a,b,c){function e(a,b){return(a+b).toFixed(7)/1}var f={},g=ta.xVal[0],h=ta.xVal[ta.xVal.length-1],i=!1,j=!1,k=0;return c=d(c.slice().sort(function(a,b){return a-b})),c[0]!==g&&(c.unshift(g),i=!0),c[c.length-1]!==h&&(c.push(h),j=!0),c.forEach(function(d,g){var h,l,m,n,o,p,q,r,s,t,u=d,v=c[g+1];if("steps"===b&&(h=ta.xNumSteps[g]),h||(h=v-u),u!==!1&&void 0!==v)for(h=Math.max(h,1e-7),l=u;v>=l;l=e(l,h)){for(n=ta.toStepping(l),o=n-k,r=o/a,s=Math.round(r),t=o/s,m=1;s>=m;m+=1)p=k+m*t,f[p.toFixed(5)]=["x",0];q=c.indexOf(l)>-1?1:"steps"===b?2:0,!g&&i&&(q=0),l===v&&j||(f[n.toFixed(5)]=[l,q]),k=n}}),f}function B(a,b,c){function d(a,b){var c=b===e.cssClasses.value,d=c?j:m,f=c?h:i;return b+" "+d[e.ort]+" "+f[a]}function f(a,f){f[1]=f[1]&&b?b(f[0],f[1]):f[1];var h=k(g,!1);h.className=d(f[1],e.cssClasses.marker),h.style[e.style]=a+"%",f[1]&&(h=k(g,!1),h.className=d(f[1],e.cssClasses.value),h.style[e.style]=a+"%",h.innerText=c.to(f[0]))}var g=xa.createElement("div"),h=[e.cssClasses.valueNormal,e.cssClasses.valueLarge,e.cssClasses.valueSub],i=[e.cssClasses.markerNormal,e.cssClasses.markerLarge,e.cssClasses.markerSub],j=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],m=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];return l(g,e.cssClasses.pips),l(g,0===e.ort?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical),Object.keys(a).forEach(function(b){f(b,a[b])}),g}function C(){la&&(b(la),la=null)}function D(a){C();var b=a.mode,c=a.density||1,d=a.filter||!1,e=a.values||!1,f=a.stepped||!1,g=z(b,e,f),h=A(c,b,g),i=a.format||{to:Math.round};return la=pa.appendChild(B(h,d,i))}function E(){var a=ha.getBoundingClientRect(),b="offset"+["Width","Height"][e.ort];return 0===e.ort?a.width||ha[b]:a.height||ha[b]}function F(a,b,c,d){var f=function(b){return pa.hasAttribute("disabled")?!1:n(pa,e.cssClasses.tap)?!1:(b=G(b,d.pageOffset))?a===ma.start&&void 0!==b.buttons&&b.buttons>1?!1:d.hover&&b.buttons?!1:(oa||b.preventDefault(),b.calcPoint=b.points[e.ort],void c(b,d)):!1},g=[];return a.split(" ").forEach(function(a){b.addEventListener(a,f,oa?{passive:!0}:!1),g.push([a,f])}),g}function G(a,b){var c,d,e=0===a.type.indexOf("touch"),f=0===a.type.indexOf("mouse"),g=0===a.type.indexOf("pointer");if(0===a.type.indexOf("MSPointer")&&(g=!0),e){if(a.touches.length>1)return!1;c=a.changedTouches[0].pageX,d=a.changedTouches[0].pageY}return b=b||o(xa),(f||g)&&(c=a.clientX+b.x,d=a.clientY+b.y),a.pageOffset=b,a.points=[c,d],a.cursor=f||g,a}function H(a){var b=a-f(ha,e.ort),c=100*b/E();return e.dir?100-c:c}function I(a){var b=100,c=!1;return ia.forEach(function(d,e){if(!d.hasAttribute("disabled")){var f=Math.abs(qa[e]-a);b>f&&(c=e,b=f)}}),c}function J(a,b,c,d){var e=c.slice(),f=[!a,a],g=[a,!a];d=d.slice(),a&&d.reverse(),d.length>1?d.forEach(function(a,c){var d=S(e,a,e[a]+b,f[c],g[c],!1);d===!1?b=0:(b=d-e[a],e[a]=d)}):f=g=[!0];var h=!1;d.forEach(function(a,d){h=W(a,c[a]+b,f[d],g[d])||h}),h&&d.forEach(function(a){K("update",a),K("slide",a)})}function K(a,b,c){Object.keys(va).forEach(function(d){var f=d.split(".")[0];a===f&&va[d].forEach(function(a){a.call(ka,ua.map(e.format.to),b,ua.slice(),c||!1,qa.slice())})})}function L(a,b){"mouseout"===a.type&&"HTML"===a.target.nodeName&&null===a.relatedTarget&&N(a,b)}function M(a,b){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===a.buttons&&0!==b.buttonsProperty)return N(a,b);var c=(e.dir?-1:1)*(a.calcPoint-b.startCalcPoint),d=100*c/b.baseSize;J(c>0,d,b.locations,b.handleNumbers)}function N(a,b){sa&&(m(sa,e.cssClasses.active),sa=!1),a.cursor&&(za.style.cursor="",za.removeEventListener("selectstart",c)),wa.forEach(function(a){ya.removeEventListener(a[0],a[1])}),m(pa,e.cssClasses.drag),V(),b.handleNumbers.forEach(function(a){K("change",a),K("set",a),K("end",a)})}function O(a,b){if(1===b.handleNumbers.length){var d=ia[b.handleNumbers[0]];if(d.hasAttribute("disabled"))return!1;sa=d.children[0],l(sa,e.cssClasses.active)}a.stopPropagation();var f=F(ma.move,ya,M,{startCalcPoint:a.calcPoint,baseSize:E(),pageOffset:a.pageOffset,handleNumbers:b.handleNumbers,buttonsProperty:a.buttons,locations:qa.slice()}),g=F(ma.end,ya,N,{handleNumbers:b.handleNumbers}),h=F("mouseout",ya,L,{handleNumbers:b.handleNumbers});wa=f.concat(g,h),a.cursor&&(za.style.cursor=getComputedStyle(a.target).cursor,ia.length>1&&l(pa,e.cssClasses.drag),za.addEventListener("selectstart",c,!1)),b.handleNumbers.forEach(function(a){K("start",a)})}function P(a){a.stopPropagation();var b=H(a.calcPoint),c=I(b);return c===!1?!1:(e.events.snap||h(pa,e.cssClasses.tap,e.animationDuration),W(c,b,!0,!0),V(),K("slide",c,!0),K("update",c,!0),K("change",c,!0),K("set",c,!0),void(e.events.snap&&O(a,{handleNumbers:[c]})))}function Q(a){var b=H(a.calcPoint),c=ta.getStep(b),d=ta.fromStepping(c);Object.keys(va).forEach(function(a){"hover"===a.split(".")[0]&&va[a].forEach(function(a){a.call(ka,d)})})}function R(a){a.fixed||ia.forEach(function(a,b){F(ma.start,a.children[0],O,{handleNumbers:[b]})}),a.tap&&F(ma.start,ha,P,{}),a.hover&&F(ma.move,ha,Q,{hover:!0}),a.drag&&ja.forEach(function(b,c){if(b!==!1&&0!==c&&c!==ja.length-1){var d=ia[c-1],f=ia[c],g=[b];l(b,e.cssClasses.draggable),a.fixed&&(g.push(d.children[0]),g.push(f.children[0])),g.forEach(function(a){F(ma.start,a,O,{handles:[d,f],handleNumbers:[c-1,c]})})}})}function S(a,b,c,d,f,g){return ia.length>1&&(d&&b>0&&(c=Math.max(c,a[b-1]+e.margin)),f&&b<ia.length-1&&(c=Math.min(c,a[b+1]-e.margin))),ia.length>1&&e.limit&&(d&&b>0&&(c=Math.min(c,a[b-1]+e.limit)),f&&b<ia.length-1&&(c=Math.max(c,a[b+1]-e.limit))),e.padding&&(0===b&&(c=Math.max(c,e.padding)),b===ia.length-1&&(c=Math.min(c,100-e.padding))),c=ta.getStep(c),c=i(c),c!==a[b]||g?c:!1}function T(a){return a+"%"}function U(a,b){qa[a]=b,ua[a]=ta.fromStepping(b);var c=function(){ia[a].style[e.style]=T(b),Y(a),Y(a+1)};window.requestAnimationFrame&&e.useRequestAnimationFrame?window.requestAnimationFrame(c):c()}function V(){ra.forEach(function(a){var b=qa[a]>50?-1:1,c=3+(ia.length+b*a);ia[a].childNodes[0].style.zIndex=c})}function W(a,b,c,d){return b=S(qa,a,b,c,d,!1),b===!1?!1:(U(a,b),!0)}function Y(a){if(ja[a]){var b=0,c=100;0!==a&&(b=qa[a-1]),a!==ja.length-1&&(c=qa[a]),ja[a].style[e.style]=T(b),ja[a].style[e.styleOposite]=T(100-c)}}function Z(a,b){null!==a&&a!==!1&&("number"==typeof a&&(a=String(a)),a=e.format.from(a),a===!1||isNaN(a)||W(b,ta.toStepping(a),!1,!1))}function _(a,b){var c=j(a),d=void 0===qa[0];b=void 0===b?!0:!!b,c.forEach(Z),e.animate&&!d&&h(pa,e.cssClasses.tap,e.animationDuration),ra.forEach(function(a){W(a,qa[a],!0,!1)}),V(),ra.forEach(function(a){K("update",a),null!==c[a]&&b&&K("set",a)})}function aa(a){_(e.start,a)}function ba(){var a=ua.map(e.format.to);return 1===a.length?a[0]:a}function ca(){for(var a in e.cssClasses)e.cssClasses.hasOwnProperty(a)&&m(pa,e.cssClasses[a]);for(;pa.firstChild;)pa.removeChild(pa.firstChild);delete pa.noUiSlider}function da(){return qa.map(function(a,b){var c=ta.getNearbySteps(a),d=ua[b],e=c.thisStep.step,f=null;e!==!1&&d+e>c.stepAfter.startValue&&(e=c.stepAfter.startValue-d),f=d>c.thisStep.startValue?c.thisStep.step:c.stepBefore.step===!1?!1:d-c.stepBefore.highestStep,100===a?e=null:0===a&&(f=null);var g=ta.countStepDecimals();return null!==e&&e!==!1&&(e=Number(e.toFixed(g))),null!==f&&f!==!1&&(f=Number(f.toFixed(g))),[f,e]})}function ea(a,b){va[a]=va[a]||[],va[a].push(b),"update"===a.split(".")[0]&&ia.forEach(function(a,b){K("update",b)})}function fa(a){var b=a&&a.split(".")[0],c=b&&a.substring(b.length);Object.keys(va).forEach(function(a){var d=a.split(".")[0],e=a.substring(d.length);b&&b!==d||c&&c!==e||delete va[a]})}function ga(a,b){var c=ba(),d=["margin","limit","padding","range","animate","snap","step","format"];d.forEach(function(b){void 0!==a[b]&&(g[b]=a[b])});var f=X(g);d.forEach(function(b){void 0!==a[b]&&(e[b]=f[b])}),ta=f.spectrum,e.margin=f.margin,e.limit=f.limit,e.padding=f.padding,e.pips&&D(e.pips),qa=[],_(a.start||c,b)}var ha,ia,ja,ka,la,ma=p(),na=r(),oa=na&&q(),pa=a,qa=[],ra=[],sa=!1,ta=e.spectrum,ua=[],va={},wa=null,xa=a.ownerDocument,ya=xa.documentElement,za=xa.body;if(pa.noUiSlider)throw new Error("noUiSlider ("+$+"): Slider was already initialized.");return v(pa),u(e.connect,ha),ka={destroy:ca,steps:da,on:ea,off:fa,get:ba,set:_,reset:aa,__moveHandles:function(a,b,c){J(a,b,qa,c)},options:g,updateOptions:ga,target:pa,removePips:C,pips:D},R(e.events),_(e.start),e.pips&&D(e.pips),e.tooltips&&x(),y(),ka}function Z(a,b){if(!a||!a.nodeName)throw new Error("noUiSlider ("+$+"): create requires a single element, got: "+a);var c=X(b,a),d=Y(a,c,b);return a.noUiSlider=d,d}var $="10.0.0";C.prototype.getMargin=function(a){var b=this.xNumSteps[0];if(b&&a/b%1!==0)throw new Error("noUiSlider ("+$+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length?t(this.xVal,a):!1},C.prototype.toStepping=function(a){return a=x(this.xVal,this.xPct,a)},C.prototype.fromStepping=function(a){return y(this.xVal,this.xPct,a)},C.prototype.getStep=function(a){return a=z(this.xPct,this.xSteps,this.snap,a)},C.prototype.getNearbySteps=function(a){var b=w(a,this.xPct);return{stepBefore:{startValue:this.xVal[b-2],step:this.xNumSteps[b-2],highestStep:this.xHighestCompleteStep[b-2]},thisStep:{startValue:this.xVal[b-1],step:this.xNumSteps[b-1],highestStep:this.xHighestCompleteStep[b-1]},stepAfter:{startValue:this.xVal[b-0],step:this.xNumSteps[b-0],highestStep:this.xHighestCompleteStep[b-0]}}},C.prototype.countStepDecimals=function(){var a=this.xNumSteps.map(k);return Math.max.apply(null,a)},C.prototype.convert=function(a){return this.getStep(this.toStepping(a))};var _={to:function(a){return void 0!==a&&a.toFixed(2)},from:Number};return{version:$,create:Z}});

/*
* jquery-match-height 0.7.2 by @liabru
* http://brm.io/jquery-match-height/
* License MIT
*/
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e=-1,o=-1,n=function(t){return parseFloat(t)||0},a=function(e){var o=1,a=t(e),i=null,r=[];return a.each(function(){var e=t(this),a=e.offset().top-n(e.css("margin-top")),s=r.length>0?r[r.length-1]:null;null===s?r.push(e):Math.floor(Math.abs(i-a))<=o?r[r.length-1]=s.add(e):r.push(e),i=a}),r},i=function(e){var o={
byRow:!0,property:"height",target:null,remove:!1};return"object"==typeof e?t.extend(o,e):("boolean"==typeof e?o.byRow=e:"remove"===e&&(o.remove=!0),o)},r=t.fn.matchHeight=function(e){var o=i(e);if(o.remove){var n=this;return this.css(o.property,""),t.each(r._groups,function(t,e){e.elements=e.elements.not(n)}),this}return this.length<=1&&!o.target?this:(r._groups.push({elements:this,options:o}),r._apply(this,o),this)};r.version="0.7.2",r._groups=[],r._throttle=80,r._maintainScroll=!1,r._beforeUpdate=null,
r._afterUpdate=null,r._rows=a,r._parse=n,r._parseOptions=i,r._apply=function(e,o){var s=i(o),h=t(e),l=[h],c=t(window).scrollTop(),p=t("html").outerHeight(!0),u=h.parents().filter(":hidden");return u.each(function(){var e=t(this);e.data("style-cache",e.attr("style"))}),u.css("display","block"),s.byRow&&!s.target&&(h.each(function(){var e=t(this),o=e.css("display");"inline-block"!==o&&"flex"!==o&&"inline-flex"!==o&&(o="block"),e.data("style-cache",e.attr("style")),e.css({display:o,"padding-top":"0",
"padding-bottom":"0","margin-top":"0","margin-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px",overflow:"hidden"})}),l=a(h),h.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||"")})),t.each(l,function(e,o){var a=t(o),i=0;if(s.target)i=s.target.outerHeight(!1);else{if(s.byRow&&a.length<=1)return void a.css(s.property,"");a.each(function(){var e=t(this),o=e.attr("style"),n=e.css("display");"inline-block"!==n&&"flex"!==n&&"inline-flex"!==n&&(n="block");var a={
display:n};a[s.property]="",e.css(a),e.outerHeight(!1)>i&&(i=e.outerHeight(!1)),o?e.attr("style",o):e.css("display","")})}a.each(function(){var e=t(this),o=0;s.target&&e.is(s.target)||("border-box"!==e.css("box-sizing")&&(o+=n(e.css("border-top-width"))+n(e.css("border-bottom-width")),o+=n(e.css("padding-top"))+n(e.css("padding-bottom"))),e.css(s.property,i-o+"px"))})}),u.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||null)}),r._maintainScroll&&t(window).scrollTop(c/p*t("html").outerHeight(!0)),
this},r._applyDataApi=function(){var e={};t("[data-match-height], [data-mh]").each(function(){var o=t(this),n=o.attr("data-mh")||o.attr("data-match-height");n in e?e[n]=e[n].add(o):e[n]=o}),t.each(e,function(){this.matchHeight(!0)})};var s=function(e){r._beforeUpdate&&r._beforeUpdate(e,r._groups),t.each(r._groups,function(){r._apply(this.elements,this.options)}),r._afterUpdate&&r._afterUpdate(e,r._groups)};r._update=function(n,a){if(a&&"resize"===a.type){var i=t(window).width();if(i===e)return;e=i;
}n?o===-1&&(o=setTimeout(function(){s(a),o=-1},r._throttle)):s(a)},t(r._applyDataApi);var h=t.fn.on?"on":"bind";t(window)[h]("load",function(t){r._update(!1,t)}),t(window)[h]("resize orientationchange",function(t){r._update(!0,t)})});

/*!
imgLiquid v0.9.944 / 03-05-2013
jQuery plugin to resize images to fit in a container.
Copyright (c) 2012 Alejandro Emparan (karacas) @krc_ale
Dual licensed under the MIT and GPL licenses
https://github.com/karacas/imgLiquid
**/
var imgLiquid=imgLiquid||{VER:"0.9.944"};imgLiquid.bgs_Available=!1,imgLiquid.bgs_CheckRunned=!1,imgLiquid.injectCss=".imgLiquid img {visibility:hidden}",function(i){function t(){if(!imgLiquid.bgs_CheckRunned){imgLiquid.bgs_CheckRunned=!0;var t=i('<span style="background-size:cover" />');i("body").append(t),!function(){var i=t[0];if(i&&window.getComputedStyle){var e=window.getComputedStyle(i,null);e&&e.backgroundSize&&(imgLiquid.bgs_Available="cover"===e.backgroundSize)}}(),t.remove()}}i.fn.extend({imgLiquid:function(e){this.defaults={fill:!0,verticalAlign:"center",horizontalAlign:"center",useBackgroundSize:!0,useDataHtmlAttr:!0,responsive:!0,delay:0,fadeInTime:0,removeBoxBackground:!0,hardPixels:!0,responsiveCheckTime:500,timecheckvisibility:500,onStart:null,onFinish:null,onItemStart:null,onItemFinish:null,onItemError:null},t();var a=this;return this.options=e,this.settings=i.extend({},this.defaults,this.options),this.settings.onStart&&this.settings.onStart(),this.each(function(t){function e(){-1===u.css("background-image").indexOf(encodeURI(c.attr("src")))&&u.css({"background-image":'url("'+encodeURI(c.attr("src"))+'")'}),u.css({"background-size":g.fill?"cover":"contain","background-position":(g.horizontalAlign+" "+g.verticalAlign).toLowerCase(),"background-repeat":"no-repeat"}),i("a:first",u).css({display:"block",width:"100%",height:"100%"}),i("img",u).css({display:"none"}),g.onItemFinish&&g.onItemFinish(t,u,c),u.addClass("imgLiquid_bgSize"),u.addClass("imgLiquid_ready"),l()}function d(){function e(){c.data("imgLiquid_error")||c.data("imgLiquid_loaded")||c.data("imgLiquid_oldProcessed")||(u.is(":visible")&&c[0].complete&&c[0].width>0&&c[0].height>0?(c.data("imgLiquid_loaded",!0),setTimeout(r,t*g.delay)):setTimeout(e,g.timecheckvisibility))}if(c.data("oldSrc")&&c.data("oldSrc")!==c.attr("src")){var a=c.clone().removeAttr("style");return a.data("imgLiquid_settings",c.data("imgLiquid_settings")),c.parent().prepend(a),c.remove(),c=a,c[0].width=0,setTimeout(d,10),void 0}return c.data("imgLiquid_oldProcessed")?(r(),void 0):(c.data("imgLiquid_oldProcessed",!1),c.data("oldSrc",c.attr("src")),i("img:not(:first)",u).css("display","none"),u.css({overflow:"hidden"}),c.fadeTo(0,0).removeAttr("width").removeAttr("height").css({visibility:"visible","max-width":"none","max-height":"none",width:"auto",height:"auto",display:"block"}),c.on("error",n),c[0].onerror=n,e(),o(),void 0)}function o(){(g.responsive||c.data("imgLiquid_oldProcessed"))&&c.data("imgLiquid_settings")&&(g=c.data("imgLiquid_settings"),u.actualSize=u.get(0).offsetWidth+u.get(0).offsetHeight/1e4,u.sizeOld&&u.actualSize!==u.sizeOld&&r(),u.sizeOld=u.actualSize,setTimeout(o,g.responsiveCheckTime))}function n(){c.data("imgLiquid_error",!0),u.addClass("imgLiquid_error"),g.onItemError&&g.onItemError(t,u,c),l()}function s(){var i={};if(a.settings.useDataHtmlAttr){var t=u.attr("data-imgLiquid-fill"),e=u.attr("data-imgLiquid-horizontalAlign"),d=u.attr("data-imgLiquid-verticalAlign");("true"===t||"false"===t)&&(i.fill=Boolean("true"===t)),void 0===e||"left"!==e&&"center"!==e&&"right"!==e&&-1===e.indexOf("%")||(i.horizontalAlign=e),void 0===d||"top"!==d&&"bottom"!==d&&"center"!==d&&-1===d.indexOf("%")||(i.verticalAlign=d)}return imgLiquid.isIE&&a.settings.ieFadeInDisabled&&(i.fadeInTime=0),i}function r(){var i,e,a,d,o,n,s,r,m=0,h=0,f=u.width(),v=u.height();void 0===c.data("owidth")&&c.data("owidth",c[0].width),void 0===c.data("oheight")&&c.data("oheight",c[0].height),g.fill===f/v>=c.data("owidth")/c.data("oheight")?(i="100%",e="auto",a=Math.floor(f),d=Math.floor(f*(c.data("oheight")/c.data("owidth")))):(i="auto",e="100%",a=Math.floor(v*(c.data("owidth")/c.data("oheight"))),d=Math.floor(v)),o=g.horizontalAlign.toLowerCase(),s=f-a,"left"===o&&(h=0),"center"===o&&(h=.5*s),"right"===o&&(h=s),-1!==o.indexOf("%")&&(o=parseInt(o.replace("%",""),10),o>0&&(h=.01*s*o)),n=g.verticalAlign.toLowerCase(),r=v-d,"left"===n&&(m=0),"center"===n&&(m=.5*r),"bottom"===n&&(m=r),-1!==n.indexOf("%")&&(n=parseInt(n.replace("%",""),10),n>0&&(m=.01*r*n)),g.hardPixels&&(i=a,e=d),c.css({width:i,height:e,"margin-left":Math.floor(h),"margin-top":Math.floor(m)}),c.data("imgLiquid_oldProcessed")||(c.fadeTo(g.fadeInTime,1),c.data("imgLiquid_oldProcessed",!0),g.removeBoxBackground&&u.css("background-image","none"),u.addClass("imgLiquid_nobgSize"),u.addClass("imgLiquid_ready")),g.onItemFinish&&g.onItemFinish(t,u,c),l()}function l(){t===a.length-1&&a.settings.onFinish&&a.settings.onFinish()}var g=a.settings,u=i(this),c=i("img:first",u);return c.length?(c.data("imgLiquid_settings")?(u.removeClass("imgLiquid_error").removeClass("imgLiquid_ready"),g=i.extend({},c.data("imgLiquid_settings"),a.options)):g=i.extend({},a.settings,s()),c.data("imgLiquid_settings",g),g.onItemStart&&g.onItemStart(t,u,c),imgLiquid.bgs_Available&&g.useBackgroundSize?e():d(),void 0):(n(),void 0)})}})}(jQuery),!function(){var i=imgLiquid.injectCss,t=document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i)),t.appendChild(e)}();


/*!
* MediaElement.js
* HTML5 <video> and <audio> shim and player
* http://mediaelementjs.com/
*
* Creates a JavaScript object that mimics HTML5 MediaElement API
* for browsers that don't understand HTML5 or can't play the provided codec
* Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
*
* Copyright 2010-2014, John Dyer (http://j.hn)
* License: MIT
*
*/var mejs=mejs||{};mejs.version="2.15.1";mejs.meIndex=0;
mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/youtube","video/x-youtube","application/x-mpegURL"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,
types:["video/vimeo","video/x-vimeo"]}]};
mejs.Utility={encodeUrl:function(a){return encodeURIComponent(a)},escapeHTML:function(a){return a.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(a){var b=document.createElement("div");b.innerHTML='<a href="'+this.escapeHTML(a)+'">x</a>';return b.firstChild.href},getScriptPath:function(a){for(var b=0,c,d="",e="",g,f,i=document.getElementsByTagName("script"),k=i.length,h=a.length;b<k;b++){g=i[b].src;c=g.lastIndexOf("/");if(c>-1){f=g.substring(c+
1);g=g.substring(0,c+1)}else{f=g;g=""}for(c=0;c<h;c++){e=a[c];e=f.indexOf(e);if(e>-1){d=g;break}}if(d!=="")break}return d},secondsToTimeCode:function(a,b,c,d){if(typeof c=="undefined")c=false;else if(typeof d=="undefined")d=25;var e=Math.floor(a/3600)%24,g=Math.floor(a/60)%60,f=Math.floor(a%60);a=Math.floor((a%1*d).toFixed(3));return(b||e>0?(e<10?"0"+e:e)+":":"")+(g<10?"0"+g:g)+":"+(f<10?"0"+f:f)+(c?":"+(a<10?"0"+a:a):"")},timeCodeToSeconds:function(a,b,c,d){if(typeof c=="undefined")c=false;else if(typeof d==
"undefined")d=25;a=a.split(":");b=parseInt(a[0],10);var e=parseInt(a[1],10),g=parseInt(a[2],10),f=0,i=0;if(c)f=parseInt(a[3])/d;return i=b*3600+e*60+g+f},convertSMPTEtoSeconds:function(a){if(typeof a!="string")return false;a=a.replace(",",".");var b=0,c=a.indexOf(".")!=-1?a.split(".")[1].length:0,d=1;a=a.split(":").reverse();for(var e=0;e<a.length;e++){d=1;if(e>0)d=Math.pow(60,e);b+=Number(a[e])*d}return Number(b.toFixed(c))},removeSwf:function(a){var b=document.getElementById(a);if(b&&/object|embed/i.test(b.nodeName))if(mejs.MediaFeatures.isIE){b.style.display=
"none";(function(){b.readyState==4?mejs.Utility.removeObjectInIE(a):setTimeout(arguments.callee,10)})()}else b.parentNode.removeChild(b)},removeObjectInIE:function(a){if(a=document.getElementById(a)){for(var b in a)if(typeof a[b]=="function")a[b]=null;a.parentNode.removeChild(a)}}};
mejs.PluginDetector={hasPluginVersion:function(a,b){var c=this.plugins[a];b[1]=b[1]||0;b[2]=b[2]||0;return c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?true:false},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(a,b,c,d,e){this.plugins[a]=this.detectPlugin(b,c,d,e)},detectPlugin:function(a,b,c,d){var e=[0,0,0],g;if(typeof this.nav.plugins!="undefined"&&typeof this.nav.plugins[a]=="object"){if((c=this.nav.plugins[a].description)&&
!(typeof this.nav.mimeTypes!="undefined"&&this.nav.mimeTypes[b]&&!this.nav.mimeTypes[b].enabledPlugin)){e=c.replace(a,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".");for(a=0;a<e.length;a++)e[a]=parseInt(e[a].match(/\d+/),10)}}else if(typeof window.ActiveXObject!="undefined")try{if(g=new ActiveXObject(c))e=d(g)}catch(f){}return e}};
mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(a){var b=[];if(a=a.GetVariable("$version")){a=a.split(" ")[1].split(",");b=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]}return b});
mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(a){var b=[0,0,0,0],c=function(d,e,g,f){for(;d.isVersionSupported(e[0]+"."+e[1]+"."+e[2]+"."+e[3]);)e[g]+=f;e[g]-=f};c(a,b,0,1);c(a,b,1,1);c(a,b,2,1E4);c(a,b,2,1E3);c(a,b,2,100);c(a,b,2,10);c(a,b,2,1);c(a,b,3,1);return b});
mejs.MediaFeatures={init:function(){var a=this,b=document,c=mejs.PluginDetector.nav,d=mejs.PluginDetector.ua.toLowerCase(),e,g=["source","track","audio","video"];a.isiPad=d.match(/ipad/i)!==null;a.isiPhone=d.match(/iphone/i)!==null;a.isiOS=a.isiPhone||a.isiPad;a.isAndroid=d.match(/android/i)!==null;a.isBustedAndroid=d.match(/android 2\.[12]/)!==null;a.isBustedNativeHTTPS=location.protocol==="https:"&&(d.match(/android [12]\./)!==null||d.match(/macintosh.* version.* safari/)!==null);a.isIE=c.appName.toLowerCase().indexOf("microsoft")!=
-1||c.appName.toLowerCase().match(/trident/gi)!==null;a.isChrome=d.match(/chrome/gi)!==null;a.isChromium=d.match(/chromium/gi)!==null;a.isFirefox=d.match(/firefox/gi)!==null;a.isWebkit=d.match(/webkit/gi)!==null;a.isGecko=d.match(/gecko/gi)!==null&&!a.isWebkit&&!a.isIE;a.isOpera=d.match(/opera/gi)!==null;a.hasTouch="ontouchstart"in window;a.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;for(c=0;c<g.length;c++)e=document.createElement(g[c]);
a.supportsMediaTag=typeof e.canPlayType!=="undefined"||a.isBustedAndroid;try{e.canPlayType("video/mp4")}catch(f){a.supportsMediaTag=false}a.hasSemiNativeFullScreen=typeof e.webkitEnterFullscreen!=="undefined";a.hasNativeFullscreen=typeof e.requestFullscreen!=="undefined";a.hasWebkitNativeFullScreen=typeof e.webkitRequestFullScreen!=="undefined";a.hasMozNativeFullScreen=typeof e.mozRequestFullScreen!=="undefined";a.hasMsNativeFullScreen=typeof e.msRequestFullscreen!=="undefined";a.hasTrueNativeFullScreen=
a.hasWebkitNativeFullScreen||a.hasMozNativeFullScreen||a.hasMsNativeFullScreen;a.nativeFullScreenEnabled=a.hasTrueNativeFullScreen;if(a.hasMozNativeFullScreen)a.nativeFullScreenEnabled=document.mozFullScreenEnabled;else if(a.hasMsNativeFullScreen)a.nativeFullScreenEnabled=document.msFullscreenEnabled;if(a.isChrome)a.hasSemiNativeFullScreen=false;if(a.hasTrueNativeFullScreen){a.fullScreenEventName="";if(a.hasWebkitNativeFullScreen)a.fullScreenEventName="webkitfullscreenchange";else if(a.hasMozNativeFullScreen)a.fullScreenEventName=
"mozfullscreenchange";else if(a.hasMsNativeFullScreen)a.fullScreenEventName="MSFullscreenChange";a.isFullScreen=function(){if(a.hasMozNativeFullScreen)return b.mozFullScreen;else if(a.hasWebkitNativeFullScreen)return b.webkitIsFullScreen;else if(a.hasMsNativeFullScreen)return b.msFullscreenElement!==null};a.requestFullScreen=function(i){if(a.hasWebkitNativeFullScreen)i.webkitRequestFullScreen();else if(a.hasMozNativeFullScreen)i.mozRequestFullScreen();else a.hasMsNativeFullScreen&&i.msRequestFullscreen()};
a.cancelFullScreen=function(){if(a.hasWebkitNativeFullScreen)document.webkitCancelFullScreen();else if(a.hasMozNativeFullScreen)document.mozCancelFullScreen();else a.hasMsNativeFullScreen&&document.msExitFullscreen()}}if(a.hasSemiNativeFullScreen&&d.match(/mac os x 10_5/i)){a.hasNativeFullScreen=false;a.hasSemiNativeFullScreen=false}}};mejs.MediaFeatures.init();
mejs.HtmlMediaElement={pluginType:"native",isFullScreen:false,setCurrentTime:function(a){this.currentTime=a},setMuted:function(a){this.muted=a},setVolume:function(a){this.volume=a},stop:function(){this.pause()},setSrc:function(a){for(var b=this.getElementsByTagName("source");b.length>0;)this.removeChild(b[0]);if(typeof a=="string")this.src=a;else{var c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.src=c.src;break}}}},setVideoSize:function(a,b){this.width=a;this.height=b}};
mejs.PluginMediaElement=function(a,b,c){this.id=a;this.pluginType=b;this.src=c;this.events={};this.attributes={}};
mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:false,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,error:null,tagName:"",muted:false,volume:1,currentTime:0,play:function(){if(this.pluginApi!=null){this.pluginType=="youtube"||this.pluginType=="vimeo"?this.pluginApi.playVideo():this.pluginApi.playMedia();this.paused=false}},load:function(){if(this.pluginApi!=null){this.pluginType=="youtube"||this.pluginType==
"vimeo"||this.pluginApi.loadMedia();this.paused=false}},pause:function(){if(this.pluginApi!=null){this.pluginType=="youtube"||this.pluginType=="vimeo"?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia();this.paused=true}},stop:function(){if(this.pluginApi!=null){this.pluginType=="youtube"||this.pluginType=="vimeo"?this.pluginApi.stopVideo():this.pluginApi.stopMedia();this.paused=true}},canPlayType:function(a){var b,c,d,e=mejs.plugins[this.pluginType];for(b=0;b<e.length;b++){d=e[b];if(mejs.PluginDetector.hasPluginVersion(this.pluginType,
d.version))for(c=0;c<d.types.length;c++)if(a==d.types[c])return"probably"}return""},positionFullscreenButton:function(a,b,c){this.pluginApi!=null&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(a),Math.floor(b),c)},hideFullscreenButton:function(){this.pluginApi!=null&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(a){if(typeof a=="string"){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(a));this.src=mejs.Utility.absolutizeUrl(a)}else{var b,
c;for(b=0;b<a.length;b++){c=a[b];if(this.canPlayType(c.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(c.src));this.src=mejs.Utility.absolutizeUrl(a);break}}}},setCurrentTime:function(a){if(this.pluginApi!=null){this.pluginType=="youtube"||this.pluginType=="vimeo"?this.pluginApi.seekTo(a):this.pluginApi.setCurrentTime(a);this.currentTime=a}},setVolume:function(a){if(this.pluginApi!=null){this.pluginType=="youtube"?this.pluginApi.setVolume(a*100):this.pluginApi.setVolume(a);this.volume=a}},
setMuted:function(a){if(this.pluginApi!=null){if(this.pluginType=="youtube"){a?this.pluginApi.mute():this.pluginApi.unMute();this.muted=a;this.dispatchEvent("volumechange")}else this.pluginApi.setMuted(a);this.muted=a}},setVideoSize:function(a,b){if(this.pluginElement&&this.pluginElement.style){this.pluginElement.style.width=a+"px";this.pluginElement.style.height=b+"px"}this.pluginApi!=null&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(a,b)},setFullscreen:function(a){this.pluginApi!=null&&
this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(a)},enterFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.setFullscreen(true)},exitFullScreen:function(){this.pluginApi!=null&&this.pluginApi.setFullscreen&&this.setFullscreen(false)},addEventListener:function(a,b){this.events[a]=this.events[a]||[];this.events[a].push(b)},removeEventListener:function(a,b){if(!a){this.events={};return true}var c=this.events[a];if(!c)return true;if(!b){this.events[a]=[];return true}for(var d=
0;d<c.length;d++)if(c[d]===b){this.events[a].splice(d,1);return true}return false},dispatchEvent:function(a){var b,c,d=this.events[a];if(d){c=Array.prototype.slice.call(arguments,1);for(b=0;b<d.length;b++)d[b].apply(null,c)}},hasAttribute:function(a){return a in this.attributes},removeAttribute:function(a){delete this.attributes[a]},getAttribute:function(a){if(this.hasAttribute(a))return this.attributes[a];return""},setAttribute:function(a,b){this.attributes[a]=b},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id);
mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}};
mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(a,b,c){this.pluginMediaElements[a]=b;this.htmlMediaElements[a]=c},unregisterPluginElement:function(a){delete this.pluginMediaElements[a];delete this.htmlMediaElements[a]},initPlugin:function(a){var b=this.pluginMediaElements[a],c=this.htmlMediaElements[a];if(b){switch(b.pluginType){case "flash":b.pluginElement=b.pluginApi=document.getElementById(a);break;case "silverlight":b.pluginElement=document.getElementById(b.id);
b.pluginApi=b.pluginElement.Content.MediaElementJS}b.pluginApi!=null&&b.success&&b.success(b,c)}},fireEvent:function(a,b,c){var d,e;if(a=this.pluginMediaElements[a]){b={type:b,target:a};for(d in c){a[d]=c[d];b[d]=c[d]}e=c.bufferedTime||0;b.target.buffered=b.buffered={start:function(){return 0},end:function(){return e},length:1};a.dispatchEvent(b.type,b)}}};
mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:false,httpsBasicAuthSite:false,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",enablePluginSmoothing:false,enablePseudoStreaming:false,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,
defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:0.8,success:function(){},error:function(){}};mejs.MediaElement=function(a,b){return mejs.HtmlMediaElementShim.create(a,b)};
mejs.HtmlMediaElementShim={create:function(a,b){var c=mejs.MediaElementDefaults,d=typeof a=="string"?document.getElementById(a):a,e=d.tagName.toLowerCase(),g=e==="audio"||e==="video",f=g?d.getAttribute("src"):d.getAttribute("href");e=d.getAttribute("poster");var i=d.getAttribute("autoplay"),k=d.getAttribute("preload"),h=d.getAttribute("controls"),j;for(j in b)c[j]=b[j];f=typeof f=="undefined"||f===null||f==""?null:f;e=typeof e=="undefined"||e===null?"":e;k=typeof k=="undefined"||k===null||k==="false"?
"none":k;i=!(typeof i=="undefined"||i===null||i==="false");h=!(typeof h=="undefined"||h===null||h==="false");j=this.determinePlayback(d,c,mejs.MediaFeatures.supportsMediaTag,g,f);j.url=j.url!==null?mejs.Utility.absolutizeUrl(j.url):"";if(j.method=="native"){if(mejs.MediaFeatures.isBustedAndroid){d.src=j.url;d.addEventListener("click",function(){d.play()},false)}return this.updateNative(j,c,i,k)}else if(j.method!=="")return this.createPlugin(j,c,e,i,k,h);else{this.createErrorMessage(j,c,e);return this}},
determinePlayback:function(a,b,c,d,e){var g=[],f,i,k,h={method:"",url:"",htmlMediaElement:a,isVideo:a.tagName.toLowerCase()!="audio"},j;if(typeof b.type!="undefined"&&b.type!=="")if(typeof b.type=="string")g.push({type:b.type,url:e});else for(f=0;f<b.type.length;f++)g.push({type:b.type[f],url:e});else if(e!==null){k=this.formatType(e,a.getAttribute("type"));g.push({type:k,url:e})}else for(f=0;f<a.childNodes.length;f++){i=a.childNodes[f];if(i.nodeType==1&&i.tagName.toLowerCase()=="source"){e=i.getAttribute("src");
k=this.formatType(e,i.getAttribute("type"));i=i.getAttribute("media");if(!i||!window.matchMedia||window.matchMedia&&window.matchMedia(i).matches)g.push({type:k,url:e})}}if(!d&&g.length>0&&g[0].url!==null&&this.getTypeFromFile(g[0].url).indexOf("audio")>-1)h.isVideo=false;if(mejs.MediaFeatures.isBustedAndroid)a.canPlayType=function(m){return m.match(/video\/(mp4|m4v)/gi)!==null?"maybe":""};if(mejs.MediaFeatures.isChromium)a.canPlayType=function(m){return m.match(/video\/(webm|ogv|ogg)/gi)!==null?"maybe":
""};if(c&&(b.mode==="auto"||b.mode==="auto_plugin"||b.mode==="native")&&!(mejs.MediaFeatures.isBustedNativeHTTPS&&b.httpsBasicAuthSite===true)){if(!d){f=document.createElement(h.isVideo?"video":"audio");a.parentNode.insertBefore(f,a);a.style.display="none";h.htmlMediaElement=a=f}for(f=0;f<g.length;f++)if(g[f].type=="video/m3u8"||a.canPlayType(g[f].type).replace(/no/,"")!==""||a.canPlayType(g[f].type.replace(/mp3/,"mpeg")).replace(/no/,"")!==""||a.canPlayType(g[f].type.replace(/m4a/,"mp4")).replace(/no/,
"")!==""){h.method="native";h.url=g[f].url;break}if(h.method==="native"){if(h.url!==null)a.src=h.url;if(b.mode!=="auto_plugin")return h}}if(b.mode==="auto"||b.mode==="auto_plugin"||b.mode==="shim")for(f=0;f<g.length;f++){k=g[f].type;for(a=0;a<b.plugins.length;a++){e=b.plugins[a];i=mejs.plugins[e];for(c=0;c<i.length;c++){j=i[c];if(j.version==null||mejs.PluginDetector.hasPluginVersion(e,j.version))for(d=0;d<j.types.length;d++)if(k==j.types[d]){h.method=e;h.url=g[f].url;return h}}}}if(b.mode==="auto_plugin"&&
h.method==="native")return h;if(h.method===""&&g.length>0)h.url=g[0].url;return h},formatType:function(a,b){return a&&!b?this.getTypeFromFile(a):b&&~b.indexOf(";")?b.substr(0,b.indexOf(";")):b},getTypeFromFile:function(a){a=a.split("?")[0];a=a.substring(a.lastIndexOf(".")+1).toLowerCase();return(/(mp4|m4v|ogg|ogv|m3u8|webm|webmv|flv|wmv|mpeg|mov)/gi.test(a)?"video":"audio")+"/"+this.getTypeFromExtension(a)},getTypeFromExtension:function(a){switch(a){case "mp4":case "m4v":case "m4a":return"mp4";case "webm":case "webma":case "webmv":return"webm";
case "ogg":case "oga":case "ogv":return"ogg";default:return a}},createErrorMessage:function(a,b,c){var d=a.htmlMediaElement,e=document.createElement("div");e.className="me-cannotplay";try{e.style.width=d.width+"px";e.style.height=d.height+"px"}catch(g){}e.innerHTML=b.customError?b.customError:c!==""?'<a href="'+a.url+'"><img src="'+c+'" width="100%" height="100%" /></a>':'<a href="'+a.url+'"><span>'+mejs.i18n.t("Download File")+"</span></a>";d.parentNode.insertBefore(e,d);d.style.display="none";b.error(d)},
createPlugin:function(a,b,c,d,e,g){c=a.htmlMediaElement;var f=1,i=1,k="me_"+a.method+"_"+mejs.meIndex++,h=new mejs.PluginMediaElement(k,a.method,a.url),j=document.createElement("div"),m;h.tagName=c.tagName;for(m=0;m<c.attributes.length;m++){var q=c.attributes[m];q.specified==true&&h.setAttribute(q.name,q.value)}for(m=c.parentNode;m!==null&&m.tagName.toLowerCase()!=="body"&&m.parentNode!=null;){if(m.parentNode.tagName.toLowerCase()==="p"){m.parentNode.parentNode.insertBefore(m,m.parentNode);break}m=
m.parentNode}if(a.isVideo){f=b.pluginWidth>0?b.pluginWidth:b.videoWidth>0?b.videoWidth:c.getAttribute("width")!==null?c.getAttribute("width"):b.defaultVideoWidth;i=b.pluginHeight>0?b.pluginHeight:b.videoHeight>0?b.videoHeight:c.getAttribute("height")!==null?c.getAttribute("height"):b.defaultVideoHeight;f=mejs.Utility.encodeUrl(f);i=mejs.Utility.encodeUrl(i)}else if(b.enablePluginDebug){f=320;i=240}h.success=b.success;mejs.MediaPluginBridge.registerPluginElement(k,h,c);j.className="me-plugin";j.id=
k+"_container";a.isVideo?c.parentNode.insertBefore(j,c):document.body.insertBefore(j,document.body.childNodes[0]);d=["id="+k,"isvideo="+(a.isVideo?"true":"false"),"autoplay="+(d?"true":"false"),"preload="+e,"width="+f,"startvolume="+b.startVolume,"timerrate="+b.timerRate,"flashstreamer="+b.flashStreamer,"height="+i,"pseudostreamstart="+b.pseudoStreamingStartQueryParam];if(a.url!==null)a.method=="flash"?d.push("file="+mejs.Utility.encodeUrl(a.url)):d.push("file="+a.url);b.enablePluginDebug&&d.push("debug=true");
b.enablePluginSmoothing&&d.push("smoothing=true");b.enablePseudoStreaming&&d.push("pseudostreaming=true");g&&d.push("controls=true");if(b.pluginVars)d=d.concat(b.pluginVars);switch(a.method){case "silverlight":j.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+k+'" name="'+k+'" width="'+f+'" height="'+i+'" class="mejs-shim"><param name="initParams" value="'+d.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+
b.pluginPath+b.silverlightName+'" /></object>';break;case "flash":if(mejs.MediaFeatures.isIE){a=document.createElement("div");j.appendChild(a);a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+k+'" width="'+f+'" height="'+i+'" class="mejs-shim"><param name="movie" value="'+b.pluginPath+b.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+d.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /><param name="scale" value="default" /></object>'}else j.innerHTML=
'<embed id="'+k+'" name="'+k+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+b.pluginPath+b.flashName+'" flashvars="'+d.join("&")+'" width="'+f+'" height="'+i+'" scale="default"class="mejs-shim"></embed>';break;case "youtube":if(a.url.lastIndexOf("youtu.be")!=-1){a=a.url.substr(a.url.lastIndexOf("/")+1);if(a.indexOf("?")!=
-1)a=a.substr(0,a.indexOf("?"))}else a=a.url.substr(a.url.lastIndexOf("=")+1);youtubeSettings={container:j,containerId:j.id,pluginMediaElement:h,pluginId:k,videoId:a,height:i,width:f};mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case "vimeo":b=k+"_player";h.vimeoid=a.url.substr(a.url.lastIndexOf("/")+1);j.innerHTML='<iframe src="//player.vimeo.com/video/'+h.vimeoid+"?api=1&portrait=0&byline=0&title=0&player_id="+
b+'" width="'+f+'" height="'+i+'" frameborder="0" class="mejs-shim" id="'+b+'"></iframe>';if(typeof $f=="function"){var l=$f(j.childNodes[0]);l.addEvent("ready",function(){function o(n,p,r,s){n={type:r,target:p};if(r=="timeupdate"){p.currentTime=n.currentTime=s.seconds;p.duration=n.duration=s.duration}p.dispatchEvent(n.type,n)}$.extend(l,{playVideo:function(){l.api("play")},stopVideo:function(){l.api("unload")},pauseVideo:function(){l.api("pause")},seekTo:function(n){l.api("seekTo",n)},setVolume:function(n){l.api("setVolume",
n)},setMuted:function(n){if(n){l.lastVolume=l.api("getVolume");l.api("setVolume",0)}else{l.api("setVolume",l.lastVolume);delete l.lastVolume}}});l.addEvent("play",function(){o(l,h,"play");o(l,h,"playing")});l.addEvent("pause",function(){o(l,h,"pause")});l.addEvent("finish",function(){o(l,h,"ended")});l.addEvent("playProgress",function(n){o(l,h,"timeupdate",n)});h.pluginElement=j;h.pluginApi=l;mejs.MediaPluginBridge.initPlugin(k)})}else console.warn("You need to include froogaloop for vimeo to work")}c.style.display=
"none";c.removeAttribute("autoplay");return h},updateNative:function(a,b){var c=a.htmlMediaElement,d;for(d in mejs.HtmlMediaElement)c[d]=mejs.HtmlMediaElement[d];b.success(c,c);return c}};
mejs.YouTubeApi={isIframeStarted:false,isIframeLoaded:false,loadIframeApi:function(){if(!this.isIframeStarted){var a=document.createElement("script");a.src="//www.youtube.com/player_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);this.isIframeStarted=true}},iframeQueue:[],enqueueIframe:function(a){if(this.isLoaded)this.createIframe(a);else{this.loadIframeApi();this.iframeQueue.push(a)}},createIframe:function(a){var b=a.pluginMediaElement,c=new YT.Player(a.containerId,
{height:a.height,width:a.width,videoId:a.videoId,playerVars:{controls:0},events:{onReady:function(){a.pluginMediaElement.pluginApi=c;mejs.MediaPluginBridge.initPlugin(a.pluginId);setInterval(function(){mejs.YouTubeApi.createEvent(c,b,"timeupdate")},250)},onStateChange:function(d){mejs.YouTubeApi.handleStateChange(d.data,c,b)}}})},createEvent:function(a,b,c){c={type:c,target:b};if(a&&a.getDuration){b.currentTime=c.currentTime=a.getCurrentTime();b.duration=c.duration=a.getDuration();c.paused=b.paused;
c.ended=b.ended;c.muted=a.isMuted();c.volume=a.getVolume()/100;c.bytesTotal=a.getVideoBytesTotal();c.bufferedBytes=a.getVideoBytesLoaded();var d=c.bufferedBytes/c.bytesTotal*c.duration;c.target.buffered=c.buffered={start:function(){return 0},end:function(){return d},length:1}}b.dispatchEvent(c.type,c)},iFrameReady:function(){for(this.isIframeLoaded=this.isLoaded=true;this.iframeQueue.length>0;)this.createIframe(this.iframeQueue.pop())},flashPlayers:{},createFlash:function(a){this.flashPlayers[a.pluginId]=
a;var b,c="//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+a.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";if(mejs.MediaFeatures.isIE){b=document.createElement("div");a.container.appendChild(b);b.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+a.pluginId+'" width="'+a.width+'" height="'+a.height+'" class="mejs-shim"><param name="movie" value="'+
c+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'}else a.container.innerHTML='<object type="application/x-shockwave-flash" id="'+a.pluginId+'" data="'+c+'" width="'+a.width+'" height="'+a.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'},flashReady:function(a){var b=this.flashPlayers[a],c=
document.getElementById(a),d=b.pluginMediaElement;d.pluginApi=d.pluginElement=c;mejs.MediaPluginBridge.initPlugin(a);c.cueVideoById(b.videoId);a=b.containerId+"_callback";window[a]=function(e){mejs.YouTubeApi.handleStateChange(e,c,d)};c.addEventListener("onStateChange",a);setInterval(function(){mejs.YouTubeApi.createEvent(c,d,"timeupdate")},250);mejs.YouTubeApi.createEvent(c,d,"canplay")},handleStateChange:function(a,b,c){switch(a){case -1:c.paused=true;c.ended=true;mejs.YouTubeApi.createEvent(b,
c,"loadedmetadata");break;case 0:c.paused=false;c.ended=true;mejs.YouTubeApi.createEvent(b,c,"ended");break;case 1:c.paused=false;c.ended=false;mejs.YouTubeApi.createEvent(b,c,"play");mejs.YouTubeApi.createEvent(b,c,"playing");break;case 2:c.paused=true;c.ended=false;mejs.YouTubeApi.createEvent(b,c,"pause");break;case 3:mejs.YouTubeApi.createEvent(b,c,"progress")}}};function onYouTubePlayerAPIReady(){mejs.YouTubeApi.iFrameReady()}function onYouTubePlayerReady(a){mejs.YouTubeApi.flashReady(a)}
window.mejs=mejs;window.MediaElement=mejs.MediaElement;
(function(a,b){var c={locale:{language:"",strings:{}},methods:{}};c.getLanguage=function(){return(c.locale.language||window.navigator.userLanguage||window.navigator.language).substr(0,2).toLowerCase()};if(typeof mejsL10n!="undefined")c.locale.language=mejsL10n.language;c.methods.checkPlain=function(d){var e,g,f={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};d=String(d);for(e in f)if(f.hasOwnProperty(e)){g=RegExp(e,"g");d=d.replace(g,f[e])}return d};c.methods.t=function(d,e){if(c.locale.strings&&
c.locale.strings[e.context]&&c.locale.strings[e.context][d])d=c.locale.strings[e.context][d];return c.methods.checkPlain(d)};c.t=function(d,e){if(typeof d==="string"&&d.length>0){var g=c.getLanguage();e=e||{context:g};return c.methods.t(d,e)}else throw{name:"InvalidArgumentException",message:"First argument is either not a string or empty."};};b.i18n=c})(document,mejs);(function(a){if(typeof mejsL10n!="undefined")a[mejsL10n.language]=mejsL10n.strings})(mejs.i18n.locale.strings);
(function(a){if(typeof a.de==="undefined")a.de={Fullscreen:"Vollbild","Go Fullscreen":"Vollbild an","Turn off Fullscreen":"Vollbild aus",Close:"Schlie\u00dfen"}})(mejs.i18n.locale.strings);(function(a){if(typeof a.zh==="undefined")a.zh={Fullscreen:"\u5168\u87a2\u5e55","Go Fullscreen":"\u5168\u5c4f\u6a21\u5f0f","Turn off Fullscreen":"\u9000\u51fa\u5168\u5c4f\u6a21\u5f0f",Close:"\u95dc\u9589"}})(mejs.i18n.locale.strings);

/*!
 * MediaElementPlayer
 * http://mediaelementjs.com/
 *
 * Creates a controller bar for HTML5 <video> add <audio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *
 * Copyright 2010-2013, John Dyer (http://j.hn/)
 * License: MIT
 *
 */if(typeof jQuery!="undefined")mejs.$=jQuery;else if(typeof ender!="undefined")mejs.$=ender;
(function(f){mejs.MepDefaults={poster:"",showPosterWhenEnded:false,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(a){return a.duration*0.05},defaultSeekForwardInterval:function(a){return a.duration*0.05},setDimensions:true,audioWidth:-1,audioHeight:-1,startVolume:0.8,loop:false,autoRewind:true,enableAutosize:true,alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,autosizeProgress:true,
alwaysShowControls:false,hideVideoControlsOnLoad:false,clickToPlayPause:true,iPadUseNativeControls:false,iPhoneUseNativeControls:false,AndroidUseNativeControls:false,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:true,enableKeyboard:true,pauseOtherPlayers:true,keyActions:[{keys:[32,179],action:function(a,b){b.paused||b.ended?a.play():a.pause()}},{keys:[38],action:function(a,b){a.container.find(".mejs-volume-slider").css("display","block");if(a.isVideo){a.showControls();
a.startControlsTimer()}b.setVolume(Math.min(b.volume+0.1,1))}},{keys:[40],action:function(a,b){a.container.find(".mejs-volume-slider").css("display","block");if(a.isVideo){a.showControls();a.startControlsTimer()}b.setVolume(Math.max(b.volume-0.1,0))}},{keys:[37,227],action:function(a,b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.max(b.currentTime-a.options.defaultSeekBackwardInterval(b),0);b.setCurrentTime(c)}}},{keys:[39,228],action:function(a,
b){if(!isNaN(b.duration)&&b.duration>0){if(a.isVideo){a.showControls();a.startControlsTimer()}var c=Math.min(b.currentTime+a.options.defaultSeekForwardInterval(b),b.duration);b.setCurrentTime(c)}}},{keys:[70],action:function(a){if(typeof a.enterFullScreen!="undefined")a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}},{keys:[77],action:function(a){a.container.find(".mejs-volume-slider").css("display","block");if(a.isVideo){a.showControls();a.startControlsTimer()}a.media.muted?a.setMuted(false):
a.setMuted(true)}}]};mejs.mepIndex=0;mejs.players={};mejs.MediaElementPlayer=function(a,b){if(!(this instanceof mejs.MediaElementPlayer))return new mejs.MediaElementPlayer(a,b);this.$media=this.$node=f(a);this.node=this.media=this.$media[0];if(typeof this.node.player!="undefined")return this.node.player;else this.node.player=this;if(typeof b=="undefined")b=this.$node.data("mejsoptions");this.options=f.extend({},mejs.MepDefaults,b);this.id="mep_"+mejs.mepIndex++;mejs.players[this.id]=this;this.init();
return this};mejs.MediaElementPlayer.prototype={hasFocus:false,controlsAreVisible:true,init:function(){var a=this,b=mejs.MediaFeatures,c=f.extend(true,{},a.options,{success:function(d,g){a.meReady(d,g)},error:function(d){a.handleError(d)}}),e=a.media.tagName.toLowerCase();a.isDynamic=e!=="audio"&&e!=="video";a.isVideo=a.isDynamic?a.options.isVideo:e!=="audio"&&a.options.isVideo;if(b.isiPad&&a.options.iPadUseNativeControls||b.isiPhone&&a.options.iPhoneUseNativeControls){a.$media.attr("controls","controls");
b.isiPad&&a.media.getAttribute("autoplay")!==null&&a.play()}else if(!(b.isAndroid&&a.options.AndroidUseNativeControls)){a.$media.removeAttr("controls");a.container=f('<div id="'+a.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?"svg":"no-svg")+'"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(a.$media[0].className).insertBefore(a.$media);a.container.addClass((b.isAndroid?
"mejs-android ":"")+(b.isiOS?"mejs-ios ":"")+(b.isiPad?"mejs-ipad ":"")+(b.isiPhone?"mejs-iphone ":"")+(a.isVideo?"mejs-video ":"mejs-audio "));if(b.isiOS){b=a.$media.clone();a.container.find(".mejs-mediaelement").append(b);a.$media.remove();a.$node=a.$media=b;a.node=a.media=b[0]}else a.container.find(".mejs-mediaelement").append(a.$media);a.controls=a.container.find(".mejs-controls");a.layers=a.container.find(".mejs-layers");b=a.isVideo?"video":"audio";e=b.substring(0,1).toUpperCase()+b.substring(1);
a.width=a.options[b+"Width"]>0||a.options[b+"Width"].toString().indexOf("%")>-1?a.options[b+"Width"]:a.media.style.width!==""&&a.media.style.width!==null?a.media.style.width:a.media.getAttribute("width")!==null?a.$media.attr("width"):a.options["default"+e+"Width"];a.height=a.options[b+"Height"]>0||a.options[b+"Height"].toString().indexOf("%")>-1?a.options[b+"Height"]:a.media.style.height!==""&&a.media.style.height!==null?a.media.style.height:a.$media[0].getAttribute("height")!==null?a.$media.attr("height"):
a.options["default"+e+"Height"];a.setPlayerSize(a.width,a.height);c.pluginWidth=a.width;c.pluginHeight=a.height}mejs.MediaElement(a.$media[0],c);typeof a.container!="undefined"&&a.controlsAreVisible&&a.container.trigger("controlsshown")},showControls:function(a){var b=this;a=typeof a=="undefined"||a;if(!b.controlsAreVisible){if(a){b.controls.css("visibility","visible").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true;b.container.trigger("controlsshown")});b.container.find(".mejs-control").css("visibility",
"visible").stop(true,true).fadeIn(200,function(){b.controlsAreVisible=true})}else{b.controls.css("visibility","visible").css("display","block");b.container.find(".mejs-control").css("visibility","visible").css("display","block");b.controlsAreVisible=true;b.container.trigger("controlsshown")}b.setControlsSize()}},hideControls:function(a){var b=this;a=typeof a=="undefined"||a;if(!(!b.controlsAreVisible||b.options.alwaysShowControls))if(a){b.controls.stop(true,true).fadeOut(200,function(){f(this).css("visibility",
"hidden").css("display","block");b.controlsAreVisible=false;b.container.trigger("controlshidden")});b.container.find(".mejs-control").stop(true,true).fadeOut(200,function(){f(this).css("visibility","hidden").css("display","block")})}else{b.controls.css("visibility","hidden").css("display","block");b.container.find(".mejs-control").css("visibility","hidden").css("display","block");b.controlsAreVisible=false;b.container.trigger("controlshidden")}},controlsTimer:null,startControlsTimer:function(a){var b=
this;a=typeof a!="undefined"?a:1500;b.killControlsTimer("start");b.controlsTimer=setTimeout(function(){b.hideControls();b.killControlsTimer("hide")},a)},killControlsTimer:function(){if(this.controlsTimer!==null){clearTimeout(this.controlsTimer);delete this.controlsTimer;this.controlsTimer=null}},controlsEnabled:true,disableControls:function(){this.killControlsTimer();this.hideControls(false);this.controlsEnabled=false},enableControls:function(){this.showControls(false);this.controlsEnabled=true},
meReady:function(a,b){var c=this,e=mejs.MediaFeatures,d=b.getAttribute("autoplay");d=!(typeof d=="undefined"||d===null||d==="false");var g;if(!c.created){c.created=true;c.media=a;c.domNode=b;if(!(e.isAndroid&&c.options.AndroidUseNativeControls)&&!(e.isiPad&&c.options.iPadUseNativeControls)&&!(e.isiPhone&&c.options.iPhoneUseNativeControls)){c.buildposter(c,c.controls,c.layers,c.media);c.buildkeyboard(c,c.controls,c.layers,c.media);c.buildoverlays(c,c.controls,c.layers,c.media);c.findTracks();for(g in c.options.features){e=
c.options.features[g];if(c["build"+e])try{c["build"+e](c,c.controls,c.layers,c.media)}catch(k){}}c.container.trigger("controlsready");c.setPlayerSize(c.width,c.height);c.setControlsSize();if(c.isVideo){if(mejs.MediaFeatures.hasTouch)c.$media.bind("touchstart",function(){if(c.controlsAreVisible)c.hideControls(false);else c.controlsEnabled&&c.showControls(false)});else{c.clickToPlayPauseCallback=function(){if(c.options.clickToPlayPause)c.media.paused?c.play():c.pause()};c.media.addEventListener("click",
c.clickToPlayPauseCallback,false);c.container.bind("mouseenter mouseover",function(){if(c.controlsEnabled)if(!c.options.alwaysShowControls){c.killControlsTimer("enter");c.showControls();c.startControlsTimer(2500)}}).bind("mousemove",function(){if(c.controlsEnabled){c.controlsAreVisible||c.showControls();c.options.alwaysShowControls||c.startControlsTimer(2500)}}).bind("mouseleave",function(){c.controlsEnabled&&!c.media.paused&&!c.options.alwaysShowControls&&c.startControlsTimer(1E3)})}c.options.hideVideoControlsOnLoad&&
c.hideControls(false);d&&!c.options.alwaysShowControls&&c.hideControls();c.options.enableAutosize&&c.media.addEventListener("loadedmetadata",function(j){if(c.options.videoHeight<=0&&c.domNode.getAttribute("height")===null&&!isNaN(j.target.videoHeight)){c.setPlayerSize(j.target.videoWidth,j.target.videoHeight);c.setControlsSize();c.media.setVideoSize(j.target.videoWidth,j.target.videoHeight)}},false)}a.addEventListener("play",function(){for(var j in mejs.players){var m=mejs.players[j];m.id!=c.id&&
c.options.pauseOtherPlayers&&!m.paused&&!m.ended&&m.pause();m.hasFocus=false}c.hasFocus=true},false);c.media.addEventListener("ended",function(){if(c.options.autoRewind)try{c.media.setCurrentTime(0)}catch(j){}c.media.pause();c.setProgressRail&&c.setProgressRail();c.setCurrentRail&&c.setCurrentRail();if(c.options.loop)c.play();else!c.options.alwaysShowControls&&c.controlsEnabled&&c.showControls()},false);c.media.addEventListener("loadedmetadata",function(){c.updateDuration&&c.updateDuration();c.updateCurrent&&
c.updateCurrent();if(!c.isFullScreen){c.setPlayerSize(c.width,c.height);c.setControlsSize()}},false);setTimeout(function(){c.setPlayerSize(c.width,c.height);c.setControlsSize()},50);c.globalBind("resize",function(){c.isFullScreen||mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||c.setPlayerSize(c.width,c.height);c.setControlsSize()});c.media.pluginType=="youtube"&&c.options.autoplay&&c.container.find(".mejs-overlay-play").hide()}d&&a.pluginType=="native"&&c.play();if(c.options.success)typeof c.options.success==
"string"?window[c.options.success](c.media,c.domNode,c):c.options.success(c.media,c.domNode,c)}},handleError:function(a){this.controls.hide();this.options.error&&this.options.error(a)},setPlayerSize:function(a,b){if(!this.options.setDimensions)return false;if(typeof a!="undefined")this.width=a;if(typeof b!="undefined")this.height=b;if(this.height.toString().indexOf("%")>0||this.$node.css("max-width")==="100%"||this.$node[0].currentStyle&&this.$node[0].currentStyle.maxWidth==="100%"){var c=this.isVideo?
this.media.videoWidth&&this.media.videoWidth>0?this.media.videoWidth:this.media.getAttribute("width")!==null?this.media.getAttribute("width"):this.options.defaultVideoWidth:this.options.defaultAudioWidth,e=this.isVideo?this.media.videoHeight&&this.media.videoHeight>0?this.media.videoHeight:this.media.getAttribute("height")!==null?this.media.getAttribute("height"):this.options.defaultVideoHeight:this.options.defaultAudioHeight,d=this.container.parent().closest(":visible").width(),g=this.container.parent().closest(":visible").height();
c=this.isVideo||!this.options.autosizeProgress?parseInt(d*e/c,10):e;if(isNaN(c)||g!=0&&c>g)c=g;if(this.container.parent()[0].tagName.toLowerCase()==="body"){d=f(window).width();c=f(window).height()}if(c!=0&&d!=0){this.container.width(d).height(c);this.$media.add(this.container.find(".mejs-shim")).width("100%").height("100%");this.isVideo&&this.media.setVideoSize&&this.media.setVideoSize(d,c);this.layers.children(".mejs-layer").width("100%").height("100%")}}else{this.container.width(this.width).height(this.height);
this.layers.children(".mejs-layer").width(this.width).height(this.height)}d=this.layers.find(".mejs-overlay-play");g=d.find(".mejs-overlay-button");d.height(this.container.height()-this.controls.height());g.css("margin-top","-"+(g.height()/2-this.controls.height()/2).toString()+"px")},setControlsSize:function(){var a=0,b=0,c=this.controls.find(".mejs-time-rail"),e=this.controls.find(".mejs-time-total");this.controls.find(".mejs-time-current");this.controls.find(".mejs-time-loaded");var d=c.siblings(),
g=d.last(),k=null;if(!(!this.container.is(":visible")||!c.length||!c.is(":visible"))){if(this.options&&!this.options.autosizeProgress)b=parseInt(c.css("width"));if(b===0||!b){d.each(function(){var j=f(this);if(j.css("position")!="absolute"&&j.is(":visible"))a+=f(this).outerWidth(true)});b=this.controls.width()-a-(c.outerWidth(true)-c.width())}do{c.width(b);e.width(b-(e.outerWidth(true)-e.width()));if(g.css("position")!="absolute"){k=g.position();b--}}while(k!=null&&k.top>0&&b>0);this.setProgressRail&&
this.setProgressRail();this.setCurrentRail&&this.setCurrentRail()}},buildposter:function(a,b,c,e){var d=f('<div class="mejs-poster mejs-layer"></div>').appendTo(c);b=a.$media.attr("poster");if(a.options.poster!=="")b=a.options.poster;b!==""&&b!=null?this.setPoster(b):d.hide();e.addEventListener("play",function(){d.hide()},false);a.options.showPosterWhenEnded&&a.options.autoRewind&&e.addEventListener("ended",function(){d.show()},false)},setPoster:function(a){var b=this.container.find(".mejs-poster"),
c=b.find("img");if(c.length==0)c=f('<img width="100%" height="100%" />').appendTo(b);c.attr("src",a);b.css({"background-image":"url("+a+")"})},buildoverlays:function(a,b,c,e){var d=this;if(a.isVideo){var g=f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(c),k=f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(c),j=f('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(c).bind("click",
function(){d.options.clickToPlayPause&&e.paused&&e.play()});e.addEventListener("play",function(){j.hide();g.hide();b.find(".mejs-time-buffering").hide();k.hide()},false);e.addEventListener("playing",function(){j.hide();g.hide();b.find(".mejs-time-buffering").hide();k.hide()},false);e.addEventListener("seeking",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("seeked",function(){g.hide();b.find(".mejs-time-buffering").hide()},false);e.addEventListener("pause",function(){mejs.MediaFeatures.isiPhone||
j.show()},false);e.addEventListener("waiting",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("loadeddata",function(){g.show();b.find(".mejs-time-buffering").show()},false);e.addEventListener("canplay",function(){g.hide();b.find(".mejs-time-buffering").hide()},false);e.addEventListener("error",function(){g.hide();b.find(".mejs-time-buffering").hide();k.show();k.find("mejs-overlay-error").html("Error loading this resource")},false);e.addEventListener("keydown",
function(m){d.onkeydown(a,e,m)},false)}},buildkeyboard:function(a,b,c,e){var d=this;d.globalBind("keydown",function(g){return d.onkeydown(a,e,g)});d.globalBind("click",function(g){a.hasFocus=f(g.target).closest(".mejs-container").length!=0})},onkeydown:function(a,b,c){if(a.hasFocus&&a.options.enableKeyboard)for(var e=0,d=a.options.keyActions.length;e<d;e++)for(var g=a.options.keyActions[e],k=0,j=g.keys.length;k<j;k++)if(c.keyCode==g.keys[k]){typeof c.preventDefault=="function"&&c.preventDefault();
g.action(a,b,c.keyCode);return false}return true},findTracks:function(){var a=this,b=a.$media.find("track");a.tracks=[];b.each(function(c,e){e=f(e);a.tracks.push({srclang:e.attr("srclang")?e.attr("srclang").toLowerCase():"",src:e.attr("src"),kind:e.attr("kind"),label:e.attr("label")||"",entries:[],isLoaded:false})})},changeSkin:function(a){this.container[0].className="mejs-container "+a;this.setPlayerSize(this.width,this.height);this.setControlsSize()},play:function(){this.load();this.media.play()},
pause:function(){try{this.media.pause()}catch(a){}},load:function(){this.isLoaded||this.media.load();this.isLoaded=true},setMuted:function(a){this.media.setMuted(a)},setCurrentTime:function(a){this.media.setCurrentTime(a)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(a){this.media.setVolume(a)},getVolume:function(){return this.media.volume},setSrc:function(a){this.media.setSrc(a)},remove:function(){var a,b;for(a in this.options.features){b=this.options.features[a];if(this["clean"+
b])try{this["clean"+b](this)}catch(c){}}if(this.isDynamic)this.$node.insertBefore(this.container);else{this.$media.prop("controls",true);this.$node.clone().insertBefore(this.container).show();this.$node.remove()}this.media.pluginType!=="native"&&this.media.remove();delete mejs.players[this.id];typeof this.container=="object"&&this.container.remove();this.globalUnbind();delete this.node.player}};(function(){function a(c,e){var d={d:[],w:[]};f.each((c||"").split(" "),function(g,k){var j=k+"."+e;if(j.indexOf(".")===
0){d.d.push(j);d.w.push(j)}else d[b.test(k)?"w":"d"].push(j)});d.d=d.d.join(" ");d.w=d.w.join(" ");return d}var b=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;mejs.MediaElementPlayer.prototype.globalBind=function(c,e,d){c=a(c,this.id);c.d&&f(document).bind(c.d,e,d);c.w&&f(window).bind(c.w,e,d)};mejs.MediaElementPlayer.prototype.globalUnbind=function(c,e){c=a(c,this.id);c.d&&f(document).unbind(c.d,e);c.w&&f(window).unbind(c.w,e)}})();
if(typeof f!="undefined"){f.fn.mediaelementplayer=function(a){a===false?this.each(function(){var b=f(this).data("mediaelementplayer");b&&b.remove();f(this).removeData("mediaelementplayer")}):this.each(function(){f(this).data("mediaelementplayer",new mejs.MediaElementPlayer(this,a))});return this};f(document).ready(function(){f(".mejs-player").mediaelementplayer()})}window.MediaElementPlayer=mejs.MediaElementPlayer})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{playpauseText:mejs.i18n.t("Play/Pause")});f.extend(MediaElementPlayer.prototype,{buildplaypause:function(a,b,c,e){var d=f('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+this.id+'" title="'+this.options.playpauseText+'" aria-label="'+this.options.playpauseText+'"></button></div>').appendTo(b).click(function(g){g.preventDefault();e.paused?e.play():e.pause();return false});e.addEventListener("play",function(){d.removeClass("mejs-play").addClass("mejs-pause")},
false);e.addEventListener("playing",function(){d.removeClass("mejs-play").addClass("mejs-pause")},false);e.addEventListener("pause",function(){d.removeClass("mejs-pause").addClass("mejs-play")},false);e.addEventListener("paused",function(){d.removeClass("mejs-pause").addClass("mejs-play")},false)}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{stopText:"Stop"});f.extend(MediaElementPlayer.prototype,{buildstop:function(a,b,c,e){f('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="'+this.id+'" title="'+this.options.stopText+'" aria-label="'+this.options.stopText+'"></button></div>').appendTo(b).click(function(){e.paused||e.pause();if(e.currentTime>0){e.setCurrentTime(0);e.pause();b.find(".mejs-time-current").width("0px");b.find(".mejs-time-handle").css("left",
"0px");b.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0));b.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0));c.find(".mejs-poster").show()}})}})})(mejs.$);
(function(f){f.extend(MediaElementPlayer.prototype,{buildprogress:function(a,b,c,e){f('<div class="mejs-time-rail"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(b);b.find(".mejs-time-buffering").hide();var d=
this,g=b.find(".mejs-time-total");c=b.find(".mejs-time-loaded");var k=b.find(".mejs-time-current"),j=b.find(".mejs-time-handle"),m=b.find(".mejs-time-float"),q=b.find(".mejs-time-float-current"),p=function(h){h=h.originalEvent.changedTouches?h.originalEvent.changedTouches[0].pageX:h.pageX;var l=g.offset(),r=g.outerWidth(true),n=0,o=n=0;if(e.duration){if(h<l.left)h=l.left;else if(h>r+l.left)h=r+l.left;o=h-l.left;n=o/r;n=n<=0.02?0:n*e.duration;t&&n!==e.currentTime&&e.setCurrentTime(n);if(!mejs.MediaFeatures.hasTouch){m.css("left",
o);q.html(mejs.Utility.secondsToTimeCode(n));m.show()}}},t=false;g.bind("mousedown touchstart",function(h){if(h.which===1||h.which===0){t=true;p(h);d.globalBind("mousemove.dur touchmove.dur",function(l){p(l)});d.globalBind("mouseup.dur touchend.dur",function(){t=false;m.hide();d.globalUnbind(".dur")});return false}}).bind("mouseenter",function(){d.globalBind("mousemove.dur",function(h){p(h)});mejs.MediaFeatures.hasTouch||m.show()}).bind("mouseleave",function(){if(!t){d.globalUnbind(".dur");m.hide()}});
e.addEventListener("progress",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);e.addEventListener("timeupdate",function(h){a.setProgressRail(h);a.setCurrentRail(h)},false);d.loaded=c;d.total=g;d.current=k;d.handle=j},setProgressRail:function(a){var b=a!=undefined?a.target:this.media,c=null;if(b&&b.buffered&&b.buffered.length>0&&b.buffered.end&&b.duration)c=b.buffered.end(0)/b.duration;else if(b&&b.bytesTotal!=undefined&&b.bytesTotal>0&&b.bufferedBytes!=undefined)c=b.bufferedBytes/b.bytesTotal;
else if(a&&a.lengthComputable&&a.total!=0)c=a.loaded/a.total;if(c!==null){c=Math.min(1,Math.max(0,c));this.loaded&&this.total&&this.loaded.width(this.total.width()*c)}},setCurrentRail:function(){if(this.media.currentTime!=undefined&&this.media.duration)if(this.total&&this.handle){var a=Math.round(this.total.width()*this.media.currentTime/this.media.duration),b=a-Math.round(this.handle.outerWidth(true)/2);this.current.width(a);this.handle.css("left",b)}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"});f.extend(MediaElementPlayer.prototype,{buildcurrent:function(a,b,c,e){f('<div class="mejs-time"><span class="mejs-currenttime">'+(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00")+"</span></div>").appendTo(b);this.currenttime=this.controls.find(".mejs-currenttime");e.addEventListener("timeupdate",function(){a.updateCurrent()},false)},buildduration:function(a,b,
c,e){if(b.children().last().find(".mejs-currenttime").length>0)f(this.options.timeAndDurationSeparator+'<span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span>").appendTo(b.find(".mejs-time"));else{b.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container");
f('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(a.options.alwaysShowHours?"00:":"")+(a.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span></div>").appendTo(b)}this.durationD=this.controls.find(".mejs-duration");e.addEventListener("timeupdate",function(){a.updateDuration()},
false)},updateCurrent:function(){if(this.currenttime)this.currenttime.html(mejs.Utility.secondsToTimeCode(this.media.currentTime,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))},updateDuration:function(){this.container.toggleClass("mejs-long-video",this.media.duration>3600);if(this.durationD&&(this.options.duration>0||this.media.duration))this.durationD.html(mejs.Utility.secondsToTimeCode(this.options.duration>0?this.options.duration:
this.media.duration,this.options.alwaysShowHours,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{muteText:mejs.i18n.t("Mute Toggle"),hideVolumeOnTouchDevices:true,audioVolume:"horizontal",videoVolume:"vertical"});f.extend(MediaElementPlayer.prototype,{buildvolume:function(a,b,c,e){if(!((mejs.MediaFeatures.isAndroid||mejs.MediaFeatures.isiOS)&&this.options.hideVolumeOnTouchDevices)){var d=this,g=d.isVideo?d.options.videoVolume:d.options.audioVolume,k=g=="horizontal"?f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+
d.id+'" title="'+d.options.muteText+'" aria-label="'+d.options.muteText+'"></button></div><div class="mejs-horizontal-volume-slider"><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></div>').appendTo(b):f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+d.id+'" title="'+d.options.muteText+'" aria-label="'+d.options.muteText+'"></button><div class="mejs-volume-slider"><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></div></div>').appendTo(b),
j=d.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),m=d.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),q=d.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),p=d.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),t=function(n,o){if(!j.is(":visible")&&typeof o=="undefined"){j.show();t(n,true);j.hide()}else{n=Math.max(0,n);n=Math.min(n,1);n==0?k.removeClass("mejs-mute").addClass("mejs-unmute"):k.removeClass("mejs-unmute").addClass("mejs-mute");
if(g=="vertical"){var s=m.height(),u=m.position(),v=s-s*n;p.css("top",Math.round(u.top+v-p.height()/2));q.height(s-v);q.css("top",u.top+v)}else{s=m.width();u=m.position();s=s*n;p.css("left",Math.round(u.left+s-p.width()/2));q.width(Math.round(s))}}},h=function(n){var o=null,s=m.offset();if(g=="vertical"){o=m.height();parseInt(m.css("top").replace(/px/,""),10);o=(o-(n.pageY-s.top))/o;if(s.top==0||s.left==0)return}else{o=m.width();o=(n.pageX-s.left)/o}o=Math.max(0,o);o=Math.min(o,1);t(o);o==0?e.setMuted(true):
e.setMuted(false);e.setVolume(o)},l=false,r=false;k.hover(function(){j.show();r=true},function(){r=false;!l&&g=="vertical"&&j.hide()});j.bind("mouseover",function(){r=true}).bind("mousedown",function(n){h(n);d.globalBind("mousemove.vol",function(o){h(o)});d.globalBind("mouseup.vol",function(){l=false;d.globalUnbind(".vol");!r&&g=="vertical"&&j.hide()});l=true;return false});k.find("button").click(function(){e.setMuted(!e.muted)});e.addEventListener("volumechange",function(){if(!l)if(e.muted){t(0);
k.removeClass("mejs-mute").addClass("mejs-unmute")}else{t(e.volume);k.removeClass("mejs-unmute").addClass("mejs-mute")}},false);if(d.container.is(":visible")){t(a.options.startVolume);a.options.startVolume===0&&e.setMuted(true);e.pluginType==="native"&&e.setVolume(a.options.startVolume)}}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{usePluginFullScreen:true,newWindowCallback:function(){return""},fullscreenText:mejs.i18n.t("Fullscreen")});f.extend(MediaElementPlayer.prototype,{isFullScreen:false,isNativeFullScreen:false,isInIframe:false,buildfullscreen:function(a,b,c,e){if(a.isVideo){a.isInIframe=window.location!=window.parent.location;mejs.MediaFeatures.hasTrueNativeFullScreen&&a.globalBind(mejs.MediaFeatures.fullScreenEventName,function(){if(a.isFullScreen)if(mejs.MediaFeatures.isFullScreen()){a.isNativeFullScreen=
true;a.setControlsSize()}else{a.isNativeFullScreen=false;a.exitFullScreen()}});var d=this,g=f('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="'+d.id+'" title="'+d.options.fullscreenText+'" aria-label="'+d.options.fullscreenText+'"></button></div>').appendTo(b);if(d.media.pluginType==="native"||!d.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)g.click(function(){mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||a.isFullScreen?
a.exitFullScreen():a.enterFullScreen()});else{var k=null;if(function(){var h=document.createElement("x"),l=document.documentElement,r=window.getComputedStyle;if(!("pointerEvents"in h.style))return false;h.style.pointerEvents="auto";h.style.pointerEvents="x";l.appendChild(h);r=r&&r(h,"").pointerEvents==="auto";l.removeChild(h);return!!r}()&&!mejs.MediaFeatures.isOpera){var j=false,m=function(){if(j){for(var h in q)q[h].hide();g.css("pointer-events","");d.controls.css("pointer-events","");d.media.removeEventListener("click",
d.clickToPlayPauseCallback);j=false}},q={};b=["top","left","right","bottom"];var p,t=function(){var h=g.offset().left-d.container.offset().left,l=g.offset().top-d.container.offset().top,r=g.outerWidth(true),n=g.outerHeight(true),o=d.container.width(),s=d.container.height();for(p in q)q[p].css({position:"absolute",top:0,left:0});q.top.width(o).height(l);q.left.width(h).height(n).css({top:l});q.right.width(o-h-r).height(n).css({top:l,left:h+r});q.bottom.width(o).height(s-n-l).css({top:l+n})};d.globalBind("resize",
function(){t()});p=0;for(c=b.length;p<c;p++)q[b[p]]=f('<div class="mejs-fullscreen-hover" />').appendTo(d.container).mouseover(m).hide();g.on("mouseover",function(){if(!d.isFullScreen){var h=g.offset(),l=a.container.offset();e.positionFullscreenButton(h.left-l.left,h.top-l.top,false);g.css("pointer-events","none");d.controls.css("pointer-events","none");d.media.addEventListener("click",d.clickToPlayPauseCallback);for(p in q)q[p].show();t();j=true}});e.addEventListener("fullscreenchange",function(){d.isFullScreen=
!d.isFullScreen;d.isFullScreen?d.media.removeEventListener("click",d.clickToPlayPauseCallback):d.media.addEventListener("click",d.clickToPlayPauseCallback);m()});d.globalBind("mousemove",function(h){if(j){var l=g.offset();if(h.pageY<l.top||h.pageY>l.top+g.outerHeight(true)||h.pageX<l.left||h.pageX>l.left+g.outerWidth(true)){g.css("pointer-events","");d.controls.css("pointer-events","");j=false}}})}else g.on("mouseover",function(){if(k!==null){clearTimeout(k);delete k}var h=g.offset(),l=a.container.offset();
e.positionFullscreenButton(h.left-l.left,h.top-l.top,true)}).on("mouseout",function(){if(k!==null){clearTimeout(k);delete k}k=setTimeout(function(){e.hideFullscreenButton()},1500)})}a.fullscreenBtn=g;d.globalBind("keydown",function(h){if((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||d.isFullScreen)&&h.keyCode==27)a.exitFullScreen()})}},cleanfullscreen:function(a){a.exitFullScreen()},containerSizeTimeout:null,enterFullScreen:function(){var a=this;if(!(a.media.pluginType!==
"native"&&(mejs.MediaFeatures.isFirefox||a.options.usePluginFullScreen))){f(document.documentElement).addClass("mejs-fullscreen");normalHeight=a.container.height();normalWidth=a.container.width();if(a.media.pluginType==="native")if(mejs.MediaFeatures.hasTrueNativeFullScreen){mejs.MediaFeatures.requestFullScreen(a.container[0]);a.isInIframe&&setTimeout(function c(){if(a.isNativeFullScreen){var e=(window.devicePixelRatio||1)*f(window).width(),d=screen.width;Math.abs(d-e)>d*0.0020?a.exitFullScreen():
setTimeout(c,500)}},500)}else if(mejs.MediaFeatures.hasSemiNativeFullScreen){a.media.webkitEnterFullscreen();return}if(a.isInIframe){var b=a.options.newWindowCallback(this);if(b!=="")if(mejs.MediaFeatures.hasTrueNativeFullScreen)setTimeout(function(){if(!a.isNativeFullScreen){a.pause();window.open(b,a.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no")}},250);else{a.pause();window.open(b,a.id,"top=0,left=0,width="+screen.availWidth+
",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no");return}}a.container.addClass("mejs-container-fullscreen").width("100%").height("100%");a.containerSizeTimeout=setTimeout(function(){a.container.css({width:"100%",height:"100%"});a.setControlsSize()},500);if(a.media.pluginType==="native")a.$media.width("100%").height("100%");else{a.container.find(".mejs-shim").width("100%").height("100%");a.media.setVideoSize(f(window).width(),f(window).height())}a.layers.children("div").width("100%").height("100%");
a.fullscreenBtn&&a.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen");a.setControlsSize();a.isFullScreen=true;a.container.find(".mejs-captions-text").css("font-size",screen.width/a.width*1*100+"%");a.container.find(".mejs-captions-position").css("bottom","45px")}},exitFullScreen:function(){clearTimeout(this.containerSizeTimeout);if(this.media.pluginType!=="native"&&mejs.MediaFeatures.isFirefox)this.media.setFullscreen(false);else{if(mejs.MediaFeatures.hasTrueNativeFullScreen&&
(mejs.MediaFeatures.isFullScreen()||this.isFullScreen))mejs.MediaFeatures.cancelFullScreen();f(document.documentElement).removeClass("mejs-fullscreen");this.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight);if(this.media.pluginType==="native")this.$media.width(normalWidth).height(normalHeight);else{this.container.find(".mejs-shim").width(normalWidth).height(normalHeight);this.media.setVideoSize(normalWidth,normalHeight)}this.layers.children("div").width(normalWidth).height(normalHeight);
this.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen");this.setControlsSize();this.isFullScreen=false;this.container.find(".mejs-captions-text").css("font-size","");this.container.find(".mejs-captions-position").css("bottom","")}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{speeds:["1.50","1.25","1.00","0.75"],defaultSpeed:"1.00"});f.extend(MediaElementPlayer.prototype,{buildspeed:function(a,b,c,e){if(this.media.pluginType=="native"){c='<div class="mejs-button mejs-speed-button"><button type="button">'+this.options.defaultSpeed+'x</button><div class="mejs-speed-selector"><ul>';var d;f.inArray(this.options.defaultSpeed,this.options.speeds)===-1&&this.options.speeds.push(this.options.defaultSpeed);this.options.speeds.sort(function(g,
k){return parseFloat(k)-parseFloat(g)});for(d=0;d<this.options.speeds.length;d++){c+='<li><input type="radio" name="speed" value="'+this.options.speeds[d]+'" id="'+this.options.speeds[d]+'" ';if(this.options.speeds[d]==this.options.defaultSpeed){c+="checked=true ";c+='/><label for="'+this.options.speeds[d]+'" class="mejs-speed-selected">'+this.options.speeds[d]+"x</label></li>"}else c+='/><label for="'+this.options.speeds[d]+'">'+this.options.speeds[d]+"x</label></li>"}c+="</ul></div></div>";a.speedButton=
f(c).appendTo(b);a.playbackspeed=this.options.defaultSpeed;a.speedButton.on("click","input[type=radio]",function(){a.playbackspeed=f(this).attr("value");e.playbackRate=parseFloat(a.playbackspeed);a.speedButton.find("button").text(a.playbackspeed+"x");a.speedButton.find(".mejs-speed-selected").removeClass("mejs-speed-selected");a.speedButton.find("input[type=radio]:checked").next().addClass("mejs-speed-selected")});b=a.speedButton.find(".mejs-speed-selector");b.height(this.speedButton.find(".mejs-speed-selector ul").outerHeight(true)+
a.speedButton.find(".mejs-speed-translations").outerHeight(true));b.css("top",-1*b.height()+"px")}}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{startLanguage:"",tracksText:mejs.i18n.t("Captions/Subtitles"),hideCaptionsButtonWhenEmpty:true,toggleCaptionsButtonWhenOnlyOne:false,slidesSelector:""});f.extend(MediaElementPlayer.prototype,{hasChapters:false,buildtracks:function(a,b,c,e){if(a.tracks.length!==0){var d;if(this.domNode.textTracks)for(d=this.domNode.textTracks.length-1;d>=0;d--)this.domNode.textTracks[d].mode="hidden";a.chapters=f('<div class="mejs-chapters mejs-layer"></div>').prependTo(c).hide();
a.captions=f('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>').prependTo(c).hide();a.captionsText=a.captions.find(".mejs-captions-text");a.captionsButton=f('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="'+this.id+'" title="'+this.options.tracksText+'" aria-label="'+this.options.tracksText+'"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="'+
a.id+'_captions" id="'+a.id+'_captions_none" value="none" checked="checked" /><label for="'+a.id+'_captions_none">'+mejs.i18n.t("None")+"</label></li></ul></div></div>").appendTo(b);for(d=b=0;d<a.tracks.length;d++)a.tracks[d].kind=="subtitles"&&b++;if(this.options.toggleCaptionsButtonWhenOnlyOne&&b==1)a.captionsButton.on("click",function(){lang=a.selectedTrack===null?a.tracks[0].srclang:"none";a.setTrack(lang)});else{a.captionsButton.on("mouseenter focusin",function(){f(this).find(".mejs-captions-selector").css("visibility",
"visible")}).on("click","input[type=radio]",function(){lang=this.value;a.setTrack(lang)});a.captionsButton.on("mouseleave focusout",function(){f(this).find(".mejs-captions-selector").css("visibility","hidden")})}a.options.alwaysShowControls?a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover"):a.container.bind("controlsshown",function(){a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")}).bind("controlshidden",function(){e.paused||a.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")});
a.trackToLoad=-1;a.selectedTrack=null;a.isLoadingTrack=false;for(d=0;d<a.tracks.length;d++)a.tracks[d].kind=="subtitles"&&a.addTrackButton(a.tracks[d].srclang,a.tracks[d].label);a.loadNextTrack();e.addEventListener("timeupdate",function(){a.displayCaptions()},false);if(a.options.slidesSelector!==""){a.slidesContainer=f(a.options.slidesSelector);e.addEventListener("timeupdate",function(){a.displaySlides()},false)}e.addEventListener("loadedmetadata",function(){a.displayChapters()},false);a.container.hover(function(){if(a.hasChapters){a.chapters.css("visibility",
"visible");a.chapters.fadeIn(200).height(a.chapters.find(".mejs-chapter").outerHeight())}},function(){a.hasChapters&&!e.paused&&a.chapters.fadeOut(200,function(){f(this).css("visibility","hidden");f(this).css("display","block")})});a.node.getAttribute("autoplay")!==null&&a.chapters.css("visibility","hidden")}},setTrack:function(a){var b;if(a=="none"){this.selectedTrack=null;this.captionsButton.removeClass("mejs-captions-enabled")}else for(b=0;b<this.tracks.length;b++)if(this.tracks[b].srclang==a){this.selectedTrack===
null&&this.captionsButton.addClass("mejs-captions-enabled");this.selectedTrack=this.tracks[b];this.captions.attr("lang",this.selectedTrack.srclang);this.displayCaptions();break}},loadNextTrack:function(){this.trackToLoad++;if(this.trackToLoad<this.tracks.length){this.isLoadingTrack=true;this.loadTrack(this.trackToLoad)}else{this.isLoadingTrack=false;this.checkForTracks()}},loadTrack:function(a){var b=this,c=b.tracks[a];f.ajax({url:c.src,dataType:"text",success:function(e){c.entries=typeof e=="string"&&
/<tt\s+xml/ig.exec(e)?mejs.TrackFormatParser.dfxp.parse(e):mejs.TrackFormatParser.webvtt.parse(e);c.isLoaded=true;b.enableTrackButton(c.srclang,c.label);b.loadNextTrack();c.kind=="chapters"&&b.media.addEventListener("play",function(){b.media.duration>0&&b.displayChapters(c)},false);c.kind=="slides"&&b.setupSlides(c)},error:function(){b.loadNextTrack()}})},enableTrackButton:function(a,b){if(b==="")b=mejs.language.codes[a]||a;this.captionsButton.find("input[value="+a+"]").prop("disabled",false).siblings("label").html(b);
this.options.startLanguage==a&&f("#"+this.id+"_captions_"+a).prop("checked",true).trigger("click");this.adjustLanguageBox()},addTrackButton:function(a,b){if(b==="")b=mejs.language.codes[a]||a;this.captionsButton.find("ul").append(f('<li><input type="radio" name="'+this.id+'_captions" id="'+this.id+"_captions_"+a+'" value="'+a+'" disabled="disabled" /><label for="'+this.id+"_captions_"+a+'">'+b+" (loading)</label></li>"));this.adjustLanguageBox();this.container.find(".mejs-captions-translations option[value="+
a+"]").remove()},adjustLanguageBox:function(){this.captionsButton.find(".mejs-captions-selector").height(this.captionsButton.find(".mejs-captions-selector ul").outerHeight(true)+this.captionsButton.find(".mejs-captions-translations").outerHeight(true))},checkForTracks:function(){var a=false;if(this.options.hideCaptionsButtonWhenEmpty){for(i=0;i<this.tracks.length;i++)if(this.tracks[i].kind=="subtitles"){a=true;break}if(!a){this.captionsButton.hide();this.setControlsSize()}}},displayCaptions:function(){if(typeof this.tracks!=
"undefined"){var a,b=this.selectedTrack;if(b!==null&&b.isLoaded)for(a=0;a<b.entries.times.length;a++)if(this.media.currentTime>=b.entries.times[a].start&&this.media.currentTime<=b.entries.times[a].stop){this.captionsText.html(b.entries.text[a]).attr("class","mejs-captions-text "+(b.entries.times[a].identifier||""));this.captions.show().height(0);return}this.captions.hide()}},setupSlides:function(a){this.slides=a;this.slides.entries.imgs=[this.slides.entries.text.length];this.showSlide(0)},showSlide:function(a){if(!(typeof this.tracks==
"undefined"||typeof this.slidesContainer=="undefined")){var b=this,c=b.slides.entries.text[a],e=b.slides.entries.imgs[a];if(typeof e=="undefined"||typeof e.fadeIn=="undefined")b.slides.entries.imgs[a]=e=f('<img src="'+c+'">').on("load",function(){e.appendTo(b.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()});else!e.is(":visible")&&!e.is(":animated")&&e.fadeIn().siblings(":visible").fadeOut()}},displaySlides:function(){if(typeof this.slides!="undefined"){var a=this.slides,b;for(b=0;b<
a.entries.times.length;b++)if(this.media.currentTime>=a.entries.times[b].start&&this.media.currentTime<=a.entries.times[b].stop){this.showSlide(b);break}}},displayChapters:function(){var a;for(a=0;a<this.tracks.length;a++)if(this.tracks[a].kind=="chapters"&&this.tracks[a].isLoaded){this.drawChapters(this.tracks[a]);this.hasChapters=true;break}},drawChapters:function(a){var b=this,c,e,d=e=0;b.chapters.empty();for(c=0;c<a.entries.times.length;c++){e=a.entries.times[c].stop-a.entries.times[c].start;
e=Math.floor(e/b.media.duration*100);if(e+d>100||c==a.entries.times.length-1&&e+d<100)e=100-d;b.chapters.append(f('<div class="mejs-chapter" rel="'+a.entries.times[c].start+'" style="left: '+d.toString()+"%;width: "+e.toString()+'%;"><div class="mejs-chapter-block'+(c==a.entries.times.length-1?" mejs-chapter-block-last":"")+'"><span class="ch-title">'+a.entries.text[c]+'</span><span class="ch-time">'+mejs.Utility.secondsToTimeCode(a.entries.times[c].start)+"&ndash;"+mejs.Utility.secondsToTimeCode(a.entries.times[c].stop)+
"</span></div></div>"));d+=e}b.chapters.find("div.mejs-chapter").click(function(){b.media.setCurrentTime(parseFloat(f(this).attr("rel")));b.media.paused&&b.media.play()});b.chapters.show()}});mejs.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",
el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}};mejs.TrackFormatParser={webvtt:{pattern_timecode:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,
parse:function(a){var b=0;a=mejs.TrackFormatParser.split2(a,/\r?\n/);for(var c={text:[],times:[]},e,d,g;b<a.length;b++){if((e=this.pattern_timecode.exec(a[b]))&&b<a.length){if(b-1>=0&&a[b-1]!=="")g=a[b-1];b++;d=a[b];for(b++;a[b]!==""&&b<a.length;){d=d+"\n"+a[b];b++}d=f.trim(d).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");c.text.push(d);c.times.push({identifier:g,start:mejs.Utility.convertSMPTEtoSeconds(e[1])===0?0.2:mejs.Utility.convertSMPTEtoSeconds(e[1]),
stop:mejs.Utility.convertSMPTEtoSeconds(e[3]),settings:e[5]})}g=""}return c}},dfxp:{parse:function(a){a=f(a).filter("tt");var b=0;b=a.children("div").eq(0);var c=b.find("p");b=a.find("#"+b.attr("style"));var e,d;a={text:[],times:[]};if(b.length){d=b.removeAttr("id").get(0).attributes;if(d.length){e={};for(b=0;b<d.length;b++)e[d[b].name.split(":")[1]]=d[b].value}}for(b=0;b<c.length;b++){var g;d={start:null,stop:null,style:null};if(c.eq(b).attr("begin"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("begin"));
if(!d.start&&c.eq(b-1).attr("end"))d.start=mejs.Utility.convertSMPTEtoSeconds(c.eq(b-1).attr("end"));if(c.eq(b).attr("end"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("end"));if(!d.stop&&c.eq(b+1).attr("begin"))d.stop=mejs.Utility.convertSMPTEtoSeconds(c.eq(b+1).attr("begin"));if(e){g="";for(var k in e)g+=k+":"+e[k]+";"}if(g)d.style=g;if(d.start===0)d.start=0.2;a.times.push(d);d=f.trim(c.eq(b).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,
"<a href='$1' target='_blank'>$1</a>");a.text.push(d);if(a.times.start===0)a.times.start=2}return a}},split2:function(a,b){return a.split(b)}};if("x\n\ny".split(/\n/gi).length!=3)mejs.TrackFormatParser.split2=function(a,b){var c=[],e="",d;for(d=0;d<a.length;d++){e+=a.substring(d,d+1);if(b.test(e)){c.push(e.replace(b,""));e=""}}c.push(e);return c}})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{contextMenuItems:[{render:function(a){if(typeof a.enterFullScreen=="undefined")return null;return a.isFullScreen?mejs.i18n.t("Turn off Fullscreen"):mejs.i18n.t("Go Fullscreen")},click:function(a){a.isFullScreen?a.exitFullScreen():a.enterFullScreen()}},{render:function(a){return a.media.muted?mejs.i18n.t("Unmute"):mejs.i18n.t("Mute")},click:function(a){a.media.muted?a.setMuted(false):a.setMuted(true)}},{isSeparator:true},{render:function(){return mejs.i18n.t("Download Video")},
click:function(a){window.location.href=a.media.currentSrc}}]});f.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(a){a.contextMenu=f('<div class="mejs-contextmenu"></div>').appendTo(f("body")).hide();a.container.bind("contextmenu",function(b){if(a.isContextMenuEnabled){b.preventDefault();a.renderContextMenu(b.clientX-1,b.clientY-1);return false}});a.container.bind("click",function(){a.contextMenu.hide()});a.contextMenu.bind("mouseleave",function(){a.startContextMenuTimer()})},cleancontextmenu:function(a){a.contextMenu.remove()},
isContextMenuEnabled:true,enableContextMenu:function(){this.isContextMenuEnabled=true},disableContextMenu:function(){this.isContextMenuEnabled=false},contextMenuTimeout:null,startContextMenuTimer:function(){var a=this;a.killContextMenuTimer();a.contextMenuTimer=setTimeout(function(){a.hideContextMenu();a.killContextMenuTimer()},750)},killContextMenuTimer:function(){var a=this.contextMenuTimer;if(a!=null){clearTimeout(a);delete a}},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(a,
b){for(var c=this,e="",d=c.options.contextMenuItems,g=0,k=d.length;g<k;g++)if(d[g].isSeparator)e+='<div class="mejs-contextmenu-separator"></div>';else{var j=d[g].render(c);if(j!=null)e+='<div class="mejs-contextmenu-item" data-itemindex="'+g+'" id="element-'+Math.random()*1E6+'">'+j+"</div>"}c.contextMenu.empty().append(f(e)).css({top:b,left:a}).show();c.contextMenu.find(".mejs-contextmenu-item").each(function(){var m=f(this),q=parseInt(m.data("itemindex"),10),p=c.options.contextMenuItems[q];typeof p.show!=
"undefined"&&p.show(m,c);m.click(function(){typeof p.click!="undefined"&&p.click(c);c.contextMenu.hide()})});setTimeout(function(){c.killControlsTimer("rev3")},100)}})})(mejs.$);
(function(f){f.extend(mejs.MepDefaults,{postrollCloseText:mejs.i18n.t("Close")});f.extend(MediaElementPlayer.prototype,{buildpostroll:function(a,b,c){var e=this.container.find('link[rel="postroll"]').attr("href");if(typeof e!=="undefined"){a.postroll=f('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+this.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(c).hide();this.media.addEventListener("ended",
function(){f.ajax({dataType:"html",url:e,success:function(d){c.find(".mejs-postroll-layer-content").html(d)}});a.postroll.show()},false)}}})})(mejs.$);


/**
 * Copyright (c) 2007 Ariel Flesler - aflesler â—‹ gmail â€¢ com | https://github.com/flesler
 * Licensed under MIT
 * @author Ariel Flesler
 * @version 2.1.2
 */
;(function(f){"use strict";"function"===typeof define&&define.amd?define(["jquery"],f):"undefined"!==typeof module&&module.exports?module.exports=f(require("jquery")):f(jQuery)})(function($){"use strict";function n(a){return!a.nodeName||-1!==$.inArray(a.nodeName.toLowerCase(),["iframe","#document","html","body"])}function h(a){return $.isFunction(a)||$.isPlainObject(a)?a:{top:a,left:a}}var p=$.scrollTo=function(a,d,b){return $(window).scrollTo(a,d,b)};p.defaults={axis:"xy",duration:0,limit:!0};$.fn.scrollTo=function(a,d,b){"object"=== typeof d&&(b=d,d=0);"function"===typeof b&&(b={onAfter:b});"max"===a&&(a=9E9);b=$.extend({},p.defaults,b);d=d||b.duration;var u=b.queue&&1<b.axis.length;u&&(d/=2);b.offset=h(b.offset);b.over=h(b.over);return this.each(function(){function k(a){var k=$.extend({},b,{queue:!0,duration:d,complete:a&&function(){a.call(q,e,b)}});r.animate(f,k)}if(null!==a){var l=n(this),q=l?this.contentWindow||window:this,r=$(q),e=a,f={},t;switch(typeof e){case "number":case "string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(e)){e= h(e);break}e=l?$(e):$(e,q);case "object":if(e.length===0)return;if(e.is||e.style)t=(e=$(e)).offset()}var v=$.isFunction(b.offset)&&b.offset(q,e)||b.offset;$.each(b.axis.split(""),function(a,c){var d="x"===c?"Left":"Top",m=d.toLowerCase(),g="scroll"+d,h=r[g](),n=p.max(q,c);t?(f[g]=t[m]+(l?0:h-r.offset()[m]),b.margin&&(f[g]-=parseInt(e.css("margin"+d),10)||0,f[g]-=parseInt(e.css("border"+d+"Width"),10)||0),f[g]+=v[m]||0,b.over[m]&&(f[g]+=e["x"===c?"width":"height"]()*b.over[m])):(d=e[m],f[g]=d.slice&& "%"===d.slice(-1)?parseFloat(d)/100*n:d);b.limit&&/^\d+$/.test(f[g])&&(f[g]=0>=f[g]?0:Math.min(f[g],n));!a&&1<b.axis.length&&(h===f[g]?f={}:u&&(k(b.onAfterFirst),f={}))});k(b.onAfter)}})};p.max=function(a,d){var b="x"===d?"Width":"Height",h="scroll"+b;if(!n(a))return a[h]-$(a)[b.toLowerCase()]();var b="client"+b,k=a.ownerDocument||a.document,l=k.documentElement,k=k.body;return Math.max(l[h],k[h])-Math.min(l[b],k[b])};$.Tween.propHooks.scrollLeft=$.Tween.propHooks.scrollTop={get:function(a){return $(a.elem)[a.prop]()}, set:function(a){var d=this.get(a);if(a.options.interrupt&&a._last&&a._last!==d)return $(a.elem).stop();var b=Math.round(a.now);d!==b&&($(a.elem)[a.prop](b),a._last=this.get(a))}};return p});


/* @license 
 * jQuery.print, version 1.5.1
 *  (c) Sathvik Ponangi, Doers' Guild
 * Licence: CC-By (http://creativecommons.org/licenses/by/3.0/)
 *--------------------------------------------------------------------------*/
!function(a){"use strict";function b(b){var c=a("");try{c=a(b).clone()}catch(d){c=a("<span />").html(b)}return c}function c(b,c,d){var e=a.Deferred();try{b=b.contentWindow||b.contentDocument||b;var f=b.document||b.contentDocument||b;d.doctype&&f.write(d.doctype),f.write(c),f.close();var g=!1,h=function(){if(!g){b.focus();try{b.document.execCommand("print",!1,null)||b.print(),a("body").focus()}catch(a){b.print()}b.close(),g=!0,e.resolve()}};a(b).on("load",h),setTimeout(h,d.timeout)}catch(a){e.reject(a)}return e}function d(b,d){var f=a(d.iframe+""),g=f.length;return 0===g&&(f=a('<iframe height="0" width="0" border="0" wmode="Opaque"/>').prependTo("body").css({position:"absolute",top:-999,left:-999})),c(f.get(0),b,d).done(function(){setTimeout(function(){0===g&&f.remove()},1e3)}).fail(function(a){console.error("Failed to print from iframe",a),e(b,d)}).always(function(){try{d.deferred.resolve()}catch(a){console.warn("Error notifying deferred",a)}})}function e(a,b){return c(window.open(),a,b).always(function(){try{b.deferred.resolve()}catch(a){console.warn("Error notifying deferred",a)}})}function f(a){return!!("object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName)}a.print=a.fn.print=function(){var c,g,h=this;h instanceof a&&(h=h.get(0)),f(h)?(g=a(h),arguments.length>0&&(c=arguments[0])):arguments.length>0?(g=a(arguments[0]),f(g[0])?arguments.length>1&&(c=arguments[1]):(c=arguments[0],g=a("html"))):g=a("html");var i={globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:null,prepend:null,manuallyCopyFormValues:!0,deferred:a.Deferred(),timeout:750,title:null,doctype:"<!doctype html>"};c=a.extend({},i,c||{});var j=a("");c.globalStyles?j=a("style, link, meta, base, title"):c.mediaPrint&&(j=a("link[media=print]")),c.stylesheet&&(j=a.merge(j,a('<link rel="stylesheet" href="'+c.stylesheet+'">')));var k=g.clone();if(k=a("<span/>").append(k),k.find(c.noPrintSelector).remove(),k.append(j.clone()),c.title){var l=a("title",k);0===l.length&&(l=a("<title />"),k.append(l)),l.text(c.title)}k.append(b(c.append)),k.prepend(b(c.prepend)),c.manuallyCopyFormValues&&(k.find("input").each(function(){var b=a(this);b.is("[type='radio']")||b.is("[type='checkbox']")?b.prop("checked")&&b.attr("checked","checked"):b.attr("value",b.val())}),k.find("select").each(function(){a(this).find(":selected").attr("selected","selected")}),k.find("textarea").each(function(){var b=a(this);b.text(b.val())}));var m=k.html();try{c.deferred.notify("generated_markup",m,k)}catch(a){console.warn("Error notifying deferred",a)}if(k.remove(),c.iframe)try{d(m,c)}catch(a){console.error("Failed to print from iframe",a.stack,a.message),e(m,c)}else e(m,c);return this}}(jQuery);





// jQuery Mask Plugin v1.14.15
// github.com/igorescobar/jQuery-Mask-Plugin
var $jscomp={scope:{},findInternal:function(a,l,d){a instanceof String&&(a=String(a));for(var p=a.length,h=0;h<p;h++){var b=a[h];if(l.call(d,b,h,a))return{i:h,v:b}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,l,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[l]=d.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,l,d,p){if(l){d=$jscomp.global;a=a.split(".");for(p=0;p<a.length-1;p++){var h=a[p];h in d||(d[h]={});d=d[h]}a=a[a.length-1];p=d[a];l=l(p);l!=p&&null!=l&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");
(function(a,l,d){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?module.exports=a(require("jquery")):a(l||d)})(function(a){var l=function(b,e,f){var c={invalid:[],getCaret:function(){try{var a,r=0,g=b.get(0),e=document.selection,f=g.selectionStart;if(e&&-1===navigator.appVersion.indexOf("MSIE 10"))a=e.createRange(),a.moveStart("character",-c.val().length),r=a.text.length;else if(f||"0"===f)r=f;return r}catch(C){}},setCaret:function(a){try{if(b.is(":focus")){var c,
g=b.get(0);g.setSelectionRange?g.setSelectionRange(a,a):(c=g.createTextRange(),c.collapse(!0),c.moveEnd("character",a),c.moveStart("character",a),c.select())}}catch(B){}},events:function(){b.on("keydown.mask",function(a){b.data("mask-keycode",a.keyCode||a.which);b.data("mask-previus-value",b.val());b.data("mask-previus-caret-pos",c.getCaret());c.maskDigitPosMapOld=c.maskDigitPosMap}).on(a.jMaskGlobals.useInput?"input.mask":"keyup.mask",c.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){b.keydown().keyup()},
100)}).on("change.mask",function(){b.data("changed",!0)}).on("blur.mask",function(){d===c.val()||b.data("changed")||b.trigger("change");b.data("changed",!1)}).on("blur.mask",function(){d=c.val()}).on("focus.mask",function(b){!0===f.selectOnFocus&&a(b.target).select()}).on("focusout.mask",function(){f.clearIfNotMatch&&!h.test(c.val())&&c.val("")})},getRegexMask:function(){for(var a=[],b,c,f,n,d=0;d<e.length;d++)(b=m.translation[e.charAt(d)])?(c=b.pattern.toString().replace(/.{1}$|^.{1}/g,""),f=b.optional,
(b=b.recursive)?(a.push(e.charAt(d)),n={digit:e.charAt(d),pattern:c}):a.push(f||b?c+"?":c)):a.push(e.charAt(d).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));a=a.join("");n&&(a=a.replace(new RegExp("("+n.digit+"(.*"+n.digit+")?)"),"($1)?").replace(new RegExp(n.digit,"g"),n.pattern));return new RegExp(a)},destroyEvents:function(){b.off("input keydown keyup paste drop blur focusout ".split(" ").join(".mask "))},val:function(a){var c=b.is("input")?"val":"text";if(0<arguments.length){if(b[c]()!==a)b[c](a);
c=b}else c=b[c]();return c},calculateCaretPosition:function(){var a=b.data("mask-previus-value")||"",e=c.getMasked(),g=c.getCaret();if(a!==e){var f=b.data("mask-previus-caret-pos")||0,e=e.length,d=a.length,m=a=0,h=0,l=0,k;for(k=g;k<e&&c.maskDigitPosMap[k];k++)m++;for(k=g-1;0<=k&&c.maskDigitPosMap[k];k--)a++;for(k=g-1;0<=k;k--)c.maskDigitPosMap[k]&&h++;for(k=f-1;0<=k;k--)c.maskDigitPosMapOld[k]&&l++;g>d?g=10*e:f>=g&&f!==d?c.maskDigitPosMapOld[g]||(f=g,g=g-(l-h)-a,c.maskDigitPosMap[g]&&(g=f)):g>f&&
(g=g+(h-l)+m)}return g},behaviour:function(f){f=f||window.event;c.invalid=[];var e=b.data("mask-keycode");if(-1===a.inArray(e,m.byPassKeys)){var e=c.getMasked(),g=c.getCaret();setTimeout(function(){c.setCaret(c.calculateCaretPosition())},a.jMaskGlobals.keyStrokeCompensation);c.val(e);c.setCaret(g);return c.callbacks(f)}},getMasked:function(a,b){var g=[],d=void 0===b?c.val():b+"",n=0,h=e.length,q=0,l=d.length,k=1,r="push",p=-1,t=0,y=[],v,z;f.reverse?(r="unshift",k=-1,v=0,n=h-1,q=l-1,z=function(){return-1<
n&&-1<q}):(v=h-1,z=function(){return n<h&&q<l});for(var A;z();){var x=e.charAt(n),w=d.charAt(q),u=m.translation[x];if(u)w.match(u.pattern)?(g[r](w),u.recursive&&(-1===p?p=n:n===v&&n!==p&&(n=p-k),v===p&&(n-=k)),n+=k):w===A?(t--,A=void 0):u.optional?(n+=k,q-=k):u.fallback?(g[r](u.fallback),n+=k,q-=k):c.invalid.push({p:q,v:w,e:u.pattern}),q+=k;else{if(!a)g[r](x);w===x?(y.push(q),q+=k):(A=x,y.push(q+t),t++);n+=k}}d=e.charAt(v);h!==l+1||m.translation[d]||g.push(d);g=g.join("");c.mapMaskdigitPositions(g,
y,l);return g},mapMaskdigitPositions:function(a,b,e){a=f.reverse?a.length-e:0;c.maskDigitPosMap={};for(e=0;e<b.length;e++)c.maskDigitPosMap[b[e]+a]=1},callbacks:function(a){var h=c.val(),g=h!==d,m=[h,a,b,f],q=function(a,b,c){"function"===typeof f[a]&&b&&f[a].apply(this,c)};q("onChange",!0===g,m);q("onKeyPress",!0===g,m);q("onComplete",h.length===e.length,m);q("onInvalid",0<c.invalid.length,[h,a,b,c.invalid,f])}};b=a(b);var m=this,d=c.val(),h;e="function"===typeof e?e(c.val(),void 0,b,f):e;m.mask=
e;m.options=f;m.remove=function(){var a=c.getCaret();m.options.placeholder&&b.removeAttr("placeholder");b.data("mask-maxlength")&&b.removeAttr("maxlength");c.destroyEvents();c.val(m.getCleanVal());c.setCaret(a);return b};m.getCleanVal=function(){return c.getMasked(!0)};m.getMaskedVal=function(a){return c.getMasked(!1,a)};m.init=function(d){d=d||!1;f=f||{};m.clearIfNotMatch=a.jMaskGlobals.clearIfNotMatch;m.byPassKeys=a.jMaskGlobals.byPassKeys;m.translation=a.extend({},a.jMaskGlobals.translation,f.translation);
m=a.extend(!0,{},m,f);h=c.getRegexMask();if(d)c.events(),c.val(c.getMasked());else{f.placeholder&&b.attr("placeholder",f.placeholder);b.data("mask")&&b.attr("autocomplete","off");d=0;for(var l=!0;d<e.length;d++){var g=m.translation[e.charAt(d)];if(g&&g.recursive){l=!1;break}}l&&b.attr("maxlength",e.length).data("mask-maxlength",!0);c.destroyEvents();c.events();d=c.getCaret();c.val(c.getMasked());c.setCaret(d)}};m.init(!b.is("input"))};a.maskWatchers={};var d=function(){var b=a(this),e={},f=b.attr("data-mask");
b.attr("data-mask-reverse")&&(e.reverse=!0);b.attr("data-mask-clearifnotmatch")&&(e.clearIfNotMatch=!0);"true"===b.attr("data-mask-selectonfocus")&&(e.selectOnFocus=!0);if(p(b,f,e))return b.data("mask",new l(this,f,e))},p=function(b,e,f){f=f||{};var c=a(b).data("mask"),d=JSON.stringify;b=a(b).val()||a(b).text();try{return"function"===typeof e&&(e=e(b)),"object"!==typeof c||d(c.options)!==d(f)||c.mask!==e}catch(t){}},h=function(a){var b=document.createElement("div"),d;a="on"+a;d=a in b;d||(b.setAttribute(a,
"return;"),d="function"===typeof b[a]);return d};a.fn.mask=function(b,d){d=d||{};var e=this.selector,c=a.jMaskGlobals,h=c.watchInterval,c=d.watchInputs||c.watchInputs,t=function(){if(p(this,b,d))return a(this).data("mask",new l(this,b,d))};a(this).each(t);e&&""!==e&&c&&(clearInterval(a.maskWatchers[e]),a.maskWatchers[e]=setInterval(function(){a(document).find(e).each(t)},h));return this};a.fn.masked=function(a){return this.data("mask").getMaskedVal(a)};a.fn.unmask=function(){clearInterval(a.maskWatchers[this.selector]);
delete a.maskWatchers[this.selector];return this.each(function(){var b=a(this).data("mask");b&&b.remove().removeData("mask")})};a.fn.cleanVal=function(){return this.data("mask").getCleanVal()};a.applyDataMask=function(b){b=b||a.jMaskGlobals.maskElements;(b instanceof a?b:a(b)).filter(a.jMaskGlobals.dataMaskAttr).each(d)};h={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&
h("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};a.jMaskGlobals=a.jMaskGlobals||{};h=a.jMaskGlobals=a.extend(!0,{},h,a.jMaskGlobals);h.dataMask&&a.applyDataMask();setInterval(function(){a.jMaskGlobals.watchDataMask&&a.applyDataMask()},h.watchInterval)},window.jQuery,window.Zepto);


// jQuery autoComplete v1.0.7
// https://github.com/Pixabay/jQuery-autoComplete
!function(e){e.fn.autoComplete=function(t){var o=e.extend({},e.fn.autoComplete.defaults,t);return"string"==typeof t?(this.each(function(){var o=e(this);"destroy"==t&&(e(window).off("resize.autocomplete",o.updateSC),o.off("blur.autocomplete focus.autocomplete keydown.autocomplete keyup.autocomplete"),o.data("autocomplete")?o.attr("autocomplete",o.data("autocomplete")):o.removeAttr("autocomplete"),e(o.data("sc")).remove(),o.removeData("sc").removeData("autocomplete"))}),this):this.each(function(){function t(e){var t=s.val();if(s.cache[t]=e,e.length&&t.length>=o.minChars){for(var a="",c=0;c<e.length;c++)a+=o.renderItem(e[c],t);s.sc.html(a),s.updateSC(0)}else s.sc.hide()}var s=e(this);s.sc=e('<div class="autocomplete-suggestions '+o.menuClass+'"></div>'),s.data("sc",s.sc).data("autocomplete",s.attr("autocomplete")),s.attr("autocomplete","off"),s.cache={},s.last_val="",s.updateSC=function(t,o){if(s.sc.css({top:s.offset().top+s.outerHeight(),left:s.offset().left,width:s.outerWidth()}),!t&&(s.sc.show(),s.sc.maxHeight||(s.sc.maxHeight=parseInt(s.sc.css("max-height"))),s.sc.suggestionHeight||(s.sc.suggestionHeight=e(".autocomplete-suggestion",s.sc).first().outerHeight()),s.sc.suggestionHeight))if(o){var a=s.sc.scrollTop(),c=o.offset().top-s.sc.offset().top;c+s.sc.suggestionHeight-s.sc.maxHeight>0?s.sc.scrollTop(c+s.sc.suggestionHeight+a-s.sc.maxHeight):0>c&&s.sc.scrollTop(c+a)}else s.sc.scrollTop(0)},e(window).on("resize.autocomplete",s.updateSC),s.sc.appendTo("body"),s.sc.on("mouseleave",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected")}),s.sc.on("mouseenter",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected"),e(this).addClass("selected")}),s.sc.on("mousedown click",".autocomplete-suggestion",function(t){var a=e(this),c=a.data("val");return(c||a.hasClass("autocomplete-suggestion"))&&(s.val(c),o.onSelect(t,c,a),s.sc.hide()),!1}),s.on("blur.autocomplete",function(){try{over_sb=e(".autocomplete-suggestions:hover").length}catch(t){over_sb=0}over_sb?s.is(":focus")||setTimeout(function(){s.focus()},20):(s.last_val=s.val(),s.sc.hide(),setTimeout(function(){s.sc.hide()},350))}),o.minChars||s.on("focus.autocomplete",function(){s.last_val="\n",s.trigger("keyup.autocomplete")}),s.on("keydown.autocomplete",function(t){if((40==t.which||38==t.which)&&s.sc.html()){var a,c=e(".autocomplete-suggestion.selected",s.sc);return c.length?(a=40==t.which?c.next(".autocomplete-suggestion"):c.prev(".autocomplete-suggestion"),a.length?(c.removeClass("selected"),s.val(a.addClass("selected").data("val"))):(c.removeClass("selected"),s.val(s.last_val),a=0)):(a=40==t.which?e(".autocomplete-suggestion",s.sc).first():e(".autocomplete-suggestion",s.sc).last(),s.val(a.addClass("selected").data("val"))),s.updateSC(0,a),!1}if(27==t.which)s.val(s.last_val).sc.hide();else if(13==t.which||9==t.which){var c=e(".autocomplete-suggestion.selected",s.sc);c.length&&s.sc.is(":visible")&&(o.onSelect(t,c.data("val"),c),setTimeout(function(){s.sc.hide()},20))}}),s.on("keyup.autocomplete",function(a){if(!~e.inArray(a.which,[13,27,35,36,37,38,39,40])){var c=s.val();if(c.length>=o.minChars){if(c!=s.last_val){if(s.last_val=c,clearTimeout(s.timer),o.cache){if(c in s.cache)return void t(s.cache[c]);for(var l=1;l<c.length-o.minChars;l++){var i=c.slice(0,c.length-l);if(i in s.cache&&!s.cache[i].length)return void t([])}}s.timer=setTimeout(function(){o.source(c,t)},o.delay)}}else s.last_val=c,s.sc.hide()}})})},e.fn.autoComplete.defaults={source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(e,t,o){}}}(jQuery);
/*!
* MediaElement.js
* HTML5 <video> and <audio> shim and player
* http://mediaelementjs.com/
*
* Creates a JavaScript object that mimics HTML5 MediaElement API
* for browsers that don't understand HTML5 or can't play the provided codec
* Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
*
* Copyright 2010-2014, John Dyer (http://j.hn)
* License: MIT
*
*/
// Namespace
var mejs = mejs || {};

// version number
mejs.version = '2.15.1'; 


// player number (for missing, same id attr)
mejs.meIndex = 0;

// media types accepted by plugins
mejs.plugins = {
	silverlight: [
		{version: [3,0], types: ['video/mp4','video/m4v','video/mov','video/wmv','audio/wma','audio/m4a','audio/mp3','audio/wav','audio/mpeg']}
	],
	flash: [
		{version: [9,0,124], types: ['video/mp4','video/m4v','video/mov','video/flv','video/rtmp','video/x-flv','audio/flv','audio/x-flv','audio/mp3','audio/m4a','audio/mpeg', 'video/youtube', 'video/x-youtube', 'application/x-mpegURL']}
		//,{version: [12,0], types: ['video/webm']} // for future reference (hopefully!)
	],
	youtube: [
		{version: null, types: ['video/youtube', 'video/x-youtube', 'audio/youtube', 'audio/x-youtube']}
	],
	vimeo: [
		{version: null, types: ['video/vimeo', 'video/x-vimeo']}
	]
};

/*
Utility methods
*/
mejs.Utility = {
	encodeUrl: function(url) {
		return encodeURIComponent(url); //.replace(/\?/gi,'%3F').replace(/=/gi,'%3D').replace(/&/gi,'%26');
	},
	escapeHTML: function(s) {
		return s.toString().split('&').join('&amp;').split('<').join('&lt;').split('"').join('&quot;');
	},
	absolutizeUrl: function(url) {
		var el = document.createElement('div');
		el.innerHTML = '<a href="' + this.escapeHTML(url) + '">x</a>';
		return el.firstChild.href;
	},
	getScriptPath: function(scriptNames) {
		var
			i = 0,
			j,
			codePath = '',
			testname = '',
			slashPos,
			filenamePos,
			scriptUrl,
			scriptPath,			
			scriptFilename,
			scripts = document.getElementsByTagName('script'),
			il = scripts.length,
			jl = scriptNames.length;
			
		// go through all <script> tags
		for (; i < il; i++) {
			scriptUrl = scripts[i].src;
			slashPos = scriptUrl.lastIndexOf('/');
			if (slashPos > -1) {
				scriptFilename = scriptUrl.substring(slashPos + 1);
				scriptPath = scriptUrl.substring(0, slashPos + 1);
			} else {
				scriptFilename = scriptUrl;
				scriptPath = '';			
			}
			
			// see if any <script> tags have a file name that matches the 
			for (j = 0; j < jl; j++) {
				testname = scriptNames[j];
				filenamePos = scriptFilename.indexOf(testname);
				if (filenamePos > -1) {
					codePath = scriptPath;
					break;
				}
			}
			
			// if we found a path, then break and return it
			if (codePath !== '') {
				break;
			}
		}
		
		// send the best path back
		return codePath;
	},
	secondsToTimeCode: function(time, forceHours, showFrameCount, fps) {
		//add framecount
		if (typeof showFrameCount == 'undefined') {
		    showFrameCount=false;
		} else if(typeof fps == 'undefined') {
		    fps = 25;
		}
	
		var hours = Math.floor(time / 3600) % 24,
			minutes = Math.floor(time / 60) % 60,
			seconds = Math.floor(time % 60),
			frames = Math.floor(((time % 1)*fps).toFixed(3)),
			result = 
					( (forceHours || hours > 0) ? (hours < 10 ? '0' + hours : hours) + ':' : '')
						+ (minutes < 10 ? '0' + minutes : minutes) + ':'
						+ (seconds < 10 ? '0' + seconds : seconds)
						+ ((showFrameCount) ? ':' + (frames < 10 ? '0' + frames : frames) : '');
	
		return result;
	},
	
	timeCodeToSeconds: function(hh_mm_ss_ff, forceHours, showFrameCount, fps){
		if (typeof showFrameCount == 'undefined') {
		    showFrameCount=false;
		} else if(typeof fps == 'undefined') {
		    fps = 25;
		}
	
		var tc_array = hh_mm_ss_ff.split(":"),
			tc_hh = parseInt(tc_array[0], 10),
			tc_mm = parseInt(tc_array[1], 10),
			tc_ss = parseInt(tc_array[2], 10),
			tc_ff = 0,
			tc_in_seconds = 0;
		
		if (showFrameCount) {
		    tc_ff = parseInt(tc_array[3])/fps;
		}
		
		tc_in_seconds = ( tc_hh * 3600 ) + ( tc_mm * 60 ) + tc_ss + tc_ff;
		
		return tc_in_seconds;
	},
	

	convertSMPTEtoSeconds: function (SMPTE) {
		if (typeof SMPTE != 'string') 
			return false;

		SMPTE = SMPTE.replace(',', '.');
		
		var secs = 0,
			decimalLen = (SMPTE.indexOf('.') != -1) ? SMPTE.split('.')[1].length : 0,
			multiplier = 1;
		
		SMPTE = SMPTE.split(':').reverse();
		
		for (var i = 0; i < SMPTE.length; i++) {
			multiplier = 1;
			if (i > 0) {
				multiplier = Math.pow(60, i); 
			}
			secs += Number(SMPTE[i]) * multiplier;
		}
		return Number(secs.toFixed(decimalLen));
	},	
	
	/* borrowed from SWFObject: http://code.google.com/p/swfobject/source/browse/trunk/swfobject/src/swfobject.js#474 */
	removeSwf: function(id) {
		var obj = document.getElementById(id);
		if (obj && /object|embed/i.test(obj.nodeName)) {
			if (mejs.MediaFeatures.isIE) {
				obj.style.display = "none";
				(function(){
					if (obj.readyState == 4) {
						mejs.Utility.removeObjectInIE(id);
					} else {
						setTimeout(arguments.callee, 10);
					}
				})();
			} else {
				obj.parentNode.removeChild(obj);
			}
		}
	},
	removeObjectInIE: function(id) {
		var obj = document.getElementById(id);
		if (obj) {
			for (var i in obj) {
				if (typeof obj[i] == "function") {
					obj[i] = null;
				}
			}
			obj.parentNode.removeChild(obj);
		}		
	}
};


// Core detector, plugins are added below
mejs.PluginDetector = {

	// main public function to test a plug version number PluginDetector.hasPluginVersion('flash',[9,0,125]);
	hasPluginVersion: function(plugin, v) {
		var pv = this.plugins[plugin];
		v[1] = v[1] || 0;
		v[2] = v[2] || 0;
		return (pv[0] > v[0] || (pv[0] == v[0] && pv[1] > v[1]) || (pv[0] == v[0] && pv[1] == v[1] && pv[2] >= v[2])) ? true : false;
	},

	// cached values
	nav: window.navigator,
	ua: window.navigator.userAgent.toLowerCase(),

	// stored version numbers
	plugins: [],

	// runs detectPlugin() and stores the version number
	addPlugin: function(p, pluginName, mimeType, activeX, axDetect) {
		this.plugins[p] = this.detectPlugin(pluginName, mimeType, activeX, axDetect);
	},

	// get the version number from the mimetype (all but IE) or ActiveX (IE)
	detectPlugin: function(pluginName, mimeType, activeX, axDetect) {

		var version = [0,0,0],
			description,
			i,
			ax;

		// Firefox, Webkit, Opera
		if (typeof(this.nav.plugins) != 'undefined' && typeof this.nav.plugins[pluginName] == 'object') {
			description = this.nav.plugins[pluginName].description;
			if (description && !(typeof this.nav.mimeTypes != 'undefined' && this.nav.mimeTypes[mimeType] && !this.nav.mimeTypes[mimeType].enabledPlugin)) {
				version = description.replace(pluginName, '').replace(/^\s+/,'').replace(/\sr/gi,'.').split('.');
				for (i=0; i<version.length; i++) {
					version[i] = parseInt(version[i].match(/\d+/), 10);
				}
			}
		// Internet Explorer / ActiveX
		} else if (typeof(window.ActiveXObject) != 'undefined') {
			try {
				ax = new ActiveXObject(activeX);
				if (ax) {
					version = axDetect(ax);
				}
			}
			catch (e) { }
		}
		return version;
	}
};

// Add Flash detection
mejs.PluginDetector.addPlugin('flash','Shockwave Flash','application/x-shockwave-flash','ShockwaveFlash.ShockwaveFlash', function(ax) {
	// adapted from SWFObject
	var version = [],
		d = ax.GetVariable("$version");
	if (d) {
		d = d.split(" ")[1].split(",");
		version = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];
	}
	return version;
});

// Add Silverlight detection
mejs.PluginDetector.addPlugin('silverlight','Silverlight Plug-In','application/x-silverlight-2','AgControl.AgControl', function (ax) {
	// Silverlight cannot report its version number to IE
	// but it does have a isVersionSupported function, so we have to loop through it to get a version number.
	// adapted from http://www.silverlightversion.com/
	var v = [0,0,0,0],
		loopMatch = function(ax, v, i, n) {
			while(ax.isVersionSupported(v[0]+ "."+ v[1] + "." + v[2] + "." + v[3])){
				v[i]+=n;
			}
			v[i] -= n;
		};
	loopMatch(ax, v, 0, 1);
	loopMatch(ax, v, 1, 1);
	loopMatch(ax, v, 2, 10000); // the third place in the version number is usually 5 digits (4.0.xxxxx)
	loopMatch(ax, v, 2, 1000);
	loopMatch(ax, v, 2, 100);
	loopMatch(ax, v, 2, 10);
	loopMatch(ax, v, 2, 1);
	loopMatch(ax, v, 3, 1);

	return v;
});
// add adobe acrobat
/*
PluginDetector.addPlugin('acrobat','Adobe Acrobat','application/pdf','AcroPDF.PDF', function (ax) {
	var version = [],
		d = ax.GetVersions().split(',')[0].split('=')[1].split('.');

	if (d) {
		version = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];
	}
	return version;
});
*/
// necessary detection (fixes for <IE9)
mejs.MediaFeatures = {
	init: function() {
		var
			t = this,
			d = document,
			nav = mejs.PluginDetector.nav,
			ua = mejs.PluginDetector.ua.toLowerCase(),
			i,
			v,
			html5Elements = ['source','track','audio','video'];

		// detect browsers (only the ones that have some kind of quirk we need to work around)
		t.isiPad = (ua.match(/ipad/i) !== null);
		t.isiPhone = (ua.match(/iphone/i) !== null);
		t.isiOS = t.isiPhone || t.isiPad;
		t.isAndroid = (ua.match(/android/i) !== null);
		t.isBustedAndroid = (ua.match(/android 2\.[12]/) !== null);
		t.isBustedNativeHTTPS = (location.protocol === 'https:' && (ua.match(/android [12]\./) !== null || ua.match(/macintosh.* version.* safari/) !== null));
		t.isIE = (nav.appName.toLowerCase().indexOf("microsoft") != -1 || nav.appName.toLowerCase().match(/trident/gi) !== null);
		t.isChrome = (ua.match(/chrome/gi) !== null);
		t.isChromium = (ua.match(/chromium/gi) !== null);
		t.isFirefox = (ua.match(/firefox/gi) !== null);
		t.isWebkit = (ua.match(/webkit/gi) !== null);
		t.isGecko = (ua.match(/gecko/gi) !== null) && !t.isWebkit && !t.isIE;
		t.isOpera = (ua.match(/opera/gi) !== null);
		t.hasTouch = ('ontouchstart' in window); //  && window.ontouchstart != null); // this breaks iOS 7
		
		// borrowed from Modernizr
		t.svg = !! document.createElementNS &&
				!! document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect;

		// create HTML5 media elements for IE before 9, get a <video> element for fullscreen detection
		for (i=0; i<html5Elements.length; i++) {
			v = document.createElement(html5Elements[i]);
		}
		
		t.supportsMediaTag = (typeof v.canPlayType !== 'undefined' || t.isBustedAndroid);

		// Fix for IE9 on Windows 7N / Windows 7KN (Media Player not installer)
		try{
			v.canPlayType("video/mp4");
		}catch(e){
			t.supportsMediaTag = false;
		}

		// detect native JavaScript fullscreen (Safari/Firefox only, Chrome still fails)
		
		// iOS
		t.hasSemiNativeFullScreen = (typeof v.webkitEnterFullscreen !== 'undefined');
		
		// W3C
		t.hasNativeFullscreen = (typeof v.requestFullscreen !== 'undefined');
		
		// webkit/firefox/IE11+
		t.hasWebkitNativeFullScreen = (typeof v.webkitRequestFullScreen !== 'undefined');
		t.hasMozNativeFullScreen = (typeof v.mozRequestFullScreen !== 'undefined');
		t.hasMsNativeFullScreen = (typeof v.msRequestFullscreen !== 'undefined');
		
		t.hasTrueNativeFullScreen = (t.hasWebkitNativeFullScreen || t.hasMozNativeFullScreen || t.hasMsNativeFullScreen);
		t.nativeFullScreenEnabled = t.hasTrueNativeFullScreen;
		
		// Enabled?
		if (t.hasMozNativeFullScreen) {
			t.nativeFullScreenEnabled = document.mozFullScreenEnabled;
		} else if (t.hasMsNativeFullScreen) {
			t.nativeFullScreenEnabled = document.msFullscreenEnabled;		
		}
		
		if (t.isChrome) {
			t.hasSemiNativeFullScreen = false;
		}
		
		if (t.hasTrueNativeFullScreen) {
			
			t.fullScreenEventName = '';
			if (t.hasWebkitNativeFullScreen) { 
				t.fullScreenEventName = 'webkitfullscreenchange';
				
			} else if (t.hasMozNativeFullScreen) {
				t.fullScreenEventName = 'mozfullscreenchange';
				
			} else if (t.hasMsNativeFullScreen) {
				t.fullScreenEventName = 'MSFullscreenChange';
			}
			
			t.isFullScreen = function() {
				if (t.hasMozNativeFullScreen) {
					return d.mozFullScreen;
				
				} else if (t.hasWebkitNativeFullScreen) {
					return d.webkitIsFullScreen;
				
				} else if (t.hasMsNativeFullScreen) {
					return d.msFullscreenElement !== null;
				}
			}
					
			t.requestFullScreen = function(el) {
		
				if (t.hasWebkitNativeFullScreen) {
					el.webkitRequestFullScreen();
					
				} else if (t.hasMozNativeFullScreen) {
					el.mozRequestFullScreen();

				} else if (t.hasMsNativeFullScreen) {
					el.msRequestFullscreen();

				}
			}
			
			t.cancelFullScreen = function() {				
				if (t.hasWebkitNativeFullScreen) {
					document.webkitCancelFullScreen();
					
				} else if (t.hasMozNativeFullScreen) {
					document.mozCancelFullScreen();
					
				} else if (t.hasMsNativeFullScreen) {
					document.msExitFullscreen();
					
				}
			}	
			
		}
		
		
		// OS X 10.5 can't do this even if it says it can :(
		if (t.hasSemiNativeFullScreen && ua.match(/mac os x 10_5/i)) {
			t.hasNativeFullScreen = false;
			t.hasSemiNativeFullScreen = false;
		}
		
	}
};
mejs.MediaFeatures.init();

/*
extension methods to <video> or <audio> object to bring it into parity with PluginMediaElement (see below)
*/
mejs.HtmlMediaElement = {
	pluginType: 'native',
	isFullScreen: false,

	setCurrentTime: function (time) {
		this.currentTime = time;
	},

	setMuted: function (muted) {
		this.muted = muted;
	},

	setVolume: function (volume) {
		this.volume = volume;
	},

	// for parity with the plugin versions
	stop: function () {
		this.pause();
	},

	// This can be a url string
	// or an array [{src:'file.mp4',type:'video/mp4'},{src:'file.webm',type:'video/webm'}]
	setSrc: function (url) {
		
		// Fix for IE9 which can't set .src when there are <source> elements. Awesome, right?
		var 
			existingSources = this.getElementsByTagName('source');
		while (existingSources.length > 0){
			this.removeChild(existingSources[0]);
		}
	
		if (typeof url == 'string') {
			this.src = url;
		} else {
			var i, media;

			for (i=0; i<url.length; i++) {
				media = url[i];
				if (this.canPlayType(media.type)) {
					this.src = media.src;
					break;
				}
			}
		}
	},

	setVideoSize: function (width, height) {
		this.width = width;
		this.height = height;
	}
};

/*
Mimics the <video/audio> element by calling Flash's External Interface or Silverlights [ScriptableMember]
*/
mejs.PluginMediaElement = function (pluginid, pluginType, mediaUrl) {
	this.id = pluginid;
	this.pluginType = pluginType;
	this.src = mediaUrl;
	this.events = {};
	this.attributes = {};
};

// JavaScript values and ExternalInterface methods that match HTML5 video properties methods
// http://www.adobe.com/livedocs/flash/9.0/ActionScriptLangRefV3/fl/video/FLVPlayback.html
// http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html
mejs.PluginMediaElement.prototype = {

	// special
	pluginElement: null,
	pluginType: '',
	isFullScreen: false,

	// not implemented :(
	playbackRate: -1,
	defaultPlaybackRate: -1,
	seekable: [],
	played: [],

	// HTML5 read-only properties
	paused: true,
	ended: false,
	seeking: false,
	duration: 0,
	error: null,
	tagName: '',

	// HTML5 get/set properties, but only set (updated by event handlers)
	muted: false,
	volume: 1,
	currentTime: 0,

	// HTML5 methods
	play: function () {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube' || this.pluginType == 'vimeo') {
				this.pluginApi.playVideo();
			} else {
				this.pluginApi.playMedia();
			}
			this.paused = false;
		}
	},
	load: function () {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube' || this.pluginType == 'vimeo') {
			} else {
				this.pluginApi.loadMedia();
			}
			
			this.paused = false;
		}
	},
	pause: function () {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube' || this.pluginType == 'vimeo') {
				this.pluginApi.pauseVideo();
			} else {
				this.pluginApi.pauseMedia();
			}			
			
			
			this.paused = true;
		}
	},
	stop: function () {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube' || this.pluginType == 'vimeo') {
				this.pluginApi.stopVideo();
			} else {
				this.pluginApi.stopMedia();
			}	
			this.paused = true;
		}
	},
	canPlayType: function(type) {
		var i,
			j,
			pluginInfo,
			pluginVersions = mejs.plugins[this.pluginType];

		for (i=0; i<pluginVersions.length; i++) {
			pluginInfo = pluginVersions[i];

			// test if user has the correct plugin version
			if (mejs.PluginDetector.hasPluginVersion(this.pluginType, pluginInfo.version)) {

				// test for plugin playback types
				for (j=0; j<pluginInfo.types.length; j++) {
					// find plugin that can play the type
					if (type == pluginInfo.types[j]) {
						return 'probably';
					}
				}
			}
		}

		return '';
	},
	
	positionFullscreenButton: function(x,y,visibleAndAbove) {
		if (this.pluginApi != null && this.pluginApi.positionFullscreenButton) {
			this.pluginApi.positionFullscreenButton(Math.floor(x),Math.floor(y),visibleAndAbove);
		}
	},
	
	hideFullscreenButton: function() {
		if (this.pluginApi != null && this.pluginApi.hideFullscreenButton) {
			this.pluginApi.hideFullscreenButton();
		}		
	},	
	

	// custom methods since not all JavaScript implementations support get/set

	// This can be a url string
	// or an array [{src:'file.mp4',type:'video/mp4'},{src:'file.webm',type:'video/webm'}]
	setSrc: function (url) {
		if (typeof url == 'string') {
			this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(url));
			this.src = mejs.Utility.absolutizeUrl(url);
		} else {
			var i, media;

			for (i=0; i<url.length; i++) {
				media = url[i];
				if (this.canPlayType(media.type)) {
					this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(media.src));
					this.src = mejs.Utility.absolutizeUrl(url);
					break;
				}
			}
		}

	},
	setCurrentTime: function (time) {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube' || this.pluginType == 'vimeo') {
				this.pluginApi.seekTo(time);
			} else {
				this.pluginApi.setCurrentTime(time);
			}				
			
			
			
			this.currentTime = time;
		}
	},
	setVolume: function (volume) {
		if (this.pluginApi != null) {
			// same on YouTube and MEjs
			if (this.pluginType == 'youtube') {
				this.pluginApi.setVolume(volume * 100);
			} else {
				this.pluginApi.setVolume(volume);
			}
			this.volume = volume;
		}
	},
	setMuted: function (muted) {
		if (this.pluginApi != null) {
			if (this.pluginType == 'youtube') {
				if (muted) {
					this.pluginApi.mute();
				} else {
					this.pluginApi.unMute();
				}
				this.muted = muted;
				this.dispatchEvent('volumechange');
			} else {
				this.pluginApi.setMuted(muted);
			}
			this.muted = muted;
		}
	},

	// additional non-HTML5 methods
	setVideoSize: function (width, height) {
		
		//if (this.pluginType == 'flash' || this.pluginType == 'silverlight') {
			if (this.pluginElement && this.pluginElement.style) {
				this.pluginElement.style.width = width + 'px';
				this.pluginElement.style.height = height + 'px';
			}
			if (this.pluginApi != null && this.pluginApi.setVideoSize) {
				this.pluginApi.setVideoSize(width, height);
			}
		//}
	},

	setFullscreen: function (fullscreen) {
		if (this.pluginApi != null && this.pluginApi.setFullscreen) {
			this.pluginApi.setFullscreen(fullscreen);
		}
	},
	
	enterFullScreen: function() {
		if (this.pluginApi != null && this.pluginApi.setFullscreen) {
			this.setFullscreen(true);
		}		
		
	},
	
	exitFullScreen: function() {
		if (this.pluginApi != null && this.pluginApi.setFullscreen) {
			this.setFullscreen(false);
		}
	},	

	// start: fake events
	addEventListener: function (eventName, callback, bubble) {
		this.events[eventName] = this.events[eventName] || [];
		this.events[eventName].push(callback);
	},
	removeEventListener: function (eventName, callback) {
		if (!eventName) { this.events = {}; return true; }
		var callbacks = this.events[eventName];
		if (!callbacks) return true;
		if (!callback) { this.events[eventName] = []; return true; }
		for (var i = 0; i < callbacks.length; i++) {
			if (callbacks[i] === callback) {
				this.events[eventName].splice(i, 1);
				return true;
			}
		}
		return false;
	},	
	dispatchEvent: function (eventName) {
		var i,
			args,
			callbacks = this.events[eventName];

		if (callbacks) {
			args = Array.prototype.slice.call(arguments, 1);
			for (i = 0; i < callbacks.length; i++) {
				callbacks[i].apply(null, args);
			}
		}
	},
	// end: fake events
	
	// fake DOM attribute methods
	hasAttribute: function(name){
		return (name in this.attributes);  
	},
	removeAttribute: function(name){
		delete this.attributes[name];
	},
	getAttribute: function(name){
		if (this.hasAttribute(name)) {
			return this.attributes[name];
		}
		return '';
	},
	setAttribute: function(name, value){
		this.attributes[name] = value;
	},

	remove: function() {
		mejs.Utility.removeSwf(this.pluginElement.id);
		mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id);
	}
};

// Handles calls from Flash/Silverlight and reports them as native <video/audio> events and properties
mejs.MediaPluginBridge = {

	pluginMediaElements:{},
	htmlMediaElements:{},

	registerPluginElement: function (id, pluginMediaElement, htmlMediaElement) {
		this.pluginMediaElements[id] = pluginMediaElement;
		this.htmlMediaElements[id] = htmlMediaElement;
	},

	unregisterPluginElement: function (id) {
		delete this.pluginMediaElements[id];
		delete this.htmlMediaElements[id];
	},

	// when Flash/Silverlight is ready, it calls out to this method
	initPlugin: function (id) {

		var pluginMediaElement = this.pluginMediaElements[id],
			htmlMediaElement = this.htmlMediaElements[id];

		if (pluginMediaElement) {
			// find the javascript bridge
			switch (pluginMediaElement.pluginType) {
				case "flash":
					pluginMediaElement.pluginElement = pluginMediaElement.pluginApi = document.getElementById(id);
					break;
				case "silverlight":
					pluginMediaElement.pluginElement = document.getElementById(pluginMediaElement.id);
					pluginMediaElement.pluginApi = pluginMediaElement.pluginElement.Content.MediaElementJS;
					break;
			}
	
			if (pluginMediaElement.pluginApi != null && pluginMediaElement.success) {
				pluginMediaElement.success(pluginMediaElement, htmlMediaElement);
			}
		}
	},

	// receives events from Flash/Silverlight and sends them out as HTML5 media events
	// http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html
	fireEvent: function (id, eventName, values) {

		var
			e,
			i,
			bufferedTime,
			pluginMediaElement = this.pluginMediaElements[id];

		if(!pluginMediaElement){
            return;
        }
        
		// fake event object to mimic real HTML media event.
		e = {
			type: eventName,
			target: pluginMediaElement
		};

		// attach all values to element and event object
		for (i in values) {
			pluginMediaElement[i] = values[i];
			e[i] = values[i];
		}

		// fake the newer W3C buffered TimeRange (loaded and total have been removed)
		bufferedTime = values.bufferedTime || 0;

		e.target.buffered = e.buffered = {
			start: function(index) {
				return 0;
			},
			end: function (index) {
				return bufferedTime;
			},
			length: 1
		};

		pluginMediaElement.dispatchEvent(e.type, e);
	}
};

/*
Default options
*/
mejs.MediaElementDefaults = {
	// allows testing on HTML5, flash, silverlight
	// auto: attempts to detect what the browser can do
	// auto_plugin: prefer plugins and then attempt native HTML5
	// native: forces HTML5 playback
	// shim: disallows HTML5, will attempt either Flash or Silverlight
	// none: forces fallback view
	mode: 'auto',
	// remove or reorder to change plugin priority and availability
	plugins: ['flash','silverlight','youtube','vimeo'],
	// shows debug errors on screen
	enablePluginDebug: false,
	// use plugin for browsers that have trouble with Basic Authentication on HTTPS sites
	httpsBasicAuthSite: false,
	// overrides the type specified, useful for dynamic instantiation
	type: '',
	// path to Flash and Silverlight plugins
	pluginPath: mejs.Utility.getScriptPath(['mediaelement.js','mediaelement.min.js','mediaelement-and-player.js','mediaelement-and-player.min.js']),
	// name of flash file
	flashName: 'flashmediaelement.swf',
	// streamer for RTMP streaming
	flashStreamer: '',
	// turns on the smoothing filter in Flash
	enablePluginSmoothing: false,
	// enabled pseudo-streaming (seek) on .mp4 files
	enablePseudoStreaming: false,
	// start query parameter sent to server for pseudo-streaming
	pseudoStreamingStartQueryParam: 'start',
	// name of silverlight file
	silverlightName: 'silverlightmediaelement.xap',
	// default if the <video width> is not specified
	defaultVideoWidth: 480,
	// default if the <video height> is not specified
	defaultVideoHeight: 270,
	// overrides <video width>
	pluginWidth: -1,
	// overrides <video height>
	pluginHeight: -1,
	// additional plugin variables in 'key=value' form
	pluginVars: [],	
	// rate in milliseconds for Flash and Silverlight to fire the timeupdate event
	// larger number is less accurate, but less strain on plugin->JavaScript bridge
	timerRate: 250,
	// initial volume for player
	startVolume: 0.8,
	success: function () { },
	error: function () { }
};

/*
Determines if a browser supports the <video> or <audio> element
and returns either the native element or a Flash/Silverlight version that
mimics HTML5 MediaElement
*/
mejs.MediaElement = function (el, o) {
	return mejs.HtmlMediaElementShim.create(el,o);
};

mejs.HtmlMediaElementShim = {

	create: function(el, o) {
		var
			options = mejs.MediaElementDefaults,
			htmlMediaElement = (typeof(el) == 'string') ? document.getElementById(el) : el,
			tagName = htmlMediaElement.tagName.toLowerCase(),
			isMediaTag = (tagName === 'audio' || tagName === 'video'),
			src = (isMediaTag) ? htmlMediaElement.getAttribute('src') : htmlMediaElement.getAttribute('href'),
			poster = htmlMediaElement.getAttribute('poster'),
			autoplay =  htmlMediaElement.getAttribute('autoplay'),
			preload =  htmlMediaElement.getAttribute('preload'),
			controls =  htmlMediaElement.getAttribute('controls'),
			playback,
			prop;

		// extend options
		for (prop in o) {
			options[prop] = o[prop];
		}

		// clean up attributes
		src = 		(typeof src == 'undefined' 	|| src === null || src == '') ? null : src;		
		poster =	(typeof poster == 'undefined' 	|| poster === null) ? '' : poster;
		preload = 	(typeof preload == 'undefined' 	|| preload === null || preload === 'false') ? 'none' : preload;
		autoplay = 	!(typeof autoplay == 'undefined' || autoplay === null || autoplay === 'false');
		controls = 	!(typeof controls == 'undefined' || controls === null || controls === 'false');

		// test for HTML5 and plugin capabilities
		playback = this.determinePlayback(htmlMediaElement, options, mejs.MediaFeatures.supportsMediaTag, isMediaTag, src);
		playback.url = (playback.url !== null) ? mejs.Utility.absolutizeUrl(playback.url) : '';

		if (playback.method == 'native') {
			// second fix for android
			if (mejs.MediaFeatures.isBustedAndroid) {
				htmlMediaElement.src = playback.url;
				htmlMediaElement.addEventListener('click', function() {
					htmlMediaElement.play();
				}, false);
			}
		
			// add methods to native HTMLMediaElement
			return this.updateNative(playback, options, autoplay, preload);
		} else if (playback.method !== '') {
			// create plugin to mimic HTMLMediaElement
			
			return this.createPlugin( playback,  options, poster, autoplay, preload, controls);
		} else {
			// boo, no HTML5, no Flash, no Silverlight.
			this.createErrorMessage( playback, options, poster );
			
			return this;
		}
	},
	
	determinePlayback: function(htmlMediaElement, options, supportsMediaTag, isMediaTag, src) {
		var
			mediaFiles = [],
			i,
			j,
			k,
			l,
			n,
			type,
			result = { method: '', url: '', htmlMediaElement: htmlMediaElement, isVideo: (htmlMediaElement.tagName.toLowerCase() != 'audio')},
			pluginName,
			pluginVersions,
			pluginInfo,
			dummy,
			media;
			
		// STEP 1: Get URL and type from <video src> or <source src>

		// supplied type overrides <video type> and <source type>
		if (typeof options.type != 'undefined' && options.type !== '') {
			
			// accept either string or array of types
			if (typeof options.type == 'string') {
				mediaFiles.push({type:options.type, url:src});
			} else {
				
				for (i=0; i<options.type.length; i++) {
					mediaFiles.push({type:options.type[i], url:src});
				}
			}

		// test for src attribute first
		} else if (src !== null) {
			type = this.formatType(src, htmlMediaElement.getAttribute('type'));
			mediaFiles.push({type:type, url:src});

		// then test for <source> elements
		} else {
			// test <source> types to see if they are usable
			for (i = 0; i < htmlMediaElement.childNodes.length; i++) {
				n = htmlMediaElement.childNodes[i];
				if (n.nodeType == 1 && n.tagName.toLowerCase() == 'source') {
					src = n.getAttribute('src');
					type = this.formatType(src, n.getAttribute('type'));
					media = n.getAttribute('media');

					if (!media || !window.matchMedia || (window.matchMedia && window.matchMedia(media).matches)) {
						mediaFiles.push({type:type, url:src});
					}
				}
			}
		}
		
		// in the case of dynamicly created players
		// check for audio types
		if (!isMediaTag && mediaFiles.length > 0 && mediaFiles[0].url !== null && this.getTypeFromFile(mediaFiles[0].url).indexOf('audio') > -1) {
			result.isVideo = false;
		}
		

		// STEP 2: Test for playback method
		
		// special case for Android which sadly doesn't implement the canPlayType function (always returns '')
		if (mejs.MediaFeatures.isBustedAndroid) {
			htmlMediaElement.canPlayType = function(type) {
				return (type.match(/video\/(mp4|m4v)/gi) !== null) ? 'maybe' : '';
			};
		}		
		
		// special case for Chromium to specify natively supported video codecs (i.e. WebM and Theora) 
		if (mejs.MediaFeatures.isChromium) { 
			htmlMediaElement.canPlayType = function(type) { 
				return (type.match(/video\/(webm|ogv|ogg)/gi) !== null) ? 'maybe' : ''; 
			}; 
		}

		// test for native playback first
		if (supportsMediaTag && (options.mode === 'auto' || options.mode === 'auto_plugin' || options.mode === 'native')  && !(mejs.MediaFeatures.isBustedNativeHTTPS && options.httpsBasicAuthSite === true)) {
						
			if (!isMediaTag) {

				// create a real HTML5 Media Element 
				dummy = document.createElement( result.isVideo ? 'video' : 'audio');			
				htmlMediaElement.parentNode.insertBefore(dummy, htmlMediaElement);
				htmlMediaElement.style.display = 'none';
				
				// use this one from now on
				result.htmlMediaElement = htmlMediaElement = dummy;
			}
				
			for (i=0; i<mediaFiles.length; i++) {
				// normal check
				if (mediaFiles[i].type == "video/m3u8" || htmlMediaElement.canPlayType(mediaFiles[i].type).replace(/no/, '') !== ''
					// special case for Mac/Safari 5.0.3 which answers '' to canPlayType('audio/mp3') but 'maybe' to canPlayType('audio/mpeg')
					|| htmlMediaElement.canPlayType(mediaFiles[i].type.replace(/mp3/,'mpeg')).replace(/no/, '') !== ''
					// special case for m4a supported by detecting mp4 support
					|| htmlMediaElement.canPlayType(mediaFiles[i].type.replace(/m4a/,'mp4')).replace(/no/, '') !== '') {
					result.method = 'native';
					result.url = mediaFiles[i].url;
					break;
				}
			}			
			
			if (result.method === 'native') {
				if (result.url !== null) {
					htmlMediaElement.src = result.url;
				}
			
				// if `auto_plugin` mode, then cache the native result but try plugins.
				if (options.mode !== 'auto_plugin') {
					return result;
				}
			}
		}

		// if native playback didn't work, then test plugins
		if (options.mode === 'auto' || options.mode === 'auto_plugin' || options.mode === 'shim') {
			for (i=0; i<mediaFiles.length; i++) {
				type = mediaFiles[i].type;

				// test all plugins in order of preference [silverlight, flash]
				for (j=0; j<options.plugins.length; j++) {

					pluginName = options.plugins[j];
			
					// test version of plugin (for future features)
					pluginVersions = mejs.plugins[pluginName];				
					
					for (k=0; k<pluginVersions.length; k++) {
						pluginInfo = pluginVersions[k];
					
						// test if user has the correct plugin version
						
						// for youtube/vimeo
						if (pluginInfo.version == null || 
							
							mejs.PluginDetector.hasPluginVersion(pluginName, pluginInfo.version)) {

							// test for plugin playback types
							for (l=0; l<pluginInfo.types.length; l++) {
								// find plugin that can play the type
								if (type == pluginInfo.types[l]) {
									result.method = pluginName;
									result.url = mediaFiles[i].url;
									return result;
								}
							}
						}
					}
				}
			}
		}
		
		// at this point, being in 'auto_plugin' mode implies that we tried plugins but failed.
		// if we have native support then return that.
		if (options.mode === 'auto_plugin' && result.method === 'native') {
			return result;
		}

		// what if there's nothing to play? just grab the first available
		if (result.method === '' && mediaFiles.length > 0) {
			result.url = mediaFiles[0].url;
		}

		return result;
	},

	formatType: function(url, type) {
		var ext;

		// if no type is supplied, fake it with the extension
		if (url && !type) {		
			return this.getTypeFromFile(url);
		} else {
			// only return the mime part of the type in case the attribute contains the codec
			// see http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#the-source-element
			// `video/mp4; codecs="avc1.42E01E, mp4a.40.2"` becomes `video/mp4`
			
			if (type && ~type.indexOf(';')) {
				return type.substr(0, type.indexOf(';')); 
			} else {
				return type;
			}
		}
	},
	
	getTypeFromFile: function(url) {
		url = url.split('?')[0];
		var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
		return (/(mp4|m4v|ogg|ogv|m3u8|webm|webmv|flv|wmv|mpeg|mov)/gi.test(ext) ? 'video' : 'audio') + '/' + this.getTypeFromExtension(ext);
	},
	
	getTypeFromExtension: function(ext) {
		
		switch (ext) {
			case 'mp4':
			case 'm4v':
			case 'm4a':
				return 'mp4';
			case 'webm':
			case 'webma':
			case 'webmv':	
				return 'webm';
			case 'ogg':
			case 'oga':
			case 'ogv':	
				return 'ogg';
			default:
				return ext;
		}
	},

	createErrorMessage: function(playback, options, poster) {
		var 
			htmlMediaElement = playback.htmlMediaElement,
			errorContainer = document.createElement('div');
			
		errorContainer.className = 'me-cannotplay';

		try {
			errorContainer.style.width = htmlMediaElement.width + 'px';
			errorContainer.style.height = htmlMediaElement.height + 'px';
		} catch (e) {}

    if (options.customError) {
      errorContainer.innerHTML = options.customError;
    } else {
      errorContainer.innerHTML = (poster !== '') ?
        '<a href="' + playback.url + '"><img src="' + poster + '" width="100%" height="100%" /></a>' :
        '<a href="' + playback.url + '"><span>' + mejs.i18n.t('Download File') + '</span></a>';
    }

		htmlMediaElement.parentNode.insertBefore(errorContainer, htmlMediaElement);
		htmlMediaElement.style.display = 'none';

		options.error(htmlMediaElement);
	},

	createPlugin:function(playback, options, poster, autoplay, preload, controls) {
		var 
			htmlMediaElement = playback.htmlMediaElement,
			width = 1,
			height = 1,
			pluginid = 'me_' + playback.method + '_' + (mejs.meIndex++),
			pluginMediaElement = new mejs.PluginMediaElement(pluginid, playback.method, playback.url),
			container = document.createElement('div'),
			specialIEContainer,
			node,
			initVars;

		// copy tagName from html media element
		pluginMediaElement.tagName = htmlMediaElement.tagName

		// copy attributes from html media element to plugin media element
		for (var i = 0; i < htmlMediaElement.attributes.length; i++) {
			var attribute = htmlMediaElement.attributes[i];
			if (attribute.specified == true) {
				pluginMediaElement.setAttribute(attribute.name, attribute.value);
			}
		}

		// check for placement inside a <p> tag (sometimes WYSIWYG editors do this)
		node = htmlMediaElement.parentNode;
		while (node !== null && node.tagName.toLowerCase() !== 'body' && node.parentNode != null) {
			if (node.parentNode.tagName.toLowerCase() === 'p') {
				node.parentNode.parentNode.insertBefore(node, node.parentNode);
				break;
			}
			node = node.parentNode;
		}

		if (playback.isVideo) {
			width = (options.pluginWidth > 0) ? options.pluginWidth : (options.videoWidth > 0) ? options.videoWidth : (htmlMediaElement.getAttribute('width') !== null) ? htmlMediaElement.getAttribute('width') : options.defaultVideoWidth;
			height = (options.pluginHeight > 0) ? options.pluginHeight : (options.videoHeight > 0) ? options.videoHeight : (htmlMediaElement.getAttribute('height') !== null) ? htmlMediaElement.getAttribute('height') : options.defaultVideoHeight;
		
			// in case of '%' make sure it's encoded
			width = mejs.Utility.encodeUrl(width);
			height = mejs.Utility.encodeUrl(height);
		
		} else {
			if (options.enablePluginDebug) {
				width = 320;
				height = 240;
			}
		}

		// register plugin
		pluginMediaElement.success = options.success;
		mejs.MediaPluginBridge.registerPluginElement(pluginid, pluginMediaElement, htmlMediaElement);

		// add container (must be added to DOM before inserting HTML for IE)
		container.className = 'me-plugin';
		container.id = pluginid + '_container';
		
		if (playback.isVideo) {
				htmlMediaElement.parentNode.insertBefore(container, htmlMediaElement);
		} else {
				document.body.insertBefore(container, document.body.childNodes[0]);
		}

		// flash/silverlight vars
		initVars = [
			'id=' + pluginid,
			'isvideo=' + ((playback.isVideo) ? "true" : "false"),
			'autoplay=' + ((autoplay) ? "true" : "false"),
			'preload=' + preload,
			'width=' + width,
			'startvolume=' + options.startVolume,
			'timerrate=' + options.timerRate,
			'flashstreamer=' + options.flashStreamer,
			'height=' + height,
      'pseudostreamstart=' + options.pseudoStreamingStartQueryParam];

		if (playback.url !== null) {
			if (playback.method == 'flash') {
				initVars.push('file=' + mejs.Utility.encodeUrl(playback.url));
			} else {
				initVars.push('file=' + playback.url);
			}
		}
		if (options.enablePluginDebug) {
			initVars.push('debug=true');
		}
		if (options.enablePluginSmoothing) {
			initVars.push('smoothing=true');
		}
    if (options.enablePseudoStreaming) {
      initVars.push('pseudostreaming=true');
    }
		if (controls) {
			initVars.push('controls=true'); // shows controls in the plugin if desired
		}
		if (options.pluginVars) {
			initVars = initVars.concat(options.pluginVars);
		}		

		switch (playback.method) {
			case 'silverlight':
				container.innerHTML =
'<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="' + pluginid + '" name="' + pluginid + '" width="' + width + '" height="' + height + '" class="mejs-shim">' +
'<param name="initParams" value="' + initVars.join(',') + '" />' +
'<param name="windowless" value="true" />' +
'<param name="background" value="black" />' +
'<param name="minRuntimeVersion" value="3.0.0.0" />' +
'<param name="autoUpgrade" value="true" />' +
'<param name="source" value="' + options.pluginPath + options.silverlightName + '" />' +
'</object>';
					break;

			case 'flash':

				if (mejs.MediaFeatures.isIE) {
					specialIEContainer = document.createElement('div');
					container.appendChild(specialIEContainer);
					specialIEContainer.outerHTML =
'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" ' +
'id="' + pluginid + '" width="' + width + '" height="' + height + '" class="mejs-shim">' +
'<param name="movie" value="' + options.pluginPath + options.flashName + '?x=' + (new Date()) + '" />' +
'<param name="flashvars" value="' + initVars.join('&amp;') + '" />' +
'<param name="quality" value="high" />' +
'<param name="bgcolor" value="#000000" />' +
'<param name="wmode" value="transparent" />' +
'<param name="allowScriptAccess" value="always" />' +
'<param name="allowFullScreen" value="true" />' +
'<param name="scale" value="default" />' + 
'</object>';

				} else {

					container.innerHTML =
'<embed id="' + pluginid + '" name="' + pluginid + '" ' +
'play="true" ' +
'loop="false" ' +
'quality="high" ' +
'bgcolor="#000000" ' +
'wmode="transparent" ' +
'allowScriptAccess="always" ' +
'allowFullScreen="true" ' +
'type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" ' +
'src="' + options.pluginPath + options.flashName + '" ' +
'flashvars="' + initVars.join('&') + '" ' +
'width="' + width + '" ' +
'height="' + height + '" ' +
'scale="default"' + 
'class="mejs-shim"></embed>';
				}
				break;
			
			case 'youtube':
			
				
				var videoId;
				// youtu.be url from share button
				if (playback.url.lastIndexOf("youtu.be") != -1) {
					videoId = playback.url.substr(playback.url.lastIndexOf('/')+1);
					if (videoId.indexOf('?') != -1) {
						videoId = videoId.substr(0, videoId.indexOf('?'));
					}
				}
				else {
					videoId = playback.url.substr(playback.url.lastIndexOf('=')+1);
				}
				youtubeSettings = {
						container: container,
						containerId: container.id,
						pluginMediaElement: pluginMediaElement,
						pluginId: pluginid,
						videoId: videoId,
						height: height,
						width: width	
					};				
				
				if (mejs.PluginDetector.hasPluginVersion('flash', [10,0,0]) ) {
					mejs.YouTubeApi.createFlash(youtubeSettings);
				} else {
					mejs.YouTubeApi.enqueueIframe(youtubeSettings);		
				}
				
				break;
			
			// DEMO Code. Does NOT work.
			case 'vimeo':
				var player_id = pluginid + "_player";
				pluginMediaElement.vimeoid = playback.url.substr(playback.url.lastIndexOf('/')+1);
				
				container.innerHTML ='<iframe src="//player.vimeo.com/video/' + pluginMediaElement.vimeoid + '?api=1&portrait=0&byline=0&title=0&player_id=' + player_id + '" width="' + width +'" height="' + height +'" frameborder="0" class="mejs-shim" id="' + player_id + '"></iframe>';
				if (typeof($f) == 'function') { // froogaloop available
					var player = $f(container.childNodes[0]);
					player.addEvent('ready', function() {
						$.extend( player, {
							playVideo: function() {
								player.api( 'play' );
							}, 
							stopVideo: function() {
								player.api( 'unload' );
							}, 
							pauseVideo: function() {
								player.api( 'pause' );
							}, 
							seekTo: function( seconds ) {
								player.api( 'seekTo', seconds );
							}, 
							setVolume: function( volume ) {
								player.api( 'setVolume', volume );
							}, 
							setMuted: function( muted ) {
								if( muted ) {
									player.lastVolume = player.api( 'getVolume' );
									player.api( 'setVolume', 0 );
								} else {
									player.api( 'setVolume', player.lastVolume );
									delete player.lastVolume;
								}
							}
						});

						function createEvent(player, pluginMediaElement, eventName, e) {
							var obj = {
								type: eventName,
								target: pluginMediaElement
							};
							if (eventName == 'timeupdate') {
								pluginMediaElement.currentTime = obj.currentTime = e.seconds;
								pluginMediaElement.duration = obj.duration = e.duration;
							}
							pluginMediaElement.dispatchEvent(obj.type, obj);
						}

						player.addEvent('play', function() {
							createEvent(player, pluginMediaElement, 'play');
							createEvent(player, pluginMediaElement, 'playing');
						});

						player.addEvent('pause', function() {
							createEvent(player, pluginMediaElement, 'pause');
						});

						player.addEvent('finish', function() {
							createEvent(player, pluginMediaElement, 'ended');
						});

						player.addEvent('playProgress', function(e) {
							createEvent(player, pluginMediaElement, 'timeupdate', e);
						});

						pluginMediaElement.pluginElement = container;
						pluginMediaElement.pluginApi = player;

						// init mejs
						mejs.MediaPluginBridge.initPlugin(pluginid);
					});
				}
				else {
					console.warn("You need to include froogaloop for vimeo to work");
				}
				break;			
		}
		// hide original element
		htmlMediaElement.style.display = 'none';
		// prevent browser from autoplaying when using a plugin
		htmlMediaElement.removeAttribute('autoplay');

		// FYI: options.success will be fired by the MediaPluginBridge
		
		return pluginMediaElement;
	},

	updateNative: function(playback, options, autoplay, preload) {
		
		var htmlMediaElement = playback.htmlMediaElement,
			m;
		
		
		// add methods to video object to bring it into parity with Flash Object
		for (m in mejs.HtmlMediaElement) {
			htmlMediaElement[m] = mejs.HtmlMediaElement[m];
		}

		/*
		Chrome now supports preload="none"
		if (mejs.MediaFeatures.isChrome) {
		
			// special case to enforce preload attribute (Chrome doesn't respect this)
			if (preload === 'none' && !autoplay) {
			
				// forces the browser to stop loading (note: fails in IE9)
				htmlMediaElement.src = '';
				htmlMediaElement.load();
				htmlMediaElement.canceledPreload = true;

				htmlMediaElement.addEventListener('play',function() {
					if (htmlMediaElement.canceledPreload) {
						htmlMediaElement.src = playback.url;
						htmlMediaElement.load();
						htmlMediaElement.play();
						htmlMediaElement.canceledPreload = false;
					}
				}, false);
			// for some reason Chrome forgets how to autoplay sometimes.
			} else if (autoplay) {
				htmlMediaElement.load();
				htmlMediaElement.play();
			}
		}
		*/

		// fire success code
		options.success(htmlMediaElement, htmlMediaElement);
		
		return htmlMediaElement;
	}
};

/*
 - test on IE (object vs. embed)
 - determine when to use iframe (Firefox, Safari, Mobile) vs. Flash (Chrome, IE)
 - fullscreen?
*/

// YouTube Flash and Iframe API
mejs.YouTubeApi = {
	isIframeStarted: false,
	isIframeLoaded: false,
	loadIframeApi: function() {
		if (!this.isIframeStarted) {
			var tag = document.createElement('script');
			tag.src = "//www.youtube.com/player_api";
			var firstScriptTag = document.getElementsByTagName('script')[0];
			firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
			this.isIframeStarted = true;
		}
	},
	iframeQueue: [],
	enqueueIframe: function(yt) {
		
		if (this.isLoaded) {
			this.createIframe(yt);
		} else {
			this.loadIframeApi();
			this.iframeQueue.push(yt);
		}
	},
	createIframe: function(settings) {
		
		var
		pluginMediaElement = settings.pluginMediaElement,	
		player = new YT.Player(settings.containerId, {
			height: settings.height,
			width: settings.width,
			videoId: settings.videoId,
			playerVars: {controls:0},
			events: {
				'onReady': function() {
					
					// hook up iframe object to MEjs
					settings.pluginMediaElement.pluginApi = player;
					
					// init mejs
					mejs.MediaPluginBridge.initPlugin(settings.pluginId);
					
					// create timer
					setInterval(function() {
						mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'timeupdate');
					}, 250);					
				},
				'onStateChange': function(e) {
					
					mejs.YouTubeApi.handleStateChange(e.data, player, pluginMediaElement);
					
				}
			}
		});
	},
	
	createEvent: function (player, pluginMediaElement, eventName) {
		var obj = {
			type: eventName,
			target: pluginMediaElement
		};

		if (player && player.getDuration) {
			
			// time 
			pluginMediaElement.currentTime = obj.currentTime = player.getCurrentTime();
			pluginMediaElement.duration = obj.duration = player.getDuration();
			
			// state
			obj.paused = pluginMediaElement.paused;
			obj.ended = pluginMediaElement.ended;			
			
			// sound
			obj.muted = player.isMuted();
			obj.volume = player.getVolume() / 100;
			
			// progress
			obj.bytesTotal = player.getVideoBytesTotal();
			obj.bufferedBytes = player.getVideoBytesLoaded();
			
			// fake the W3C buffered TimeRange
			var bufferedTime = obj.bufferedBytes / obj.bytesTotal * obj.duration;
			
			obj.target.buffered = obj.buffered = {
				start: function(index) {
					return 0;
				},
				end: function (index) {
					return bufferedTime;
				},
				length: 1
			};

		}
		
		// send event up the chain
		pluginMediaElement.dispatchEvent(obj.type, obj);
	},	
	
	iFrameReady: function() {
		
		this.isLoaded = true;
		this.isIframeLoaded = true;
		
		while (this.iframeQueue.length > 0) {
			var settings = this.iframeQueue.pop();
			this.createIframe(settings);
		}	
	},
	
	// FLASH!
	flashPlayers: {},
	createFlash: function(settings) {
		
		this.flashPlayers[settings.pluginId] = settings;
		
		/*
		settings.container.innerHTML =
			'<object type="application/x-shockwave-flash" id="' + settings.pluginId + '" data="//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid=' + settings.pluginId  + '&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0" ' +
				'width="' + settings.width + '" height="' + settings.height + '" style="visibility: visible; " class="mejs-shim">' +
				'<param name="allowScriptAccess" value="always">' +
				'<param name="wmode" value="transparent">' +
			'</object>';
		*/

		var specialIEContainer,
			youtubeUrl = '//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid=' + settings.pluginId  + '&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0';
			
		if (mejs.MediaFeatures.isIE) {
			
			specialIEContainer = document.createElement('div');
			settings.container.appendChild(specialIEContainer);
			specialIEContainer.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" ' +
'id="' + settings.pluginId + '" width="' + settings.width + '" height="' + settings.height + '" class="mejs-shim">' +
	'<param name="movie" value="' + youtubeUrl + '" />' +
	'<param name="wmode" value="transparent" />' +
	'<param name="allowScriptAccess" value="always" />' +
	'<param name="allowFullScreen" value="true" />' +
'</object>';
		} else {
		settings.container.innerHTML =
			'<object type="application/x-shockwave-flash" id="' + settings.pluginId + '" data="' + youtubeUrl + '" ' +
				'width="' + settings.width + '" height="' + settings.height + '" style="visibility: visible; " class="mejs-shim">' +
				'<param name="allowScriptAccess" value="always">' +
				'<param name="wmode" value="transparent">' +
			'</object>';
		}		
		
	},
	
	flashReady: function(id) {
		var
			settings = this.flashPlayers[id],
			player = document.getElementById(id),
			pluginMediaElement = settings.pluginMediaElement;
		
		// hook up and return to MediaELementPlayer.success	
		pluginMediaElement.pluginApi = 
		pluginMediaElement.pluginElement = player;
		mejs.MediaPluginBridge.initPlugin(id);
		
		// load the youtube video
		player.cueVideoById(settings.videoId);
		
		var callbackName = settings.containerId + '_callback';
		
		window[callbackName] = function(e) {
			mejs.YouTubeApi.handleStateChange(e, player, pluginMediaElement);
		}
		
		player.addEventListener('onStateChange', callbackName);
		
		setInterval(function() {
			mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'timeupdate');
		}, 250);
		
		mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'canplay');
	},
	
	handleStateChange: function(youTubeState, player, pluginMediaElement) {
		switch (youTubeState) {
			case -1: // not started
				pluginMediaElement.paused = true;
				pluginMediaElement.ended = true;
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'loadedmetadata');
				//createYouTubeEvent(player, pluginMediaElement, 'loadeddata');
				break;
			case 0:
				pluginMediaElement.paused = false;
				pluginMediaElement.ended = true;
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'ended');
				break;
			case 1:
				pluginMediaElement.paused = false;
				pluginMediaElement.ended = false;				
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'play');
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'playing');
				break;
			case 2:
				pluginMediaElement.paused = true;
				pluginMediaElement.ended = false;				
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'pause');
				break;
			case 3: // buffering
				mejs.YouTubeApi.createEvent(player, pluginMediaElement, 'progress');
				break;
			case 5:
				// cued?
				break;						
			
		}			
		
	}
}
// IFRAME
function onYouTubePlayerAPIReady() {
	mejs.YouTubeApi.iFrameReady();
}
// FLASH
function onYouTubePlayerReady(id) {
	mejs.YouTubeApi.flashReady(id);
}

window.mejs = mejs;
window.MediaElement = mejs.MediaElement;

/*!
 * Adds Internationalization and localization to mediaelement.
 *
 * This file does not contain translations, you have to add the manually.
 * The schema is always the same: me-i18n-locale-[ISO_639-1 Code].js
 *
 * Examples are provided both for german and chinese translation.
 *
 *
 * What is the concept beyond i18n?
 *   http://en.wikipedia.org/wiki/Internationalization_and_localization
 *
 * What langcode should i use?
 *   http://en.wikipedia.org/wiki/ISO_639-1
 *
 *
 * License?
 *
 *   The i18n file uses methods from the Drupal project (drupal.js):
 *     - i18n.methods.t() (modified)
 *     - i18n.methods.checkPlain() (full copy)
 *
 *   The Drupal project is (like mediaelementjs) licensed under GPLv2.
 *    - http://drupal.org/licensing/faq/#q1
 *    - https://github.com/johndyer/mediaelement
 *    - http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
 *
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 *
 * @params
 *  - context - document, iframe ..
 *  - exports - CommonJS, window ..
 *
 */
;(function(context, exports, undefined) {
    "use strict";
    var i18n = {
        "locale": {
            "language" : '',
            "strings" : {}
        },
        "methods" : {}
    };
// start i18n


    /**
     * Get language, fallback to browser's language if empty
     */
    i18n.getLanguage = function () {
        var language = i18n.locale.language || window.navigator.userLanguage || window.navigator.language;
        // convert to iso 639-1 (2-letters, lower case)
        return language.substr(0, 2).toLowerCase();
    };

    // i18n fixes for compatibility with WordPress
    if ( typeof mejsL10n != 'undefined' ) {
        i18n.locale.language = mejsL10n.language;
    }



    /**
     * Encode special characters in a plain-text string for display as HTML.
     */
    i18n.methods.checkPlain = function (str) {
        var character, regex,
        replace = {
            '&': '&amp;',
            '"': '&quot;',
            '<': '&lt;',
            '>': '&gt;'
        };
        str = String(str);
        for (character in replace) {
            if (replace.hasOwnProperty(character)) {
                regex = new RegExp(character, 'g');
                str = str.replace(regex, replace[character]);
            }
        }
        return str;
    };

    /**
     * Translate strings to the page language or a given language.
     *
     *
     * @param str
     *   A string containing the English string to translate.
     *
     * @param options
     *   - 'context' (defaults to the default context): The context the source string
     *     belongs to.
     *
     * @return
     *   The translated string, escaped via i18n.methods.checkPlain()
     */
    i18n.methods.t = function (str, options) {

        // Fetch the localized version of the string.
        if (i18n.locale.strings && i18n.locale.strings[options.context] && i18n.locale.strings[options.context][str]) {
            str = i18n.locale.strings[options.context][str];
        }

        return i18n.methods.checkPlain(str);
    };


    /**
     * Wrapper for i18n.methods.t()
     *
     * @see i18n.methods.t()
     * @throws InvalidArgumentException
     */
    i18n.t = function(str, options) {

        if (typeof str === 'string' && str.length > 0) {

            // check every time due language can change for
            // different reasons (translation, lang switcher ..)
            var language = i18n.getLanguage();

            options = options || {
                "context" : language
            };

            return i18n.methods.t(str, options);
        }
        else {
            throw {
                "name" : 'InvalidArgumentException',
                "message" : 'First argument is either not a string or empty.'
            };
        }
    };

// end i18n
    exports.i18n = i18n;
}(document, mejs));

// i18n fixes for compatibility with WordPress
;(function(exports, undefined) {

    "use strict";

    if ( typeof mejsL10n != 'undefined' ) {
        exports[mejsL10n.language] = mejsL10n.strings;
    }

}(mejs.i18n.locale.strings));

/*!
 * This is a i18n.locale language object.
 *
 * German translation by Tim Latz, latz.tim@gmail.com
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
;(function(exports, undefined) {

    "use strict";

    if (typeof exports.de === 'undefined') {
        exports.de = {
            "Fullscreen" : "Vollbild",
            "Go Fullscreen" : "Vollbild an",
            "Turn off Fullscreen" : "Vollbild aus",
            "Close" : "Schließen"
        };
    }

}(mejs.i18n.locale.strings));
/*!
 * This is a i18n.locale language object.
 *
 * Traditional chinese translation by Tim Latz, latz.tim@gmail.com
 *
 * @author
 *   Tim Latz (latz.tim@gmail.com)
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
;(function(exports, undefined) {

    "use strict";

    if (typeof exports.zh === 'undefined') {
        exports.zh = {
            "Fullscreen" : "全螢幕",
            "Go Fullscreen" : "全屏模式",
            "Turn off Fullscreen" : "退出全屏模式",
            "Close" : "關閉"
        };
    }

}(mejs.i18n.locale.strings));


/*!
 * MediaElementPlayer
 * http://mediaelementjs.com/
 *
 * Creates a controller bar for HTML5 <video> add <audio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *
 * Copyright 2010-2013, John Dyer (http://j.hn/)
 * License: MIT
 *
 */
if (typeof jQuery != 'undefined') {
	mejs.$ = jQuery;
} else if (typeof ender != 'undefined') {
	mejs.$ = ender;
}
(function ($) {

	// default player values
	mejs.MepDefaults = {
		// url to poster (to fix iOS 3.x)
		poster: '',
		// When the video is ended, we can show the poster.
		showPosterWhenEnded: false,
		// default if the <video width> is not specified
		defaultVideoWidth: 480,
		// default if the <video height> is not specified
		defaultVideoHeight: 270,
		// if set, overrides <video width>
		videoWidth: -1,
		// if set, overrides <video height>
		videoHeight: -1,
		// default if the user doesn't specify
		defaultAudioWidth: 400,
		// default if the user doesn't specify
		defaultAudioHeight: 30,

		// default amount to move back when back key is pressed
		defaultSeekBackwardInterval: function(media) {
			return (media.duration * 0.05);
		},
		// default amount to move forward when forward key is pressed
		defaultSeekForwardInterval: function(media) {
			return (media.duration * 0.05);
		},

		// set dimensions via JS instead of CSS
		setDimensions: true,

		// width of audio player
		audioWidth: -1,
		// height of audio player
		audioHeight: -1,
		// initial volume when the player starts (overrided by user cookie)
		startVolume: 0.8,
		// useful for <audio> player loops
		loop: false,
		// rewind to beginning when media ends
                autoRewind: true,
		// resize to media dimensions
		enableAutosize: true,
		// forces the hour marker (##:00:00)
		alwaysShowHours: false,

		// show framecount in timecode (##:00:00:00)
		showTimecodeFrameCount: false,
		// used when showTimecodeFrameCount is set to true
		framesPerSecond: 25,

		// automatically calculate the width of the progress bar based on the sizes of other elements
		autosizeProgress : true,
		// Hide controls when playing and mouse is not over the video
		alwaysShowControls: false,
		// Display the video control
		hideVideoControlsOnLoad: false,
		// Enable click video element to toggle play/pause
		clickToPlayPause: true,
		// force iPad's native controls
		iPadUseNativeControls: false,
		// force iPhone's native controls
		iPhoneUseNativeControls: false,
		// force Android's native controls
		AndroidUseNativeControls: false,
		// features to show
		features: ['playpause','current','progress','duration','tracks','volume','fullscreen'],
		// only for dynamic
		isVideo: true,

		// turns keyboard support on and off for this instance
		enableKeyboard: true,

		// whenthis player starts, it will pause other players
		pauseOtherPlayers: true,

		// array of keyboard actions such as play pause
		keyActions: [
				{
						keys: [
								32, // SPACE
								179 // GOOGLE play/pause button
							  ],
						action: function(player, media) {
								if (media.paused || media.ended) {
										player.play();
								} else {
										player.pause();
								}
						}
				},
				{
						keys: [38], // UP
						action: function(player, media) {
								player.container.find('.mejs-volume-slider').css('display','block');
								if (player.isVideo) {
										player.showControls();
										player.startControlsTimer();
								}

								var newVolume = Math.min(media.volume + 0.1, 1);
								media.setVolume(newVolume);
						}
				},
				{
						keys: [40], // DOWN
						action: function(player, media) {
								player.container.find('.mejs-volume-slider').css('display','block');
								if (player.isVideo) {
										player.showControls();
										player.startControlsTimer();
								}

								var newVolume = Math.max(media.volume - 0.1, 0);
								media.setVolume(newVolume);
						}
				},
				{
						keys: [
								37, // LEFT
								227 // Google TV rewind
						],
						action: function(player, media) {
								if (!isNaN(media.duration) && media.duration > 0) {
										if (player.isVideo) {
												player.showControls();
												player.startControlsTimer();
										}

										// 5%
										var newTime = Math.max(media.currentTime - player.options.defaultSeekBackwardInterval(media), 0);
										media.setCurrentTime(newTime);
								}
						}
				},
				{
						keys: [
								39, // RIGHT
								228 // Google TV forward
						],
						action: function(player, media) {
								if (!isNaN(media.duration) && media.duration > 0) {
										if (player.isVideo) {
												player.showControls();
												player.startControlsTimer();
										}

										// 5%
										var newTime = Math.min(media.currentTime + player.options.defaultSeekForwardInterval(media), media.duration);
										media.setCurrentTime(newTime);
								}
						}
				},
				{
						keys: [70], // F
						action: function(player, media) {
								if (typeof player.enterFullScreen != 'undefined') {
										if (player.isFullScreen) {
												player.exitFullScreen();
										} else {
												player.enterFullScreen();
										}
								}
						}
				},
				{
						keys: [77], // M
						action: function(player, media) {
								player.container.find('.mejs-volume-slider').css('display','block');
								if (player.isVideo) {
										player.showControls();
										player.startControlsTimer();
								}
								if (player.media.muted) {
										player.setMuted(false);
								} else {
										player.setMuted(true);
								}
						}
				}
		]
	};

	mejs.mepIndex = 0;

	mejs.players = {};

	// wraps a MediaElement object in player controls
	mejs.MediaElementPlayer = function(node, o) {
		// enforce object, even without "new" (via John Resig)
		if ( !(this instanceof mejs.MediaElementPlayer) ) {
			return new mejs.MediaElementPlayer(node, o);
		}

		var t = this;

		// these will be reset after the MediaElement.success fires
		t.$media = t.$node = $(node);
		t.node = t.media = t.$media[0];

		// check for existing player
		if (typeof t.node.player != 'undefined') {
			return t.node.player;
		} else {
			// attach player to DOM node for reference
			t.node.player = t;
		}


		// try to get options from data-mejsoptions
		if (typeof o == 'undefined') {
			o = t.$node.data('mejsoptions');
		}

		// extend default options
		t.options = $.extend({},mejs.MepDefaults,o);

		// unique ID
		t.id = 'mep_' + mejs.mepIndex++;

		// add to player array (for focus events)
		mejs.players[t.id] = t;

		// start up
		t.init();

		return t;
	};

	// actual player
	mejs.MediaElementPlayer.prototype = {

		hasFocus: false,

		controlsAreVisible: true,

		init: function() {

			var
				t = this,
				mf = mejs.MediaFeatures,
				// options for MediaElement (shim)
				meOptions = $.extend(true, {}, t.options, {
					success: function(media, domNode) { t.meReady(media, domNode); },
					error: function(e) { t.handleError(e);}
				}),
				tagName = t.media.tagName.toLowerCase();

			t.isDynamic = (tagName !== 'audio' && tagName !== 'video');

			if (t.isDynamic) {
				// get video from src or href?
				t.isVideo = t.options.isVideo;
			} else {
				t.isVideo = (tagName !== 'audio' && t.options.isVideo);
			}

			// use native controls in iPad, iPhone, and Android
			if ((mf.isiPad && t.options.iPadUseNativeControls) || (mf.isiPhone && t.options.iPhoneUseNativeControls)) {

				// add controls and stop
				t.$media.attr('controls', 'controls');

				// attempt to fix iOS 3 bug
				//t.$media.removeAttr('poster');
                                // no Issue found on iOS3 -ttroxell

				// override Apple's autoplay override for iPads
				if (mf.isiPad && t.media.getAttribute('autoplay') !== null) {
					t.play();
				}

			} else if (mf.isAndroid && t.options.AndroidUseNativeControls) {

				// leave default player

			} else {

				// DESKTOP: use MediaElementPlayer controls

				// remove native controls
				t.$media.removeAttr('controls');

				// if (t.container.attr("video-background-homepage")){
				// 	console.log('hello');
				// }

				// build container
				var videoTakeOver = document.getElementById('video-background-homepage');
					if (videoTakeOver === null){ 
					  t.container =
						$('<div id="' + t.id + '" class="mejs-container ' + (mejs.MediaFeatures.svg ? 'svg' : 'no-svg') + '">'+
							'<div class="mejs-inner">'+
								'<div class="mejs-mediaelement"></div>'+
								'<div class="mejs-layers"></div>'+
								'<div class="mejs-controls"></div>'+
								'<div class="mejs-clear"></div>'+
							'</div>' +
						'</div>')
						.addClass(t.$media[0].className)
						.insertBefore(t.$media);
					}


				// add classes for user and content
				t.container.addClass(
					(mf.isAndroid ? 'mejs-android ' : '') +
					(mf.isiOS ? 'mejs-ios ' : '') +
					(mf.isiPad ? 'mejs-ipad ' : '') +
					(mf.isiPhone ? 'mejs-iphone ' : '') +
					(t.isVideo ? 'mejs-video ' : 'mejs-audio ')
				);


				// move the <video/video> tag into the right spot
				if (mf.isiOS) {

					// sadly, you can't move nodes in iOS, so we have to destroy and recreate it!
					var $newMedia = t.$media.clone();

					t.container.find('.mejs-mediaelement').append($newMedia);

					t.$media.remove();
					t.$node = t.$media = $newMedia;
					t.node = t.media = $newMedia[0]

				} else {

					// normal way of moving it into place (doesn't work on iOS)
					t.container.find('.mejs-mediaelement').append(t.$media);
				}

				// find parts
				t.controls = t.container.find('.mejs-controls');
				t.layers = t.container.find('.mejs-layers');

				// determine the size

				/* size priority:
					(1) videoWidth (forced),
					(2) style="width;height;"
					(3) width attribute,
					(4) defaultVideoWidth (for unspecified cases)
				*/

				var tagType = (t.isVideo ? 'video' : 'audio'),
					capsTagName = tagType.substring(0,1).toUpperCase() + tagType.substring(1);



				if (t.options[tagType + 'Width'] > 0 || t.options[tagType + 'Width'].toString().indexOf('%') > -1) {
					t.width = t.options[tagType + 'Width'];
				} else if (t.media.style.width !== '' && t.media.style.width !== null) {
					t.width = t.media.style.width;
				} else if (t.media.getAttribute('width') !== null) {
					t.width = t.$media.attr('width');
				} else {
					t.width = t.options['default' + capsTagName + 'Width'];
				}

				if (t.options[tagType + 'Height'] > 0 || t.options[tagType + 'Height'].toString().indexOf('%') > -1) {
					t.height = t.options[tagType + 'Height'];
				} else if (t.media.style.height !== '' && t.media.style.height !== null) {
					t.height = t.media.style.height;
				} else if (t.$media[0].getAttribute('height') !== null) {
					t.height = t.$media.attr('height');
				} else {
					t.height = t.options['default' + capsTagName + 'Height'];
				}

				// set the size, while we wait for the plugins to load below
				t.setPlayerSize(t.width, t.height);

				// create MediaElementShim
				meOptions.pluginWidth = t.width;
				meOptions.pluginHeight = t.height;
			}

			// create MediaElement shim
			mejs.MediaElement(t.$media[0], meOptions);

			if (typeof(t.container) != 'undefined' && t.controlsAreVisible){
			    // controls are shown when loaded
			    t.container.trigger('controlsshown');
			}
		},

		showControls: function(doAnimation) {
			var t = this;

			doAnimation = typeof doAnimation == 'undefined' || doAnimation;

			if (t.controlsAreVisible)
				return;

			if (doAnimation) {
				t.controls
					.css('visibility','visible')
					.stop(true, true).fadeIn(200, function() {
					      t.controlsAreVisible = true;
					      t.container.trigger('controlsshown');
					});

				// any additional controls people might add and want to hide
				t.container.find('.mejs-control')
					.css('visibility','visible')
					.stop(true, true).fadeIn(200, function() {t.controlsAreVisible = true;});

			} else {
				t.controls
					.css('visibility','visible')
					.css('display','block');

				// any additional controls people might add and want to hide
				t.container.find('.mejs-control')
					.css('visibility','visible')
					.css('display','block');

				t.controlsAreVisible = true;
				t.container.trigger('controlsshown');
			}

			t.setControlsSize();

		},

		hideControls: function(doAnimation) {
			var t = this;

			doAnimation = typeof doAnimation == 'undefined' || doAnimation;

			if (!t.controlsAreVisible || t.options.alwaysShowControls)
				return;

			if (doAnimation) {
				// fade out main controls
				t.controls.stop(true, true).fadeOut(200, function() {
					$(this)
						.css('visibility','hidden')
						.css('display','block');

					t.controlsAreVisible = false;
					t.container.trigger('controlshidden');
				});

				// any additional controls people might add and want to hide
				t.container.find('.mejs-control').stop(true, true).fadeOut(200, function() {
					$(this)
						.css('visibility','hidden')
						.css('display','block');
				});
			} else {

				// hide main controls
				t.controls
					.css('visibility','hidden')
					.css('display','block');

				// hide others
				t.container.find('.mejs-control')
					.css('visibility','hidden')
					.css('display','block');

				t.controlsAreVisible = false;
				t.container.trigger('controlshidden');
			}
		},

		controlsTimer: null,

		startControlsTimer: function(timeout) {

			var t = this;

			timeout = typeof timeout != 'undefined' ? timeout : 1500;

			t.killControlsTimer('start');

			t.controlsTimer = setTimeout(function() {
				//
				t.hideControls();
				t.killControlsTimer('hide');
			}, timeout);
		},

		killControlsTimer: function(src) {

			var t = this;

			if (t.controlsTimer !== null) {
				clearTimeout(t.controlsTimer);
				delete t.controlsTimer;
				t.controlsTimer = null;
			}
		},

		controlsEnabled: true,

		disableControls: function() {
			var t= this;

			t.killControlsTimer();
			t.hideControls(false);
			this.controlsEnabled = false;
		},

		enableControls: function() {
			var t= this;

			t.showControls(false);

			t.controlsEnabled = true;
		},


		// Sets up all controls and events
		meReady: function(media, domNode) {


			var t = this,
				mf = mejs.MediaFeatures,
				autoplayAttr = domNode.getAttribute('autoplay'),
				autoplay = !(typeof autoplayAttr == 'undefined' || autoplayAttr === null || autoplayAttr === 'false'),
				featureIndex,
				feature;

			// make sure it can't create itself again if a plugin reloads
			if (t.created) {
				return;
			} else {
				t.created = true;
			}

			t.media = media;
			t.domNode = domNode;

			if (!(mf.isAndroid && t.options.AndroidUseNativeControls) && !(mf.isiPad && t.options.iPadUseNativeControls) && !(mf.isiPhone && t.options.iPhoneUseNativeControls)) {

				// two built in features
				t.buildposter(t, t.controls, t.layers, t.media);
				t.buildkeyboard(t, t.controls, t.layers, t.media);
				t.buildoverlays(t, t.controls, t.layers, t.media);

				// grab for use by features
				t.findTracks();

				// add user-defined features/controls
				for (featureIndex in t.options.features) {
					feature = t.options.features[featureIndex];
					if (t['build' + feature]) {
						try {
							t['build' + feature](t, t.controls, t.layers, t.media);
						} catch (e) {
							// TODO: report control error
							//throw e;
							
							
						}
					}
				}

				t.container.trigger('controlsready');

				// reset all layers and controls
				t.setPlayerSize(t.width, t.height);
				t.setControlsSize();


				// controls fade
				if (t.isVideo) {

					if (mejs.MediaFeatures.hasTouch) {

						// for touch devices (iOS, Android)
						// show/hide without animation on touch

						t.$media.bind('touchstart', function() {


							// toggle controls
							if (t.controlsAreVisible) {
								t.hideControls(false);
							} else {
								if (t.controlsEnabled) {
									t.showControls(false);
								}
							}
						});

					} else {

						// create callback here since it needs access to current
						// MediaElement object
						t.clickToPlayPauseCallback = function() {
							//

							if (t.options.clickToPlayPause) {
								if (t.media.paused) {
									t.play();
								} else {
									t.pause();
								}
							}
						};

			            // click to play/pause
			            t.media.addEventListener('click', t.clickToPlayPauseCallback, false);

						// show/hide controls
						t.container
							.bind('mouseenter mouseover', function () {
								if (t.controlsEnabled) {
									if (!t.options.alwaysShowControls ) {
										t.killControlsTimer('enter');
										t.showControls();
										t.startControlsTimer(2500);
									}
								}
							})
							.bind('mousemove', function() {
								if (t.controlsEnabled) {
									if (!t.controlsAreVisible) {
										t.showControls();
									}
									if (!t.options.alwaysShowControls) {
										t.startControlsTimer(2500);
									}
								}
							})
							.bind('mouseleave', function () {
								if (t.controlsEnabled) {
									if (!t.media.paused && !t.options.alwaysShowControls) {
										t.startControlsTimer(1000);
									}
								}
							});
					}

					if(t.options.hideVideoControlsOnLoad) {
						t.hideControls(false);
					}

					// check for autoplay
					if (autoplay && !t.options.alwaysShowControls) {
						t.hideControls();
					}

					// resizer
					if (t.options.enableAutosize) {
						t.media.addEventListener('loadedmetadata', function(e) {
							// if the <video height> was not set and the options.videoHeight was not set
							// then resize to the real dimensions
							if (t.options.videoHeight <= 0 && t.domNode.getAttribute('height') === null && !isNaN(e.target.videoHeight)) {
								t.setPlayerSize(e.target.videoWidth, e.target.videoHeight);
								t.setControlsSize();
								t.media.setVideoSize(e.target.videoWidth, e.target.videoHeight);
							}
						}, false);
					}
				}

				// EVENTS

				// FOCUS: when a video starts playing, it takes focus from other players (possibily pausing them)
				media.addEventListener('play', function() {
					var playerIndex;

					// go through all other players
					for (playerIndex in mejs.players) {
						var p = mejs.players[playerIndex];
						if (p.id != t.id && t.options.pauseOtherPlayers && !p.paused && !p.ended) {
							p.pause();
						}
						p.hasFocus = false;
					}

					t.hasFocus = true;
				},false);


				// ended for all
				t.media.addEventListener('ended', function (e) {
					if(t.options.autoRewind) {
						try{
							t.media.setCurrentTime(0);
						} catch (exp) {

						}
					}
					t.media.pause();

					if (t.setProgressRail) {
						t.setProgressRail();
					}
					if (t.setCurrentRail) {
						t.setCurrentRail();
					}

					if (t.options.loop) {
						t.play();
					} else if (!t.options.alwaysShowControls && t.controlsEnabled) {
						t.showControls();
					}
				}, false);

				// resize on the first play
				t.media.addEventListener('loadedmetadata', function(e) {
					if (t.updateDuration) {
						t.updateDuration();
					}
					if (t.updateCurrent) {
						t.updateCurrent();
					}

					if (!t.isFullScreen) {
						t.setPlayerSize(t.width, t.height);
						t.setControlsSize();
					}
				}, false);


				// webkit has trouble doing this without a delay
				setTimeout(function () {
					t.setPlayerSize(t.width, t.height);
					t.setControlsSize();
				}, 50);

				// adjust controls whenever window sizes (used to be in fullscreen only)
				t.globalBind('resize', function() {

					// don't resize for fullscreen mode
					if ( !(t.isFullScreen || (mejs.MediaFeatures.hasTrueNativeFullScreen && document.webkitIsFullScreen)) ) {
						t.setPlayerSize(t.width, t.height);
					}

					// always adjust controls
					t.setControlsSize();
				});

				// TEMP: needs to be moved somewhere else
				if (t.media.pluginType == 'youtube' && t.options.autoplay) {
				//LOK-Soft: added t.options.autoplay to if -- I can only guess this is for hiding play button when autoplaying youtube, general hiding play button layer causes missing button on player load
					t.container.find('.mejs-overlay-play').hide();
				}
			}

			// force autoplay for HTML5
			if (autoplay && media.pluginType == 'native') {
				t.play();
			}


			if (t.options.success) {

				if (typeof t.options.success == 'string') {
					window[t.options.success](t.media, t.domNode, t);
				} else {
					t.options.success(t.media, t.domNode, t);
				}
			}
		},

		handleError: function(e) {
			var t = this;

			t.controls.hide();

			// Tell user that the file cannot be played
			if (t.options.error) {
				t.options.error(e);
			}
		},

		setPlayerSize: function(width,height) {
			var t = this;

			if( !t.options.setDimensions ) {
				return false;
			}

			if (typeof width != 'undefined') {
				t.width = width;
			}

			if (typeof height != 'undefined') {
				t.height = height;
			}

			// detect 100% mode - use currentStyle for IE since css() doesn't return percentages
			if (t.height.toString().indexOf('%') > 0 || t.$node.css('max-width') === '100%' || (t.$node[0].currentStyle && t.$node[0].currentStyle.maxWidth === '100%')) {

				// do we have the native dimensions yet?
				var nativeWidth = (function() {
					if (t.isVideo) {
						if (t.media.videoWidth && t.media.videoWidth > 0) {
							return t.media.videoWidth;
						} else if (t.media.getAttribute('width') !== null) {
							return t.media.getAttribute('width');
						} else {
							return t.options.defaultVideoWidth;
						}
					} else {
						return t.options.defaultAudioWidth;
					}
				})();

				var nativeHeight = (function() {
					if (t.isVideo) {
						if (t.media.videoHeight && t.media.videoHeight > 0) {
							return t.media.videoHeight;
						} else if (t.media.getAttribute('height') !== null) {
							return t.media.getAttribute('height');
						} else {
							return t.options.defaultVideoHeight;
						}
					} else {
						return t.options.defaultAudioHeight;
					}
				})();

				var
					parentWidth = t.container.parent().closest(':visible').width(),
					parentHeight = t.container.parent().closest(':visible').height(),
					newHeight = t.isVideo || !t.options.autosizeProgress ? parseInt(parentWidth * nativeHeight/nativeWidth, 10) : nativeHeight;

				// When we use percent, the newHeight can't be calculated so we get the container height
				if(isNaN(newHeight) || ( parentHeight != 0 && newHeight > parentHeight )) {
					newHeight = parentHeight;
				}

				if (t.container.parent()[0].tagName.toLowerCase() === 'body') { // && t.container.siblings().count == 0) {
					parentWidth = $(window).width();
					newHeight = $(window).height();
				}

				if ( newHeight != 0 && parentWidth != 0 ) {
					// set outer container size
					t.container
						.width(parentWidth)
						.height(newHeight);

					// set native <video> or <audio> and shims
					t.$media.add(t.container.find('.mejs-shim'))
						.width('100%')
						.height('100%');

					// if shim is ready, send the size to the embeded plugin
					if (t.isVideo) {
						if (t.media.setVideoSize) {
							t.media.setVideoSize(parentWidth, newHeight);
						}
					}

					// set the layers
					t.layers.children('.mejs-layer')
						.width('100%')
						.height('100%');
				}


			} else {

				t.container
					.width(t.width)
					.height(t.height);

				t.layers.children('.mejs-layer')
					.width(t.width)
					.height(t.height);

			}

			// special case for big play button so it doesn't go over the controls area
			var playLayer = t.layers.find('.mejs-overlay-play'),
				playButton = playLayer.find('.mejs-overlay-button');

			playLayer.height(t.container.height() - t.controls.height());
			playButton.css('margin-top', '-' + (playButton.height()/2 - t.controls.height()/2).toString() + 'px'  );

		},

		setControlsSize: function() {
			var t = this,
				usedWidth = 0,
				railWidth = 0,
				rail = t.controls.find('.mejs-time-rail'),
				total = t.controls.find('.mejs-time-total'),
				current = t.controls.find('.mejs-time-current'),
				loaded = t.controls.find('.mejs-time-loaded'),
				others = rail.siblings(),
				lastControl = others.last(),
				lastControlPosition = null;

			// skip calculation if hidden
			if (!t.container.is(':visible') || !rail.length || !rail.is(':visible')) {
				return;
			}


			// allow the size to come from custom CSS
			if (t.options && !t.options.autosizeProgress) {
				// Also, frontends devs can be more flexible
				// due the opportunity of absolute positioning.
				railWidth = parseInt(rail.css('width'));
			}

			// attempt to autosize
			if (railWidth === 0 || !railWidth) {

				// find the size of all the other controls besides the rail
				others.each(function() {
					var $this = $(this);
					if ($this.css('position') != 'absolute' && $this.is(':visible')) {
						usedWidth += $(this).outerWidth(true);
					}
				});

				// fit the rail into the remaining space
				railWidth = t.controls.width() - usedWidth - (rail.outerWidth(true) - rail.width());
			}

			// resize the rail,
			// but then check if the last control (say, the fullscreen button) got pushed down
			// this often happens when zoomed
			do {
				// outer area
				rail.width(railWidth);
				// dark space
				total.width(railWidth - (total.outerWidth(true) - total.width()));

				if (lastControl.css('position') != 'absolute') {
					lastControlPosition = lastControl.position();
					railWidth--;
				}
			} while (lastControlPosition != null && lastControlPosition.top > 0 && railWidth > 0);

			if (t.setProgressRail)
				t.setProgressRail();
			if (t.setCurrentRail)
				t.setCurrentRail();
		},


		buildposter: function(player, controls, layers, media) {
			var t = this,
				poster =
				$('<div class="mejs-poster mejs-layer">' +
				'</div>')
					.appendTo(layers),
				posterUrl = player.$media.attr('poster');

			// prioriy goes to option (this is useful if you need to support iOS 3.x (iOS completely fails with poster)
			if (player.options.poster !== '') {
				posterUrl = player.options.poster;
			}

			// second, try the real poster
			if (posterUrl !== '' && posterUrl != null) {
				t.setPoster(posterUrl);
			} else {
				poster.hide();
			}

			media.addEventListener('play',function() {
				poster.hide();
			}, false);

			if(player.options.showPosterWhenEnded && player.options.autoRewind){
				media.addEventListener('ended',function() {
					poster.show();
				}, false);
			}
		},

		setPoster: function(url) {
			var t = this,
				posterDiv = t.container.find('.mejs-poster'),
				posterImg = posterDiv.find('img');

			if (posterImg.length == 0) {
				posterImg = $('<img width="100%" height="100%" />').appendTo(posterDiv);
			}

			posterImg.attr('src', url);
			posterDiv.css({'background-image' : 'url(' + url + ')'});
		},

		buildoverlays: function(player, controls, layers, media) {
            var t = this;
			if (!player.isVideo)
				return;

			var
			loading =
				$('<div class="mejs-overlay mejs-layer">'+
					'<div class="mejs-overlay-loading"><span></span></div>'+
				'</div>')
				.hide() // start out hidden
				.appendTo(layers),
			error =
				$('<div class="mejs-overlay mejs-layer">'+
					'<div class="mejs-overlay-error"></div>'+
				'</div>')
				.hide() // start out hidden
				.appendTo(layers),
			// this needs to come last so it's on top
			bigPlay =
				$('<div class="mejs-overlay mejs-layer mejs-overlay-play">'+
					'<div class="mejs-overlay-button"></div>'+
				'</div>')
				.appendTo(layers)
				.bind('click', function() {  // Removed 'touchstart' due issues on Samsung Android devices where a tap on bigPlay started and immediately stopped the video
					if (t.options.clickToPlayPause) {
						if (media.paused) {
							media.play();
						}
					}
				});

			/*
			if (mejs.MediaFeatures.isiOS || mejs.MediaFeatures.isAndroid) {
				bigPlay.remove();
				loading.remove();
			}
			*/


			// show/hide big play button
			media.addEventListener('play',function() {
				bigPlay.hide();
				loading.hide();
				controls.find('.mejs-time-buffering').hide();
				error.hide();
			}, false);

			media.addEventListener('playing', function() {
				bigPlay.hide();
				loading.hide();
				controls.find('.mejs-time-buffering').hide();
				error.hide();
			}, false);

			media.addEventListener('seeking', function() {
				loading.show();
				controls.find('.mejs-time-buffering').show();
			}, false);

			media.addEventListener('seeked', function() {
				loading.hide();
				controls.find('.mejs-time-buffering').hide();
			}, false);

			media.addEventListener('pause',function() {
				if (!mejs.MediaFeatures.isiPhone) {
					bigPlay.show();
				}
			}, false);

			media.addEventListener('waiting', function() {
				loading.show();
				controls.find('.mejs-time-buffering').show();
			}, false);


			// show/hide loading
			media.addEventListener('loadeddata',function() {
				// for some reason Chrome is firing this event
				//if (mejs.MediaFeatures.isChrome && media.getAttribute && media.getAttribute('preload') === 'none')
				//	return;

				loading.show();
				controls.find('.mejs-time-buffering').show();
			}, false);
			media.addEventListener('canplay',function() {
				loading.hide();
				controls.find('.mejs-time-buffering').hide();
			}, false);

			// error handling
			media.addEventListener('error',function() {
				loading.hide();
				controls.find('.mejs-time-buffering').hide();
				error.show();
				error.find('mejs-overlay-error').html("Error loading this resource");
			}, false);

			media.addEventListener('keydown', function(e) {
				t.onkeydown(player, media, e);
			}, false);
		},

		buildkeyboard: function(player, controls, layers, media) {

				var t = this;

				// listen for key presses
				t.globalBind('keydown', function(e) {
					return t.onkeydown(player, media, e);
				});

				// check if someone clicked outside a player region, then kill its focus
				t.globalBind('click', function(event) {
					player.hasFocus = $(event.target).closest('.mejs-container').length != 0;
				});

		},
		onkeydown: function(player, media, e) {
			if (player.hasFocus && player.options.enableKeyboard) {
				// find a matching key
				for (var i = 0, il = player.options.keyActions.length; i < il; i++) {
					var keyAction = player.options.keyActions[i];

					for (var j = 0, jl = keyAction.keys.length; j < jl; j++) {
						if (e.keyCode == keyAction.keys[j]) {
							if (typeof(e.preventDefault) == "function") e.preventDefault();
							keyAction.action(player, media, e.keyCode);
							return false;
						}
					}
				}
			}

			return true;
		},

		findTracks: function() {
			var t = this,
				tracktags = t.$media.find('track');

			// store for use by plugins
			t.tracks = [];
			tracktags.each(function(index, track) {

				track = $(track);

				t.tracks.push({
					srclang: (track.attr('srclang')) ? track.attr('srclang').toLowerCase() : '',
					src: track.attr('src'),
					kind: track.attr('kind'),
					label: track.attr('label') || '',
					entries: [],
					isLoaded: false
				});
			});
		},
		changeSkin: function(className) {
			this.container[0].className = 'mejs-container ' + className;
			this.setPlayerSize(this.width, this.height);
			this.setControlsSize();
		},
		play: function() {
			this.load();
			this.media.play();
		},
		pause: function() {
			try {
				this.media.pause();
			} catch (e) {}
		},
		load: function() {
			if (!this.isLoaded) {
				this.media.load();
			}

			this.isLoaded = true;
		},
		setMuted: function(muted) {
			this.media.setMuted(muted);
		},
		setCurrentTime: function(time) {
			this.media.setCurrentTime(time);
		},
		getCurrentTime: function() {
			return this.media.currentTime;
		},
		setVolume: function(volume) {
			this.media.setVolume(volume);
		},
		getVolume: function() {
			return this.media.volume;
		},
		setSrc: function(src) {
			this.media.setSrc(src);
		},
		remove: function() {
			var t = this, featureIndex, feature;

			// invoke features cleanup
			for (featureIndex in t.options.features) {
				feature = t.options.features[featureIndex];
				if (t['clean' + feature]) {
					try {
						t['clean' + feature](t);
					} catch (e) {
						// TODO: report control error
						//throw e;
						//
						//
					}
				}
			}

			// grab video and put it back in place
			if (!t.isDynamic) {
				t.$media.prop('controls', true);
				// detach events from the video
				// TODO: detach event listeners better than this;
				//       also detach ONLY the events attached by this plugin!
				t.$node.clone().insertBefore(t.container).show();
				t.$node.remove();
			} else {
				t.$node.insertBefore(t.container);
			}

			if (t.media.pluginType !== 'native') {
				t.media.remove();
			}

			// Remove the player from the mejs.players object so that pauseOtherPlayers doesn't blow up when trying to pause a non existance flash api.
			delete mejs.players[t.id];

			if (typeof t.container == 'object') {
				t.container.remove();
			}
			t.globalUnbind();
			delete t.node.player;
		}
	};

	(function(){
		var rwindow = /^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;

		function splitEvents(events, id) {
			// add player ID as an event namespace so it's easier to unbind them all later
			var ret = {d: [], w: []};
			$.each((events || '').split(' '), function(k, v){
				var eventname = v + '.' + id;
				if (eventname.indexOf('.') === 0) {
					ret.d.push(eventname);
					ret.w.push(eventname);
				}
				else {
					ret[rwindow.test(v) ? 'w' : 'd'].push(eventname);
				}
			});
			ret.d = ret.d.join(' ');
			ret.w = ret.w.join(' ');
			return ret;
		}

		mejs.MediaElementPlayer.prototype.globalBind = function(events, data, callback) {
			var t = this;
			events = splitEvents(events, t.id);
			if (events.d) $(document).bind(events.d, data, callback);
			if (events.w) $(window).bind(events.w, data, callback);
		};

		mejs.MediaElementPlayer.prototype.globalUnbind = function(events, callback) {
			var t = this;
			events = splitEvents(events, t.id);
			if (events.d) $(document).unbind(events.d, callback);
			if (events.w) $(window).unbind(events.w, callback);
		};
	})();

	// turn into jQuery plugin
	if (typeof $ != 'undefined') {
		$.fn.mediaelementplayer = function (options) {
			if (options === false) {
				this.each(function () {
					var player = $(this).data('mediaelementplayer');
					if (player) {
						player.remove();
					}
					$(this).removeData('mediaelementplayer');
				});
			}
			else {
				this.each(function () {
					$(this).data('mediaelementplayer', new mejs.MediaElementPlayer(this, options));
				});
			}
			return this;
		};


		$(document).ready(function() {
			// auto enable using JSON attribute
			$('.mejs-player').mediaelementplayer();
		});
	}

	// push out to window
	window.MediaElementPlayer = mejs.MediaElementPlayer;

})(mejs.$);

(function($) {

	$.extend(mejs.MepDefaults, {
		playpauseText: mejs.i18n.t('Play/Pause')
	});

	// PLAY/pause BUTTON
	$.extend(MediaElementPlayer.prototype, {
		buildplaypause: function(player, controls, layers, media) {
			var 
				t = this,
				play = 
				$('<div class="mejs-button mejs-playpause-button mejs-play" >' +
					'<button type="button" aria-controls="' + t.id + '" title="' + t.options.playpauseText + '" aria-label="' + t.options.playpauseText + '"></button>' +
				'</div>')
				.appendTo(controls)
				.click(function(e) {
					e.preventDefault();
				
					if (media.paused) {
						media.play();
					} else {
						media.pause();
					}
					
					return false;
				});

			media.addEventListener('play',function() {
				play.removeClass('mejs-play').addClass('mejs-pause');
			}, false);
			media.addEventListener('playing',function() {
				play.removeClass('mejs-play').addClass('mejs-pause');
			}, false);


			media.addEventListener('pause',function() {
				play.removeClass('mejs-pause').addClass('mejs-play');
			}, false);
			media.addEventListener('paused',function() {
				play.removeClass('mejs-pause').addClass('mejs-play');
			}, false);
		}
	});
	
})(mejs.$);

(function($) {

	$.extend(mejs.MepDefaults, {
		stopText: 'Stop'
	});

	// STOP BUTTON
	$.extend(MediaElementPlayer.prototype, {
		buildstop: function(player, controls, layers, media) {
			var t = this,
				stop = 
				$('<div class="mejs-button mejs-stop-button mejs-stop">' +
					'<button type="button" aria-controls="' + t.id + '" title="' + t.options.stopText + '" aria-label="' + t.options.stopText + '"></button>' +
				'</div>')
				.appendTo(controls)
				.click(function() {
					if (!media.paused) {
						media.pause();
					}
					if (media.currentTime > 0) {
						media.setCurrentTime(0);
                        media.pause();
						controls.find('.mejs-time-current').width('0px');
						controls.find('.mejs-time-handle').css('left', '0px');
						controls.find('.mejs-time-float-current').html( mejs.Utility.secondsToTimeCode(0) );
						controls.find('.mejs-currenttime').html( mejs.Utility.secondsToTimeCode(0) );					
						layers.find('.mejs-poster').show();
					}
				});
		}
	});
	
})(mejs.$);

(function($) {
	// progress/loaded bar
	$.extend(MediaElementPlayer.prototype, {
		buildprogress: function(player, controls, layers, media) {

			$('<div class="mejs-time-rail">'+
				'<span class="mejs-time-total">'+
					'<span class="mejs-time-buffering"></span>'+
					'<span class="mejs-time-loaded"></span>'+
					'<span class="mejs-time-current"></span>'+
					'<span class="mejs-time-handle"></span>'+
					'<span class="mejs-time-float">' + 
						'<span class="mejs-time-float-current">00:00</span>' + 
						'<span class="mejs-time-float-corner"></span>' + 
					'</span>'+
				'</span>'+
			'</div>')
				.appendTo(controls);
				controls.find('.mejs-time-buffering').hide();

			var 
				t = this,
				total = controls.find('.mejs-time-total'),
				loaded  = controls.find('.mejs-time-loaded'),
				current  = controls.find('.mejs-time-current'),
				handle  = controls.find('.mejs-time-handle'),
				timefloat  = controls.find('.mejs-time-float'),
				timefloatcurrent  = controls.find('.mejs-time-float-current'),
				handleMouseMove = function (e) {
					// mouse or touch position relative to the object
					if (e.originalEvent.changedTouches) {
						var x = e.originalEvent.changedTouches[0].pageX;
					}else{
						var x = e.pageX;
					}
					
					var offset = total.offset(),
						width = total.outerWidth(true),
						percentage = 0,
						newTime = 0,
						pos = 0;


					if (media.duration) {
						if (x < offset.left) {
							x = offset.left;
						} else if (x > width + offset.left) {
							x = width + offset.left;
						}
						
						pos = x - offset.left;
						percentage = (pos / width);
						newTime = (percentage <= 0.02) ? 0 : percentage * media.duration;

						// seek to where the mouse is
						if (mouseIsDown && newTime !== media.currentTime) {
							media.setCurrentTime(newTime);
						}

						// position floating time box
						if (!mejs.MediaFeatures.hasTouch) {
								timefloat.css('left', pos);
								timefloatcurrent.html( mejs.Utility.secondsToTimeCode(newTime) );
								timefloat.show();
						}
					}
				},
				mouseIsDown = false,
				mouseIsOver = false;

			// handle clicks
			//controls.find('.mejs-time-rail').delegate('span', 'click', handleMouseMove);
			total
				.bind('mousedown touchstart', function (e) {
					// only handle left clicks or touch
					if (e.which === 1 || e.which === 0) {
						mouseIsDown = true;
						handleMouseMove(e);
						t.globalBind('mousemove.dur touchmove.dur', function(e) {
							handleMouseMove(e);
						});
						t.globalBind('mouseup.dur touchend.dur', function (e) {
							mouseIsDown = false;
							timefloat.hide();
							t.globalUnbind('.dur');
						});
						return false;
					}
				})
				.bind('mouseenter', function(e) {
					mouseIsOver = true;
					t.globalBind('mousemove.dur', function(e) {
						handleMouseMove(e);
					});
					if (!mejs.MediaFeatures.hasTouch) {
						timefloat.show();
					}
				})
				.bind('mouseleave',function(e) {
					mouseIsOver = false;
					if (!mouseIsDown) {
						t.globalUnbind('.dur');
						timefloat.hide();
					}
				});

			// loading
			media.addEventListener('progress', function (e) {
				player.setProgressRail(e);
				player.setCurrentRail(e);
			}, false);

			// current time
			media.addEventListener('timeupdate', function(e) {
				player.setProgressRail(e);
				player.setCurrentRail(e);
			}, false);
			
			
			// store for later use
			t.loaded = loaded;
			t.total = total;
			t.current = current;
			t.handle = handle;
		},
		setProgressRail: function(e) {

			var
				t = this,
				target = (e != undefined) ? e.target : t.media,
				percent = null;			

			// newest HTML5 spec has buffered array (FF4, Webkit)
			if (target && target.buffered && target.buffered.length > 0 && target.buffered.end && target.duration) {
				// TODO: account for a real array with multiple values (only Firefox 4 has this so far) 
				percent = target.buffered.end(0) / target.duration;
			} 
			// Some browsers (e.g., FF3.6 and Safari 5) cannot calculate target.bufferered.end()
			// to be anything other than 0. If the byte count is available we use this instead.
			// Browsers that support the else if do not seem to have the bufferedBytes value and
			// should skip to there. Tested in Safari 5, Webkit head, FF3.6, Chrome 6, IE 7/8.
			else if (target && target.bytesTotal != undefined && target.bytesTotal > 0 && target.bufferedBytes != undefined) {
				percent = target.bufferedBytes / target.bytesTotal;
			}
			// Firefox 3 with an Ogg file seems to go this way
			else if (e && e.lengthComputable && e.total != 0) {
				percent = e.loaded/e.total;
			}

			// finally update the progress bar
			if (percent !== null) {
				percent = Math.min(1, Math.max(0, percent));
				// update loaded bar
				if (t.loaded && t.total) {
					t.loaded.width(t.total.width() * percent);
				}
			}
		},
		setCurrentRail: function() {

			var t = this;
		
			if (t.media.currentTime != undefined && t.media.duration) {

				// update bar and handle
				if (t.total && t.handle) {
					var 
						newWidth = Math.round(t.total.width() * t.media.currentTime / t.media.duration),
						handlePos = newWidth - Math.round(t.handle.outerWidth(true) / 2);

					t.current.width(newWidth);
					t.handle.css('left', handlePos);
				}
			}

		}	
	});
})(mejs.$);

(function($) {
	
	// options
	$.extend(mejs.MepDefaults, {
		duration: -1,
		timeAndDurationSeparator: '<span> | </span>'
	});


	// current and duration 00:00 / 00:00
	$.extend(MediaElementPlayer.prototype, {
		buildcurrent: function(player, controls, layers, media) {
			var t = this;
			
			$('<div class="mejs-time">'+
					'<span class="mejs-currenttime">' + (player.options.alwaysShowHours ? '00:' : '')
					+ (player.options.showTimecodeFrameCount? '00:00:00':'00:00')+ '</span>'+
					'</div>')
					.appendTo(controls);
			
			t.currenttime = t.controls.find('.mejs-currenttime');

			media.addEventListener('timeupdate',function() {
				player.updateCurrent();
			}, false);
		},


		buildduration: function(player, controls, layers, media) {
			var t = this;
			
			if (controls.children().last().find('.mejs-currenttime').length > 0) {
				$(t.options.timeAndDurationSeparator +
					'<span class="mejs-duration">' + 
						(t.options.duration > 0 ? 
							mejs.Utility.secondsToTimeCode(t.options.duration, t.options.alwaysShowHours || t.media.duration > 3600, t.options.showTimecodeFrameCount,  t.options.framesPerSecond || 25) :
				   			((player.options.alwaysShowHours ? '00:' : '') + (player.options.showTimecodeFrameCount? '00:00:00':'00:00')) 
				   		) + 
					'</span>')
					.appendTo(controls.find('.mejs-time'));
			} else {

				// add class to current time
				controls.find('.mejs-currenttime').parent().addClass('mejs-currenttime-container');
				
				$('<div class="mejs-time mejs-duration-container">'+
					'<span class="mejs-duration">' + 
						(t.options.duration > 0 ? 
							mejs.Utility.secondsToTimeCode(t.options.duration, t.options.alwaysShowHours || t.media.duration > 3600, t.options.showTimecodeFrameCount,  t.options.framesPerSecond || 25) :
				   			((player.options.alwaysShowHours ? '00:' : '') + (player.options.showTimecodeFrameCount? '00:00:00':'00:00')) 
				   		) + 
					'</span>' +
				'</div>')
				.appendTo(controls);
			}
			
			t.durationD = t.controls.find('.mejs-duration');

			media.addEventListener('timeupdate',function() {
				player.updateDuration();
			}, false);
		},
		
		updateCurrent:  function() {
			var t = this;

			if (t.currenttime) {
				t.currenttime.html(mejs.Utility.secondsToTimeCode(t.media.currentTime, t.options.alwaysShowHours || t.media.duration > 3600, t.options.showTimecodeFrameCount,  t.options.framesPerSecond || 25));
			}
		},
		
		updateDuration: function() {
			var t = this;

			//Toggle the long video class if the video is longer than an hour.
			t.container.toggleClass("mejs-long-video", t.media.duration > 3600);
			
			if (t.durationD && (t.options.duration > 0 || t.media.duration)) {
				t.durationD.html(mejs.Utility.secondsToTimeCode(t.options.duration > 0 ? t.options.duration : t.media.duration, t.options.alwaysShowHours, t.options.showTimecodeFrameCount, t.options.framesPerSecond || 25));
			}		
		}
	});

})(mejs.$);

(function($) {

	$.extend(mejs.MepDefaults, {
		muteText: mejs.i18n.t('Mute Toggle'),
		hideVolumeOnTouchDevices: true,
		
		audioVolume: 'horizontal',
		videoVolume: 'vertical'
	});

	$.extend(MediaElementPlayer.prototype, {
		buildvolume: function(player, controls, layers, media) {
				
			// Android and iOS don't support volume controls
			if ((mejs.MediaFeatures.isAndroid || mejs.MediaFeatures.isiOS) && this.options.hideVolumeOnTouchDevices)
				return;
			
			var t = this,
				mode = (t.isVideo) ? t.options.videoVolume : t.options.audioVolume,
				mute = (mode == 'horizontal') ?
				
				// horizontal version
				$('<div class="mejs-button mejs-volume-button mejs-mute">'+
					'<button type="button" aria-controls="' + t.id + '" title="' + t.options.muteText + '" aria-label="' + t.options.muteText + '"></button>'+
				'</div>' +
				'<div class="mejs-horizontal-volume-slider">'+ // outer background
					'<div class="mejs-horizontal-volume-total"></div>'+ // line background
					'<div class="mejs-horizontal-volume-current"></div>'+ // current volume
					'<div class="mejs-horizontal-volume-handle"></div>'+ // handle
				'</div>'
				)
					.appendTo(controls) :
				
				// vertical version
				$('<div class="mejs-button mejs-volume-button mejs-mute">'+
					'<button type="button" aria-controls="' + t.id + '" title="' + t.options.muteText + '" aria-label="' + t.options.muteText + '"></button>'+
					'<div class="mejs-volume-slider">'+ // outer background
						'<div class="mejs-volume-total"></div>'+ // line background
						'<div class="mejs-volume-current"></div>'+ // current volume
						'<div class="mejs-volume-handle"></div>'+ // handle
					'</div>'+
				'</div>')
					.appendTo(controls),
			volumeSlider = t.container.find('.mejs-volume-slider, .mejs-horizontal-volume-slider'),
			volumeTotal = t.container.find('.mejs-volume-total, .mejs-horizontal-volume-total'),
			volumeCurrent = t.container.find('.mejs-volume-current, .mejs-horizontal-volume-current'),
			volumeHandle = t.container.find('.mejs-volume-handle, .mejs-horizontal-volume-handle'),

			positionVolumeHandle = function(volume, secondTry) {

				if (!volumeSlider.is(':visible') && typeof secondTry == 'undefined') {
					volumeSlider.show();
					positionVolumeHandle(volume, true);
					volumeSlider.hide()
					return;
				}
			
				// correct to 0-1
				volume = Math.max(0,volume);
				volume = Math.min(volume,1);					
				
				// ajust mute button style
				if (volume == 0) {
					mute.removeClass('mejs-mute').addClass('mejs-unmute');
				} else {
					mute.removeClass('mejs-unmute').addClass('mejs-mute');
				}				

				// position slider 
				if (mode == 'vertical') {
					var 
					
						// height of the full size volume slider background
						totalHeight = volumeTotal.height(),
						
						// top/left of full size volume slider background
						totalPosition = volumeTotal.position(),
						
						// the new top position based on the current volume
						// 70% volume on 100px height == top:30px
						newTop = totalHeight - (totalHeight * volume);
	
					// handle
					volumeHandle.css('top', Math.round(totalPosition.top + newTop - (volumeHandle.height() / 2)));
	
					// show the current visibility
					volumeCurrent.height(totalHeight - newTop );
					volumeCurrent.css('top', totalPosition.top + newTop);
				} else {
					var 
					
						// height of the full size volume slider background
						totalWidth = volumeTotal.width(),
						
						// top/left of full size volume slider background
						totalPosition = volumeTotal.position(),
						
						// the new left position based on the current volume
						newLeft = totalWidth * volume;
	
					// handle
					volumeHandle.css('left', Math.round(totalPosition.left + newLeft - (volumeHandle.width() / 2)));
	
					// rezize the current part of the volume bar
					volumeCurrent.width( Math.round(newLeft) );
				}
			},
			handleVolumeMove = function(e) {
				
				var volume = null,
					totalOffset = volumeTotal.offset();
				
				// calculate the new volume based on the moust position
				if (mode == 'vertical') {
				
					var
						railHeight = volumeTotal.height(),
						totalTop = parseInt(volumeTotal.css('top').replace(/px/,''),10),
						newY = e.pageY - totalOffset.top;
						
					volume = (railHeight - newY) / railHeight;
						
					// the controls just hide themselves (usually when mouse moves too far up)
					if (totalOffset.top == 0 || totalOffset.left == 0)
						return;
					
				} else {
					var
						railWidth = volumeTotal.width(),
						newX = e.pageX - totalOffset.left;
						
					volume = newX / railWidth;
				}
				
				// ensure the volume isn't outside 0-1
				volume = Math.max(0,volume);
				volume = Math.min(volume,1);
				
				// position the slider and handle			
				positionVolumeHandle(volume);
				
				// set the media object (this will trigger the volumechanged event)
				if (volume == 0) {
					media.setMuted(true);
				} else {
					media.setMuted(false);
				}
				media.setVolume(volume);			
			},
			mouseIsDown = false,
			mouseIsOver = false;

			// SLIDER
			
			mute
				.hover(function() {
					volumeSlider.show();
					mouseIsOver = true;
				}, function() {
					mouseIsOver = false;	
						
					if (!mouseIsDown && mode == 'vertical')	{
						volumeSlider.hide();
					}
				});
			
			volumeSlider
				.bind('mouseover', function() {
					mouseIsOver = true;	
				})
				.bind('mousedown', function (e) {
					handleVolumeMove(e);
					t.globalBind('mousemove.vol', function(e) {
						handleVolumeMove(e);
					});
					t.globalBind('mouseup.vol', function () {
						mouseIsDown = false;
						t.globalUnbind('.vol');

						if (!mouseIsOver && mode == 'vertical') {
							volumeSlider.hide();
						}
					});
					mouseIsDown = true;
						
					return false;
				});


			// MUTE button
			mute.find('button').click(function() {
				media.setMuted( !media.muted );
			});

			// listen for volume change events from other sources
			media.addEventListener('volumechange', function(e) {
				if (!mouseIsDown) {
					if (media.muted) {
						positionVolumeHandle(0);
						mute.removeClass('mejs-mute').addClass('mejs-unmute');
					} else {
						positionVolumeHandle(media.volume);
						mute.removeClass('mejs-unmute').addClass('mejs-mute');
					}
				}
			}, false);

			if (t.container.is(':visible')) {
				// set initial volume
				positionVolumeHandle(player.options.startVolume);

				// mutes the media and sets the volume icon muted if the initial volume is set to 0
        if (player.options.startVolume === 0) {
          media.setMuted(true);
        }

				// shim gets the startvolume as a parameter, but we have to set it on the native <video> and <audio> elements
				if (media.pluginType === 'native') {
					media.setVolume(player.options.startVolume);
				}
			}
		}
	});
	
})(mejs.$);

(function($) {

	$.extend(mejs.MepDefaults, {
		usePluginFullScreen: true,
		newWindowCallback: function() { return '';},
		fullscreenText: mejs.i18n.t('Fullscreen')
	});

	$.extend(MediaElementPlayer.prototype, {

		isFullScreen: false,

		isNativeFullScreen: false,

		isInIframe: false,

		buildfullscreen: function(player, controls, layers, media) {

			if (!player.isVideo)
				return;

			player.isInIframe = (window.location != window.parent.location);

			// native events
			if (mejs.MediaFeatures.hasTrueNativeFullScreen) {

				// chrome doesn't alays fire this in an iframe
				var func = function(e) {
					if (player.isFullScreen) {
						if (mejs.MediaFeatures.isFullScreen()) {
							player.isNativeFullScreen = true;
							// reset the controls once we are fully in full screen
							player.setControlsSize();
						} else {
							player.isNativeFullScreen = false;
							// when a user presses ESC
							// make sure to put the player back into place
							player.exitFullScreen();
						}
					}
				};

				player.globalBind(mejs.MediaFeatures.fullScreenEventName, func);
			}

			var t = this,
				normalHeight = 0,
				normalWidth = 0,
				container = player.container,
				fullscreenBtn =
					$('<div class="mejs-button mejs-fullscreen-button">' +
						'<button type="button" aria-controls="' + t.id + '" title="' + t.options.fullscreenText + '" aria-label="' + t.options.fullscreenText + '"></button>' +
					'</div>')
					.appendTo(controls);

				if (t.media.pluginType === 'native' || (!t.options.usePluginFullScreen && !mejs.MediaFeatures.isFirefox)) {

					fullscreenBtn.click(function() {
						var isFullScreen = (mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen()) || player.isFullScreen;

						if (isFullScreen) {
							player.exitFullScreen();
						} else {
							player.enterFullScreen();
						}
					});

				} else {

					var hideTimeout = null,
						supportsPointerEvents = (function() {
							// TAKEN FROM MODERNIZR
							var element = document.createElement('x'),
								documentElement = document.documentElement,
								getComputedStyle = window.getComputedStyle,
								supports;
							if(!('pointerEvents' in element.style)){
								return false;
							}
							element.style.pointerEvents = 'auto';
							element.style.pointerEvents = 'x';
							documentElement.appendChild(element);
							supports = getComputedStyle &&
								getComputedStyle(element, '').pointerEvents === 'auto';
							documentElement.removeChild(element);
							return !!supports;
						})();

					//

					if (supportsPointerEvents && !mejs.MediaFeatures.isOpera) { // opera doesn't allow this :(

						// allows clicking through the fullscreen button and controls down directly to Flash

						/*
						 When a user puts his mouse over the fullscreen button, the controls are disabled
						 So we put a div over the video and another one on iether side of the fullscreen button
						 that caputre mouse movement
						 and restore the controls once the mouse moves outside of the fullscreen button
						*/

						var fullscreenIsDisabled = false,
							restoreControls = function() {
								if (fullscreenIsDisabled) {
									// hide the hovers
									for (var i in hoverDivs) {
										hoverDivs[i].hide();
									}

									// restore the control bar
									fullscreenBtn.css('pointer-events', '');
									t.controls.css('pointer-events', '');

									// prevent clicks from pausing video
									t.media.removeEventListener('click', t.clickToPlayPauseCallback);

									// store for later
									fullscreenIsDisabled = false;
								}
							},
							hoverDivs = {},
							hoverDivNames = ['top', 'left', 'right', 'bottom'],
							i, len,
							positionHoverDivs = function() {
								var fullScreenBtnOffsetLeft = fullscreenBtn.offset().left - t.container.offset().left,
									fullScreenBtnOffsetTop = fullscreenBtn.offset().top - t.container.offset().top,
									fullScreenBtnWidth = fullscreenBtn.outerWidth(true),
									fullScreenBtnHeight = fullscreenBtn.outerHeight(true),
									containerWidth = t.container.width(),
									containerHeight = t.container.height();

								for (i in hoverDivs) {
									hoverDivs[i].css({position: 'absolute', top: 0, left: 0}); //, backgroundColor: '#f00'});
								}

								// over video, but not controls
								hoverDivs['top']
									.width( containerWidth )
									.height( fullScreenBtnOffsetTop );

								// over controls, but not the fullscreen button
								hoverDivs['left']
									.width( fullScreenBtnOffsetLeft )
									.height( fullScreenBtnHeight )
									.css({top: fullScreenBtnOffsetTop});

								// after the fullscreen button
								hoverDivs['right']
									.width( containerWidth - fullScreenBtnOffsetLeft - fullScreenBtnWidth )
									.height( fullScreenBtnHeight )
									.css({top: fullScreenBtnOffsetTop,
										 left: fullScreenBtnOffsetLeft + fullScreenBtnWidth});

								// under the fullscreen button
								hoverDivs['bottom']
									.width( containerWidth )
									.height( containerHeight - fullScreenBtnHeight - fullScreenBtnOffsetTop )
									.css({top: fullScreenBtnOffsetTop + fullScreenBtnHeight});
							};

						t.globalBind('resize', function() {
							positionHoverDivs();
						});

						for (i = 0, len = hoverDivNames.length; i < len; i++) {
							hoverDivs[hoverDivNames[i]] = $('<div class="mejs-fullscreen-hover" />').appendTo(t.container).mouseover(restoreControls).hide();
						}

						// on hover, kill the fullscreen button's HTML handling, allowing clicks down to Flash
						fullscreenBtn.on('mouseover',function() {

							if (!t.isFullScreen) {

								var buttonPos = fullscreenBtn.offset(),
									containerPos = player.container.offset();

								// move the button in Flash into place
								media.positionFullscreenButton(buttonPos.left - containerPos.left, buttonPos.top - containerPos.top, false);

								// allows click through
								fullscreenBtn.css('pointer-events', 'none');
								t.controls.css('pointer-events', 'none');

								// restore click-to-play
								t.media.addEventListener('click', t.clickToPlayPauseCallback);

								// show the divs that will restore things
								for (i in hoverDivs) {
									hoverDivs[i].show();
								}

								positionHoverDivs();

								fullscreenIsDisabled = true;
							}

						});

						// restore controls anytime the user enters or leaves fullscreen
						media.addEventListener('fullscreenchange', function(e) {
							t.isFullScreen = !t.isFullScreen;
							// don't allow plugin click to pause video - messes with
							// plugin's controls
							if (t.isFullScreen) {
								t.media.removeEventListener('click', t.clickToPlayPauseCallback);
							} else {
								t.media.addEventListener('click', t.clickToPlayPauseCallback);
							}
							restoreControls();
						});


						// the mouseout event doesn't work on the fullscren button, because we already killed the pointer-events
						// so we use the document.mousemove event to restore controls when the mouse moves outside the fullscreen button

						t.globalBind('mousemove', function(e) {

							// if the mouse is anywhere but the fullsceen button, then restore it all
							if (fullscreenIsDisabled) {

								var fullscreenBtnPos = fullscreenBtn.offset();


								if (e.pageY < fullscreenBtnPos.top || e.pageY > fullscreenBtnPos.top + fullscreenBtn.outerHeight(true) ||
									e.pageX < fullscreenBtnPos.left || e.pageX > fullscreenBtnPos.left + fullscreenBtn.outerWidth(true)
									) {

									fullscreenBtn.css('pointer-events', '');
									t.controls.css('pointer-events', '');

									fullscreenIsDisabled = false;
								}
							}
						});



					} else {

						// the hover state will show the fullscreen button in Flash to hover up and click

						fullscreenBtn
							.on('mouseover', function() {

								if (hideTimeout !== null) {
									clearTimeout(hideTimeout);
									delete hideTimeout;
								}

								var buttonPos = fullscreenBtn.offset(),
									containerPos = player.container.offset();

								media.positionFullscreenButton(buttonPos.left - containerPos.left, buttonPos.top - containerPos.top, true);

							})
							.on('mouseout', function() {

								if (hideTimeout !== null) {
									clearTimeout(hideTimeout);
									delete hideTimeout;
								}

								hideTimeout = setTimeout(function() {
									media.hideFullscreenButton();
								}, 1500);


							});
					}
				}

			player.fullscreenBtn = fullscreenBtn;

			t.globalBind('keydown',function (e) {
				if (((mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen()) || t.isFullScreen) && e.keyCode == 27) {
					player.exitFullScreen();
				}
			});

		},

		cleanfullscreen: function(player) {
			player.exitFullScreen();
		},

        containerSizeTimeout: null,

		enterFullScreen: function() {

			var t = this;

			// firefox+flash can't adjust plugin sizes without resetting :(
			if (t.media.pluginType !== 'native' && (mejs.MediaFeatures.isFirefox || t.options.usePluginFullScreen)) {
				//t.media.setFullscreen(true);
				//player.isFullScreen = true;
				return;
			}

			// set it to not show scroll bars so 100% will work
            $(document.documentElement).addClass('mejs-fullscreen');

			// store sizing
			normalHeight = t.container.height();
			normalWidth = t.container.width();

			// attempt to do true fullscreen (Safari 5.1 and Firefox Nightly only for now)
			if (t.media.pluginType === 'native') {
				if (mejs.MediaFeatures.hasTrueNativeFullScreen) {

					mejs.MediaFeatures.requestFullScreen(t.container[0]);
					//return;

					if (t.isInIframe) {
						// sometimes exiting from fullscreen doesn't work
						// notably in Chrome <iframe>. Fixed in version 17
						setTimeout(function checkFullscreen() {

							if (t.isNativeFullScreen) {
								var zoomMultiplier = window["devicePixelRatio"] || 1;
								// Use a percent error margin since devicePixelRatio is a float and not exact.
								var percentErrorMargin = 0.002; // 0.2%
								var windowWidth = zoomMultiplier * $(window).width();
								var screenWidth = screen.width;
								var absDiff = Math.abs(screenWidth - windowWidth);
								var marginError = screenWidth * percentErrorMargin;

								// check if the video is suddenly not really fullscreen
								if (absDiff > marginError) {
									// manually exit
									t.exitFullScreen();
								} else {
									// test again
									setTimeout(checkFullscreen, 500);
								}
							}


						}, 500);
					}

				} else if (mejs.MediaFeatures.hasSemiNativeFullScreen) {
					t.media.webkitEnterFullscreen();
					return;
				}
			}

			// check for iframe launch
			if (t.isInIframe) {
				var url = t.options.newWindowCallback(this);


				if (url !== '') {

					// launch immediately
					if (!mejs.MediaFeatures.hasTrueNativeFullScreen) {
						t.pause();
						window.open(url, t.id, 'top=0,left=0,width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=yes,scrollbars=no,status=no,toolbar=no');
						return;
					} else {
						setTimeout(function() {
							if (!t.isNativeFullScreen) {
								t.pause();
								window.open(url, t.id, 'top=0,left=0,width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=yes,scrollbars=no,status=no,toolbar=no');
							}
						}, 250);
					}
				}

			}

			// full window code



			// make full size
			t.container
				.addClass('mejs-container-fullscreen')
				.width('100%')
				.height('100%');
				//.css({position: 'fixed', left: 0, top: 0, right: 0, bottom: 0, overflow: 'hidden', width: '100%', height: '100%', 'z-index': 1000});

			// Only needed for safari 5.1 native full screen, can cause display issues elsewhere
			// Actually, it seems to be needed for IE8, too
			//if (mejs.MediaFeatures.hasTrueNativeFullScreen) {
				t.containerSizeTimeout = setTimeout(function() {
					t.container.css({width: '100%', height: '100%'});
					t.setControlsSize();
				}, 500);
			//}

			if (t.media.pluginType === 'native') {
				t.$media
					.width('100%')
					.height('100%');
			} else {
				t.container.find('.mejs-shim')
					.width('100%')
					.height('100%');

				//if (!mejs.MediaFeatures.hasTrueNativeFullScreen) {
					t.media.setVideoSize($(window).width(),$(window).height());
				//}
			}

			t.layers.children('div')
				.width('100%')
				.height('100%');

			if (t.fullscreenBtn) {
				t.fullscreenBtn
					.removeClass('mejs-fullscreen')
					.addClass('mejs-unfullscreen');
			}

			t.setControlsSize();
			t.isFullScreen = true;

			t.container.find('.mejs-captions-text').css('font-size', screen.width / t.width * 1.00 * 100 + '%');
			t.container.find('.mejs-captions-position').css('bottom', '45px');
		},

		exitFullScreen: function() {

			var t = this;

            // Prevent container from attempting to stretch a second time
            clearTimeout(t.containerSizeTimeout);

			// firefox can't adjust plugins
			if (t.media.pluginType !== 'native' && mejs.MediaFeatures.isFirefox) {
				t.media.setFullscreen(false);
				//player.isFullScreen = false;
				return;
			}

			// come outo of native fullscreen
			if (mejs.MediaFeatures.hasTrueNativeFullScreen && (mejs.MediaFeatures.isFullScreen() || t.isFullScreen)) {
				mejs.MediaFeatures.cancelFullScreen();
			}

			// restore scroll bars to document
            $(document.documentElement).removeClass('mejs-fullscreen');

			t.container
				.removeClass('mejs-container-fullscreen')
				.width(normalWidth)
				.height(normalHeight);
				//.css({position: '', left: '', top: '', right: '', bottom: '', overflow: 'inherit', width: normalWidth + 'px', height: normalHeight + 'px', 'z-index': 1});

			if (t.media.pluginType === 'native') {
				t.$media
					.width(normalWidth)
					.height(normalHeight);
			} else {
				t.container.find('.mejs-shim')
					.width(normalWidth)
					.height(normalHeight);

				t.media.setVideoSize(normalWidth, normalHeight);
			}

			t.layers.children('div')
				.width(normalWidth)
				.height(normalHeight);

			t.fullscreenBtn
				.removeClass('mejs-unfullscreen')
				.addClass('mejs-fullscreen');

			t.setControlsSize();
			t.isFullScreen = false;

			t.container.find('.mejs-captions-text').css('font-size','');
			t.container.find('.mejs-captions-position').css('bottom', '');
		}
	});

})(mejs.$);

(function($) {

	// Speed
	$.extend(mejs.MepDefaults, {

		speeds: ['1.50', '1.25', '1.00', '0.75'],

		defaultSpeed: '1.00'

	});

	$.extend(MediaElementPlayer.prototype, {

		buildspeed: function(player, controls, layers, media) {
			var t = this;

			if (t.media.pluginType == 'native') {
				var s = '<div class="mejs-button mejs-speed-button"><button type="button">'+t.options.defaultSpeed+'x</button><div class="mejs-speed-selector"><ul>';
				var i, ss;

				if ($.inArray(t.options.defaultSpeed, t.options.speeds) === -1) {
					t.options.speeds.push(t.options.defaultSpeed);
				}

				t.options.speeds.sort(function(a, b) {
					return parseFloat(b) - parseFloat(a);
				});

				for (i = 0; i < t.options.speeds.length; i++) {
					s += '<li><input type="radio" name="speed" value="' + t.options.speeds[i] + '" id="' + t.options.speeds[i] + '" ';
					if (t.options.speeds[i] == t.options.defaultSpeed) {
						s += 'checked=true ';
						s += '/><label for="' + t.options.speeds[i] + '" class="mejs-speed-selected">'+ t.options.speeds[i] + 'x</label></li>';
					} else {
						s += '/><label for="' + t.options.speeds[i] + '">'+ t.options.speeds[i] + 'x</label></li>';
					}
				}
				s += '</ul></div></div>';

				player.speedButton = $(s).appendTo(controls);

				player.playbackspeed = t.options.defaultSpeed;

				player.speedButton
				.on('click', 'input[type=radio]', function() {
					player.playbackspeed = $(this).attr('value');
					media.playbackRate = parseFloat(player.playbackspeed);
					player.speedButton.find('button').text(player.playbackspeed + 'x');
					player.speedButton.find('.mejs-speed-selected').removeClass('mejs-speed-selected');
					player.speedButton.find('input[type=radio]:checked').next().addClass('mejs-speed-selected');
				});

				ss = player.speedButton.find('.mejs-speed-selector');
				ss.height(this.speedButton.find('.mejs-speed-selector ul').outerHeight(true) + player.speedButton.find('.mejs-speed-translations').outerHeight(true));
				ss.css('top', (-1 * ss.height()) + 'px');
			}
		}
	});

})(mejs.$);

(function($) {

	// add extra default options
	$.extend(mejs.MepDefaults, {
		// this will automatically turn on a <track>
		startLanguage: '',

		tracksText: mejs.i18n.t('Captions/Subtitles'),

		// option to remove the [cc] button when no <track kind="subtitles"> are present
		hideCaptionsButtonWhenEmpty: true,

		// If true and we only have one track, change captions to popup
		toggleCaptionsButtonWhenOnlyOne: false,

		// #id or .class
		slidesSelector: ''
	});

	$.extend(MediaElementPlayer.prototype, {

		hasChapters: false,

		buildtracks: function(player, controls, layers, media) {
			if (player.tracks.length === 0)
				return;

			var t = this,
				i,
				options = '';

			if (t.domNode.textTracks) { // if browser will do native captions, prefer mejs captions, loop through tracks and hide
				for (i = t.domNode.textTracks.length - 1; i >= 0; i--) {
					t.domNode.textTracks[i].mode = "hidden";
				}
			}
			player.chapters =
					$('<div class="mejs-chapters mejs-layer"></div>')
						.prependTo(layers).hide();
			player.captions =
					$('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>')
						.prependTo(layers).hide();
			player.captionsText = player.captions.find('.mejs-captions-text');
			player.captionsButton =
					$('<div class="mejs-button mejs-captions-button">'+
						'<button type="button" aria-controls="' + t.id + '" title="' + t.options.tracksText + '" aria-label="' + t.options.tracksText + '"></button>'+
						'<div class="mejs-captions-selector">'+
							'<ul>'+
								'<li>'+
									'<input type="radio" name="' + player.id + '_captions" id="' + player.id + '_captions_none" value="none" checked="checked" />' +
									'<label for="' + player.id + '_captions_none">' + mejs.i18n.t('None') +'</label>'+
								'</li>'	+
							'</ul>'+
						'</div>'+
					'</div>')
						.appendTo(controls);


			var subtitleCount = 0;
			for (i=0; i<player.tracks.length; i++) {
				if (player.tracks[i].kind == 'subtitles') {
					subtitleCount++;
				}
			}

			// if only one language then just make the button a toggle
			if (t.options.toggleCaptionsButtonWhenOnlyOne && subtitleCount == 1){
				// click
				player.captionsButton.on('click',function() {
					if (player.selectedTrack === null) {
						lang = player.tracks[0].srclang;
					} else {
						lang = 'none';
					}
					player.setTrack(lang);
				});
			} else {
				// hover or keyboard focus
				player.captionsButton.on( 'mouseenter focusin', function() {
					$(this).find('.mejs-captions-selector').css('visibility','visible');
				})

				// handle clicks to the language radio buttons
				.on('click','input[type=radio]',function() {
					lang = this.value;
					player.setTrack(lang);
				});

				player.captionsButton.on( 'mouseleave focusout', function() {
					$(this).find(".mejs-captions-selector").css("visibility","hidden");
				});

			}

			if (!player.options.alwaysShowControls) {
				// move with controls
				player.container
					.bind('controlsshown', function () {
						// push captions above controls
						player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');

					})
					.bind('controlshidden', function () {
						if (!media.paused) {
							// move back to normal place
							player.container.find('.mejs-captions-position').removeClass('mejs-captions-position-hover');
						}
					});
			} else {
				player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');
			}

			player.trackToLoad = -1;
			player.selectedTrack = null;
			player.isLoadingTrack = false;

			// add to list
			for (i=0; i<player.tracks.length; i++) {
				if (player.tracks[i].kind == 'subtitles') {
					player.addTrackButton(player.tracks[i].srclang, player.tracks[i].label);
				}
			}

			// start loading tracks
			player.loadNextTrack();

			media.addEventListener('timeupdate',function(e) {
				player.displayCaptions();
			}, false);

			if (player.options.slidesSelector !== '') {
				player.slidesContainer = $(player.options.slidesSelector);

				media.addEventListener('timeupdate',function(e) {
					player.displaySlides();
				}, false);

			}

			media.addEventListener('loadedmetadata', function(e) {
				player.displayChapters();
			}, false);

			player.container.hover(
				function () {
					// chapters
					if (player.hasChapters) {
						player.chapters.css('visibility','visible');
						player.chapters.fadeIn(200).height(player.chapters.find('.mejs-chapter').outerHeight());
					}
				},
				function () {
					if (player.hasChapters && !media.paused) {
						player.chapters.fadeOut(200, function() {
							$(this).css('visibility','hidden');
							$(this).css('display','block');
						});
					}
				});

			// check for autoplay
			if (player.node.getAttribute('autoplay') !== null) {
				player.chapters.css('visibility','hidden');
			}
		},

		setTrack: function(lang){

			var t = this,
				i;

			if (lang == 'none') {
				t.selectedTrack = null;
				t.captionsButton.removeClass('mejs-captions-enabled');
			} else {
				for (i=0; i<t.tracks.length; i++) {
					if (t.tracks[i].srclang == lang) {
						if (t.selectedTrack === null)
							t.captionsButton.addClass('mejs-captions-enabled');
						t.selectedTrack = t.tracks[i];
						t.captions.attr('lang', t.selectedTrack.srclang);
						t.displayCaptions();
						break;
					}
				}
			}
		},

		loadNextTrack: function() {
			var t = this;

			t.trackToLoad++;
			if (t.trackToLoad < t.tracks.length) {
				t.isLoadingTrack = true;
				t.loadTrack(t.trackToLoad);
			} else {
				// add done?
				t.isLoadingTrack = false;

				t.checkForTracks();
			}
		},

		loadTrack: function(index){
			var
				t = this,
				track = t.tracks[index],
				after = function() {

					track.isLoaded = true;

					// create button
					//t.addTrackButton(track.srclang);
					t.enableTrackButton(track.srclang, track.label);

					t.loadNextTrack();

				};


			$.ajax({
				url: track.src,
				dataType: "text",
				success: function(d) {

					// parse the loaded file
					if (typeof d == "string" && (/<tt\s+xml/ig).exec(d)) {
						track.entries = mejs.TrackFormatParser.dfxp.parse(d);
					} else {
						track.entries = mejs.TrackFormatParser.webvtt.parse(d);
					}

					after();

					if (track.kind == 'chapters') {
						t.media.addEventListener('play', function(e) {
							if (t.media.duration > 0) {
								t.displayChapters(track);
							}
						}, false);
					}

					if (track.kind == 'slides') {
						t.setupSlides(track);
					}
				},
				error: function() {
					t.loadNextTrack();
				}
			});
		},

		enableTrackButton: function(lang, label) {
			var t = this;

			if (label === '') {
				label = mejs.language.codes[lang] || lang;
			}

			t.captionsButton
				.find('input[value=' + lang + ']')
					.prop('disabled',false)
				.siblings('label')
					.html( label );

			// auto select
			if (t.options.startLanguage == lang) {
				$('#' + t.id + '_captions_' + lang).prop('checked', true).trigger('click');
			}

			t.adjustLanguageBox();
		},

		addTrackButton: function(lang, label) {
			var t = this;
			if (label === '') {
				label = mejs.language.codes[lang] || lang;
			}

			t.captionsButton.find('ul').append(
				$('<li>'+
					'<input type="radio" name="' + t.id + '_captions" id="' + t.id + '_captions_' + lang + '" value="' + lang + '" disabled="disabled" />' +
					'<label for="' + t.id + '_captions_' + lang + '">' + label + ' (loading)' + '</label>'+
				'</li>')
			);

			t.adjustLanguageBox();

			// remove this from the dropdownlist (if it exists)
			t.container.find('.mejs-captions-translations option[value=' + lang + ']').remove();
		},

		adjustLanguageBox:function() {
			var t = this;
			// adjust the size of the outer box
			t.captionsButton.find('.mejs-captions-selector').height(
				t.captionsButton.find('.mejs-captions-selector ul').outerHeight(true) +
				t.captionsButton.find('.mejs-captions-translations').outerHeight(true)
			);
		},

		checkForTracks: function() {
			var
				t = this,
				hasSubtitles = false;

			// check if any subtitles
			if (t.options.hideCaptionsButtonWhenEmpty) {
				for (i=0; i<t.tracks.length; i++) {
					if (t.tracks[i].kind == 'subtitles') {
						hasSubtitles = true;
						break;
					}
				}

				if (!hasSubtitles) {
					t.captionsButton.hide();
					t.setControlsSize();
				}
			}
		},

		displayCaptions: function() {

			if (typeof this.tracks == 'undefined')
				return;

			var
				t = this,
				i,
				track = t.selectedTrack;

			if (track !== null && track.isLoaded) {
				for (i=0; i<track.entries.times.length; i++) {
					if (t.media.currentTime >= track.entries.times[i].start && t.media.currentTime <= track.entries.times[i].stop) {
						// Set the line before the timecode as a class so the cue can be targeted if needed
						t.captionsText.html(track.entries.text[i]).attr('class', 'mejs-captions-text ' + (track.entries.times[i].identifier || ''));
						t.captions.show().height(0);
						return; // exit out if one is visible;
					}
				}
				t.captions.hide();
			} else {
				t.captions.hide();
			}
		},

		setupSlides: function(track) {
			var t = this;

			t.slides = track;
			t.slides.entries.imgs = [t.slides.entries.text.length];
			t.showSlide(0);

		},

		showSlide: function(index) {
			if (typeof this.tracks == 'undefined' || typeof this.slidesContainer == 'undefined') {
				return;
			}

			var t = this,
				url = t.slides.entries.text[index],
				img = t.slides.entries.imgs[index];

			if (typeof img == 'undefined' || typeof img.fadeIn == 'undefined') {

				t.slides.entries.imgs[index] = img = $('<img src="' + url + '">')
						.on('load', function() {
							img.appendTo(t.slidesContainer)
								.hide()
								.fadeIn()
								.siblings(':visible')
									.fadeOut();

						});

			} else {

				if (!img.is(':visible') && !img.is(':animated')) {

					//

					img.fadeIn()
						.siblings(':visible')
							.fadeOut();
				}
			}

		},

		displaySlides: function() {

			if (typeof this.slides == 'undefined')
				return;

			var
				t = this,
				slides = t.slides,
				i;

			for (i=0; i<slides.entries.times.length; i++) {
				if (t.media.currentTime >= slides.entries.times[i].start && t.media.currentTime <= slides.entries.times[i].stop){

					t.showSlide(i);

					return; // exit out if one is visible;
				}
			}
		},

		displayChapters: function() {
			var
				t = this,
				i;

			for (i=0; i<t.tracks.length; i++) {
				if (t.tracks[i].kind == 'chapters' && t.tracks[i].isLoaded) {
					t.drawChapters(t.tracks[i]);
					t.hasChapters = true;
					break;
				}
			}
		},

		drawChapters: function(chapters) {
			var
				t = this,
				i,
				dur,
				//width,
				//left,
				percent = 0,
				usedPercent = 0;

			t.chapters.empty();

			for (i=0; i<chapters.entries.times.length; i++) {
				dur = chapters.entries.times[i].stop - chapters.entries.times[i].start;
				percent = Math.floor(dur / t.media.duration * 100);
				if (percent + usedPercent > 100 || // too large
					i == chapters.entries.times.length-1 && percent + usedPercent < 100) // not going to fill it in
					{
					percent = 100 - usedPercent;
				}
				//width = Math.floor(t.width * dur / t.media.duration);
				//left = Math.floor(t.width * chapters.entries.times[i].start / t.media.duration);
				//if (left + width > t.width) {
				//	width = t.width - left;
				//}

				t.chapters.append( $(
					'<div class="mejs-chapter" rel="' + chapters.entries.times[i].start + '" style="left: ' + usedPercent.toString() + '%;width: ' + percent.toString() + '%;">' +
						'<div class="mejs-chapter-block' + ((i==chapters.entries.times.length-1) ? ' mejs-chapter-block-last' : '') + '">' +
							'<span class="ch-title">' + chapters.entries.text[i] + '</span>' +
							'<span class="ch-time">' + mejs.Utility.secondsToTimeCode(chapters.entries.times[i].start) + '&ndash;' + mejs.Utility.secondsToTimeCode(chapters.entries.times[i].stop) + '</span>' +
						'</div>' +
					'</div>'));
				usedPercent += percent;
			}

			t.chapters.find('div.mejs-chapter').click(function() {
				t.media.setCurrentTime( parseFloat( $(this).attr('rel') ) );
				if (t.media.paused) {
					t.media.play();
				}
			});

			t.chapters.show();
		}
	});



	mejs.language = {
		codes:  {
			af:'Afrikaans',
			sq:'Albanian',
			ar:'Arabic',
			be:'Belarusian',
			bg:'Bulgarian',
			ca:'Catalan',
			zh:'Chinese',
			'zh-cn':'Chinese Simplified',
			'zh-tw':'Chinese Traditional',
			hr:'Croatian',
			cs:'Czech',
			da:'Danish',
			nl:'Dutch',
			en:'English',
			et:'Estonian',
			fl:'Filipino',
			fi:'Finnish',
			fr:'French',
			gl:'Galician',
			de:'German',
			el:'Greek',
			ht:'Haitian Creole',
			iw:'Hebrew',
			hi:'Hindi',
			hu:'Hungarian',
			is:'Icelandic',
			id:'Indonesian',
			ga:'Irish',
			it:'Italian',
			ja:'Japanese',
			ko:'Korean',
			lv:'Latvian',
			lt:'Lithuanian',
			mk:'Macedonian',
			ms:'Malay',
			mt:'Maltese',
			no:'Norwegian',
			fa:'Persian',
			pl:'Polish',
			pt:'Portuguese',
			// 'pt-pt':'Portuguese (Portugal)',
			ro:'Romanian',
			ru:'Russian',
			sr:'Serbian',
			sk:'Slovak',
			sl:'Slovenian',
			es:'Spanish',
			sw:'Swahili',
			sv:'Swedish',
			tl:'Tagalog',
			th:'Thai',
			tr:'Turkish',
			uk:'Ukrainian',
			vi:'Vietnamese',
			cy:'Welsh',
			yi:'Yiddish'
		}
	};

	/*
	Parses WebVTT format which should be formatted as
	================================
	WEBVTT

	1
	00:00:01,1 --> 00:00:05,000
	A line of text

	2
	00:01:15,1 --> 00:02:05,000
	A second line of text

	===============================

	Adapted from: http://www.delphiki.com/html5/playr
	*/
	mejs.TrackFormatParser = {
		webvtt: {
			pattern_timecode: /^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,

			parse: function(trackText) {
				var
					i = 0,
					lines = mejs.TrackFormatParser.split2(trackText, /\r?\n/),
					entries = {text:[], times:[]},
					timecode,
					text,
					identifier;
				for(; i<lines.length; i++) {
					timecode = this.pattern_timecode.exec(lines[i]);

					if (timecode && i<lines.length) {
						if ((i - 1) >= 0 && lines[i - 1] !== '') {
							identifier = lines[i - 1];
						}
						i++;
						// grab all the (possibly multi-line) text that follows
						text = lines[i];
						i++;
						while(lines[i] !== '' && i<lines.length){
							text = text + '\n' + lines[i];
							i++;
						}
						text = $.trim(text).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a href='$1' target='_blank'>$1</a>");
						// Text is in a different array so I can use .join
						entries.text.push(text);
						entries.times.push(
						{
							identifier: identifier,
							start: (mejs.Utility.convertSMPTEtoSeconds(timecode[1]) === 0) ? 0.200 : mejs.Utility.convertSMPTEtoSeconds(timecode[1]),
							stop: mejs.Utility.convertSMPTEtoSeconds(timecode[3]),
							settings: timecode[5]
						});
					}
					identifier = '';
				}
				return entries;
			}
		},
		// Thanks to Justin Capella: https://github.com/johndyer/mediaelement/pull/420
		dfxp: {
			parse: function(trackText) {
				trackText = $(trackText).filter("tt");
				var
					i = 0,
					container = trackText.children("div").eq(0),
					lines = container.find("p"),
					styleNode = trackText.find("#" + container.attr("style")),
					styles,
					begin,
					end,
					text,
					entries = {text:[], times:[]};


				if (styleNode.length) {
					var attributes = styleNode.removeAttr("id").get(0).attributes;
					if (attributes.length) {
						styles = {};
						for (i = 0; i < attributes.length; i++) {
							styles[attributes[i].name.split(":")[1]] = attributes[i].value;
						}
					}
				}

				for(i = 0; i<lines.length; i++) {
					var style;
					var _temp_times = {
						start: null,
						stop: null,
						style: null
					};
					if (lines.eq(i).attr("begin")) _temp_times.start = mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("begin"));
					if (!_temp_times.start && lines.eq(i-1).attr("end")) _temp_times.start = mejs.Utility.convertSMPTEtoSeconds(lines.eq(i-1).attr("end"));
					if (lines.eq(i).attr("end")) _temp_times.stop = mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("end"));
					if (!_temp_times.stop && lines.eq(i+1).attr("begin")) _temp_times.stop = mejs.Utility.convertSMPTEtoSeconds(lines.eq(i+1).attr("begin"));
					if (styles) {
						style = "";
						for (var _style in styles) {
							style += _style + ":" + styles[_style] + ";";
						}
					}
					if (style) _temp_times.style = style;
					if (_temp_times.start === 0) _temp_times.start = 0.200;
					entries.times.push(_temp_times);
					text = $.trim(lines.eq(i).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a href='$1' target='_blank'>$1</a>");
					entries.text.push(text);
					if (entries.times.start === 0) entries.times.start = 2;
				}
				return entries;
			}
		},
		split2: function (text, regex) {
			// normal version for compliant browsers
			// see below for IE fix
			return text.split(regex);
		}
	};

	// test for browsers with bad String.split method.
	if ('x\n\ny'.split(/\n/gi).length != 3) {
		// add super slow IE8 and below version
		mejs.TrackFormatParser.split2 = function(text, regex) {
			var
				parts = [],
				chunk = '',
				i;

			for (i=0; i<text.length; i++) {
				chunk += text.substring(i,i+1);
				if (regex.test(chunk)) {
					parts.push(chunk.replace(regex, ''));
					chunk = '';
				}
			}
			parts.push(chunk);
			return parts;
		};
	}

})(mejs.$);

/*
* ContextMenu Plugin
* 
*
*/

(function($) {

$.extend(mejs.MepDefaults,
	{ 'contextMenuItems': [
		// demo of a fullscreen option
		{ 
			render: function(player) {
				
				// check for fullscreen plugin
				if (typeof player.enterFullScreen == 'undefined')
					return null;
			
				if (player.isFullScreen) {
					return mejs.i18n.t('Turn off Fullscreen');
				} else {
					return mejs.i18n.t('Go Fullscreen');
				}
			},
			click: function(player) {
				if (player.isFullScreen) {
					player.exitFullScreen();
				} else {
					player.enterFullScreen();
				}
			}
		}
		,
		// demo of a mute/unmute button
		{ 
			render: function(player) {
				if (player.media.muted) {
					return mejs.i18n.t('Unmute');
				} else {
					return mejs.i18n.t('Mute');
				}
			},
			click: function(player) {
				if (player.media.muted) {
					player.setMuted(false);
				} else {
					player.setMuted(true);
				}
			}
		},
		// separator
		{
			isSeparator: true
		}
		,
		// demo of simple download video
		{ 
			render: function(player) {
				return mejs.i18n.t('Download Video');
			},
			click: function(player) {
				window.location.href = player.media.currentSrc;
			}
		}	
	]}
);


	$.extend(MediaElementPlayer.prototype, {
		buildcontextmenu: function(player, controls, layers, media) {
			
			// create context menu
			player.contextMenu = $('<div class="mejs-contextmenu"></div>')
								.appendTo($('body'))
								.hide();
			
			// create events for showing context menu
			player.container.bind('contextmenu', function(e) {
				if (player.isContextMenuEnabled) {
					e.preventDefault();
					player.renderContextMenu(e.clientX-1, e.clientY-1);
					return false;
				}
			});
			player.container.bind('click', function() {
				player.contextMenu.hide();
			});	
			player.contextMenu.bind('mouseleave', function() {

				//
				player.startContextMenuTimer();
				
			});		
		},

		cleancontextmenu: function(player) {
			player.contextMenu.remove();
		},
		
		isContextMenuEnabled: true,
		enableContextMenu: function() {
			this.isContextMenuEnabled = true;
		},
		disableContextMenu: function() {
			this.isContextMenuEnabled = false;
		},
		
		contextMenuTimeout: null,
		startContextMenuTimer: function() {
			//
			
			var t = this;
			
			t.killContextMenuTimer();
			
			t.contextMenuTimer = setTimeout(function() {
				t.hideContextMenu();
				t.killContextMenuTimer();
			}, 750);
		},
		killContextMenuTimer: function() {
			var timer = this.contextMenuTimer;
			
			//
			
			if (timer != null) {				
				clearTimeout(timer);
				delete timer;
				timer = null;
			}
		},		
		
		hideContextMenu: function() {
			this.contextMenu.hide();
		},
		
		renderContextMenu: function(x,y) {
			
			// alway re-render the items so that things like "turn fullscreen on" and "turn fullscreen off" are always written correctly
			var t = this,
				html = '',
				items = t.options.contextMenuItems;
			
			for (var i=0, il=items.length; i<il; i++) {
				
				if (items[i].isSeparator) {
					html += '<div class="mejs-contextmenu-separator"></div>';
				} else {
				
					var rendered = items[i].render(t);
				
					// render can return null if the item doesn't need to be used at the moment
					if (rendered != null) {
						html += '<div class="mejs-contextmenu-item" data-itemindex="' + i + '" id="element-' + (Math.random()*1000000) + '">' + rendered + '</div>';
					}
				}
			}
			
			// position and show the context menu
			t.contextMenu
				.empty()
				.append($(html))
				.css({top:y, left:x})
				.show();
				
			// bind events
			t.contextMenu.find('.mejs-contextmenu-item').each(function() {
							
				// which one is this?
				var $dom = $(this),
					itemIndex = parseInt( $dom.data('itemindex'), 10 ),
					item = t.options.contextMenuItems[itemIndex];
				
				// bind extra functionality?
				if (typeof item.show != 'undefined')
					item.show( $dom , t);
				
				// bind click action
				$dom.click(function() {			
					// perform click action
					if (typeof item.click != 'undefined')
						item.click(t);
					
					// close
					t.contextMenu.hide();				
				});				
			});	
			
			// stop the controls from hiding
			setTimeout(function() {
				t.killControlsTimer('rev3');	
			}, 100);
						
		}
	});
	
})(mejs.$);
/**
 * Postroll plugin
 */
(function($) {

	$.extend(mejs.MepDefaults, {
		postrollCloseText: mejs.i18n.t('Close')
	});

	// Postroll
	$.extend(MediaElementPlayer.prototype, {
		buildpostroll: function(player, controls, layers, media) {
			var
				t = this,
				postrollLink = t.container.find('link[rel="postroll"]').attr('href');

			if (typeof postrollLink !== 'undefined') {
				player.postroll =
					$('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">' + t.options.postrollCloseText + '</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(layers).hide();

				t.media.addEventListener('ended', function (e) {
					$.ajax({
						dataType: 'html',
						url: postrollLink,
						success: function (data, textStatus) {
							layers.find('.mejs-postroll-layer-content').html(data);
						}
					});
					player.postroll.show();
				}, false);
			}
		}
	});

})(mejs.$);


// For Map Locator

gmarkers = new Array();
var globapMap;
var itemClicked;
var jsonData = $.ajax({
    url: "/bin/cimbgroup/dailyQueueTrend",
    dataType: "json",
    async: false
}).responseText;

var rawData = JSON.parse(jsonData),
    mainData = rawData.dailyQueueTrend,
    brnclsMsg = rawData.branchClosedMessage,
    bankData;
lastUptime = rawData.lastUpdatedTime;



$(function () {
    $(".hide-branch-list-btn").click(function () {
        var obj = $(this)
        $(".branch-list ul").slideToggle(function () {

            if ($(this).is(":hidden")) {
                obj.removeClass("active");
            } else {
                obj.addClass("active");
            }
        })
    })

    $(".branch-tab:not(.hide-branch-list-btn)").click(function () {

        $(this).addClass("selected")
        $(".branch-list").slideDown()
        $(".atm-tab").removeClass("selected");

        relocate('branch');
    })

    $(".atm-tab").click(function () {
        $(".branch-list ul").slideUp()
        $(this).addClass("selected")
        $(".branch-list").slideUp("normal", function () {
            $(".hide-branch-list-btn").removeClass("active");
        })
        $(".branch-tab").removeClass("selected")

        relocate('atm');
    });

    function relocate(currentlocation) {
        for (var i = 0; i < gmarkers.length; i++) {
            //console.log(gmarkers[i]);
            var thisMarker = gmarkers[i];
            var thisMarkerType = thisMarker.markerType;
            var thisMarkerAddress = thisMarker.markerAddress;
            var thisMarkerSvcType = thisMarker.markerSvcType;

            thisMarkerSvcType = thisMarkerSvcType.replace(/-/g, " ");
            var selectedSvcTypeArr = selectedServiceTypes.split(",");
            selectedSvcTypeArr.splice(-1, 1);
            var correctState = false;
            var hasSvcTypes = false;

            if (thisMarkerAddress.indexOf(selectedState) > -1) {
                correctState = true;
            } else correctState = false;
            for (var j = 0; j < selectedSvcTypeArr.length; j++) {
                var selectedSvcType = selectedSvcTypeArr[j].toLowerCase();
                if (thisMarkerSvcType.indexOf(selectedSvcType) > -1) {
                    //OR logic
                    hasSvcTypes = true;
                }
            }

            if (thisMarkerType != currentlocation || !correctState) {
                thisMarker.setMap(null);
            } else if (thisMarkerType === currentlocation || correctState) {
                if (thisMarkerType === "branch" && hasSvcTypes) {
                    thisMarker.setMap(map);
                } else if (thisMarkerType === "branch" && !hasSvcTypes) thisMarker.setMap(null);
                else if (thisMarkerType === "atm") thisMarker.setMap(map);
            }
        }
    }

    if (!("latlng" in window)) {
        latlng = "";
    }
    $(document).ready(function () {
        if (hasMapLocator) {
            relocate('branch');
            map.setZoom(15);
            map.setCenter(latlng);
        }

    });

    //Determine if theres map locator component because top nav uses google map api also but without the map.
    var maplocatorclass = $('.map-locator');
    var hasMapLocator = false;
    if (maplocatorclass.length > 0) {
        hasMapLocator = true;
    } else hasMapLocator = false;

    //Run getLocation only if there is map locator, else other pages throw reference error.
    if (hasMapLocator) {
        getLocation();
    }

    function getLocation() {
        if (navigator.geolocation) {
            //Temporarily disabled to always show default location
            //navigator.geolocation.getCurrentPosition(showPosition,showError);
            return;
        } else {
            return;
        }

    }

    function showPosition(position) {
        myLat = position.coords.latitude;
        myLong = position.coords.longitude;
        var yourPlaceIcon = imagePath + 'yourplace.png';

        var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            icon: yourPlaceIcon,
            zIndex: 10
        });

        map.setZoom(15);
        map.setCenter(latlng);
    }

    function showError(error) {
        switch (error.code) {
            case error.PERMISSION_DENIED:
                //x.innerHTML="User denied the request for Geolocation."
                break;
            case error.POSITION_UNAVAILABLE:
                //x.innerHTML="Location information is unavailable."
                break;
            case error.TIMEOUT:
                //x.innerHTML="The request to get user location timed out."
                break;
            case error.UNKNOWN_ERROR:
                //x.innerHTML="An unknown error occurred."
                break;
        }
    }

    $('select').change(function () {
        var selectedTab;
        var selectedState = $('select option:selected').val();
        $('.service-tab').each(function () {
            if ($(this).hasClass("selected")) {
                selectedTab = $(this).find('span.service-text').text().toLowerCase();
            }
        });
        relocate(selectedTab);
    });

    //latlng is defined in component
    if (!latlng) {
        latlng = new google.maps.LatLng(3.15399379362, 101.696470209);
    } else {
        var latlngArr = latlng.split(",");
        var userlat = latlngArr[0];
        var userlng = latlngArr[1];
        latlng = new google.maps.LatLng(userlat, userlng);
    }

    var myOptions = {
        map: map,
        zoom: 5,
        minZoom: 2,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        panControl: false,
        zoomControl: true,
        mapTypeControl: false,
        scaleControl: true,
        streetViewControl: true,
        navigationControl: true
    };
    //Render map only if there is map locator class, else other page will throw error.
    if (hasMapLocator) {
        var map = new google.maps.Map(document.getElementById("map"), myOptions);
        var geocoder = new google.maps.Geocoder();
        var infowindow = new google.maps.InfoWindow();

        globapMap = map;

        var marker, i;

        for (i = 0; i < markerLocations.length; i++) {
            //console.log(markerLocations[i]);
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(markerLocations[i][1], markerLocations[i][2]),
                map: map,
                icon: imagePath + markerLocations[i][8],
                zIndex: 10,
                markerType: markerLocations[i][7],
                markerAddress: markerLocations[i][3],
                markerSvcType: markerLocations[i][9]
            });

            if(i=== 0){
                console.log( markerLocations[i])
            }

            const jsDays = [ "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            var weekdays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
            const today = weekdays.indexOf(jsDays[new Date().getDay()]);

            if(markerLocations[i][10] != "undefined"){
                google.maps.event.addListener(marker, 'click', (function (marker, i) {
                    return function () {

                        // NEED TO CHANGE
                        var bCode = markerLocations[i][10];
                        //var bCode = '0133';

                        bankData = undefined;

                        for (var j = 0; j < mainData.length; j++) {
                            var a = parseInt(bCode),
                                b = parseInt(mainData[j].branchCode);
                            if (a == b) {
                                bankData = mainData[j];
                            }
                        }

                        regex = /<br\s*[\/]?>/gi;
                        markerLocation = markerLocations[i][3].replace(regex, '');

                        //Individual Pop Up Content
                        var popTel = "";
                        var popFax = "";
                        var popOperating = "";
                        var branchCode = "";

                        if (markerLocations[i][4].replace(/\<br \/\>/g, "").length > 0) {
                            popTel = "<p><label>" + telLabel + "</label>" + markerLocations[i][4] + "</p>";
                        }
                        if (markerLocations[i][5].replace(/\<br \/\>/g, "").length > 0) {
                            popFax = "<p><label>" + faxLabel + "</label>" + markerLocations[i][5] + "</p>";
                        }
                        if (bankData !== undefined ){
                            if (bankData.openingTime && bankData.closingTime) {
                                var popOperatingContent = "<p>" + bankData.openingTime + ' - ' + bankData.closingTime +' '+ bankData.workingDays[0] + ' - ' + bankData.workingDays[bankData.workingDays.length-1] +"</p>";
                                popOperating = "<h6><strong>" + operatingLabel + "</strong></h6>" + popOperatingContent;
                            }
                        }

                        //Added for QMS
                        if(markerLocations[i][10] != "undefined"){
                            branchCode = markerLocations[i][10];
                        }

                        if(bankData !== undefined){

                            //Set pop up marker contents
                            infowindow.setContent(
                                "<div class='map-popup'>" +
                                "<h5>" + markerLocations[i][0] + "</h5>" +
                                "<div class='map-popup-content'>" +
                                "<p>" + markerLocations[i][3] + "</p>" +
                                "<div class='map-popup-contact'>" +
                                popTel +
                                popFax +
                                "</div>" +
                                popOperating +
                                "<p><a href='javascript:void(0);' onclick=\"callExternalLinks('http://maps.google.com/maps?saddr=&daddr='+markerLocation)\">" + directionsLabel + " &raquo;</a></p>" +
                                "<hr>" + //New code added for Chart
                                "<div class='owl-carousel qms_list'>" +
                                "<div><p>Number of people waiting for <span>Monday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div1'></div></div>" +
                                "<div><p>Number of people waiting for <span>Tuesday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div2'></div></div>" +
                                "<div><p>Number of people waiting for <span>Wednesday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div3'></div></div>" +
                                "<div><p>Number of people waiting for <span>Thursday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div4'></div></div>" +
                                "<div><p>Number of people waiting for <span>Friday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div5'></div></div>" +
                                "<div><p>Number of people waiting for <span>Saturday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div6'></div></div>" +
                                "<div><p>Number of people waiting for <span>Sunday</span><br><small>Tap to see number of people waiting</small></p><div id='chart_div7'></div></div>" +
                                "</div>" +
                                "<p class='last-time'><span></span></p>" +
                                "</div>" +
                                "</div>"
                            );

                        }else{
                            //Set pop up marker contents
                            infowindow.setContent(
                                "<div class='map-popup'>" +
                                "<h5>" + markerLocations[i][0] + "</h5>" +
                                "<div class='map-popup-content'>" +
                                "<p>" + markerLocations[i][3] + "</p>" +
                                "<div class='map-popup-contact'>" +
                                popTel +
                                popFax +
                                "</div>" +
                                popOperating +
                                "<p><a href='javascript:void(0);' onclick=\"callExternalLinks('http://maps.google.com/maps?saddr=&daddr='+markerLocation)\">" + directionsLabel + " &raquo;</a></p>"
                            );
                        }
                        infowindow.open(map, marker);
                        google.charts.load('current', {
                            packages: ['corechart', 'bar']
                        });

                        if(bankData !== undefined){
                            google.charts.setOnLoadCallback(function () {
                                drawBasic(bCode);
                            });
                            setTimeout(function () {
                                $('.last-time span').text("Last updated " + lastUptime);
                            }, 400);
                            if(!mobileCheck()){
                                const owl = $('.qms_list').owlCarousel({
                                    items: 1,
                                    loop: true,
                                    margin: 0,
                                    stagePadding: 0,
                                    dot: true
                                });

                                owl.trigger('owl.goTo', today);
                            }
                        }
                    }
                })(marker, i));
                gmarkers.push(marker);
            }else{
                alert('branchCode Empty');
            }
        }
    }


    $('.location-filter-result li a').click(function (e) {
        var obj = $(this)
        $('.location-filter-result li').removeClass("selected")
        obj.addClass("selected")

        var clickedIndex = obj.index();


        var filterLiArr = $.map($('.location-filter-result li a'), function (e, i) {
            return $(e).index()
        })

        var theClicked = $.inArray(clickedIndex, filterLiArr)

        if ($(window).width() > 1020) {
            map.setZoom(12);
        }

        e.preventDefault();
    });


})

function callExternalLinks(links1) {

    $('.modal#external-site').addClass('active');
    $("#external-site .more-link").prop("href", links1);

};

function clickedLink(i) {
    itemClicked = i;
    //clear chartmob
    $('.chart-mob .owl-carousel').remove();
    $('.chart-mob .last-time').remove();
    $('.chart-mob').removeClass('show');
    google.maps.event.trigger(gmarkers[i], "click");
};

function redefineMapCenter() {
    var count = $('.location-filter-result li a').first().data('count');

    if (count > 0) {
        var newlatlng = gmarkers[count].position;
        if (newlatlng) {
            globapMap.setZoom(15);
            globapMap.setCenter(newlatlng);
        }
    }
};

//Chart Function
var lastUptime;
function drawBasic(bCode) {



    for (var j = 0; j < mainData.length; j++) {
        var a = parseInt(bCode),
            b = parseInt(mainData[j].branchCode);
        if (a == b) {
            bankData = mainData[j];
        }
    }

    /*var maxPplWaiting = 0;
    if(bankData !== undefined){
        for (var key1 in bankData.queueDetails) {
            if (bankData.queueDetails.hasOwnProperty(key1)) {
                //console.log(key + " -> " + p[key]);
                for (var key2 in bankData.queueDetails[key1]){
                    //console.log('ppw...' + bankData.queueDetails[key1][key2]['peopleWaiting']);
                    if(parseInt(bankData.queueDetails[key1][key2]['peopleWaiting']) > maxPplWaiting){
                        maxPplWaiting = parseInt(bankData.queueDetails[key1][key2]['peopleWaiting']);
                    }
                }

            }
        }
    }

    console.log(maxPplWaiting);
    var maxNumber = maxPplWaiting < 10 ? 10 : maxPplWaiting + 5;*/
    if(bankData !== undefined){

        //var dailytime = ["7AM", "8AM", "9AM", "10AM", "11AM", "12PM", "1PM", "2PM", "3PM", "4PM", "5PM", "6PM", "7PM", "8PM", "9PM", "10PM", "11PM", "12AM"];
        var dailytime = ["12AM", "1AM", "2AM", "3AM", "4AM", "5AM", "6AM", "7AM", "8AM", "9AM", "10AM", "11AM","12PM", "1PM", "2PM", "3PM", "4PM", "5PM", "6PM", "7PM", "8PM", "9PM", "10PM", "11PM"];
        var opentime = bankData.openingTime, closetime = bankData.closingTime;
        var c = dailytime.indexOf(opentime);
        var d = dailytime.indexOf(closetime) + 1;
        var officetime = dailytime.slice(c, d);
        //var officetime = ["","","7AM", "8AM", "9AM", "10AM", "11AM", "12PM", "1PM", "2PM", "3PM", "4PM", "5PM", "6PM"];
        const jsDays = [ "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        var weekdays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
        const today = weekdays.indexOf(jsDays[new Date().getDay()]);
        var divnames = ["chart1", "chart2", "chart3", "chart4", "chart5"];
        var workday = bankData.workingDays;
        var holiday = $(weekdays).not(workday).get();
        var json_data = [];
        var chart_data = [];
        var chart1, chart2, chart3, chart4, chart5, t_count;

        //clone the carousel to mobile specific div
        $( ".owl-carousel" ).clone().appendTo( '.chart-mob[data-count='+ itemClicked + ']' );
        
        var dataAvailable = "true";
        var maxNumber = 0;
        for (var i = 0; i < weekdays.length; i++) {
            var a = weekdays[i];
            //var index = weekdays.indexOf(a)+1;

            //maxNumber = 0;

            if(holiday.indexOf(a) <= -1){

                var b = divnames[i];
                var mob_b = b;
                t_count = i;
                json_data[i] = bankData.queueDetails[a];
                chart_data[i] = new google.visualization.DataTable();
                
                if (json_data[i]) {
                    
                    chart_data[i].addColumn('string', 'Time');
                    chart_data[i].addColumn('number', 'People Waiting');    
                    //chart_data[i].addColumn({type: 'number', role: 'tooltip'});
                    chart_data[i].addColumn({
                        type: 'string',
                        role: 'tooltip',
                        p: {
                            html: true
                        }
                    });
                    
                    if(officetime.length < 12){
                        chart_data[i].addRows([['',0,''],['',0,'']]);
                    }
                    var keys = Object.keys(json_data[i]),
                        time, jsontime, n;
                    for (var k = 0; k < officetime.length; k++) {
                        time = officetime[k];
                        jsontime = json_data[i][time];
                        if (jsontime) {
                            n = parseInt(jsontime.peopleWaiting)
                        } else {
                            n = 0;
                        }
                        if(k===0 && n===0){
                            n=1;
                        }
                        
                        if(maxNumber <= n){
                            maxNumber = n < 10 ? 10 : n + 5;
                        }
                        time = time.slice(0, -1).toLowerCase();
                        chart_data[i].addRows([
                            //[time, n, '<div class="google-chart-tooltip tip' + k + '"><div class="circle">' + n + '</div><div class="vl"></div></div>'],
                            [time, n, n + ' '],
                        ]);
                    }
                    dataAvailable = "true";
                    if(officetime.length < 12){
                        chart_data[i].addRows([['',0,''],['',0,'']]);
                    }
                } else {
                    
                    //chart_data[i].addColumn('string', 'Time');
                    dataAvailable = "false";
                    $('.map-popup #chart_div' + (i+1)).addClass('holiday').html("<h4>" + "No data available" + "</h4>");
                    $('.chart-mob #chart_div' + (i+1)).addClass('holiday').html("<h4>" + "No data available" + "</h4>");
                    //chart_data[i].addRows([
                        //['No Data Copy', 0, '<div class="google-chart-tooltip tip' + k + '"><div class="circle">' + n + '</div><div class="vl"></div></div>']
                      //  ['No Data Copy', 0, n + ' people waiting']
                    //]);
                    //            var time, n;
                    //            for (var k = 0; k < officetime.length; k++) {
                    //                time = officetime[k], n = 1;
                    //                time = time.slice(0, -1).toLowerCase();
                    //                chart_data[i].addRows([
                    //                    [time, n, '<div class="google-chart-tooltip tip' + k + '">' + n + '</div>']
                    //                ]);
                    //            }
                }

                //b = new google.visualization.ColumnChart(document.getElementById('chart_div' + (i+1)));
                b = new google.visualization.ColumnChart($('.map-popup ' + '#chart_div' + (i+1))[0]);
                
                if(dataAvailable == "true"){
                
                
                    b.draw(chart_data[i], {
                        tooltip: {
                            //isHtml: true,
                            trigger: 'selection'
                        },
                        height: 150,
                        chartArea: {
                            bottom: 25,
                            top: 25,
                            width: "125%",
                            height: "125%"
                        },
                        vAxis: {
                            viewWindow: {
                                max: maxNumber,
                                min: 0
                            }
                        },
                        bar: {
                            groupWidth: "95%",
                            width: {
                                ratio: 0 // this makes bar width 50% of length between ticks
                            }
                        },
                        colors: ['#D01D22']
                    });

                    var cm = $('.chart-mob ' + '#chart_div' + (i+1))[0];

                    if(cm != undefined){
                    mob_b = new google.visualization.ColumnChart(cm);

                    mob_b.draw(chart_data[i], {
                        tooltip: {
                            //isHtml: true,
                            trigger: 'selection'
                        },
                        width: 280,
                        height: 150,
                        chartArea: {
                            left: -5,
                            top: 15,
                            bottom: 25,
                            width: "150%"
                        },
                        vAxis: {
                            viewWindow: {
                                max: maxNumber,
                                min: 0
                            }
                        },
                        bar: {
                            groupWidth: "85%",
                            width: {
                                ratio: 1 // this makes bar width 50% of length between ticks
                            }
                        },
                        colors: ['#D01D22']
                    });

                    }
                }

            }else{
                $('.map-popup #chart_div' + (i+1)).addClass('holiday').html("<h4>" + brnclsMsg + "</h4>");
                $('.chart-mob #chart_div' + (i+1)).addClass('holiday').html("<h4>" + brnclsMsg + "</h4>");      
            }
        }

        //$( ".owl-carousel" ).clone().appendTo( '.chart-mob[data-count='+ itemClicked + ']' );
        $( ".last-time" ).clone().appendTo( '.chart-mob[data-count='+ itemClicked + ']' );
        $('.chart-mob[data-count='+ itemClicked + ']').addClass('show');
        $('.chart-mob .owl-carousel').css('opacity', 1);
        if(mobileCheck()){
            var owl_mob = $('.chart-mob .qms_list').owlCarousel({
                items: 1,
                loop: true,
                margin: 0,
                stagePadding: 0,
                dot: true
            });
            owl_mob.trigger('owl.goTo', today);
        }
        // $('.chart-mob[data-count='+ itemClicked + ']').html($('.owl-carousel').html());
        //$('.map-popup-content .owl-carousel').remove();
    }
}

function mobileCheck() {
    /*var check = false;
    (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
    return check;*/
    if(window.innerWidth <= 600) {
        return true;
    } else {
        return false;
    }
};


function setDLCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d;
    document.cookie = cname + "=" + cvalue + "; " + expires + "; path=/";
}

function getDLCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
}

function alphaOnlyTwoSGCC(event) {
  // var key = event.keyCode;
  // return ((key >= 65 && key <= 90) || key == 8 || key == 8 || key == 229);

  var key = event.keyCode || event.which;
    if (key == 0 || key == 229) { //for android chrome keycode fix
        key = getKeyCode(this.value);
    }
    return ((key >= 65 && key <= 90) || key == 8 || key == 32 || key == 9 || key == 37 || key == 39 || key == 189 || key == 190);

};

$(function() {
    $('.global-prefix').attr("maxlength", "3");
});

function displayErr(obj)
{
    alert(obj.errMsg);
    if(obj.errInd == "ReqTimeout4")
    {
    	window.location.href = obj.nextUrl + '?n=' + new Date().getTime();
    }
}

function showLoadingOverlay ()
{
  $(".loading-overlay").addClass ("active");
  $("body").css ({
    'pointer-events': "none",
    'overflow': "hidden"
  });
}

function hideLoadingOverlay ()
{
  $(".loading-overlay").removeClass ("active");
  $("body").css ({
    'pointer-events': "",
    'overflow': ""
  });
}

$.validator.addMethod('supPCLcheck', function (value, element) {
 if(!$('.rdoPCLYes').is(':checked') || $('.rdoSupPCLNo').is(':checked'))
 {
  return true;
 }

    if (value == "") { return true; }
 var prinPCL = parseInt($('.prefcreditlimitamount').val().replace(/,/g , ''));
 var suppPCL = parseInt(value.replace(/,/g , ''));
    console.log("prinPCL" + prinPCL);
    console.log("suppPCL" + suppPCL);
 return prinPCL >= suppPCL;
 }, "Amount exceeded Principal's Preferred Credit Limit"
);

$.validator.addMethod('incomecheck', function (value, element) {
	var annualincome = parseInt(value.replace(/,/g , ''));
	var incomeRequired = parseInt(($('.incomeRequired').val()).replace(/,/g , ''));
	return annualincome >= incomeRequired;
	}, "N/A"
);

$.validator.addMethod("residtype", function(value, element) {

    var residtypeoption = $("#residtype").val()
    return residtypeoption == 'NRIC';
    }, "Only Singaporean or Singaporean PR are eligible to apply for a CIMB Credit Card. For Singaporean PR, please select and input your NRIC"
);

$.validator.addMethod("supresidtype", function(value, element) {

    var residtypeoption = $("#supresidtype").val()
    return residtypeoption == 'NRIC';
    }, "Only Singaporean or Singaporean PR are eligible to apply for a CIMB Credit Card. For Singaporean PR, please select and input your NRIC"
);

jQuery.validator.addMethod("notEqual", function(value, element) {
	var prinNric = $("#nricsg").val(); 
	return prinNric != value;
}, $(".msgErrEqualNRIC14").val());

jQuery.validator.addMethod ("checkPrefCredLimit", function (value, element) {

    var prefCredLimit = /\d+00$/;
    //var value = $("#prefcreditlimit").val();
    var result = prefCredLimit.test(value);
    var value1 = $(".prefcreditlimitamount").val();

    if (result == false) {

    }
    if(value1 < 100) {
        // jQuery("#warning").text("Value is less than 100");
        return;
    }
    if(value1[0] == 0){ //start with 0 error
        return;
    }
    return result;
},
"Your Preferred Credit Limit must be in multiple of 00' and a minimum of S$100");

jQuery.validator.addMethod ("checkSuppPrefCredLimit", function (value, element) {
 if (value == "")
    {
        return true;
    }
    else
    {
        var suppPrefCredLimit = /\d+00$/;
        var result = suppPrefCredLimit.test(value);
    
        var value2 = $(".supprefcreditlimitamount").val();
        if (result == false) {
    
        }
        if(value2 < 100) {
            // jQuery("#warning").text("Value is less than 100");
            return;
            console.log("test 1");
        }
        if(value2[0] == 0){ //start with 0 error
            return;
            console.log("test 2");
        }
        return result;
    }
},
"Your Preferred Credit Limit must be in multiple of 00' and a minimum of S$100");

/* validate myIC and sgIC */
$.validator.addMethod ("mysgIC", function (value, element) {
  if (value == "") return true;
 
  //var myIC = /^\d{6}\-?\d{2}\-?\d{4}$/;

  var sgIC = value.trim();
  var sgICResult = false;
  sgIC = sgIC.toUpperCase();

  var i,
      icArray = [];
  for(i = 0; i < 9; i++) {
      icArray[i] = sgIC.charAt(i);
  }
  
  //alert(icArray[0]);
  if (icArray[0] == "F" || icArray[0] == "G") return false;

  icArray[1] = parseInt(icArray[1], 10) * 2;
  icArray[2] = parseInt(icArray[2], 10) * 7;
  icArray[3] = parseInt(icArray[3], 10) * 6;
  icArray[4] = parseInt(icArray[4], 10) * 5;
  icArray[5] = parseInt(icArray[5], 10) * 4;
  icArray[6] = parseInt(icArray[6], 10) * 3;
  icArray[7] = parseInt(icArray[7], 10) * 2;

  var weight = 0;
  for(i = 1; i < 8; i++) {
      weight += icArray[i];
  }

  var offset = (icArray[0] == "T" || icArray[0] == "G") ? 4:0;
  var temp = (offset + weight) % 11;

  var st = ["J","Z","I","H","G","F","E","D","C","B","A"];
  var fg = ["X","W","U","T","R","Q","P","N","M","L","K"];

  var theAlpha;
  if (icArray[0] == "S" || icArray[0] == "T") {
      theAlpha = st[temp];
  }
  else if (icArray[0] == "F" || icArray[0] == "G") {
      theAlpha = fg[temp];
  }

  sgICResult = (icArray[8] === theAlpha);

  return sgICResult;
},
'Please enter a valid NRIC number.');

//revalidation
$.validator.addMethod(
        "regex",
        function(value, element, regexp) {
            var re = new RegExp(regexp);
            return re.test(value);
        },
        "Please check your input."
);

function getAddressEnc(type, postUrl)
{
    var postCode = $('.' + type + 'postcode').val();
    if(postCode.length < 6)
    {
        alert("Minimum 6 characters required for postcode.");
    }
    else
    {
        $.ajax({
            url: postUrl,
            type: 'post',
            dataType: 'json',
            cache : false,
            data : {
                postcode : $('.' + type + 'postcode').val(),
                p : '2f636f6e74656e742f7573657267656e6572617465642f636f6e74656e742f73672d706f7374616c2d636f6465'
            },
            success: function(obj) {
                for (i = 0; i < obj.length; i++) {
                    var buildingName = obj[i].building_name;
                    var buildingNumber = obj[i].building_number;
                    var streetName = obj[i].street_name;
                    $('.' + type + 'address1').val(buildingNumber + ' ' + streetName);
                    $('.' + type + 'address2').val(buildingName);
                    
                    if((buildingName != "") || (buildingNumber != "") || (streetName != ""))
                    {
                        $('.' + type + 'CountryList').val('Singapore');
                    }
                }
            },
            error: function(obj) {
                //$("#upload-error").text("Couldn't upload file");
            }
        });
    }
}

//job section
/*
$(function() {
    $('.job-section').hide();

	initJobFields($('.hiddenEmpType').val());

	$('.ddlEmploymentType').change(function() {
	    initJobFields($(this).val());
	});
});
*/
function initJobFields(empType)
{
	if(empType != '')
	{
		$('.job-section').show();
		if(empType != 'Retiree')
	    {
	        $('.non-retiree').show();
	        $('.retiree-css').css('margin-left', '4.16667%');
	        if($('.txtCompanyName').val() == 'N/A')
	        {
	        	$('.txtCompanyName').val('');
	        }
	        if($('.ddlBizNature').val() == 'Retired')
	        {
	        	$('.ddlBizNature').val('');
	        }
	        if($('.ddlOccupation').val() == 'Retired/Pensioner')
	        {
	        	$('.ddlOccupation').val('');
	        }
	        
	        $('.txtCompanyYears').rules('add', { regex: '^[1-9]+$' });
	        $('.txtCompanyYears').rules('add', { messages: {regex: 'Please input a valid length of employment. If you are employed for less than 1 year, please input 1'}});
	    }
	    else if(empType == 'Retiree')
	    {
	        $('.non-retiree').hide();
	        $('.retiree-css').css('margin-left', '0');
	        $('.txtCompanyName').val('N/A');
	        $('.ddlBizNature').val('Retired');
	        $('.ddlOccupation').val('Retired/Pensioner');
	        $('#companyname-error').hide();
	        $('#biznature-error').hide();
	        $('#occupation-error').hide();
	        
	        $('.txtCompanyYears').rules('remove', 'regex');
	    }
	}
}

function optionalFieldsValidation()
{
	/*if($('.txtCompanyAddress1').val() != "")
    {
        $('.txtCompanyAddress1').rules('add', { regex: '^[a-zA-Z0-9 ,-]+$' });
        $('.txtCompanyAddress1').rules('add', { messages: {regex: 'Please enter valid company address (Line 1)'}});        
    }
    else
    {
        $('.txtCompanyAddress1').rules('remove', 'regex');
    }
	
	if($('.txtCompanyAddress2').val() != "")
    {
        $('.txtCompanyAddress2').rules('add', { regex: '^[a-zA-Z0-9 ,-]+$' });
        $('.txtCompanyAddress2').rules('add', { messages: {regex: 'Please enter valid company address (Line 2)'}});        
    }
    else
    {
        $('.txtCompanyAddress2').rules('remove', 'regex');
    }*/
	
	if($('.txtRelationship').val() != "")
    {
        $('.txtRelationship').rules('add', { regex: '^[a-zA-Z ]+$' });
        $('.txtRelationship').rules('add', { messages: {regex: 'Please enter valid relationship'}});        
    }
    else
    {
        $('.txtRelationship').rules('remove', 'regex');
    }
	
	if($('.txtEmergencyContact').val() != "")
    {
        $('.txtEmergencyContact').rules('add', { regex: '^[a-zA-Z ]+$' });
        $('.txtEmergencyContact').rules('add', { messages: {regex: 'Please enter valid emergency contact name'}});        
    }
    else
    {
        $('.txtEmergencyContact').rules('remove', 'regex');
    }
	
	if($('.rdoPCLYes').is(':checked'))
    {
		$('.txtPCL').rules('add', { regex: "^[0-9,]+$" });
        $('.txtPCL').rules('add', { messages: {regex: 'Please enter valid preferred credit limit'}});
    }
	
	if($('.rdoPCLNo').is(':checked'))
    {
		$('.txtPCL').rules('remove', 'regex');
    }

    if($('.rdoSuppYes').is(':checked'))
    {
		$('.txtSupSurName').rules('add', { regex: "^[a-zA-Z \\\\@,/='-]+$" });
        $('.txtSupSurName').rules('add', { messages: {regex: 'Please enter valid surname'}});

        $('.txtSupName').rules('add', { regex: "^[a-zA-Z \\\\@,/='-]+$" });
        $('.txtSupName').rules('add', { messages: {regex: 'Please enter valid fullname'}});

        $('.txtSupCardName').rules('add', { regex: "^[a-zA-Z ._-]+$" });
        $('.txtSupCardName').rules('add', { messages: {regex: 'Please enter valid card name'}});

        $('.txtSupMothername ').rules('add', { regex: "^[a-zA-Z ]+$" });
        $('.txtSupMothername ').rules('add', { messages: {regex: "Please enter valid mother's maiden name"}});

        $('.txtSupCompanyName').rules('add', { regex: "^[a-zA-Z \\\\@,/='-]+$" });
        $('.txtSupCompanyName').rules('add', { messages: {regex: "Please enter valid company name"}});
        
        if($('.rdoSupPCLYes').is(':checked'))
        {
    		$('.txtSupPCL').rules('add', { regex: "^[0-9,]+$" });
            $('.txtSupPCL').rules('add', { messages: {regex: 'Please enter valid preferred credit limit'}});
        }
        
        if($('.rdoSupPCLNo').is(':checked'))
        {
    		$('.txtSupPCL').rules('remove', 'regex');
        }
    }

    if($('.rdoSuppNo').is(':checked'))
    {
    	$('.txtSupSurName').rules('remove', 'regex');
        $('.txtSupName').rules('remove', 'regex');
        $('.txtSupCardName').rules('remove', 'regex');
        $('.txtSupMothername ').rules('remove', 'regex');
        $('.txtSupCompanyName').rules('remove', 'regex');
        $('.txtSupPCL').rules('remove', 'regex');
    }
}

function initDatePicker()
{
    $( ".datepicker" ).datepicker({ 
        dateFormat: 'mm/dd/yy',
        yearRange: '-100:-21',
        maxDate: '-21Y',
        minDate: '-100Y',
        changeMonth: true,
        changeYear: true
    });

    $( ".datepickerSup" ).datepicker({ 
        dateFormat: 'mm/dd/yy',
        yearRange: '-100:-16',
        maxDate: '-16Y',
        minDate: '-100Y',
        changeMonth: true,
        changeYear: true,
        onSelect: function(dateText, inst) { 
            var dob = $(this).datepicker('getDate');
	        var age = GetAge(dob);
	        if (age >= 16 && age < 18) {
	            alert("The minimum age requirement for supplementary card applicant is 18 years old. For applicant aged 16 and 17, and are going overseas to study, please submit the letter of acceptance from the education institution.");
	        }
        }
    });
    
    /*$( ".datepickerEmp" ).datepicker({ 
        dateFormat: 'mm/dd/yy',
        yearRange: '+0:+10', 
        changeMonth: true,
        changeYear: true
    });*/
}

//Principal NRIC length validation
$('#residtype').change(function(){
    if(this.value=="NRIC"){
     document.getElementById('nricsg').maxLength=9;
    }else{
     document.getElementById('nricsg').maxLength=16;
    }
  
});

//Supp NRIC length validation
$('#supresidtype').change(function(){
    if(this.value=="NRIC"){
     document.getElementById('supnricsg').maxLength=9;
    }else{
     document.getElementById('supnricsg').maxLength=16;
    }
  
});

$('.back-step').click(function(){
	var loc = $('.currentPage').val() + '.' + $('.backStep').val() + '.html';
    window.location.href = loc + '?n=' + new Date().getTime(); // random number
});

$(document).ready(function(){

    // Accordion function
    if ($('.section-bar').length > 0){
        $('.collapse-content').hide();

        // Click and expand
        $('.section-bar').click(function(){
            if($(this).parent().parent().find('.collapse-content').css('display') == 'block'){
                $(this).parent().parent().find('.collapse-content').slideUp();
            }
            else{
                $(this).parent().parent().find('.collapse-content').slideDown();
            }
            $(this).toggleClass('active');
        })   
    }
    // Accordion function END

    //same height for div (equal height)
    if( $(window).width() >= 768){
        var maxHeight = 0;
        $(".group-ps").each(function(){
           if ($(this).height() > maxHeight) { maxHeight = $(this).height(); }
        });

        $(".group-ps").height(maxHeight);

        // var borderMaxHeight = 0;
        // $(".biz123 ul.info-content-row li").each(function(){
        //    if ($(this).height() > borderMaxHeight) { borderMaxHeight = $(this).height(); }
        // });

        //  $(".biz123 ul.info-content-row li").height(borderMaxHeight);
    }    
        //same height for div (equal height) END

        // if( $(window).width() < 768){
        //     $('.haha').toggleClass('push-right');
        //     console.log("haha");
        //  }   

    // class remove //    
        
    $(window).on('resize', function () {
        $('.control-lr').toggleClass('push-right', $(window).width() >= 768);
    }).trigger('resize')

    // END class remove //

});


$('input:radio[name="prefcreditlimit"]').change(function(){
   if($('#yesprefcreditlimit').is(':checked')) { 
    $('.addDiv').append($('<div id="hideComplete" style="display: inline-block;"><div id="creditChecked" style="display: none;" class="section-complete section-complete-js"><i class="icon-tick"></i> Completed</div></div>'));
    $('#preferred-fieldset').addClass('field-complete');
    // add complete this div / or class in php
    }else{
    $('#hideComplete').remove();
    $('#preferred-fieldset').removeClass('field-complete');
    // delete complete this div / or class in php    
    }
});

// 18-max length inclusive of country code (2 input total)
$(".limit-18-MobilePrefix, .limit-18-mobile").keypress(function(e) {
  var $prefixInput = $('.limit-18-MobilePrefix').val().length;
  var $phoneInput = $('.limit-18-mobile').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-18-supMobilePrefix, .limit-18-supMobile").keypress(function(e) {
  var $prefixInput = $('.limit-18-supMobilePrefix').val().length;
  var $phoneInput = $('.limit-18-supMobile').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-18-homePrefix, .limit-18-home").keypress(function(e) {
  var $prefixInput = $('.limit-18-homePrefix').val().length;
  var $phoneInput = $('.limit-18-home').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-18-urgentMobilePrefix, .limit-18-urgentMobile").keypress(function(e) {
  var $prefixInput = $('.limit-18-urgentMobilePrefix').val().length;
  var $phoneInput = $('.limit-18-urgentMobile').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-18-urgentHomePrefix, .limit-18-urgentHome").keypress(function(e) {
  var $prefixInput = $('.limit-18-urgentHomePrefix').val().length;
  var $phoneInput = $('.limit-18-urgentHome').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-18-urgentOfficePrefix, .limit-18-urgentOffice").keypress(function(e) {
  var $prefixInput = $('.limit-18-urgentOfficePrefix').val().length;
  var $phoneInput = $('.limit-18-urgentOffice').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 18) {
   return false;
  }
});

$(".limit-11-urgentOfficePrefix, .limit-11-urgentOffice").keypress(function(e) {
  var $prefixInput = $('.limit-11-urgentOfficePrefix').val().length;
  var $phoneInput = $('.limit-11-urgentOffice').val().length;
  var totalLen = $prefixInput + $phoneInput;
  if (totalLen >= 11) {
   return false;
  }
});

function decent_name (event)
{
  var field = event.target;
  var fieldval = $(field).val ();
  fieldval = fieldval.replace (/[^a-zA-Z\s@]/g, '');
  if (fieldval !== $(field).val ())
  {
    $(field).val (fieldval);
  }
}

function getUrlParameter(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++) 
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam) 
        {
            return sParameterName[1];
        }
    }
} 

$(document).ready(function(){
    var income = getUrlParameter('income');
    $('#monthlyincome').val(income);      
})

// Credit card application form:
$(document).ready(function() {
    //setAllToMaxHeight($(".chosen-card .card-feat"));
	activateInfoTooltip();
    //
    if($('.signup-card-section.noneditable-form').length >= 1){
        $('.signup-card-section.noneditable-form').find('input[type=text]').attr('disabled',true);
        $('.signup-card-section.noneditable-form').find('select').attr('disabled',true);
    }
})

function activateInfoTooltip()
{
	//Styling tooltip
    $('.info-tooltip').each(function(){
        var labelwidth = $(this).parent().parent().find('input[type=text]').width();
        var labelcontentwidth = $(this).parent().find('span').width() + $(this).parent().find('img').width();
        $(this).css({
            'left': labelcontentwidth + 20,
            'width' : labelwidth
        });
    })
    $('.i-info').each(function(){
        $(this).mouseenter(function(){
            $(this).parent().find('.info-tooltip').fadeIn(200);
        });
        $(this).mouseleave(function(){
            $(this).parent().find('.info-tooltip').fadeOut(200);
        });
    });
}

// For file input
function uploadFile(){
    $('.uploadbtn').each(function(){
        $(this).change(function(){
            var fileName = $(this).parent().find('.uploadbtn').val();
            fileName = fileName.replace(/^.*[\\\/]/, '');
            var limit = 30;

			// get both parts
			var fileNameExtension = "." + fileName.split(".").pop();
			var fileNameBase = fileName.substring(0, fileName.length - fileNameExtension.length);

			if(fileNameBase.length > limit){
			    // now limit it and set it as fileName
			    // fileName = fileNameBase.substring(0, limit) + fileNameExtension;
			    alert('File name exceed 30 characters. Please rename file name.')
			}
			else{
				$(this).parent().parent().find('.uploadfile').val(fileName);
			}

            // Show Add Another File button only after at least one document is uploaded
            $('.add-file').animate({'opacity':1},250)
        })
    })
}

$(document).ready(uploadFile);

// Length set to 13 = minus 2 default ones
$('.add-file').click(function(){
    if($('.uploadfile-container').find('.uploadfile-row').length < 11){
        $('.uploadfile-row:first-child').clone().appendTo('.uploadfile-container').removeClass('hide'); 
        $('.uploadfile-row:last-child').find('.uploadfile').val("");
        uploadFile(); 
    }

    // Set to 11, including the hidden row
    if($('.uploadfile-container').find('.uploadfile-row').length === 11){
        $(this).hide()
    }
})

// Accordion function
$(document).ready(function(){
    if ($('.accordion-header').length > 0){
        // Accordion
        $('.signup-card-section').find('fieldset').hide()
        $('.signup-card-section:first-child').find('fieldset').slideDown();
        $('.signup-card-section:first-child h2').addClass('active');

        // Click and expand
        $('.signup-card-section h2').click(function(){
            
            if($(this).parent().find('fieldset').css('display') == 'block'){
                $(this).parent().find('fieldset').slideUp();
            }
            else{
                $('.signup-card-section fieldset').slideUp();
                $('.signup-card-section h2').removeClass('active');
                $(this).parent().find('fieldset').slideDown();
            }
            $(this).toggleClass('active');
        })  
    }
})

// $(".signup-card-section h2").click(function(){
//     activateCompletedNotification();
// });

$('.signup-card-section input[type="text"]').blur(function(){
	// alert('bulr')
	activateCompletedNotification();
});

$('.signup-card-section select').change(function(){
	activateCompletedNotification();
});

function activateCompletedNotification(){
    $('.signup-card-section').each(function(){
        var badinput = 0;
        var badlabel = 0;
        var errormsg = 0;
        var errormsg2 = 0;
        $(this).find(':text').each(function() {
            if ($.trim($(this).val()) == "" && $(this).hasClass('not-required') === false ) badinput++;
            else if($.trim($(this).val()) == "RM") badinput++; //Fixes bug in IE8 that recognizes RM as value
        });
        $(this).find('select').each(function() {
            if ($(this).val() == null) badlabel++;
        });
		$(this).find('label.error').each(function() {
			if ($(this).css('display') == 'block') errormsg++;
		});
        $(this).find('span.error').each(function() {
            if ($(this).length > 0) errormsg2++;
        });

        if (badinput > 0 ||  badlabel > 0 || errormsg > 0 || errormsg2 > 0) {
            $(this).find('.section-complete').css('opacity',0.2)
        }
        else {
            $(this).find('.section-complete').css('opacity',1)
        }
    })
}

function focusFirstInput() {
	  var inputElements = document.getElementsByTagName('input');
	  try {
	    for (var i = 0; i < inputElements.length; i++) {
	      var e = inputElements[i];
	      // uses jQuery for hasClass()
	      if (e.tagName == 'INPUT' &&
	          !$(e).hasClass('nofocus') &&
	          (e.type == "text" || e.type == "password") &&
	          e.value === '') {
	        e.focus();
	        return;
	      }
	    }
	  } catch (e) {} // in case IE gets angry
	}


	function focusToFirstError(){

	    firstErrorElementID = $('label.error').attr('id');
	    // // reset all
	    // $('.signup-card-section').find('fieldset').hide();
	    // $('.signup-card-section:first-child h2').removeClass('active');
	    
	    // // focus on first error element

	   $('label.error[id="' + firstErrorElementID + '"]').closest('.signup-card-section').find(':input.error:first').focus();
	   // $('label.error[id="' + firstErrorElementID + '"]').closest('.signup-card-section').find('fieldset').focus();
	   // $('label.error[id="' + firstErrorElementID + '"]').closest('.signup-card-section').find('h2.accordion-header').addClass('active');

	}

$(document).ready(function() {
    // validate form on click
	$('.btn-card-next, .btn-card-confirm').click(function() {
        if( $(this).hasClass('disabled') ){
            //do nothing
        }else{
            activateCompletedNotification();
            if ($('.signup-card').valid()) {
                // alert('form is valid');
            } else {

                $(".signup-card-section").each(function() {
                if($(this).find('.section-complete').css('opacity') == 1){
                	
                    $(this).find('.field-complete').hide();
                    $(this).removeClass('active');

                    if($('#suppcardyes').is(':checked')){
                    $(this).find('h2').addClass('active');
                    window.location.href='#supp-card';
                    focusToFirstError();
                    focusFirstInput();


                    }
                    // e.preventDefault();
                    // e.stopPropagation(); 

                }
                else{
                    $(this).find('.field-complete').show();
                    $(this).find('h2').addClass('active');
                    focusToFirstError();
                    focusFirstInput();
                }
                });

                alert('Kindly ensure that all fields are filled accordingly.');
            }
        }
    });

	// Validate
    $('.btn-edit-form').click(function(){

      var visibleSaveBtn = $('.btn-save-form').filter(function() {
      return $(this).css('display') !== 'none';
    }).length;

      if( visibleSaveBtn >= 1){
        alert('Please save current active section before editing another section');
      }
      else{
        $(this).parent().parent().find('input[type=text]').attr('disabled',false);
        $(this).parent().parent().find('select').attr('disabled',false);
            $(this).parent().parent().find('input[type=radio]').attr('disabled',false);
            $(this).parent().parent().find('input[type=checkbox]').attr('disabled',false);
        $(this).parent().parent().removeClass('noneditable-form');
        $(this).hide();
        $(this).parent().find('.btn-save-form').show();
      }
      
  })

    $('.btn-save-form').click(function() {
    
	    if ($('.signup-card').valid()) {
	    	$(this).parent().parent().find('input[type=text]').attr('disabled', true);
	    	$(this).parent().parent().find('select').attr('disabled', true);
            $(this).parent().parent().find('input[type=radio]').attr('disabled',true);
            $(this).parent().parent().find('input[type=checkbox]').attr('disabled',true);
            $(this).parent().parent().addClass('noneditable-form');
            $(this).hide();
            $(this).parent().find('.btn-edit-form').show();
	    } else {
	            // Checking for errors per section
	      var badinput = 0;
	      var badlabel = 0;
	      var errormsg = 0;
	            var errormsg2 = 0;
	      $(this).parent().parent().find(':text').each(function() {
	        if ($.trim($(this).val()) == "") badinput++;
	      });
	      $(this).parent().parent().find('select').each(function() {
	        if ($(this).val() == null) badlabel++;
	      });
	      $(this).parent().parent().find('label.error').each(function() {
	        if ($(this).css('display') == 'block') errormsg++;
	      });
	            $(this).parent().parent().find('span.error').each(function() {
	                if ($(this).length > 0) errormsg2++;
	            });
	
	
	      // console.log(errormsg);
	
	      if (badinput > 0 || badlabel > 0 || errormsg > 0 || errormsg2 > 0) {
	        alert('Please ensure that all fields are filled accordingly');
	        $(this).parent().parent().addClass('halt');
	      } else {
	        $(this).parent().parent().find('input[type=text]').attr('disabled', true);
	        $(this).parent().parent().find('select').attr('disabled', true);
	        $(this).parent().parent().addClass('noneditable-form');
	        $(this).hide();
	        $(this).parent().find('.btn-edit-form').show();
	      }
	        }

  });

    // validate signup form on keyup and submit
    cardclubLength = $('#clubcardno').attr('maxlength');

    $(".signup-card").validate({
        ignore:"",
        errorPlacement: function(error, field){
	        if ($(field).attr('data-error-container') != undefined) {
	            var error_container = $(field).parent().find($(field).attr('data-error-container'));
	            error.appendTo ($(error_container));
	        }else {
	            $(field).after (error);
	
	        }
	        
	        if ($(field).attr ('type') == "checkbox" || $(field).attr ('type') == "radio")
	        {
	        	var field_parent = $(field).parent ();
	        	error.appendTo ($(field_parent));
	        }
	    },
        rules: {
	    	residenceyear: {
	            required: true
	        },
	        residencemonth: {
	            required: true
	        },
    		prefcreditlimitamount: {
        		required: true,
        		checkPrefCredLimit: true
    		},
    		supprefcreditlimitamount: {
                required: "#suppcardyes:checked",
          		checkSuppPrefCredLimit: true,
          		supPCLcheck: true
      		},
    		surname: {
        		required: true,
        		regex: "^[a-zA-Z \\\\@,/='-]+$"
    		},
            salutation: {
                required: true
            },
            annualincome: {
                required: true,
                regex: "^[0-9,]+$",
                incomecheck: true
            },
            acknowledge: {
                required: true
            },
            mothername: {
                required: true,
                regex: "^[a-zA-Z ]+$"
            },
            name: {
                required: true,
                regex: "^[a-zA-Z \\\\@,/='-]+$"
            },
            cardname: {
                required: true,
                regex: "^[a-zA-Z ._-]+$"
            },
            creditcardcustomer: {
                required: true
            },
            idtype: {
                required: true
            },
            idno: {
                required: true,
                minlength: 5,
                maxlength: 12
            },
            dobdd: {
                required: true,
                range: [01, 31]
            },
            dobmm: {
                required: true,
                range: [01, 12]
            },
            dobyyyy: {
                required: true,
                minlength: 4,
                range: [1000, 9999]
            },
            gender: {
                required: true
            },
            race: {
                required: true
            },
            marital: {
                required: true
            },
            nricsg: {
                required: true,
                mysgIC: true
            },
            education: {
                required: true
            },
            nationality: {
                required: true
            },
            mobileprefix: {
                required: true,
                digits: true
            },
            mobile: {
                required: true,
                maxlength: 18,
                digits: true
            },
            homeprefix: {
                digits: true
            },
            homeno: {
                digits: true
            },
            emergencycontactmobprefix: {
                digits: true,
                required: function(){
                    return $('.-phone-no-emer-mobile').val().length !== 0
                }
            },
            emergencycontactmobno: {
                digits: true
            },
            emergencycontacthomeprefix: {
                digits: true,
                required: function(){
                    return $('.-phone-no-emer-home').val().length !== 0
                }
            },
            emergencycontacthomeno: {
                digits: true
            },
            emergencycontactofficeprefix: {
                digits: true,
                required: function(){
                    return $('.-phone-no-emer-office').val().length !== 0
                }
            },
            emergencycontactofficeno: {
                digits: true
            },
            officeprefix: {
                digits: true,
                required: function(){
                    return $('.-phone-no-job-contact').val().length !== 0
                }
            },
            officeno: {
                digits: true
            },
            residenceyear: {
                digits: true
            },
            residencemonth: {
                digits: true
            },
            email: {
                required: true,
                regex: "^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+[a-zA-Z0-9]{2,4}$"
            },
            emailconfirm: {
                required: true,
                regex: "^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$",
                equalTo: "#email"
            },
            emergencycontactno: {
                required: true,
                minlength: 8,
                maxlength: 14,
                digits: true
            },
            clubcardno: {
                required: false,
                minlength: cardclubLength,
                maxlength: cardclubLength
            },
            residentialstatus: {
                required: true
            },
            residentialaddress1: {
                required: true,
                maxlength: 30
                //regex: "^[a-zA-Z0-9 ,-]+$"
            },
            residentialaddress2: {
            	required: true,
                maxlength: 30
                //regex: "^[a-zA-Z0-9 ,-]+$"
            },
            residentialcity: {
                required: true
            },
            residentialpostcode: {
                required: true,
                minlength: 3,
                digits: true
            },
            residentialstate: {
                required: true
            },
            residentialcountry: {
                required: true
            },
            monthlyincome: {
                required: true
            },
            // monthlyinstallment: {
            //     required: true
            // },
            biznature: {
                required: true
            },
            companyname: {
                required: true,
                regex: "^[a-zA-Z \\\\@,/='-]+$"
            },
            occupation: {
                required: true
            },
            employmentmm: {
                required: true,
                range: [01, 12]
            },
            employmentyyyy: {
                required: true,
                minlength: 4
                // range: [1000, 9999]
            },
            companyaddress1: {
                required: true,
                maxlength: 30
            },
            companyaddress2: {
                required: true,
                maxlength: 30
            },
            companycity: {
                required: true
            },
            companyyears: {
                required: true,
                digits: true
            },
            companypostcode: {
            	required: true,
                minlength: 3,
                digits: true
            },
            companystate: {
                required: true
            },
            companycountry: {
                required: true
            },
            employmenttype: {
                required: true
            },
            carddelivery: {
                required: true
            },
            correspondadd: {
                required: true
            },
            estatement: {
            	required: true
            },
            supsurname: {
                required: true
            },
            cardtype:{
                required: true
            },
            supname: {
                required: true
            },
            supcardname: {
                required:true
            },
            supnationality: {
                required: true
            },
            supidtype: {
                required: true
            },
            supnricsg: {
                required: true,
                mysgIC: true,
                notEqual: true
            },
            suprace: {
                required: true
            },
            supgender: {
                required: true
            },
            supmarital: {
                required: true
            },
            supmothername: {
                required: true
            },
            residtype: {
                residtype: true
            },
            //supresidtype: {
            //	supresidtype: true
            //},
            cardagreement: {
            	required: true
            },
            dob: {
                required: true
            },
            supdob: {
                required: true
            },
            printin: {
                required:true
            },
            supptin: {
                required: true
            },
            cpf:{
                required: true
            },
            propertytype:{
                required: true
            },
            supmobile:{
                digits: true
            },
            supmobileprefix: {
                required: function(){
                    return $('.-phone-no-sub-mobile').val().length !== 0   
                },
                digits: true
            },
            supresidentialpostcode:{
            	required: true,
                minlength: 3,
                digits: true
            },
            supresidentialaddress1:{
                required: true,
                maxlength: 30
            },
            supresidentialaddress2:{
                required: true,
                maxlength: 30
            },
            //supresidentialcountry:{
            //    required: '#supaddopt:checked'
            //}
            supresidentialcountry:{
                required: true
            },
            supcompanyname:{
                required: true
            },
            supoccupation:{
                required: true
            },
            supbiznature:{
                required: true
            },
            nodepends:{
            	digits: true
            },
            homeprefix: {
                required: function(){
                    return $('.-phone-no-home').val().length !== 0
                }
            }
        },
        messages: {
        	residenceyear: {
	            required: "Please input your year"
	        },
	        residencemonth: {
	            required: "Please input your month"
	        },
        	supresidentialcountry: {
	    		required: "Please choose your country of residence"
			},
        	supresidentialpostcode: {
	    		required: "Please enter enter your residential postcode"
			},
			supresidentialaddress1: {
	    		required: "Please enter enter your residential address (Line 1)"
			},
			supresidentialaddress2: {
	        	required: "Please enter enter your residential address (Line 2)"
	    	},
        	supmobile: {
	    		required: "Please enter your mobile number"
			},
        	prefcreditlimitamount: {
        		required: "Please enter your preferred credit limit"
    		},
    		supprefcreditlimitamount: {
        		required: "Please enter your preferred credit limit"
    		},
        	acknowledge: {
            	required: "Required field"
        	},
        	surname: {
	            required: "Please enter your surname",
            	regex: "Please enter valid surname"
	        },
            salutation: {
                required: "Please pick a salutation"
            },
            annualincome: {
                required: "Please enter your gross annual salary",
            	regex: "Please enter valid gross annual salary"
            },
            name: {
                required: "Please enter your name",
                regex: "Please enter valid name"
            },
            cardname: {
                required: "Please enter your card name",
            	regex: "Please enter valid card name"
            },
            mothername: {
                required: "Please enter your mother's maiden name",
                regex: "Please enter valid mother's maiden name"
            },
            creditcardcustomer: {
                required: "Please select yes or no"
            },
            idtype: {
                required: "Please select an ID type"
            },
            idno: {
                required: "Please enter ID number"
            },
            dobdd: {
                required: "Please enter date of birth (DD)"
            },
            dobmm: {
                required: "Please enter date of birth (MM)"
            },
            dobyyyy: {
                required: "Please enter date of birth (YYYY)"
            },
            gender: {
                required: "Please pick a gender"
            },
            race: {
                required: "Please pick your race"
            },
            marital: {
                required: "Please pick your marital status"
            },
            nricsg: {
                required: "Please enter a valid NRIC/Passport"
            },
            education: {
                required: "Please pick your education level"
            },
            nationality: {
                required: "Please pick your nationality"
            },
            mobile: {
                required: "Please enter your mobile number"
            },
            email: {
                required: "Please enter your email address",
                regex: "Please enter valid email address"
            },
            emailconfirm: {
                required: "Please enter your email address again",
                regex: "Please enter valid email address",
                equalTo: "Please ensure your email address is the same"
            },
            emergencycontactno: {
                required: "Please enter emergency contact number"
            },
            residentialstatus: {
                required: "Please enter your residential status"
            },
            residentialaddress1: {
                required: "Please enter your residential address (Line 1)",
            	regex: "Please enter valid residential address (Line 1)"
            },
            residentialaddress2: {
                required: "Please enter your residential address (Line 2)",
                regex: "Please enter valid residential address (Line 2)"
            },
            residentialcity: {
                required: "Please enter your residential city"
            },
            residentialpostcode: {
                required: "Please enter your residential postcode"
            },
            residentialstate: {
                required: "Please enter your residential state"
            },
            residentialcountry: {
                required: "Please choose your country of residence"
            },
            monthlyincome: {
                required: "Please enter your monthly income"
            },
            // monthlyinstallment: {
            //     required: "Please enter your monthly installment"
            // },
            biznature: {
                required: "Please enter your business of nature"
            },
            companyname: {
                required: "Please enter your company name",
                regex: "Please enter valid company name"
            },
            occupation: {
                required: "Please enter your occupation"
            },
            employmentmm: {
                required: "Please enter your date joined (MM)"
            },
            employmentyyyy: {
                required: "Please enter your date joined (YYYY)"
            },
            companyaddress1: {
                required: "Please enter your company address (Line 1)"
            },
            companyaddress2: {
                required: "Please enter your company address (Line 2)"
            },
            companyyears: {
                required: "Please enter your length of employment"
            },
            companycity: {
                required: "Please enter your company city"
            },
            companypostcode: {
                required: "Please enter your company postcode"
            },
            companystate: {
                required: "Please enter your company state"
            },
            companycountry: {
                required: "Please choose your your company country"
            },
            employmenttype: {
                required: "Please pick your employment type"
            },
            carddelivery: {
                required: "Please pick a method of card collection"
            },
            correspondadd: {
                required: "Please pick a correspondence address"
            },
            estatement: {
            	required: "Please pick if you prefer an e-statement or not"
            },
            cardtype: {
                required: "Please select the type of card"
            },
            supsurname: {
                required: "Please enter your surname"
            },
            supname: {
                required: "Please enter your fullname"
            },
            supcardname: {
                required: "Please enter your card name"
            },
            supnationality: {
                required: "Please select your nationality"
            },
            supidtype: {
                required: "Please select your ID type"
            },
            supnricsg: {
                required: "Please enter a valid NRIC"
            },
            suprace: {
            	required: "Please pick your race"
            },
            supgender: {
            	required: "Please pick a gender"
            },
            supmarital: {
            	required: "Please pick your marital status"
            },
            supmothername: {
                required: "Please enter your mother's maiden name"
            },
            cardagreement: {
                required: "Please agree to our terms and conditions"
            },
            supdob: {
                required: "Applicant has to be at least 18 years old"
            },
            dob: {
                required: "Applicant has to be at least 21 years old"
            },
            printin: {
                required: "Please enter a valid Taxpayer Identification Number"
            },
            supptin: {
                required: "Please enter a valid Taxpayer Identification Number"
            },
            cpf:{
                required: "Required field"
            },
            propertytype:{
                required: "Please pick your Property Type"
            },
            supcompanyname:{
                required: "Please enter your company name"
            },
            supoccupation:{
                required: "Please enter your occupation"
            },
            supbiznature:{
                required: "Please enter your business of nature"
            },
            homeprefix: {
                required: "Please enter Country Code"
            },
            emergencycontactmobprefix: {
				required: "Please enter Country Code"	
            },
            emergencycontacthomeprefix:{
				required: "Please enter Country Code"
            },
            emergencycontactofficeprefix: {
                required: "Please enter Country Code"
            },
            officeprefix: {
				required: "Please enter Country Code"
            },
            supmobileprefix: {
                required: "Please enter Country Code"
            }
        }
    });

    
});

$("#referredbyfriend").hide();

$("#referred").change(function(){
    if ($(this).val() == 'yes'){
        $("#referredbyfriend").show();
        $("#referredbyfriend").find ('input, textarea, select').each (function (index, item) {
                $(item).val ("");
            });
    } else {
        $("#referredbyfriend").hide();
    }
})


// Numeric controlling
$(window).load(function(){
    var currentYear = (new Date).getFullYear();
    // $('#monthlyinstallment').autoNumeric('init', {aSign: 'RM ', mDec: '0'});
    // $('#monthlyincome').autoNumeric('init', {vMax: '99999999', aSign: 'RM ', mDec: '0'});
    // $('#monthlyincome').autoNumeric('init', {aSign: 'RM ', mDec: '0'});
})

// Show hidden items
$('.interest-cpc .btn-show').click(function(){
    $(this).toggleClass('active')
    $(this).parent().find('.hidden').slideToggle();
})

// Character Counting

function countChar(val) {
    var wordlength = val.value.length;
    var maxlength = $(val).attr('maxlength');
    $(val).parent().find('.charnum').text(maxlength - wordlength + ' / ' + maxlength);
};

function setChar(){
    $('.charnum').each(function(){        
        var wordlength =  $(this).parent().parent().find('input').val().length;
        var maxlength =  $(this).parent().parent().find('input').attr('maxlength');
        var lengthAvailable = maxlength - wordlength
        $(this).text(lengthAvailable + ' / ' + maxlength)
    })
}

function monthlyIncomeChecking(){
    $('#monthlyincome').keyup(function(){
        value = $(this).val().replace(/,/g,'');

        if ( value > 99999999 ){
            errorTemplate = '<span class="monthlyincome-max-error error" for="monthlyincome">Maximum income input is RM99,999,999.</span>'
             if( $('.monthlyincome-max-error').length === 0 ){
                $(this).after(errorTemplate);
             }
        } else{
            $('.monthlyincome-max-error').remove();
        }
    })
}

function dobJoinedChecking(){
    $('#dobyyyy, #employmentyyyy').blur(function(){
        dobJoinedCheckingScenario();
    })
}

function dobJoinedCheckingScenario(){
    if ( $('#dobyyyy').val() > 0 && $('#employmentyyyy').val() ){
        // Both fields are filled
        dobYear = $('#dobyyyy').val();
        joinYear = $('#employmentyyyy').val();
        if ( joinYear < dobYear ){
            errorTemplate = '<span class="dobyyyy-employmentyyyy-error error" for="monthlyincome">Invalid date</span>'
            if( $('.dobyyyy-employmentyyyy-error').length === 0 ){
                $('#dobyyyy, #employmentyyyy').after(errorTemplate);
            }  
            alert('There\'s a descrepancy between date company joined and birth year.');
        }
        else{
            $('.dobyyyy-employmentyyyy-error').remove();
        }
    }
}

function dobICChecking(){
    $('#dobdd, #dobmm, #dobyyyy, #idno').blur(function(){
        dobICCheckingScenario();
    })
}

function dobICCheckingScenario(){
    if ( $('#dobdd').val() > 0 && $('#dobmm').val() && $('#dobyyyy').val() && $('#idno').val() ){
        
        idno = $('#idno').val().substring(0, 6);

        dobYear = $('#dobyyyy').val().substring(2, 4);;   
        dobMonth = $('#dobmm').val();   
        dobDate = $('#dobdd').val(); 

        if ( dobMonth.length < 2 ){
            dobMonth = '0' + dobMonth
        }
        if ( dobDate.length < 2 ){
            dobDate = '0' + dobDate
        }

        dobString = dobYear + dobMonth + dobDate

        if( idno != dobString){
            errorTemplateDate = '<span class="dobyyyy-icno-error error" for="monthlyincome">Invalid date</span>'
            errorTemplateID = '<span class="dobyyyy-icno-error error" for="monthlyincome">Invalid ID number</span>'
            if( $('.dobyyyy-icno-error').length === 0 ){
                $('#idno').after(errorTemplateID);
                $('#dobyyyy').parent().after(errorTemplateDate);
            }  
            alert('There\'s a descrepancy between ID number and date of birth.');
        }
        else{
            $('.dobyyyy-icno-error').remove();
        }

    }   
}

$(document).ready(function(){

    setChar();
    monthlyIncomeChecking();
    dobJoinedChecking();
    dobICChecking();

    $('.btn-confirm-upload').click(function(){
        // Check if there's any files
        if ( $('.uploadic').val() === "" || $('.uploadincome').val() === "" ){
            $('.filesupload-error').fadeIn(200);
            $('html, body').animate({
                scrollTop: $(".upload-doc-container").offset().top
            }, 500);
        }
    })

    // FATCA Declaration
    // $('.fatca-container .field .radio').each(function(){
    //     $(this).click(function(){
    //         if( $(this).attr('answertype') === 'yes' ){
    //             // Yes
    //             $(this).parent().find('.specify').animate({'opacity':1},200).addClass('mobile-show');
    //         }else if( $(this).attr('answertype') === 'no' ){
    //             // No
    //             $(this).parent().find('.specify').animate({'opacity':0},200).removeClass('mobile-show');
    //         }
    //     })
    // })

    // FATCA Declaration
    var fatcaCount = 0;
    $('.fatca-container .field .radio').each(function(){
        $(this).click(function(){
            if( $(this).attr('answertype') === 'yes' ){
                fatcaCount++;
                $('#fatca-declaration').addClass('active');
            }else if( $(this).attr('answertype') === 'no' ){
                fatcaCount--;
            }
            // console.log(fatcaCount);

            if (fatcaCount === 0){
                $('.btn-card-confirm').removeClass('disabled');
            } else{
                $('.btn-card-confirm').addClass('disabled');
            }
        })
    })


    $('.btn-card-confirm').click(function(){
        $('.error').css('display','inline');
    })

    /*$(function(){
            $(".contactHow-field").change(function(){
                if($('.contactHow-field[value="uploadsig"]').is(':checked'))
                {
                	console.log("hidden upload show BEFORE slideDown");
                    $(".call-me-at-hidden-upload").slideDown()
                    console.log("hidden upload show AFTER slideDown");
                }
                else
                {
                	console.log("hidden upload hide BEFORE slideUp");
                    $(".call-me-at-hidden-upload").slideUp()
                    console.log("hidden upload hide AFTER slideUp");
                }

            })
            $(".contactHow-field").change(function(){
                if($('.contactHow-field[value="uploadsig"]').is(':checked'))
                {
                	console.log("hidden sketch hide BEFORE slideUp");
                   	$(".call-me-at-hidden-sketch").slideUp()
                   	console.log("hidden sketch hide AFTER slideUp");
                }
                else
                {
                	console.log("hidden sketch show BEFORE slideDown");
                   	$(".call-me-at-hidden-sketch").slideDown()
                   	console.log("hidden sketch show AFTER slideDown");
                }

            }) 
        })
    $(function(){
            $(".contactHow-field2").change(function(){
                if($('.contactHow-field2[value="uploadsig2"]').is(':checked'))
                {
                	console.log("hidden upload show 2 BEFORE slideDown");                
                    $(".call-me-at-hidden-upload2").slideDown()
                    console.log("hidden upload show 2 AFTER slideDown");
                } else {
                	console.log("hidden upload hide 2 BEFORE slideUp");
                    $(".call-me-at-hidden-upload2").slideUp()
                    console.log("hidden upload hide 2 AFTER slideUp");
                    
                }

            })
            $(".contactHow-field2").change(function(){
                if($('.contactHow-field2[value="uploadsig2"]').is(':checked'))
                {
                	console.log("hidden sketch hide 2 BEFORE slideUp");
                	$(".call-me-at-hidden-sketch2").slideUp()
                	console.log("hidden sketch hide 2 AFTER slideUp");
                }
                else
                {
                	console.log("hidden sketch show 2 BEFORE slideDown");
                	$(".call-me-at-hidden-sketch2").slideDown()
                	console.log("hidden sketch show 2 AFTER slideDown");
                }
            })
    })*/

});

 // focus out function
 
$(document).ready(function() {
    $('.-phone-no-fill').focusout(function() {
        if($(this).val().length === 0){
            $(this).closest('.four').find('.two input').addClass('not-required');
        }else{
            // console.log("is not empty: got value");
            $(this).closest('.four').find('.two input').removeClass('not-required');
        }
    });
});

// END focus out function
// Apply income value

function getUrlParameter(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++) 
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam) 
        {
            return sParameterName[1];
        }
    }
} 

/*$(document).ready(function(){
    var income = getUrlParameter('income');
    $('#monthlyincome').val(income);      
})*/

// Credit card application form:
$(document).ready(function() {
    // setAllToMaxHeight($(".chosen-card .card-feat"));
    //Styling tooltip
    $('.info-tooltip').each(function(){
        var labelwidth = $(this).parent().parent().find('input[type=text]').width();
        var labelcontentwidth = $(this).parent().find('span').width() + $(this).parent().find('img').width();
        $(this).css({
            'left': labelcontentwidth + 20,
            'width' : labelwidth
        });
    })
    $('.i-info').each(function(){
        $(this).mouseenter(function(){
            $(this).parent().find('.info-tooltip').fadeIn(200);
        });
        $(this).mouseleave(function(){
            $(this).parent().find('.info-tooltip').fadeOut(200);
        });
    });
    //
    if($('.signup-card-section.noneditable-form').length >= 1){
        $('.signup-card-section.noneditable-form').find('input[type=text]').attr('disabled',true);
        $('.signup-card-section.noneditable-form').find('select').attr('disabled',true);
    }
})

// For file input
function uploadFile(){
    $('.uploadbtn').each(function(){
        $(this).change(function(){
            var fileName = $(this).parent().find('.uploadbtn').val();
            fileName = fileName.replace(/^.*[\\\/]/, '');
            var limit = 30;

			// get both parts
			var fileNameExtension = "." + fileName.split(".").pop();
			var fileNameBase = fileName.substring(0, fileName.length - fileNameExtension.length);

			if(fileNameBase.length > limit){
			    // now limit it and set it as fileName
			    // fileName = fileNameBase.substring(0, limit) + fileNameExtension;
			    alert('File name exceed 30 characters. Please rename file name.')
			}
			else{
				$(this).parent().parent().find('.uploadfile').val(fileName);
			}

            //if the input is not empty, show dustbin
            if($(this).parent().parent().find('.uploadfile').val != ""){
                $(this).parent().parent().find('.deleteico').css('display', 'inline');
            }else{
                 $(this).parent().parent().find('.deleteico').css('display', 'none');
            }

            //function of dustbin to detele input data/value, mean while hide dustbin
            $(this).parent().parent().find('.deleteico').click(function(){
                $(this).parent().find('.uploadfile').val('');
                $(this).css('display', 'none');
            })

            // Show Add Another File button only after at least one document is uploaded
            $('.add-file').animate({'opacity':1},250)
        })
    })
}

$(document).ready(uploadFile);

// Length set to 13 = minus 2 default ones
$('.add-file').click(function(){
    if($('.uploadfile-container').find('.uploadfile-row').length < 11){
        $('.uploadfile-row:first-child').clone().appendTo('.uploadfile-container').removeClass('hide'); 
        $('.uploadfile-row:last-child').find('.uploadfile').val("");
        uploadFile(); 
    }

    // Set to 11, including the hidden row
    if($('.uploadfile-container').find('.uploadfile-row').length === 11){
        $(this).hide()
    }
})

// Accordion function
$(document).ready(function(){
    if ($('.accordion-header').length > 0){
        // Accordion
        $('.signup-card-section').find('fieldset').hide()
        $('.signup-card-section:first-child').find('fieldset').slideDown();
        $('.signup-card-section:first-child h2').addClass('active');

        // Click and expand
        $('.signup-card-section h2').click(function(){
            
            if($(this).parent().find('fieldset').css('display') == 'block'){
                $(this).parent().find('fieldset').slideUp();
            }
            else{
                $('.signup-card-section fieldset').slideUp();
                $('.signup-card-section h2').removeClass('active');
                $(this).parent().find('fieldset').slideDown();
            }
            $(this).toggleClass('active');
        })  
    }
})

// $(".signup-card-section h2").click(function(){
//     activateCompletedNotification();
// });

$('.signup-card-section input[type="text"]').blur(function(){
	// alert('bulr')
	activateCompletedNotification();
});

$('label.checkbox').click (function () {
    setTimeout (function () { activateCompletedNotification(); }, 9);
});

$('.signup-card-section select').change(function(){
	activateCompletedNotification();
});

function activateCompletedNotification(){
    $('.signup-card-section').each(function(){
        var badinput = 0;
        var badlabel = 0;
        var errormsg = 0;
        var errormsg2 = 0;
        $(this).find(':text').each(function() {
            if ($.trim($(this).val()) == "" && $(this).hasClass('not-required') === false ) badinput++;
            else if($.trim($(this).val()) == "RM") badinput++; //Fixes bug in IE8 that recognizes RM as value
        });
        $(this).find ('input[type="checkbox"].required').each (function (index, item) {
            if (!$(item).is (":checked")) { badinput++; }
        });
        $(this).find('select').each(function() {
            if ($(this).val() == null) badlabel++;
        });
		$(this).find('label.error').each(function() {
			if ($(this).css('display') == 'block') errormsg++;
		});
        $(this).find('span.error').each(function() {
            if ($(this).length > 0) errormsg2++;
        });

        if (badinput > 0 ||  badlabel > 0 || errormsg > 0 || errormsg2 > 0) {
            $(this).find('.section-complete').css('opacity',0.2)
            $(this).find('.wrap-progress').hide ()
        }
        else {
            $(this).find('.section-complete').css('opacity',1)
            $(this).find('.wrap-progress').show ()
        }
    })
}

function focusToFirstError(){
    firstErrorElementID = $('label.error').attr('id');

    if ($('.accordion-header').length >0) {
         // reset all
        $('.signup-card-section').find('fieldset').hide();
        $('.signup-card-section:first-child h2').removeClass('active');

        // open up first error element
        // $('label.error[id="' + firstErrorElementID + '"]').closest('.signup-card-section').find('fieldset').slideDown();
        // $('label.error[id="' + firstErrorElementID + '"]').closest('.signup-card-section').find('h2.accordion-header').addClass('active');

        var firstError = $('input.error, select.error, textarea.error').first();
        $(firstError).closest('.signup-card-section').find('fieldset').slideDown();
        $(firstError).closest('.signup-card-section').find('h2.accordion-header').addClass('active');
    }
   
}

$(document).ready(function() {
    // validate form on click
    $('.btn-card-next, .btn-card-confirm').click(function() {
        if( $(this).hasClass('disabled') ){
            //do nothing
        }else{
            activateCompletedNotification();
            if ($('.signup-card').valid()) {
                // alert('form is valid');
            } else {
                $('.signup-card').trigger ("jqueryvalidation.fail");
                focusToFirstError();
                // alert('Kindly ensure that all fields are filled accordingly.');
                setTimeout (function () { alert('Kindly ensure that all fields are filled accordingly.'); }, 333);
            }
        }
    });

    // Validate
    $('.btn-edit-form').click(function(){

        var visibleSaveBtn = $('.btn-save-form').filter(function() {
            return $(this).css('display') !== 'none';
        }).length;

        if( visibleSaveBtn >= 1){
            alert('Please save current active section before editing another section');
        }
        else{
            $(this).parent().parent().find('input[type=text]').attr('disabled',false);
            $(this).parent().parent().find('select').attr('disabled',false);
            $(this).parent().parent().removeClass('noneditable-form');
            $(this).hide();
            $(this).parent().find('.btn-save-form').show();
        }
        
    })

$('.btn-save-form').click(function() {

        if ($('.signup-card').valid()) {
            $(this).parent().parent().find('input[type=text]').attr('disabled', true);
            $(this).parent().parent().find('select').attr('disabled', true);
            $(this).parent().parent().addClass('noneditable-form');
            $(this).hide();
            $(this).parent().find('.btn-edit-form').show();

        } else {
            // Checking for errors per section
            var badinput = 0;
            var badlabel = 0;
            var errormsg = 0;
            var errormsg2 = 0;
            $(this).parent().parent().find(':text').each(function() {
                if ($.trim($(this).val()) == "" && $(this).hasClass('not-required') === false ) badinput++;
                else if($.trim($(this).val()) == "RM") badinput++; //Fixes bug in IE8 that recognizes RM as value
            });
            $(this).parent().parent().find('select').each(function() {
                if ($(this).val() == null) badlabel++;
            });
            $(this).parent().parent().find('label.error').each(function() {
                if ($(this).css('display') == 'block') errormsg++;
            });
            $(this).parent().parent().find('span.error').each(function() {
                if ($(this).length > 0) errormsg2++;
            });
            //console.log(errormsg);

            if (badinput > 0 || badlabel > 0 || errormsg > 0 || errormsg2 > 0) {
                alert('Please ensure that all fields are filled accordingly');
            } else {
                $(this).parent().parent().find('input[type=text]').attr('disabled', true);
                $(this).parent().parent().find('select').attr('disabled', true);
                $(this).parent().parent().addClass('noneditable-form');
                $(this).hide();
                $(this).parent().find('.btn-edit-form').show();
            }
        }

    });

    // validate signup form on keyup and submit
    cardclubLength = $('#clubcardno').attr('maxlength');

    $(".signup-card").validate({
        ignore:":hidden:not(#privacyagreement,#cardagreement)",
        errorPlacement : function (error, field) {
 if ($(field).attr ('type') == "checkbox" || $(field).attr ('type') == "radio")
 {
  var field_parent = $(field).parent ();
  error.appendTo ($(field_parent));
 }
},
        rules: {
            salutation: {
                required: true
            },
            annualincome: {
                required: true
            },
            acknowledge: {
                required: true
            },
            name: {
                required: true
            },
            cardname: {
                required: true
            },
            creditcardcustomer: {
                required: true
            },
            idtype: {
                required: true
            },
            idno: {
                required: true,
                minlength: 5,
                maxlength: 12
            },
            dobdd: {
                required: true,
                range: [01, 31]
            },
            dobmm: {
                required: true,
                range: [01, 12]
            },
            dobyyyy: {
                required: true,
                minlength: 4,
                range: [1000, 9999]
            },
            gender: {
                required: true
            },
            race: {
                required: true
            },
            marital: {
                required: true
            },
            nricsg: {
                required: true,
                mysgIC: true
            },
            education: {
                required: true
            },
            nationality: {
                required: true
            },
            mobile: {
                required: true,
                maxlength: 18,
                digits: true
            },
            email: {
                required: true,
                email: true
            },
            emailconfirm: {
                required: true,
                email: true,
                equalTo: "#email"
            },
            emergencycontact: {
                required: true,
            },
            emergencycontactno: {
                required: true,
                minlength: 8,
                maxlength: 14,
                digits: true
            },
            relationship: {
                required: true
            },
            mothername: {
                required: true
            },
            clubcardno: {
                required: false,
                minlength: cardclubLength,
                maxlength: cardclubLength,
            },
            residentialstatus: {
                required: true
            },
            residentialaddress1: {
                required: true,
                maxlength: 29,
            },
            residentialaddress2: {
                required: true
            },
            residentialcity: {
                required: true
            },
            residentialpostcode: {
                required: true,
                minlength: 5,
                digits: true
            },
            residentialstate: {
                required: true
            },
            residentialcountry: {
                required: true
            },
            monthlyincome: {
                required: true
            },
            // monthlyinstallment: {
            //     required: true
            // },
            biznature: {
                required: true
            },
            companyname: {
                required: true
            },
            occupation: {
                required: true
            },
            employmentmm: {
                required: true,
                range: [01, 12]
            },
            employmentyyyy: {
                required: true,
                minlength: 4
                // range: [1000, 9999]
            },
            companyadd1: {
                required: true,
                maxlength: 29,
            },
            companyadd2: {
                required: true,
                maxlength: 29,
            },
            companycity: {
                required: true
            },
            companypostcode: {
                required: true,
                minlength: 5,
                digits: true
            },
            companystate: {
                required: true
            },
            companycountry: {
                required: true
            },
            carddelivery: {
                required: true
            },
            correspondadd: {
                required: true
            },
            estatement: {
            	required: true
            },
            cardagreement: {
            	required: true
            }
        },
        messages: {
            salutation: {
                required: "Please pick a salutation"
            },
            annualincome: {
                required: "Please enter your gross annual salary"
            },
            name: {
                required: "Please enter your name"
            },
            cardname: {
                required: "Please enter your card name"
            },
            creditcardcustomer: {
                required: "Please select yes or no"
            },
            idtype: {
                required: "Please select an ID type"
            },
            idno: {
                required: "Please enter ID number"
            },
            dobdd: {
                required: "Please enter date of birth (DD)"
            },
            dobmm: {
                required: "Please enter date of birth (MM)"
            },
            dobyyyy: {
                required: "Please enter date of birth (YYYY)"
            },
            gender: {
                required: "Please pick a gender"
            },
            race: {
                required: "Please pick your race"
            },
            marital: {
                required: "Please pick your marital status"
            },
            nricsg: {
                required: "Please enter a valid NRIC/Passport"
            },
            education: {
                required: "Please pick your education level"
            },
            nationality: {
                required: "Please pick your nationality"
            },
            mobile: {
                required: "Please enter your mobile number"
            },
            email: {
                required: "Please enter your email address"
            },
            emailconfirm: {
                required: "Please enter your email address again",
                equalTo: "Please ensure your email address is the same"
            },
            emergencycontact: {
                required: "Please enter a emergency contact name"
            },
            emergencycontactno: {
                required: "Please enter emergency contact number"
            },
            relationship: {
                required: "Please enter your relationship"
            },
            mothername: {
                required: "Please enter your mother's maiden name"
            },
            residentialstatus: {
                required: "Please enter enter your residential status"
            },
            residentialaddress1: {
                required: "Please enter enter your residential address (Line 1)"
            },
            residentialaddress2: {
                required: "Please enter enter your residential address (Line 1)"
            },
            residentialcity: {
                required: "Please enter enter your residential city"
            },
            residentialpostcode: {
                required: "Please enter enter your residential postcode"
            },
            residentialstate: {
                required: "Please enter enter your residential state"
            },
            residentialcountry: {
                required: "Please choose your country of residence"
            },
            monthlyincome: {
                required: "Please enter your monthly income"
            },
            // monthlyinstallment: {
            //     required: "Please enter your monthly installment"
            // },
            biznature: {
                required: "Please enter your business of nature"
            },
            companyname: {
                required: "Please enter your company name"
            },
            occupation: {
                required: "Please enter your occupation"
            },
            employmentmm: {
                required: "Please enter your date joined (MM)"
            },
            employmentyyyy: {
                required: "Please enter your date joined (YYYY)"
            },
            companyadd1: {
                required: "Please enter your company address (Line 1)"
            },
            companyadd2: {
                required: "Please enter your company address (Line 2)"
            },
            companycity: {
                required: "Please enter your company city"
            },
            companypostcode: {
                required: "Please enter your company postcode"
            },
            companystate: {
                required: "Please enter your company state"
            },
            companycountry: {
                required: "Please enter your company country"
            },
            carddelivery: {
                required: "Please pick a method of card collection"
            },
            correspondadd: {
                required: "Please pick a correspondence address"
            },
            estatement: {
            	required: "Please pick if you prefer an e-statement or not"
            },
            cardagreement: {
                required: "Please agree to our terms and conditions"
            }
        }
    });

    
});

/* validate myIC and sgIC */
jQuery.validator.addMethod ("mysgIC", function (value, element) {
  if (value == "") return true;
 
  var myIC = /^\d{6}\-?\d{2}\-?\d{4}$/;

  var sgIC = value;
  var sgICResult = false;
    if (sgIC.length != 9){
        sgICResult = false;
    }else{
        sgIC = sgIC.toUpperCase();

        var i,
            icArray = [];
        for(i = 0; i < 9; i++) {
            icArray[i] = sgIC.charAt(i);
        }

        icArray[1] = parseInt(icArray[1], 10) * 2;
        icArray[2] = parseInt(icArray[2], 10) * 7;
        icArray[3] = parseInt(icArray[3], 10) * 6;
        icArray[4] = parseInt(icArray[4], 10) * 5;
        icArray[5] = parseInt(icArray[5], 10) * 4;
        icArray[6] = parseInt(icArray[6], 10) * 3;
        icArray[7] = parseInt(icArray[7], 10) * 2;

        var weight = 0;
        for(i = 1; i < 8; i++) {
            weight += icArray[i];
        }

        var offset = (icArray[0] == "T" || icArray[0] == "G") ? 4:0;
        var temp = (offset + weight) % 11;

        var st = ["J","Z","I","H","G","F","E","D","C","B","A"];
        var fg = ["X","W","U","T","R","Q","P","N","M","L","K"];

        var theAlpha;
        if (icArray[0] == "S" || icArray[0] == "T") {
            theAlpha = st[temp];
        }
        else if (icArray[0] == "F" || icArray[0] == "G") {
            theAlpha = fg[temp];
        }

        sgICResult = (icArray[8] === theAlpha);
    }  

  return myIC.test (value) || sgICResult;
},
'Please enter a valid NRIC number.');

$("#referredbyfriend").hide();

$("#referred").change(function(){
    if ($(this).val() == 'yes'){
        $("#referredbyfriend").show();
        $("#referredbyfriend").find ('input, textarea, select').each (function (index, item) {
                $(item).val ("");
            });
    } else {
        $("#referredbyfriend").hide();
    }
})


// Numeric controlling
$(window).load(function(){
    var currentYear = (new Date).getFullYear();
    // $('#monthlyinstallment').autoNumeric('init', {aSign: 'RM ', mDec: '0'});
    // $('#monthlyincome').autoNumeric('init', {vMax: '99999999', aSign: 'RM ', mDec: '0'});
    // $('#monthlyincome').autoNumeric('init', {aSign: 'RM ', mDec: '0'});
})

// Show hidden items
$('.interest-cpc .btn-show').click(function(){
    $(this).toggleClass('active')
    $(this).parent().find('.hidden').slideToggle();
})

// Character Counting

function countChar(val) {
    var wordlength = val.value.length;
    var maxlength = $(val).attr('maxlength');
    $(val).parent().find('.charnum').text(maxlength - wordlength + ' / ' + maxlength);
};

function setChar(){
    $('.charnum').each(function(){        
        var wordlength =  $(this).parent().parent().find('input').val().length;
        var maxlength =  $(this).parent().parent().find('input').attr('maxlength');
        var lengthAvailable = maxlength - wordlength
        $(this).text(lengthAvailable + ' / ' + maxlength)
    })
}

function monthlyIncomeChecking(){
    $('#monthlyincome').keyup(function(){
        value = $(this).val().replace(/,/g,'');

        if ( value > 99999999 ){
            errorTemplate = '<span class="monthlyincome-max-error error" for="monthlyincome">Maximum income input is RM99,999,999.</span>'
             if( $('.monthlyincome-max-error').length === 0 ){
                $(this).after(errorTemplate);
             }
        } else{
            $('.monthlyincome-max-error').remove();
        }
    })
}

function dobJoinedChecking(){
    $('#dobyyyy, #employmentyyyy').blur(function(){
        dobJoinedCheckingScenario();
    })
}

function dobJoinedCheckingScenario(){
    if ( $('#dobyyyy').val() > 0 && $('#employmentyyyy').val() ){
        // Both fields are filled
        dobYear = $('#dobyyyy').val();
        joinYear = $('#employmentyyyy').val();
        if ( joinYear < dobYear ){
            errorTemplate = '<span class="dobyyyy-employmentyyyy-error error" for="monthlyincome">Invalid date</span>'
            if( $('.dobyyyy-employmentyyyy-error').length === 0 ){
                $('#dobyyyy, #employmentyyyy').after(errorTemplate);
            }  
            alert('There\'s a descrepancy between date company joined and birth year.');
        }
        else{
            $('.dobyyyy-employmentyyyy-error').remove();
        }
    }
}

function dobICChecking(){
    $('#dobdd, #dobmm, #dobyyyy, #idno').blur(function(){
        dobICCheckingScenario();
    })
}

function dobICCheckingScenario(){
    if ( $('#dobdd').val() > 0 && $('#dobmm').val() && $('#dobyyyy').val() && $('#idno').val() ){
        
        idno = $('#idno').val().substring(0, 6);

        dobYear = $('#dobyyyy').val().substring(2, 4);;   
        dobMonth = $('#dobmm').val();   
        dobDate = $('#dobdd').val(); 

        if ( dobMonth.length < 2 ){
            dobMonth = '0' + dobMonth
        }
        if ( dobDate.length < 2 ){
            dobDate = '0' + dobDate
        }

        dobString = dobYear + dobMonth + dobDate

        if( idno != dobString){
            errorTemplateDate = '<span class="dobyyyy-icno-error error" for="monthlyincome">Invalid date</span>'
            errorTemplateID = '<span class="dobyyyy-icno-error error" for="monthlyincome">Invalid ID number</span>'
            if( $('.dobyyyy-icno-error').length === 0 ){
                $('#idno').after(errorTemplateID);
                $('#dobyyyy').parent().after(errorTemplateDate);
            }  
            alert('There\'s a descrepancy between ID number and date of birth.');
        }
        else{
            $('.dobyyyy-icno-error').remove();
        }

    }   
}

$(document).ready(function(){

    setChar();
    monthlyIncomeChecking();
    dobJoinedChecking();
    dobICChecking();

    $('.btn-confirm-upload').click(function(){
        // Check if there's any files
        if ( $('.uploadic').val() === "" || $('.uploadincome').val() === "" ){
            $('.filesupload-error').fadeIn(200);
            $('html, body').animate({
                scrollTop: $(".upload-doc-container").offset().top
            }, 500);
        }
    })

    // FATCA Declaration
    // $('.fatca-container .field .radio').each(function(){
    //     $(this).click(function(){
    //         if( $(this).attr('answertype') === 'yes' ){
    //             // Yes
    //             $(this).parent().find('.specify').animate({'opacity':1},200).addClass('mobile-show');
    //         }else if( $(this).attr('answertype') === 'no' ){
    //             // No
    //             $(this).parent().find('.specify').animate({'opacity':0},200).removeClass('mobile-show');
    //         }
    //     })
    // })

    // FATCA Declaration
    var fatcaCount = 0;
    $('.fatca-container .field .radio').each(function(){
        $(this).click(function(){
            if( $(this).attr('answertype') === 'yes' ){
                fatcaCount++;
                $('#fatca-declaration').addClass('active');
            }else if( $(this).attr('answertype') === 'no' ){
                fatcaCount--;
            }
            // console.log(fatcaCount);

            if (fatcaCount === 0){
                $('.btn-card-confirm').removeClass('disabled');
            } else{
                $('.btn-card-confirm').addClass('disabled');
            }
        })
    })


    $('.btn-card-confirm').click(function(){
        $('.error').css('display','inline');
    })

    $(function(){
            $(".contactHow-field").change(function(){
                if($('.contactHow-field[value="uploadsig"]').is(':checked'))
                    $(".call-me-at-hidden-upload").slideDown()
                else
                    $(".call-me-at-hidden-upload").slideUp()

            })
            $(".contactHow-field").change(function(){
                if($('.contactHow-field[value="uploadsig"]').is(':checked'))
                   $(".call-me-at-hidden-sketch").slideUp() 
                else
                   $(".call-me-at-hidden-sketch").slideDown()

            }) 
        })
    $(function(){
            $(".contactHow-field2").change(function(){
                if($('.contactHow-field2[value="uploadsig2"]').is(':checked')) {
                                    
                    $(".call-me-at-hidden-upload2").slideDown()
                } else {
                    $(".call-me-at-hidden-upload2").slideUp()
                }

            })
            $(".contactHow-field2").change(function(){
                if($('.contactHow-field2[value="uploadsig2"]').is(':checked'))
                   $(".call-me-at-hidden-sketch2").slideUp() 
                else
                   $(".call-me-at-hidden-sketch2").slideDown()
            })
    })

});


// $(window).load(function(){
//     $('#fatca-declaration .close').click(function(){
//         $('#fatca-declaration').removeClass('active');
//     });
// });

//////////////// Credit card eform js //////////////// 


function controlFloatLabel() {


	////////// For Input Text ///////////

    $('.wrapfloat-each-field').find ('input').each (function (index, input) {
        var label_error = $(input).parents (".wrapfloat-each-field").find ("label.error");
        var label_float = $(input).parents (".wrapfloat-each-field").find ("label.float-label");

		// label float up when input has value except enrich membership text field
		if ($(input).val () !== "") { 
          $(label_float).addClass ("float-up");
          $("#enrich, #mhId, #membershipNumber").parent().find("label").removeClass("float-up");

        }

        // focus and blur events requires separate responses depending on field value and field validity

        $(input).on ("focus.labelFloatControl", function () {
            // float up immediately on focus
            $(label_float).addClass ("float-up");

            // wait for validation to complete:
            setTimeout (function () {
                if ($(input).hasClass ("error"))
                {
                    // field has error, hide label
                    $(label_float).hide ();
                }
            }, 1);
        });

        $(input).on ("blur.labelFloatControl keyup.labelFloatControl change.labelFloatControl autoPop.labelFloatControl", function () {
            if ($(input).val () == "")
            {
                // field is empty, un-float label
                $(label_float).removeClass ("float-up");
            }
            else
            {
                // field is not empty, float label up
                $(label_float).addClass ("float-up");
            }

            // wait for validation to complete:
            setTimeout (function () {
                if ($(input).hasClass ("error"))
                {
                    if ($(input).val () == "")
                    {
                        // field is invalid and empty, show label
                        $(label_float).show ();
                    }
                    else
                    {
                        // field is invalid and not empty, hide label
                        $(label_float).hide ();
                    }
                }
                else
                {
                    // field is valid, show label
                    $(label_float).show ();
                }
            }, 1);
        });
    });


	////////// For Select ///////////

	// hide first selection due to float-label
	$('.wrapfloat-each-field').find('.picker-customized select').prop("selectedIndex", -1);

    // show first selection due to float-label
    $('.wrapfloat-each-field').find('.picker-customized.-show-select select').prop("selectedIndex", 0);  

	// float label when change
	$('.wrapfloat-each-field .picker-customized select').change(function(){
		$(this).parent().parent().find('label.float-label').addClass('float-up');
		$(this).parent().parent().find('label.error').hide();
	});
	
	// scan whether select field valid
	$('.wrapfloat-each-field .picker-customized select').on('blur', function(){

	  if($(this).hasClass('valid')){
	    $(this).parent().parent().find('label.float-label').addClass('float-up');
	    $(this).parent().parent().find('label.error').hide();
	  } else {
	    $(this).parent().parent().find('label.float-label').removeClass('float-up');
	  }

	});


}

/* validation rule for dd/mm/yyyy */
var dobpatt = /^\d{2}[\/\-\s\.]\d{2}[\/\-\s\.]\d{4}$/;
jQuery.validator.addMethod ("validDobString", function (value, element) {
  if (value == "") return true;
  return dobpatt.test (value);
},
'Please enter a valid date.');

/* https://stackoverflow.com/questions/7763327/how-to-calculate-date-difference-in-javascript */
/*function dateDiffDays (date1, date2)
{
  date1.setHours (0);
  date1.setMinutes (0, 0, 0);
  date2.setHours (0);
  date2.setMinutes (0, 0, 0);
  var datediff = Math.abs (date1.getTime() - date2.getTime()); // difference 
  return parseInt (datediff / (24 * 60 * 60 * 1000), 10); //Convert values days and return value
}*/

function dateDiffYears (date1, date2)
{
  date1.setHours (0);
  date1.setMinutes (0, 0, 0);
  date2.setHours (0);
  date2.setMinutes (0, 0, 0);
  return Math.abs (date1.getFullYear () - date2.getFullYear ());

}

/* minimum age detector for the date format dd/mm/yyyy */
jQuery.validator.addMethod ("minAge", function (value, element, param) {
  var inputDateSplit = value.split ("/");
  var inputDate = new Date (inputDateSplit[2], parseInt (inputDateSplit[1]) - 1, inputDateSplit[0]);
  var toDate = new Date ();
  var diffYears = dateDiffYears (inputDate, toDate);

  return (diffYears >= param);
},
'Date must be greater than or equal to today');

////////// Activate Date Picker ///////////

$(function() {
  var currentDate = new Date();
  $( "#datepicker_employmentdate" ).datepicker({ 
        changeMonth: true,
        changeYear: true,
        showButtonPanel: true,
        dateFormat: 'MM yy',
        'duration': "slow",
        // onChangeMonthYear: function(year, month, widget) {
        //     setTimeout(function() {
        //        $('.ui-datepicker-calendar').hide();
        //     },0);
        // },
        onChangeMonthYear: function(year, month, widget) {
            setTimeout(function() {
               $('.ui-datepicker-calendar').hide();
            },0);
        },
        onClose: function(dateText, inst) { 
            $(this).datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, 1));
            $('.ui-datepicker-calendar').hide();
            $("#datepicker_employmentdate").trigger ("autoPop.labelFloatControl");
        }

  }).on('click select', function(){
      $('.ui-datepicker-calendar').hide();
  });

  $("#datepicker_employmentdate").datepicker("setDate");
});

$('.btn-card-next-pi').click(function() { 
	if($('.signup-card.eform-step1').valid()){
		$(".personal-info").css("display","none");
        $(".h1-cceform").css("display","none");
		$(".chosen-card-container").css("display","none");
		$(".contact-details").css("display","block");
        $('html,body').animate({
        scrollTop: $("body").offset().top},
        'fast');
        setTimeout (function () {
          $('form.signup-card :input').removeClass('error');
          $('form.signup-card label.error').hide();
        },99)
	}
});
$('.btn-card-back-cd').click(function() {
	$(".personal-info").css("display","block");
    $(".h1-cceform").css("display","block");
	$(".chosen-card-container").css("display","block");
	$(".contact-details").css("display","none");
});
$('.btn-card-next-cd').click(function() {
	if($('.signup-card.eform-step1').valid()){
		$(".contact-details").css("display","none");
        $(".h1-cceform").css("display","none");
		$(".chosen-card-container").css("display","none");
		$(".employment-info").css("display","block");
        $('html,body').animate({
        scrollTop: $("body").offset().top},
        'fast');
        setTimeout (function () {
          $('form.signup-card :input').removeClass('error');
          $('form.signup-card label.error').hide();
        },99)
	}
});
$('.btn-card-back-ei').click(function() {
	$(".employment-info").css("display","none");
	$(".contact-details").css("display","block");
    $('html,body').animate({
        scrollTop: $("body").offset().top},
        'fast');
});

/* STEP 1 VALIDATION ---------------------------- */
$("form.signup-card.eform-step1").validate({
    ignore:":hidden:not(#privacyagreement,#cardagreement)",

          errorPlacement: function(error, element) 
          {
              if ( element.is(":radio") ) 
              {
                  error.appendTo( element.parents('.form-field') );
              }
              else
              { // This is the default behavior 
                  error.insertAfter( element );
              }
          },

          rules: {
            emergencycontact: {
              required: true,
            },
            emergencycontactno: {
              required: true,
              minlength: 8,
              maxlength: 14,
              digits: true,
              numberNotStartWithZero2: true

            },
            name: {
                required: true
            },
            cardname: {
                required: true
            },
            idno: {
                required: true,
                minlength: 12,
                maxlength: 12,
                invaliddob: true
            },
			dobDate: {
              required: true,
              invaliddob: true
            },
            dobMonth: {
              required: true,
            },
            dobYear: {
              required: true,
            },
            dobDD: {
                required: true,
                invaliddob: true
            },
            dobMM: {
                required: true
            },
            dobYYYY: {
                required: true,
                validDobString: true,
                minAge: 21,
            },
            gender: {
                required: true
            },
            race: {
                required: true
            },
            marital: {
                required: true
            },
            education: {
                required: true
            },
            mothername: {
                required: true
            },
            mobile: {
                required: true,
                maxlength: 18,
                digits: true,
                numberNotStartWithZero: true
            },
            email: {
                required: true,
                customemail: true,
                email: true
            },
            emailconfirm: {
                required: true,
                email: true,
                customemail: true,
                equalTo: "#email"
            },
            masEnrichNo: {
                required: false,
                maxlength: 9,
                minlength: 9,
                digits: true
            },
            membershipNumber: {
                required: false,
                maxlength: 18,
                minlength: 18,
                digits: true
            },
            giftPreference: {
			  required: true,
            },
            privacyagreement: {
			  required: true,
            },
            emergencycontact: {
              required: true,
            },
            emergencycontactno: {
              required: true,
              minlength: 8,
              maxlength: 14,
              digits: true,
              numberNotStartWithZero2: true
            },
            relationship: {
              required: true
            },
            residentialstatus: {
              required: true
            },
            residentialaddress1: {
              required: true,
              maxlength: 29,
            },
            residentialaddress2: {
              required: true,
              maxlength: 29,
            },
            residentialcity: {
              required: true
            },
            residentialpostcode: {
              required: true,
              minlength: 5,
              digits: true
            },
            residentialstate: {
              required: true
            },
            monthlyincome: {
              required: true
            },
            monthlyinstallment: {
              required: true
            },
            monthlyinstallmentyesvalue: {
              required: true,
              monthlyInstallmentMethod: true
            },
            biznature: {
              required: true
            },
            employmenttype: {
              required: true
            },
            employmentsector: {
              required: true
            },
            companyname: {
              required: true
            },
            workph: {
              required: true,
              maxlength: 18,
              digits: true,
              numberNotStartWithZeroWork: true
            },
            occupation: {
              required: true
            },
            selectMonth: {
              required: true
            },
            employmentYear: {
              required: true
            },
            companyadd1: {
              required: true,
              maxlength: 29,
            },
            companyadd2: {
              required: true,
              maxlength: 29,
            },
            companycity: {
              required: true
            },
            companypostcode: {
              required: true,
              minlength: 5,
              digits: true
            },
            companystate: {
              required: true
            },
            companycountry: {
              required: true
            },
            cardagreement: {
              required: true
            },
        },
        messages: {
            name: {
                required: "Please enter your name"
            },
            cardname: {
                required: "Please enter your card name"
            },
            idno: {
                required: "Please enter your IC number",
                invaliddob: "Please enter your valid IC number",
                minlength: "Please enter at least 12 Characters"
            },
            dobDate: {
              dobcf: "please enter your valid date"
            },
            dobDD: {
                required: "Please enter date of birth (DD/MM/YYYY)"
            },
            dobMM: {
                required: "Please enter date of birth (DD/MM/YYYY)"
            },
            dobYYYY: {
                required: "Please enter date of birth (DD/MM/YYYY)",
                validDobString: "Please enter a valid date of birth",
                minAge: "Applicant must be 21 years and above"
            },
            dobDate: {
              dobcf: "please enter your valid date"
            },
            gender: {
                required: "Please pick a gender"
            },
            race: {
                required: "Please pick your race"
            },
            marital: {
                required: "Please pick your marital status"
            },
            education: {
                required: "Please pick your education level"
            },
            mothername: {
                required: "Please enter your mother's maiden name"
            },
            mobile: {
                required: "Please enter your mobile number",
                numberNotStartWithZero: "Please enter a valid mobile number"
            },
            email: {
                required: "Please enter your email address"
            },
            emailconfirm: {
                required: "Please enter your email address again",
                equalTo: "Please ensure your email address is the same"
            },
            masEnrichNo: {
                required: "Please enter your Enrich membership ID"
            },
            membershipNumber: {
                required: "Please enter your Tesco membership ID"
            },
            giftPreference: {
                required: "Please complete Gift Code"
            },
            privacyagreement: {
              required: "Please agree to our terms and conditions"
            },
            emergencycontact: {
                required: "Please enter a emergency contact name"
            },
            emergencycontactno: {
                required: "Please enter emergency contact number",
                numberNotStartWithZero2: "Please enter a valid mobile number"

            },
            relationship: {
                required: "Please enter your relationship"
            },
            residentialstatus: {
                required: "Please enter your residential status"
            },
            residentialaddress1: {
                required: "Please enter your residential address (Line 1)"
            },
            residentialaddress2: {
                required: "Please enter your residential address (Line 2)"
            },
            residentialcity: {
                required: "Please enter your residential city"
            },
            residentialpostcode: {
                required: "Please enter your residential postcode"
            },
            residentialstate: {
                required: "Please enter your residential state"
            },
            monthlyincome: {
                required: "Please enter your monthly income"
            },
            monthlyinstallment: {
                required: "Please enter monthly installment with non-banks"
            },
            monthlyinstallmentyesvalue: {
                required: "Invalid number",
                monthlyInstallmentMethod: "Invalid number"
            },
            employmentstatus: {
                required: "Please pick your employment status"
            },
            biznature: {
                required: "Please enter your business of nature"
            },
            employmenttype: {
                required: "Please enter your employment type"
            },
            employmentsector: {
                required: "Please enter your employment sector"
            },
            companyname: {
                required: "Please enter your company name"
            },
            workph: {
                required: "Please enter your company phone number",
                numberNotStartWithZeroWork: "Please enter a valid number"
            },  
            occupation: {
               required: "Please enter your occupation"
            },
            selectMonth: {
                required: "Select a Month"
            },
            employmentYear: {
                required: "Select a Year"
            },
            companyadd1: {
                required: "Please enter your company address (Line 1)"
            },
            companyadd2: {
                required: "Please enter your company address (Line 2)"
            },
            companycity: {
                required: "Please enter your company city"
            },
            companypostcode: {
                required: "Please enter your company postcode"
            },
            companystate: {
                required: "Please enter your company state"
            },
            companycountry: {
                required: "Please enter your company country"
            },
            cardagreement: {
                required: "Please agree to our terms and conditions"
            },  
            
        }


});



function activateCompletedProgress(){
    
  $('.wrap-progress').hide();
  // the rest, use the function activateCompletedNotification() in cardapply.js

} 


function scrollToFirstError(){

  var firstError = $('input.error, select.error, textarea.error, label.error').first();
  var signupcard = $('.signup-card');
  $('body').find(firstError).focus();

  if (signupcard.length){
    $('html, body').animate({
      scrollTop: $(firstError).offset().top - 220
    }, 333);
  } else {
    $('html, body').animate({
      scrollTop: $(firstError).offset().top
    }, 333);
  }

}




// listen for form validation fail, and then scroll to error
$('.signup-card.eform-step1, .signup-card.eform-step2, .signup-card.eform-step3').on ("jqueryvalidation.fail", function () {
  scrollToFirstError ();
});



/* convert MY NRIC to birthdate */
$.fn.ic2dob = function (options) {
    var field_dob = this;
    var settings = $.extend ({
        min_age: 21,
    }, options);

    var field_ic = $(field_dob).attr ('data-field-ic');
    if ($(field_ic).length != 1)
    {
        console.log ('$.ic2dob - data-field-ic must be defined, and exists');
        return false;
    }

    /* validate yymmdd */
    function validate_yymmdd (yy, mm, dd)
    {
        var today = new Date ();
        var year = today.getFullYear ();

        var inyear = parseInt (Math.floor (year / 100) + "" + yy);

        if (inyear > year || year - inyear < settings.min_age)
        {
            inyear = parseInt (Math.floor (year / 100 - 1) + "" + yy);
        }

        if (!Date.parse (inyear + "-" + mm + "-" + dd))
        {
            return false;
        }

        mm = parseInt (mm);
        dd = parseInt (dd);

        return inyear;
    }

    /* do the conversion */
    $(field_ic).on ("change.ic2dob", function () {
        var myicpatt = /(\d{2})(\d{2})(\d{2})\d{2}\d{4}/;
        var xt = myicpatt.exec ($(field_ic).val ());

        if (xt != null && xt[1] != null && xt[2] != null && xt[3] != null)
        {
            var yy = (xt[1]);
            var mm = (xt[2]);
            var dd = (xt[3]);

            // validate IC input (and get the full year in the process)
            var fullyear = validate_yymmdd (yy, mm, dd);
            if (fullyear === false)
            {
                console.log ('Invalid birthdate in IC number');
                $(field_dob).val ("");
                return false;
            }

            //$(field_dob).val (mm + "/" + dd + "/" + fullyear);
            $("#dobMonth").val ( mm );
            $("#dobDate").val ( dd );
            $("#dobYear").val ( fullyear );
            $(field_dob).trigger ("autoPop.labelFloatControl");
        }
    });

    $(field_dob).addClass ("-ic2dob-wired-");
};

// Validation dob && IC ///
    
function isDate(txtDate)
{
    var currVal = txtDate;
    if(currVal == '')
        return false;
    
    // var rxDatePattern = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/; //Declare Regex
    // var dtArray = currVal.match(rxDatePattern); // is format OK?
    
    // if (dtArray == null) 
    //     return false;
    
    //Checks for mm/dd/yyyy format.
    dtMonth = $("#dobMonth").val();
    dtDay= $("#dobDate").val();
    dtYear = $("#dobYear").val();
    
    if (dtMonth < 1 || dtMonth > 12) 
        return false;
    else if (dtDay < 1 || dtDay> 31) 
        return false;
    else if ((dtMonth==4 || dtMonth==6 || dtMonth==9 || dtMonth==11) && dtDay ==31) 
        return false;
    else if (dtMonth == 2) 
    {
        var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));
        if (dtDay> 29 || (dtDay ==29 && !isleap)) 
                return false;
    }
    return true;
}

  $('.focusOutTest').focusout (function (index, item) {
      var txtValIc =  $('#newic').val();
      // $("#dobDate, #dobMonth, #dobYear").attr("readonly", false); 
      if(isDate(txtValIc))
          console.log("ic correct detected.")
      else
          console.log("ic Incorrect detected!")
  });

  jQuery.validator.addMethod('invaliddob', function (value, element, param) {
      var txtVal =  $('#dobMonth').val();
      var txtVal2 =  $('#dobDate').val();
      var txtVal3 =  $('#dobYear').val();
       if(isDate(txtVal) && isDate(txtVal2) && isDate(txtVal3) ){
        console.log("Valid Date detected.");
        return (isDate(txtVal) && isDate(txtVal2) && isDate(txtVal3) ) ;
        $('#dobDate, #dobMonth, #dobYear').css("border", "1px solid #d8d8d8");
    }else{
        console.log("Invalid Date detected.");
        }
  }, 'Please enter a valid date'); 

// $('#dobYear').focusout (function (index, item) {
//   setTimeout (function () {
//     if($(".error-btm input").hasClass("error")){
//       $('#dobDate, #dobMonth, #dobYear').css("border", "1px solid red");
//     }else{
//       return true;
//     }
//   }, 99);

// });

// Validation dob && IC ///
function cppAccordion () {
  $('.cpp-accordion').each(function(index,item){
    var sectionHeader = $(item).find('.cpp-accordion-header');
    var sectionContent = $(item).find('.cpp-accordion-content');

    $(sectionContent).hide();

    $(sectionHeader).click(function(){
      $(this).parent('.cpp-accordion').toggleClass('active');
      $(this).parent('.cpp-accordion').find('.cpp-accordion-content').slideToggle();
    })

  });
}


function accordionUpload () {
  $('.upload-accordion').each(function(index, item){

    var eachSection = $(item).find('.signup-card-section');
    var activeSection = $(item).find('.signup-card-section.active');
    var sectionRadio = $(item).find('.signup-card-section').find('.upfile-radio .field label');
    var eachSectionDetails = $(item).find('.signup-card-section').find('.upload-details');
    var eachActiveSectionDetails = $(item).find('.signup-card-section.active').find('.upload-details');

    $(eachSectionDetails).hide();
    $(activeSection).find(eachSectionDetails).show();

    

    $(sectionRadio).click(function(){
      $(this).parent().parent().parent(eachSection).toggleClass('active');
      $(sectionRadio).not(this).parent().parent().parent(eachSection).removeClass('active');
      $(eachSectionDetails).slideUp();
      $(this).parent().parent().parent(eachSection).find('.upload-details').slideDown();

    });



  });
}

function hiddenField () {
    $('label.radio').on('click touchstart',function() {
        setTimeout (function () {
            if ($("label.radio[for=monthlyinstallment-yes]").hasClass("checked")) {
                $('#hidden-field-monthlyinstallment').removeClass('hidden');
            } else {
                $('#hidden-field-monthlyinstallment').addClass('hidden');
            }
        },99)
    });
}

function eformToolTip () {

  $ ('.wrap-tooltip').each(function(){

    var tooltipinfo = $(this).find('.info-tooltip');
    var tooltipicon = $(this).find('.i-info');

    // Add class for red styling
    //$(tooltipinfo).addClass ('tooltip-red');

    $(tooltipinfo).each(function(){
        var labelwidth = $(this).parent().parent().find('input[type=text]').width();
        var labelcontentwidth = $(this).parent().find('span').width() + $(this).parent().find('img').width();
        $(this).css({
            //'left': 'auto!important',
            'right': -10,
            'top': 30,
            'width' : labelwidth
        });
    });
    $(tooltipicon).each(function(){
        $(this).mouseenter(function(){
            $(this).parent().find(tooltipinfo).fadeIn(200);
        });
        $(this).mouseleave(function(){
            $(this).parent().find(tooltipinfo).fadeOut(200);
        });
    });


  });
   
}


function strictly_numbers_valcheck (event)
{
  var field = event.target;
  var fieldval = $(field).val ();
  fieldval = fieldval.replace (/[\D]/g, '');  
  if (fieldval !== $(field).val ())  
  {    
      $(field).val (fieldval);  
  }
}


//// detect IC last digit number to auto select gender ////


$.fn.checkIcLastDigit = function(){
  var icLastDigit = $(".-last-digit").val().substring(11, 12); 
  if(icLastDigit % 2 == 0){
    $("#gender").val("Female");
    $("label.label-gender[for=gender]").addClass("float-up");
  }else{
    $("#gender").val("Male");
   $("label.label-gender[for=gender]").addClass("float-up");
  }
}

function icToGender(){
  $(".-last-digit").focusout (function (index, item) {
    $(item).checkIcLastDigit ();
  });
}

//// detect IC last digit number to auto select gender ////
// //// mobile/phone validation - zero ///
  // $.fn.checkPhoneNo = function () { 
  //     var firstNo = $(".-js-detect-zero").val().substring(0, 1);
  //     if(firstNo != 0) {
  //       console.log("not start from 0");
  //     }else{      
  //       console.log("correct! start from 0");
  //     }
  //     // jQuery.validator.addMethod ("validPhone", function () {
  //     //   if (firstNo != 0) return true;
  //     //   return firstNo.test (value);
  //     // },
  //     // 'Please enter a valid phone.');
  // };

  // function phoneValidateZero(){
  //   $(".-js-detect-zero").focusout (function (index, item) {
  //     $(item).checkPhoneNo ();
  //   });
  // }

  jQuery.validator.addMethod('numberNotStartWithZero', function (value, element, param) {
        var firstNo = $(".-js-detect-zero").val().substring(0, 1);
         return (firstNo == 0);
     }, 'Please enter a non zero integer value!');
  jQuery.validator.addMethod('numberNotStartWithZero2', function (value, element, param) {
        var firstNo = $(".-js-detect-urgent-zero").val().substring(0, 1);
         return (firstNo == 0);
     }, 'Please enter a non zero integer value!');
  jQuery.validator.addMethod('numberNotStartWithZeroWork', function (value, element, param) {
        var firstNo = $(".-js-detect-work-zero").val().substring(0, 1);
         return (firstNo == 0);
     }, 'Please enter a non zero integer value!');

// //// mobile/phone validation - zero ///

//email .com validaiton rules
$.validator.addMethod("customemail", 
    function(value, element) {
        return /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(value);
    }, 
    "Please enter your valid email"
);
//email .com validaiton rules

// For file input
function uploadFile(){

    $('.uploadbtn-cceform').each(function(){
        $(this).change(function(){
            var fileName = $(this).parent().find('.uploadbtn').val();
            fileName = fileName.replace(/^.*[\\\/]/, '');
            var limit = 30;

            // get both parts
            var fileNameExtension = "." + fileName.split(".").pop();
            var fileNameBase = fileName.substring(0, fileName.length - fileNameExtension.length);

            if(fileNameBase.length > limit){
                // now limit it and set it as fileName
                // fileName = fileNameBase.substring(0, limit) + fileNameExtension;
                alert('File name exceed 30 characters. Please rename file name.')
            }
            else{
                $(this).parent().parent().find('.uploadfile').val(fileName);

				//P2D1
				$('.add-file-container').show();
            }
			// if($(this).parent().parent().find('.uploadfile').val != ""){
   //              $(this).parent().parent().find('.deleteico').css('display', 'inline');
   //          }else{
   //               $(this).parent().parent().find('.deleteico').css('display', 'inline');
			// 	$(this).parent().remove();
   //          }

            //function of dustbin to detele input data/value, mean while hide dustbin
    //         $(this).parent().parent().find('.deleteico').click(function(){
    //             $(this).parent().find('.uploadfile').val('');
				// $(this).parent().parent().remove();
    //             $(this).css('display', 'inline');
    //         })
        })
    })

    //function of dustbin to detele input data/value
    $('.deleteico').click(function(){
        $(this).parent().find('.uploadfile').val('');
    })

    //function for dustbin remove for "add new-fiels only" (for clone input)
    $('.deleteico-add-file').click(function(){
        $(this).parent().find('.uploadfile').val('');
        $(this).parent().remove();
		console.log("test1");
    }) 

}

/// Total monthly installmetns != 0 ///
jQuery.validator.addMethod('monthlyInstallmentMethod', function (value, element) {
      var monthlyInsVal = $("#monthlyinstallmentyesvalue").val().substring(0, 1);
       return (monthlyInsVal != 0);
   }," ");
/// Total monthly installmetns != 0 ///

/// add not-required by radio result ////


    $('label.yes-monthly span').click(function () {
        $(this).parent().parent().find(".income-input").removeClass("not-required");
    });  

    $('label.no-monthly span').click(function () {
        $(this).parent().parent().find(".income-input").addClass("not-required");
    });    


/// add not-required by radio result ////

///  reset text field validation ///

$('label.no-monthly span').click(function () {
    $('#monthlyinstallmentyesvalue').removeClass('error').next('label.error').remove();
}); 

///  reset text field validation ///

/// click page to refresh/re-run activateCompletedNotification //
$(document).click(function(e) {
   activateCompletedNotification();
});
/// click page to refresh/re-run activateCompletedNotification //

$(document).ready(function(){
	controlFloatLabel();
  activateCompletedProgress();
  cppAccordion ();
  accordionUpload();
  hiddenField();
  eformToolTip ();
  icToGender();

  //Ignore hidden fields
  // $.validator.setDefaults({
  //       ignore: ":hidden"
  // });

  // Activate ic auto populate to dob
  $('.-js-ic2dob').not (".-ic2dob-wired-").each (function (index, item) {
        $(item).ic2dob ();
  });

});

/// mm fake placeholder
$("#selectMonth").change(function(){
if ( $(this).val() == "" ) {
//do nothing;
}else{
$(".-mm-placeholder").hide();
}
});
/// mm fake placeholder

// For Map Locator

gmarkers = new Array();
var globapMap;
$(function(){
    $(".hide-branch-list-btn").click(function(){
        var obj = $(this)
        $(".branch-list ul").slideToggle(function(){
            
            if($(this).is(":hidden")) {
                obj.removeClass("active");
            } else {
                obj.addClass("active");
            }
        })
    })
    
    $(".branch-tab:not(.hide-branch-list-btn)").click(function(){

        $(this).addClass("selected")
        $(".branch-list").slideDown()
        $(".atm-tab").removeClass("selected");

        relocate('branch');
    })
        
    $(".atm-tab").click(function(){
        $(".branch-list ul").slideUp()
        $(this).addClass("selected")
        $(".branch-list").slideUp("normal",function(){
            $(".hide-branch-list-btn").removeClass("active");
        })
        $(".branch-tab").removeClass("selected")

        relocate('atm');
    });
    
    function relocate(currentlocation){
        for(var i = 0; i <gmarkers.length; i++){
            //console.log(gmarkers[i]);
            var thisMarker = gmarkers[i];
            var thisMarkerType = thisMarker.markerType;
            var thisMarkerAddress = thisMarker.markerAddress;
            var thisMarkerSvcType = thisMarker.markerSvcType;

            thisMarkerSvcType = thisMarkerSvcType.replace(/-/g, " ");
            var selectedSvcTypeArr = selectedServiceTypes.split(",");
            selectedSvcTypeArr.splice(-1,1);
            var correctState = false;
            var hasSvcTypes = false;
            
            if(thisMarkerAddress.indexOf(selectedState) > -1){
                correctState = true;
            }
            else correctState = false;
            for(var j = 0; j < selectedSvcTypeArr.length; j++){
                var selectedSvcType = selectedSvcTypeArr[j].toLowerCase();
                if(thisMarkerSvcType.indexOf(selectedSvcType) > -1){
                    //OR logic
                    hasSvcTypes = true;
                }
            }
            
            if(thisMarkerType != currentlocation || !correctState){
                thisMarker.setMap(null);
            }
            else if(thisMarkerType === currentlocation || correctState){
                if(thisMarkerType === "branch" && hasSvcTypes){
                    thisMarker.setMap(map);
                }
                else if(thisMarkerType === "branch" && !hasSvcTypes) thisMarker.setMap(null);
                else if(thisMarkerType ==="atm") thisMarker.setMap(map);
            }
        }
    }
    
    if(!("latlng" in window)){
        latlng ="";
    }
    $(document).ready(function(){
        if(hasMapLocator){
            relocate('branch');
            map.setZoom(15);
            map.setCenter(latlng);
        }

    });
    
    //Determine if theres map locator component because top nav uses google map api also but without the map.
    var maplocatorclass = $('.map-locator');
    var hasMapLocator = false;
    if(maplocatorclass.length > 0){
        hasMapLocator = true;
    }
    else hasMapLocator = false;

    //Run getLocation only if there is map locator, else other pages throw reference error.
    if(hasMapLocator){
        getLocation();
    }
    function getLocation() {
        if (navigator.geolocation)
        {
			//Temporarily disabled to always show default location
            //navigator.geolocation.getCurrentPosition(showPosition,showError);
            return;
        }
        else
        {
            return;
        }
        
    }
    function showPosition(position) {
        myLat = position.coords.latitude;
        myLong = position.coords.longitude;
        var yourPlaceIcon= imagePath + 'yourplace.png';

        var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            icon: yourPlaceIcon,
            zIndex: 10
        });
                
        map.setZoom(15);
        map.setCenter(latlng);        
    }
        
    function showError(error) {
        switch(error.code) 
        {
            case error.PERMISSION_DENIED:
              //x.innerHTML="User denied the request for Geolocation."
              break;
            case error.POSITION_UNAVAILABLE:
              //x.innerHTML="Location information is unavailable."
              break;
            case error.TIMEOUT:
              //x.innerHTML="The request to get user location timed out."
              break;
            case error.UNKNOWN_ERROR:
              //x.innerHTML="An unknown error occurred."
              break;
        }
    }
    
    $('select').change(function(){
        var selectedTab;
        var selectedState = $('select option:selected').val();
        $('.service-tab').each(function(){
            if($(this).hasClass("selected")){
                selectedTab = $(this).find('span.service-text').text().toLowerCase();
            }
        });
        relocate(selectedTab);
    });
    
    //latlng is defined in component   
    if(!latlng){
        latlng = new google.maps.LatLng(3.15399379362, 101.696470209);
    }
    else{
        var latlngArr = latlng.split(",");
        var userlat = latlngArr[0];
        var userlng = latlngArr[1];
        latlng = new google.maps.LatLng(userlat, userlng);
    }
    
    var myOptions ={
        map: map,
        zoom: 5,
        minZoom: 2,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        panControl: false,
        zoomControl: true,
        mapTypeControl: false,
        scaleControl: true,
        streetViewControl: true,
        navigationControl: true
    };
    
    //Render map only if there is map locator class, else other page will throw error.
    if(hasMapLocator){
        var map = new google.maps.Map(document.getElementById("map"), myOptions);
        var geocoder = new google.maps.Geocoder();
        var infowindow = new google.maps.InfoWindow();

        globapMap = map;

        var marker, i;
        
        for (i = 0; i < markerLocations.length; i++) {
            //console.log(markerLocations[i]);
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(markerLocations[i][1], markerLocations[i][2]),
                map: map,
                icon: imagePath+markerLocations[i][8],
                zIndex: 10,
                markerType: markerLocations[i][7],
                markerAddress: markerLocations[i][3],
                markerSvcType: markerLocations[i][9]
            });

            google.maps.event.addListener(marker, 'click', (function(marker, i) {
                return function() {
                    regex = /<br\s*[\/]?>/gi;
                    markerLocation = markerLocations[i][1].replace(regex,'')+', '+markerLocations[i][2].replace(regex,'');
                    
                    //Individual Pop Up Content
                    var popTel = "";
                    var popFax = "";
                    var popOperating = "";
                    
                    if(markerLocations[i][4].replace(/\<br \/\>/g, "").length > 0){
                        popTel = "<p><label>"+telLabel+"</label>"+markerLocations[i][4]+"</p>";
                    }
                    if(markerLocations[i][5].replace(/\<br \/\>/g, "").length > 0){
                        popFax = "<p><label>"+faxLabel+"</label>"+markerLocations[i][5]+"</p>";
                    }
                    if(markerLocations[i][6].replace(/\<br \/\>/g, "").length > 0){
                        var popOperatingContent = "<p>"+markerLocations[i][6]+"</p>";
                        popOperating = "<h6>"+operatingLabel+"</h6>" + popOperatingContent;
                    }
                    
                    //Set pop up marker contents
                    infowindow.setContent(
                        "<div class='map-popup'>"+
                        "<h5>"+markerLocations[i][0]+"</h5>"+
                        "<div class='map-popup-content'>"+
                        "<p>"+markerLocations[i][3]+"</p>"+
                        "<div class='map-popup-contact'>"+
                        popTel+
                        popFax+
                        "</div>"+
                        popOperating+
                        "<p><a href='javascript:void(0);' onclick=\"callExternalLinks('http://maps.google.com/maps?saddr=&daddr='+markerLocation)\">" +directionsLabel+ " &raquo;</a></p>"+
                        "</div>"+
                        "</div>"
                    );
                    infowindow.open(map, marker);
                }
            })(marker, i));
            gmarkers.push(marker);
        }
    }


    $('.location-filter-result li a').click(function(e) {
        var obj = $(this)
        $('.location-filter-result li').removeClass("selected")        
        obj.addClass("selected")
        
        var clickedIndex = obj.index();
        

        var filterLiArr = $.map($('.location-filter-result li a'), function(e,i){
            return $(e).index() 
        })    
        
        var theClicked =  $.inArray( clickedIndex, filterLiArr ) 

        if($(window).width() > 1020) {
            map.setZoom(12);
        }

        e.preventDefault();
    });    

    
})


function callExternalLinks(links1) {

    $('.modal#external-site').addClass('active');
    $("#external-site .more-link").prop("href", links1);  

};

function clickedLink(i) {
    google.maps.event.trigger(gmarkers[i], "click");
};

function redefineMapCenter() {
    var count = $('.location-filter-result li a').first().data('count');

    if(count > 0) {
    	var newlatlng = gmarkers[count].position;
        if(newlatlng) {
            globapMap.setZoom(15);
            globapMap.setCenter(newlatlng);
        }
    }
};

function isEmail(email) {
  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  return regex.test(email);
}

function authperCheckOnInput() {
    var authperIsValid = true;
    $('#authper .cloneContainer1 input').not('#authper .authorised-wrapper input').each(function(i) {
        var element = $(this);
        if (element.val() == "") {
            authperIsValid = false;
        }
    });
    $('#authper .cloneContainer1 input.input-for-emailaddress').each(function(i) {
        var element = $(this);
        if (isEmail(element.val()) == false) {
            authperIsValid = false;
        }
    });
    if( $('#authper #AuthSignaSignCond').val() == 'Solely to sign' ) {
        if ($('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signvalidation:checked').length == 0) {
            authperIsValid = false;
        }
    }
    else if ( $('#authper #AuthSignaSignCond').val() == 'Anyone to sign' ) {
        if ($('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signvalidation:checked').length == 0 || $('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signpersonvalidation:checked').length == 0){
            authperIsValid = false;
        }
    }
    else if ( $('#authper #AuthSignaSignCond').val() == 'Any two to sign' ) {
        if ($('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signvalidation:checked').length < 2) {
            authperIsValid = false;
        }
    }
    else if ( $('#authper #AuthSignaSignCond').val() == 'All to Sign' ) {
        if ($('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signvalidation:checked').length < 2) {
            authperIsValid = false;
        }
    }

    if(authperIsValid) {
        $('#authper .accordion-header .section-complete').css('opacity', '1').addClass('section-completedone');
    }
    else {
        $('#authper .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
    }
}

function authuserCheckOnInput() {
    var authuserIsValid = true;
    $('#authuser .clonecontainer3 input').not('input[type="checkbox"]').each(function(i) {
        var element = $(this);
        if (element.val() == "") {
            authuserIsValid = false;
        }
    });
    $('#authuser .clonecontainer3 input.input-for-emailaddress').each(function(i) {
        var element = $(this);
        if (isEmail(element.val()) == false) {
            authperIsValid = false;
        }
    });
    if(authuserIsValid) {
        $('#authuser .accordion-header .section-complete').css('opacity', '1').addClass('section-completedone');
    }
    else {
        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
    }
}

$(function(){

    // biz-reg
    $(document).on('keydown', '#biz-reg #IDNumber', function (e) {
        if (e.which === 189) {
            return false;
        }
    });

    // CHECK data-contact-number
    $('input[vcountrycode]').mask('+00');
    $('input[vareacode]').mask('00');
    $(document).on('input', 'input[vcountrycode]', function () {
        var input = $(this);
        var value = parseInt(input.val());
        var areaCodeInput = input.closest('[data-row-contact]').find('input[vareacode]');
        var areaCodeValue = parseInt(areaCodeInput.val());
        var value = parseInt(input.val());
        if (value === 60) {
            //
        }
        else {
            areaCodeInput.attr('maxlength', '2');
        }
    });
    $(document).on('keypress', 'input[vareacode]', function(e) {
        var input = $(this);
        var value = parseInt(input.val());
        var countryCodeInput = input.closest('[data-row-contact]').find('input[vcountrycode]');
        var countryCodeValue = parseInt(countryCodeInput.val());
        if (countryCodeValue === 60) {
            if (e.which === 0 || e.which === 2) {
                return input.val('');
            }
        }
    });
    $(document).on('input', 'input[vareacode]', function () {
        var input = $(this);
        var value = parseInt(input.val());
        var countryCodeInput = input.closest('[data-row-contact]').find('input[vcountrycode]');
        var countryCodeValue = parseInt(countryCodeInput.val());
        if (countryCodeValue === 60) {
            if (value === 1 || value === 8) {
                input.attr('maxlength', '2');
            }
            else if (value === 0 || value === 2) {
                $(input).val('');
            }
            else if (value > 2 && value < 10) {
                input.attr('maxlength', '1');
            }
            else {
                input.attr('maxlength', '2');
            }
        }
        else {
            input.attr('maxlength', '2');
        }
    });


    // #authper check if completed
    $(document).on('keyup', '#authper .cloneContainer1 input', function() {
        authperCheckOnInput();
    });
    $(document).on('click', '#authper .button-add', function() {
        $('#authper .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
    });
    $(document).on('click', '#authper .confirm-delete-wraper [data-deleteclone="true"]', function() {
        authperCheckOnInput();
    });
    $(document).on('change', '#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"]', function() {
        authperCheckOnInput();
    });
    
    // #authuser check if completed
    $(document).on('keyup', '#authuser .clonecontainer3 input', function() {
        authuserCheckOnInput();
    });
    $(document).on('click', '#authuser .button-add', function() {
        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
    });
    $(document).on('click', '#authuser .confirm-delete-wraper [data-deleteclone="true"]', function() {
        authuserCheckOnInput();
    });






    /* Fix Business Type selector not synce */
    $('#LegalStructure').on('change', function() {
        var thisVal = $(this).val();
        //console.log(thisVal);
        $('.jslegalListSelector a[data-value="'+thisVal+'"]').click();
    });
    /* END Fix Business Type selector not synce */




    var msgAreaCode = 'Invalid Mobile Area Code';

    /*$(document).on('keypress', '[data-row-contact="mobile"] input[vareacode]', function(e) {
        if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
            return false;
        }
        // var $this = $(this);
        // var thisVal = $this.val();
        // var regex = /^(10|11|12|13|14|15|16|17|18|19)$/;

        // if(getValue().match(regex) == null){
        //     event.preventDefault();
        //     return false;
        // }

        // function getValue()  {
        //     return $(this).val();
        // }
    });
    $(document).on('input', '[data-row-contact="mobile"] input[vareacode]', function(e) {
        var newValue = $(this).val();
        if (newValue.charAt(0) != 1) {
            $(this).val('');
        }
    });*/

    $(document).on("focusout", "input[vareacode]",function(e){

        var isSixZero = $(this).closest('.row').find('.columns:first > input');
        var getLabelID = $(this).next().attr('id');
        var LabelID = getLabelID.replace('-error-placeholder','');
        
        // $(this).next().find('.cusvaliderror').text('').hide();

        if(parseInt(isSixZero.val()) === 60) {

            // console.log(isSixZero);
            
            if( $(this).val() == '1' || $(this).val() == '8' ) {
                // console.log('number is 1 or 8');
                if($(this).val().length !== 2 ) {
                    // console.log('invalid!');
                    $(this).next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-vareacode" for="'+LabelID+'" style="display: block;">'+msgAreaCode+'</label>');
                }
                else {
                    $(this).next().find('.cusvaliderror-vareacode').remove();
                }
            }
            else {
                $(this).next().find('.cusvaliderror-vareacode').remove();
            }
        }
        else {
            $(this).next().find('.cusvaliderror-vareacode').remove();
        }
    });



    // Check for email input is equal
    var msgEmaiislEqual = 'Email Address cannot be the same';

    $(document).on("focusout", "#authper input.input-for-emailaddress", function(e){
        var $this = $(this);
        var getLabelID = $this.next().attr('id');
        var LabelID = getLabelID.replace('-error-placeholder','');
        var thisVal = $this.val().toLowerCase();

        if($this.val().length > 4 ) {

            $('#authper input.input-for-emailaddress').not($this).each(function(i) {
                var $that = $(this);
                var thatVal = $that.val().toLowerCase();
                if (thatVal == thisVal) {
                    //console.log('is same value!');
                    $this.next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-email-equal" for="'+LabelID+'" style="display: block;">'+msgEmaiislEqual+'</label>');
                }
                else {
                    $('#authper .cusvaliderror-email-equal').remove();
                }
            });

        }

    });

    $(document).on("focusout", "#authuser input.input-for-emailaddress", function(e){
        var $this = $(this);
        var thisVal = $this.val().toLowerCase();

        if($this.val().length > 4 ) {

            $('#authuser input.input-for-emailaddress').not($this).each(function(i) {
                var $that = $(this);
                var getLabelID = $this.next().attr('id');
                var LabelID = getLabelID.replace('-error-placeholder','');
                var thatVal = $that.val().toLowerCase();
                if (thatVal == thisVal) {
                    //console.log('is same value!');
                    $this.next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-email-equal" for="'+LabelID+'" style="display: block;">'+msgEmaiislEqual+'</label>');
                }
                else {
                    $('#authuser .cusvaliderror-email-equal').remove();
                }
            });

        }

    });
    // END Check for email input is equal

    // Check for row contact input is equal
    var msgContactisEqual = 'Contact number cannot be the same';

    $(document).on("focusout", "#authper [data-row-contact] input", function(e){
        var $this = $(this);
        var getLabelID = $this.next().attr('id');
        var LabelID = getLabelID.replace('-error-placeholder','');
        var thisRow = $this.closest('[data-row-contact]');
        var thisVal = thisRow.find('input').map(function() { return this.value; }).get().join('');
        var lastField = thisRow.find('.columns:last input');

        //console.log('thisVal: ', thisVal);

        if($this.val().length > 0 && lastField.val() !== '' && lastField.val().length > 3) {

            $('#authper [data-row-contact]').not(thisRow).each(function(i) {
                var $that = $(this);
                var thatVal = $that.find('input').map(function() { return this.value; }).get().join('');
                //console.log(thatVal);
                if (thatVal == thisVal) {
                    //console.log('is same value!');
                    $this.next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-contact-equal" for="'+LabelID+'" style="display: block;">'+msgContactisEqual+'</label>');
                }
                else {
                    $('#authper .cusvaliderror-contact-equal').remove();
                }
            });

        }

    });

    $(document).on("focusout", "#authuser [data-row-contact] input", function(e){
        var $this = $(this);
        var getLabelID = $this.next().attr('id');
        var LabelID = getLabelID.replace('-error-placeholder','');
        var thisRow = $this.closest('[data-row-contact]');
        var thisVal = thisRow.find('input').map(function() { return this.value; }).get().join('');
        var lastField = thisRow.find('.columns:last input');

        //console.log('thisVal: ', thisVal);

        if($this.val().length > 0 && lastField.val() !== '' && lastField.val().length > 3) {

            $('#authuser [data-row-contact]').not(thisRow).each(function(i) {
                var $that = $(this);
                var thatVal = $that.find('input').map(function() { return this.value; }).get().join('');
                //console.log(thatVal);
                if (thatVal == thisVal) {
                    //console.log('is same value!');
                    $this.next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-contact-equal" for="'+LabelID+'" style="display: block;">'+msgContactisEqual+'</label>');
                }
                else {
                    $('#authuser .cusvaliderror-contact-equal').remove();
                }
            });

        }

    });
    // END Check for row contact input is equal

    // Check for row Authorised Users ID input is equal and no symbols
    var msgUsrUserIDisEqual = 'User ID cannot be the same';

    $(document).on('keypress', 'input.input-for-user-id', function(e){
        var $this = $(this);
        var regex = new RegExp("^[a-zA-Z0-9.]+$");
        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
        if (!regex.test(key)) {
            event.preventDefault();
            return false;
        }
    });

    $(document).on("focusout", "input.input-for-user-id",function(e){
        var $this = $(this);
        var getLabelID = $this.next().attr('id');
        var LabelID = getLabelID.replace('-error-placeholder','');
        var thisVal = $this.val();

        $('input.input-for-user-id').not($this).each(function(i) {
            var $that = $(this);
            var thatVal = $that.val();
            if(thisVal.length > 0 && thatVal == thisVal) {
                $this.next().html('<label id="'+LabelID+'-error" class="error cusvaliderror cusvaliderror-user-id-equal" for="'+LabelID+'" style="display: block;">'+msgUsrUserIDisEqual+'</label>');
            }
            else {
                $('.cusvaliderror-user-id-equal').remove();
            }
        });
    });
    // END Check for row Authorised Users ID input is equal and no symbols





    $(document).on('click', 'form input[type="submit"].ecurrentnextbtn', function(e) {


                    // #authuser mobile number not equal
                    var authuserInputMobileNumber = $('#authuser [data-row-contact="mobile"]:visible');
                    var authuserInputMobileNumberCount = 0;

                    authuserInputMobileNumberCount = authuserInputMobileNumber.filter(function(i, el){
                        var $that = $(this);
                        var thatVal = $that.find('input').map(function() { return this.value; }).get().join('');
                        if(thatVal !== '') {
                            return authuserInputMobileNumber.not($that).filter(function() {
                                var $this = $(this);
                                var thisVal = $this.find('input').map(function() { return this.value; }).get().join('');
                                return thisVal === thatVal;
                            }).length !== 0;
                        }
                    }).length;

                    if (authuserInputMobileNumberCount > 0) {
                        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Contact number cannot be the same');
                        return false;
                    }

                    // #authper mobile number not equal
                    var authperInputMobileNumber = $('#authper [data-row-contact="mobile"]:visible');
                    var authperInputMobileNumberCount = 0;

                    authperInputMobileNumberCount = authperInputMobileNumber.filter(function(i, el){
                        var $that = $(this);
                        var thatVal = $that.find('input').map(function() { return this.value; }).get().join('');
                        if(thatVal !== '') {
                            return authperInputMobileNumber.not($that).filter(function() {
                                var $this = $(this);
                                var thisVal = $this.find('input').map(function() { return this.value; }).get().join('');
                                return thisVal === thatVal;
                            }).length !== 0;
                        }
                    }).length;

                    if (authperInputMobileNumberCount > 0) {
                        $('#authper .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Contact number cannot be the same');
                        return false;
                    }

                    // Authorised Users ID not equal
                    var authuserInputID = $('#authuser input.input-for-user-id');
                    var authuserInputIDCount = 0;

                    authuserInputIDCount = authuserInputID.filter(function(i, el){
                        if(this.value !== '') {
                            return authuserInputID.not(this).filter(function() {
                                return this.value === el.value;
                            }).length !== 0;
                        }
                    }).length;

                    if (authuserInputIDCount > 0) {
                        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('User ID cannot be the same');
                        return false;
                    }

                    // #authper
                    var authperEmailInputs = $('#authper input.input-for-emailaddress');
                    var authperEmailInputCount = 0;

                    authperEmailInputCount = authperEmailInputs.filter(function(i, el){
                        if(this.value !== '') {
                            return authperEmailInputs.not(this).filter(function() {
                                return this.value === el.value;
                            }).length !== 0;
                        }
                    }).length;

                    if (authperEmailInputCount > 0) {
                        $('#authper .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Email Address cannot be the same');
                        return false;
                    }

                    // #authuser
                    var authuserEmailInputs = $('#authuser input.input-for-emailaddress');
                    var authuserEmailInputCount = 0;

                    authuserEmailInputCount = authuserEmailInputs.filter(function(i, el){
                        if(this.value !== '') {
                            return authuserEmailInputs.not(this).filter(function() {
                                return this.value === el.value;
                            }).length !== 0;
                        }
                    }).length;

                    if (authuserEmailInputCount > 0) {
                        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Email Address cannot be the same');
                        return false;
                    }

                    // Signing Condition
                    if (!$('#authper .cloneContainer1 .authorised-wrapper input[type="checkbox"].signpersonvalidation:checked').length > 0 && $('#authper #AuthSignaSignCond').val() == 'Anyone to sign') {
                        authperIsValid = false;
                        setTimeout(function(){
                            $('#authperson-error-placeholder').html('<label id="AuthorisedSignatoryFlag-error" class="error cusvaliderror" for="AuthorisedSignatoryFlag" style="display: block;">Minimum 1 authorised person required</label>');
                        },300);
                    }

    });

});

$(function(){



    $('.progresssave').attr("target-form", $(".ecurrentsubmitbtn").attr("target-form"));
    $('body').data("savetxt",registration.save.manual);
    $('body').data("fs",'false');
    $('.numeric-only').addClass("cus-numeric-only");
    var dlist = $("[disabled]");
    for(var l=0; l<dlist.length; l++){
        $("#"+$(dlist[l]).attr("name")+"-error-placeholder").addClass("cdisabled");
    }
    setTimeout(function(){
        $("span[data-hoverhide]")
        .mouseenter(function() {$("."+$( this ).attr("data-hoverhide")).hide();})
        .mouseleave(function() {$("."+$( this ).attr("data-hoverhide")).show();});
        $("#cancelonclick").unbind("click");

    }, common.ui.clickdelay);

        setTimeout(function(){
        $('body').addClass('doneLoading');
        //try{$('#questionaireform').valid();var validator = $( "#questionaireform" ).validate();$(".cusvaliderror").hide();}catch(e){}
        //try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();$(".errorDiv").removeClass("errorDiv")}catch(e){}
    }, common.ui.clickdelay+5000);



    common.support.initformsubmit('#questionaireform');
    common.support.initformsubmit('#reg1');
    common.support.initformsubmit('#savep');
    common.support.initformsubmit('#edit');
    common.ui.nextlengthfield($("[cuslength-nextid]"));

    var ellabel = $('[id*="error-placeholder"]');
    for(var elindex=0; elindex<ellabel.length; elindex++){
        if($(ellabel[elindex]).find('label').length <= 0){
            //$(ellabel[elindex]).append('<label/>');
        }
    }

    $("[data-selectopfieldsh]").parent().change(function(){
        $("#AuthPerSelected").val($("#AuthPerSignCond option:selected").attr("data-selectopfieldsh"));
        common.event.selectorOptionField(this);
    })
    common.event.selectorOptionField($("[data-selectopfieldsh]").parent());

    $("#FATCA25Percent .radio").click(function(){
        common.event.fatca25event();
    })
    common.event.fatca25();

    $("#FATCAUSEntity-grp .radio").click(function(){
        common.event.fatcatax();
    })
    common.event.fatcatax();

    common.event.clone.init();
    common.validation.dynamicRule();
    common.validation.dynamicRule2();
    common.validation.dynamicRule3();
    common.validation.dynamicRule4();
    common.validation.dynamicRuleAuthperEmailNotEqualTo();
    common.validation.condrequire();
    common.validation.selrequire();
    common.validation.subrequire();
    common.validation.authPerOtherrequire();
    common.validation.dynamicEmail();
    common.validation.fatcarequire();
    common.validation.fatcadynamicrequire();
    common.validation.bsnRule();
    common.validation.checkgrp();
    common.validation.minlength();
    common.validation.dynamicminlength();

    questionaire.init();
    registration.init();
    checkstatus.init();

    var inputList = $('input, select');
    for(var i=0; i<inputList.length; i++){
        if(common.support.isNull($(inputList[i]).attr('name'))){
           if(!common.support.isNull($(inputList[i]).attr("xml-elem"))){
                $(inputList[i]).attr('name',$(inputList[i]).attr("xml-elem"));
            }else{
                $(inputList[i]).attr('name',"geninput"+i);
            }

        }
    }

    $(".radio").click(function(){
        setTimeout(function(curthis){
            var rname = $(this).find("input[type='radio']").attr("name");
            $("#"+rname+"-error").text("");
            try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();}catch(e){}
        }, common.ui.clickdelay, this);
    })

    $(".shcontentcontainer").attr('data-checking', 'false');
    $(".checkbox").click(function(){
        var $this = $(this);
        var checked = $this.hasClass('checked');
        var shcontentcontainer = $this.hasClass('shcontentcontainer');
        // console.log(checked);
        if (!checked) {
            $this.attr("data-checking","true");
            if (shcontentcontainer) {
                $(".contentcontainer").show();
            }
        }
        else {
            $this.attr("data-checking","false");
            if (shcontentcontainer) {
                $(".contentcontainer").hide();
            }
        }
        
        setTimeout(function(curthis){
            var rname = $(curthis).find("input[type='checkbox']").attr("name");
            try{rname = rname.replace("[]","");}catch(e){}
            $("#"+rname+"-error-placeholder").find("label").text("");
            try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();}catch(e){}
            $(curthis).data("checking","false");
        }, common.ui.clickdelay, this);
    });


    try{$('#questionaireform').valid();var validator = $( "#questionaireform" ).validate();$(".cusvaliderror").hide();}catch(e){}
    try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();$(".errorDiv").removeClass("errorDiv")}catch(e){}
    //try{$('#edit').valid();var validator = $( "#edit" ).validate();$(".cusvaliderror").hide();}catch(e){}


    common.ui.inputoutfocus();

    $(".numeric-only-no-zero").bind("keypress",function(e){
        var patt = new RegExp("^[1-9][0-9]?");
        if(!patt.test(e.key)){
            //$(this).val($(this).val().substring(0, $(this).val().length-1));
            if($(this).val().length > 0){
                if(e.keyCode >= 48 && e.keyCode <= 57){
                    return true;
                }
            }
            else{
                if(e.keyCode >= 49 && e.keyCode <= 57){
                    return true;
                }
            }

            return false;
        }else{
            return true;
        }
    });


    $(".numeric-only-no-zero").focusout(function() {
        if($(this).val().length > 0){
            if(($(this).val())[0] == '0'){
                $(this).val('');
            }

        }
    })

    $(".cus-numeric-only").bind("keypress",function(e){
        var patt = new RegExp("^\\d+$");
        if(!patt.test(e.key)){
            //$(this).val($(this).val().substring(0, $(this).val().length-1));
            if(e.keyCode >= 48 && e.keyCode <= 57){
                return true;
            }
            return false;
        }else{
            return true;
        }
    });

   /* $("[vareacode]").bind("keypress",function(e){
        if(e.keyCode < 48 || e.keyCode > 57 ){
            return false;
        }


        var countryCode = $(this).attr("vareacode");
        if($("#"+countryCode).val() == ""){
            $("#"+countryCode).focus();
            return false;
        }else if($("#"+countryCode).val() == "+60"){
            var fcode = $(this).val().substring(0, 1);
            if(fcode == '3' || fcode == '4' || fcode == '5' || fcode == '6' || fcode == '7' || fcode == '9'){
                return false;
                //$("#"+$(this).attr("cuslength-nextid")).focus();
            }
            if(fcode == '' && (e.keyCode == 50 || e.keyCode == 48)){
                return false;
            }
            if(fcode == '' && (e.keyCode == 51 || e.keyCode == 52 || e.keyCode == 53 || e.keyCode == 54 || e.keyCode == 55 || e.keyCode == 57)){

                //$("#"+$(this).attr("cuslength-nextid")).focus();
            }
            if(fcode == '1'){
                var scode = $(this).val().substring(1, 2);
                if(e.keyCode >= 48 && e.keyCode <= 57 ){
                    return true;
                }else{
                    return false;
                }
            }else if(fcode == '8'){
                if(e.keyCode >= 50 && e.keyCode <= 57 ){
                    return true;
                }else{
                    return false;
                }
            }
        }else{
            return true;
        }
    });*/

    $("[data-selectopfielded]").parent().change(function(){
        common.event.selectorDisableField(this);
    })
    common.event.selectorDisableField($("[data-selectopfielded]").parent());


});

var questionaire = {
    init : function (){
        //$(".jsequesform").trigger("reset");
        $(".jsequesform").find('.fakeradio').find('i').remove();
        questionaire.event.isexistincimb();
        questionaire.event.legalListSelector();
        questionaire.validation.requiredCimbAcc();
        $("#MailingState, #State").change(function(){
            var v = $("#MailingState").val();
            if(common.support.isNull(v)){
                v = $("#State").val();
            }
            $("#BranchState").val(v);
            $("#BranchState").trigger("change");

        })
    },
    event : {
        isexistincimb : function(){

            $('#customer-exist .radio').click(function() {
                $("#TxnType").val("t3");
                $(".extitle").hide();
                $(".nextitle").show();
                setTimeout(function(curthis){
                    //console.log(curthis);
                    $(".prioritycheck").val("");
                    $('#product-selection').hide();
                    $('.for-existing-members').hide();
                    $(".jsforNewBiz").hide();

                    $('#biz-reg').show();

                    if ($('input[name="'+$("input[data-isExisting='true']").attr("name")+'"]:checked').val() == 'Y') {
                        $('.for-existing-members').show();
                    } 
                    else {
                        $('.for-existing-members').hide();
                        $(".jsforNewBiz").show();
                        $('input[name="'+$("input[data-isBizChannel='true']").attr("name")+'"]').prop('checked', false);
                        $('input[name="'+$("input[data-isBizChannel='true']").attr("name")+'"]').parent('.radio').removeClass('checked');
                        $('input[name="'+$("input[data-isBizChannel='true']").attr("name")+'"]').siblings('.fakeradio').find('i').remove();
                    }
                    common.ui.sameheight("bizChannelsh");
                    $("#questionaireform").css("min-height","101px");
                }, common.ui.clickdelay, this);
            });
            
            $('#internetbanking-exist .radio').click(function() {
                $("#TxnType").val("t3");
                setTimeout(function(curthis){
                    var isNewBiz = $('input[name="'+$("input[data-isBizChannel='true']").attr("name")+'"]:checked').val() != 'Y';
                    $("#newstdbiz").hide();
                    $("#newlitebiz").hide();
                    $("#extbiz").hide();
                    if(!isNewBiz){
                        $(".jsforNewBiz").hide();
                        $(".extitle").show();
                        $(".nextitle").hide();
                        $('#product-selection').show();
                        common.ui.sameheight("bizChannelsh2");
                        $("#extbiz").show();
                        $("#extbiz").find("#BizAlertPackage1").removeAttr("disabled");
                        $("#newlitebiz").find("#ServicePackageName2").prop('disabled', true);
                        $("#newlitebiz").find("#ServicePackageCode2").prop('disabled', true);
                        $("#newlitebiz").find("#BizAlertPackage2").prop('disabled', true);
                        $("#newstdbiz").find("#ServicePackageName3").prop('disabled', true);
                        $("#newstdbiz").find("#ServicePackageCode3").prop('disabled', true);
                        $("#newstdbiz").find("#BizAlertPackage3").prop('disabled', true);
                    }else{
                        $(".extitle").hide();
                        $(".nextitle").show();
                        $(".jsforNewBiz").show();
                        $('#product-selection').hide();
                        common.ui.sameheight("bizChannelsh");
                    }
                    $("#questionaireform").css("min-height","102px");
                }, common.ui.clickdelay, this);

                
                
            });
            
            $(".prioritycheck").change(function(){questionaire.event.priorityCheck()});
            
        },
        priorityCheck : function(){
            //console.log("priorityCheck");
            $("#newstdbiz").hide();
            $("#newlitebiz").hide();
            $("#extbiz").hide();
            var isNewBiz = $('input[name="'+$("input[data-isBizChannel='true']").attr("name")+'"]:checked').val() != 'Y';
            var isNewCimb = $('input[name="'+$("input[data-isExisting='true']").attr("name")+'"]:checked').val() != 'Y';
             $("#TxnType").val("t3");
            if(isNewBiz){

                var priorityList = $(".prioritycheck");
                var highP = 0;
                var type = "t1";
                
                for(var i=0; i<priorityList.length; i++){
                    if(common.support.isNull($(priorityList[i]).val())){
                        return;
                    }
                }
                $('#product-selection').show();
                common.ui.sameheight("bizChannelsh2");
                for(var i=0; i<priorityList.length; i++){
                    try{
                        var pvalue = parseInt($("#"+$(priorityList[i]).attr("id")+" option:selected").attr("data-priority"));
                        if(i == 0){
                            highP = pvalue;
                            type = $("#"+$(priorityList[i]).attr("id")+" option:selected").attr("data-type");
                            continue;
                        }
                        if(highP > pvalue){
                            highP = pvalue;
                            type = $("#"+$(priorityList[i]).attr("id")+" option:selected").attr("data-type");
                        }
                    }catch(e){/*console.log(e);*/continue;}
                    
                }

                if(type == "t1"){
                    $("#newlitebiz").show();
                    $("#extbiz").find("#BizAlertPackage1").prop('disabled', true);
                    $("#newlitebiz").find("#ServicePackageName2").removeAttr("disabled");
                    $("#newlitebiz").find("#ServicePackageCode2").removeAttr("disabled");
                    $("#newlitebiz").find("#BizAlertPackage2").removeAttr("disabled");
                    $("#newstdbiz").find("#ServicePackageName3").prop('disabled', true);
                    $("#newstdbiz").find("#ServicePackageCode3").prop('disabled', true);
                    $("#newstdbiz").find("#BizAlertPackage3").prop('disabled', true);
                }else{
                    $("#newstdbiz").show();
                    $("#extbiz").find("#BizAlertPackage1").prop('disabled', true);
                    $("#newlitebiz").find("#ServicePackageName2").prop('disabled', true);
                    $("#newlitebiz").find("#ServicePackageCode2").prop('disabled', true);
                    $("#newlitebiz").find("#BizAlertPackage2").prop('disabled', true);
                    $("#newstdbiz").find("#ServicePackageName3").removeAttr("disabled");
                    $("#newstdbiz").find("#ServicePackageCode3").removeAttr("disabled");
                    $("#newstdbiz").find("#BizAlertPackage3").removeAttr("disabled");
                }
                $("#TxnType").val(type);
            }
            $("#questionaireform").css("min-height","100px");
        },
        legalListSelector : function(){
            $(".jslegalListSelector a[data-value]").click(function(){
                $(".jslegalListSelector a[data-value]").removeClass("active");
                $(this).addClass("active");
                $('.jslegalListSelectorTarget').val($(this).attr("data-value"));
                $('#IsSoleProp').val($(this).attr("data-issoleprop"));

            
            })
        }
    },
    validation : {
        requiredCimbAcc : function(){
            $.validator.addMethod("requiredCimbAcc", function(value) {
                var isNewCimb = $('input[name="'+$("input[data-isExisting='true']").attr("name")+'"]:checked').val() != 'Y';
                if(isNewCimb){
                    return true;
                }
                if(common.support.isNull(value)){
                    return false;
                }
                return true;
            }, '');
        }
    }
}

var common = {
    ui : {
        sameheight : function(cls){
            
            var sameheightList = $("."+cls);
            var maxheight = 0;
            for(var i=0; i<sameheightList.length; i++){
                if($(sameheightList[i]).outerHeight() > maxheight){
                    maxheight = $(sameheightList[i]).outerHeight();
                }
            }
            $("."+cls).outerHeight(maxheight);
        },
        inputoutfocus : function(){
            $("input[xml-flatelem], input[xml-elem]").focusout(function(){
               if($(this).val() == ""){
                    common.support.completeCheck();
                }
            })

        },
        nextlengthfield : function(list){
            //var list = $("[cuslength-nextid]");
            for(var i=0; i<list.length; i++){
                $(list[i]).keyup(function() {
                     if(parseInt(this.value.length) >= parseInt($(this).attr('length'))){
                         //console.log($(this).attr("cuslength-nextid"));
                         $('#'+$(this).attr("cuslength-nextid")).focus();
                     }
                 });
            }
        },
        setDivCenter : function(div){
            $(div).css("position","absolute");
            var top = (($(window).height() - $(div).outerHeight()) / 2) + $(window).scrollTop();
            var left = (($(window).width() - $(div).outerWidth()) / 2) + $(window).scrollLeft();
            if(top < 0){
                top = 0;
            }
            if(left < 0){
                left = 0;
            }
            top = top - 200;
            $(div).css("top", top+"px");
            $(div).css("left", left + "px");    
        
        },
        showOverlay : function(){
            var div = $('<div/>',{id:'tchinitOverlap'});
            div.css("position","fixed");
            div.css("bottom","0");
            div.css("width","100%");
            div.css("height","100%");
            div.css("z-index","9999");
            div.css("background","#000000");
            div.css("margin","0");
            div.css("padding","0");
            div.css("display","none");
            div.css("opacity","0.6");
            
            $('body').append(div);
            div.fadeIn('slow');

            return div;

        },
        clickdelay : 500,
        FATCAUSBeneficiaryOwnerIndicator1sttime : true,
        alertmsg : "require field",
        signPerFlag : "require field",
        nobackmsg : "require field",
        nobackinterval: "",
        isRetrieveData : true,
        minlengthmsg : "min lenght #length#"
    },
    event : {
        selectorOptionField : function(curThis){
            
                var shvalue = $("#"+$(curThis).attr("id")+" option:selected").attr("data-selectopfieldsh");
                var list = $(curThis).find("[data-selectopfieldsh]");
                for(var j=0; j<list.length; j++){
                    var shvaluelist2 = $(list[j]).attr("data-selectopfieldsh").split("|");
                    for(var k=0; k<shvaluelist2.length; k++){
                        //console.log("."+shvaluelist2[k]);
                        if(!$("."+shvaluelist2[k]).hasClass("keepvalue")){
                            $("."+shvaluelist2[k]).find("input").val("");
                        }

                        //$("."+shvaluelist2[k]).val("");
                        $("."+shvaluelist2[k]).hide();
                        $("."+shvaluelist2[k]).find('input').attr("cus-isshow", "false");
                    }
                }
                try{
                    var shvaluelist = shvalue.split("|");
                    for(var i=0; i<shvaluelist.length; i++){
                        $("."+shvaluelist[i]).show();
                        $("."+shvaluelist[i]).find('input').attr("cus-isshow", "true");
                    }
                }catch(e){
                    
                }
                
            
        },
        noback : function(message){
            common.ui.nobackmsg=message;
            setTimeout(function(){
                window.location.hash = "lock";
                window.location = "#lock2";
                window.location.hash = "noBack";
            }, common.ui.clickdelay);
            
            setTimeout(function(){
                window.location.hash = "noBack";
                common.ui.nobackinterval = setInterval(function(){console.log("retry hash");window.location.hash = "noBack";}, 1000);
            }, common.ui.clickdelay);
            
            setTimeout(function(message){
                window.onhashchange = function() {
                    common.event.nobackhash();
                }
                if (window.addEventListener)
                    window.addEventListener("load", common.event.nobackhash(), false);
                else if (window.attachEvent)
                    window.attachEvent("onload", common.event.nobackhash());
                else
                    window.onload = common.event.nobackhash();
            }, common.ui.clickdelay+500, message);
        },
        nobackhash : function(){
            if(window.location.hash == "#lock2"){
                window.location.hash = "noBack";
                alert(common.ui.nobackmsg);
            }else{
                // console.log("stop hash");
                clearInterval(common.ui.nobackinterval);
            }
        },
        fatcatax : function(){

                setTimeout(function(curthis){
                    //console.log($('input[name="FATCAUSEntity"]:checked').val());
                     if(common.support.isNull($('input[name="FATCAUSEntity"]:checked').val())){
                        //$(".esh1").hide();
                        //$(".esh2").hide();
                        //$(".esh3").hide();
                    }
                    var isno = $('input[name="FATCAUSEntity"]:checked').val() != 'Yes';
                    if(isno){
                        //$(".esh1").hide();
                        //$(".esh2").hide();
                        //$(".esh3").hide();
                    }else{
                        //$(".esh2").show();
                        common.event.fatca25();
                        registration.event.FATCAUSBeneficiaryOwnerIndicatorLogic($("#FATCAUSBeneficiaryOwnerIndicator .radio"));
                    }


                }, common.ui.clickdelay, this);


        },
        fatca25 : function(){

                    if(common.support.isNull($('input[name="FATCA25Percent"]:checked').val())){
                         $(".esh1").hide();
                    }
                    var isno = $('input[name="FATCA25Percent"]:checked').val() != 'Yes';
                    if(isno){
                        $(".esh1").hide();
                    }else{
                        $(".esh1").show();
                    }

        },
        fatca25event : function(){

                setTimeout(function(curthis){
                    common.event.fatca25();
                }, common.ui.clickdelay, this);


        },
        selectorDisableField : function(curThis){
                var enval = $("#"+$(curThis).attr("id")+" option:selected").attr("data-selectopfielded");
                //if(common.support.isNull(enval)){
                    var list = $(curThis).find("[data-selectopfielded]");
                        
                    for(var i=0; i<list.length; i++){
                        var envaluelist2 = $(list[i]).attr("data-selectopfielded").split("|");
                            for(var k=0; k<envaluelist2.length; k++){
                                $("."+envaluelist2[k]).attr("disabled","disabled");
                                $("."+envaluelist2[k]).val("");
                                var l = $("."+envaluelist2[k]);
                                for(p=0; p<l.length; p++){
                                    if($("#"+$(l[p]).attr('id')+"-error-placeholder label").html() != ""){
                                        $("#"+$(l[p]).attr('id')+"-error-placeholder label").attr("data-error",$("#"+$(l[p]).attr('id')+"-error-placeholder label").html());
                                    }

                                    $("#"+$(l[p]).attr('id')+"-error-placeholder label").html("");
                                }
                                //$("#"+$("."+envaluelist2[k]).attr('id')+"-error-placeholder label").html("");
                            }

                        }
                    //return;
                //}
                try{
                    var envaluelist = enval.split("|");
                    for(var j=0; j<envaluelist.length; j++){
                        if(!common.support.isNull(envaluelist[j])){
                            $("."+envaluelist[j]).removeAttr("disabled");
                            var l = $("."+envaluelist2[j]);
                                for(p=0; p<l.length; p++){
                                    if(!$("#"+$(l[p]).attr('id')+"-error-placeholder label:visible")){
                                        $("#"+$(l[p]).attr('id')+"-error-placeholder label").html($("#"+$(l[p]).attr('id')+"-error-placeholder label").attr("data-error"));
                                    }

                                }
                        }else{
                            
                        }
                    }
                }catch(e){}
                
        },
        clone : {
            init : function(){
                $("[data-addclonemaster]").click(function(){
                    var clonemaster = $(this).attr("data-addclonemaster");
                    var clonecontainer = $(this).attr("data-clonecontainer");
                    common.event.clone.add(clonemaster, 1,clonecontainer );
                });


            },
            setdata : function(arg, clonemaster, clonecontainer){
                var remain = $("."+clonemaster).data("remain");
                if(!common.support.isNull(remain)){
                    common.event.clone.add(clonemaster, parseInt(remain), clonecontainer);
                }else{
                    common.event.clone.add(clonemaster, arg.length, clonecontainer);
                }
                //common.event.clone.add(clonemaster, arg.length, clonecontainer );
                for(var i=0; i<arg.length; i++){
                    for (x in arg[i]) {
                        $("."+clonecontainer).find("#"+x+"-"+(i+1)).val(common.support.xmlDeEscape(arg[i][x]));
                        if($("."+clonecontainer).find("#"+x+"-"+(i+1)).attr("type") == "checkbox"){
                            //console.log("#"+x+"-"+(i+1));
                            $("."+clonecontainer).find("#"+x+"-"+(i+1)).prop( "checked", true );
                            $("."+clonecontainer).find("#"+x+"-"+(i+1)).parents(".subsection").show();
                            $("."+clonecontainer).find("#"+x+"-"+(i+1)).attr("checked","true");
                            $("."+clonecontainer).find("#"+x+"-"+(i+1)).parent().addClass("checked");
                            $("."+clonecontainer).find("#"+x+"-"+(i+1)).siblings("span").html("<i class=\"icon-check\"></i>");
                        }
                        $("."+clonecontainer).find("#"+x+"-"+(i+1)).siblings(".label"+x).show();
                        //$(".label"+x).show();
                    }
                }

                 try{
                    Gumby.initialize(['skiplink', 'checkbox', 'radiobtn'], true);
                }catch(e){/*console.log(e);*/}
            },
            add : function(clonemaster, number, clonecontainer){
                var clonemasterelem = $("."+clonemaster);

                for(var n=0; n<number; n++){
                    var cloneElem = $(clonemasterelem).clone();
                    var totalClone = $("."+clonemaster+'clone').length+1;

                    var inputClone = $(cloneElem).find("[data-inputclone]");
                    for(var i=0; i<inputClone.length; i++){
                        var tempName = $(inputClone[i]).attr("data-inputclone");

                        //$(inputClone[i]).attr('name',tempName+"-"+totalClone);
                        $(inputClone[i]).attr('name',tempName);
                        $(inputClone[i]).attr('id',tempName+"-"+totalClone);
                        //console.log("---->"+$(inputClone[i]).attr("cuslength-nextid")+" | "+$(inputClone[i]).attr("data-inputclone"));
                        if(!common.support.isNull($(inputClone[i]).attr("cuslength-nextid"))){
                            $(inputClone[i]).attr('cuslength-nextid',$(inputClone[i]).attr("cuslength-nextid")+"-"+totalClone);
                        }


                        var cusvalidcloneerrorholder = $(inputClone[i]).attr("cusvalid-cloneerrorholder");
                        if(!common.support.isNull($(inputClone[i]).attr("cusvalid-cloneerrorholder"))){
                            if(!common.support.isNull($(inputClone[i]).attr("cusvalid-dependcheckid"))){
                                $(inputClone[i]).addClass("dynamicrequire2");
                                $(inputClone[i]).attr("cusvalid-dependcheckid",$(inputClone[i]).attr("cusvalid-dependcheckid")+"-"+totalClone);
                            }else{
                                if(!$(inputClone[i]).hasClass("dynamicrequire3") && !$(inputClone[i]).hasClass("dynamicrequire4") && !$(inputClone[i]).hasClass("fatcarequire") && !$(inputClone[i]).hasClass("fatcadynamicrequire")){
                                    $(inputClone[i]).addClass("dynamicrequire");
                                }
                            }
                            $(inputClone[i]).attr("cusvalid-clone","true");
                            $(cloneElem).find("#"+cusvalidcloneerrorholder).attr("id",tempName+"-"+totalClone+"-error-placeholder");
                        }

                        if(!common.support.isNull($(inputClone[i]).attr("vareacode"))){
                            $(inputClone[i]).attr("vareacode", $(inputClone[i]).attr("vareacode")+"-"+totalClone);
                        }
                        /*
                        if(!common.support.isNull($(inputClone[i]).attr("cuslength-nextid"))){
                            $(inputClone[i]).attr("cuslength-nextid", $(inputClone[i]).attr("cuslength-nextid")+"-"+totalClone);
                        }
                        */
                        if(!common.support.isNull($(inputClone[i]).attr("cminlength"))){
                            $(inputClone[i]).addClass("dynamicminlength");
                        }
                    }                   
                    $(cloneElem).removeClass(clonemaster);
                    $(cloneElem).find('[xml-clone="true"]').removeAttr("xml-clone");
                    $(cloneElem).addClass(clonemaster+'clone');
                    $(cloneElem).attr("clonefrom",clonemaster);
                    
                    

                    var l = $(cloneElem).find("[data-deleteclone]");
                    for(i=0; i<l.length; i++){
                        var action = $(l[i]).attr("data-deleteclone");
                        if(action != "true" && action != "false"){
                            $(l[i]).addClass(clonemaster+'delete');
                        }
                    }

                    $(cloneElem).find("[data-deleteclone]").click({ elem: cloneElem }, function(event){
                        var action = $(this).attr("data-deleteclone");
                        if(action == "true"){
                            $(event.data.elem).remove();
                            var numberList = $("."+$(event.data.elem).attr("clonefrom")+"clone [data-clonenumber]");
                            //console.log($(event.data.elem).attr("clonefrom")+"clone [data-clonenumber]");
                            for(i=0; i<numberList.length; i++){
                                $(numberList[i]).html(i+1);
                            }
                            try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();}catch(e){}
                        }else if(action == "false"){
                            $(event.data.elem).find('[data-showdelete="deleteW"]').hide();
                            var deleteW = $(event.data.elem).find('.deleteW').show();
                            return;
                        }else{
                            $(event.data.elem).find("."+$(this).attr("data-deleteclone")).show();
                            $(this).hide();
                            $(this).addClass("deleteW");
                            $(event.data.elem).find("."+$(this).attr("data-deleteclone")).attr("data-showdelete","deleteW");
                            return;
                        }

                        var cloneList = $("."+$(event.data.elem).attr("clonefrom")+"clone");
                        
                        var minClone = parseInt($(event.data.elem).attr("data-minclone"));
                        if(cloneList.length <= minClone){
                            $("."+$(event.data.elem).attr("clonefrom")+"delete").hide();
                        }else{
                            $("."+$(event.data.elem).attr("clonefrom")+"delete").show();
                        }
                        
                        var maxclone = parseInt($(event.data.elem).attr("data-maxclone"));
                        if(cloneList.length >= maxclone){
                            $('[data-addclonemaster="'+$(event.data.elem).attr("clonefrom")+'"]').hide();
                        }else{
                            $('[data-addclonemaster="'+$(event.data.elem).attr("clonefrom")+'"]').show();
                        }

                    })

                    $(cloneElem).find("[data-clonenumber]").html(totalClone);
                    if($(cloneElem).find("[data-checkgrp='id']").length > 0){
                        $(cloneElem).find("[data-checkgrp='id']").attr("id", "checkgrp"+totalClone+"-error-placeholder");
                    }
                    if($(cloneElem).find("[data-checkgrp='attr']").length > 0){
                        $(cloneElem).find("[data-checkgrp='attr']").attr("data-checkgrpnumber","checkgrp"+totalClone);
                    }
                    if($(cloneElem).find("[data-checkgrpclone='true']").length > 0){
                        $(cloneElem).find("[data-checkgrpclone='true']").attr("data-checkgrpclone","false");
                    }

                    $("."+clonecontainer).append(cloneElem);
                    common.ui.nextlengthfield($(cloneElem).find("[cuslength-nextid]"));

                    $(cloneElem).find(".numeric-only-no-zero").bind("keypress",function(e){
                        var patt = new RegExp("^[1-9][0-9]?");
                        if(!patt.test(e.key)){
                            //$(this).val($(this).val().substring(0, $(this).val().length-1));
                            if($(this).val().length > 0){
                                if(e.keyCode >= 48 && e.keyCode <= 57){
                                    return true;
                                }
                            }else{
                                if(e.keyCode >= 49 && e.keyCode <= 57){
                                    return true;
                                }
                            }
                            return false;
                        }else{
                            return true;
                        }
                    });

                    $(cloneElem).find(".numeric-only-no-zero").focusout(function() {
                        if($(this).val().length > 0){
                            if(($(this).val())[0] == '0'){
                                $(this).val('');
                            }
                        }
                    })

                    $(cloneElem).find(".cus-numeric-only").bind("keypress",function(e){
                        var patt = new RegExp("^\\d+$");
                        //console.log($(this).val());
                        if(!patt.test(e.key)){
                            //$(this).val($(this).val().substring(0, $(this).val().length-1));
                            if(e.keyCode >= 48 && e.keyCode <= 57){
                                return true;
                            }
                            return false;
                        }else{
                            return true;
                        }

                    });

                   /* $(cloneElem).find("[vareacode]").bind("keypress",function(e){
                        if(e.keyCode < 48 || e.keyCode > 57 ){
                            return false;
                        }
                        var countryCode = $(this).attr("vareacode");
                        if($("#"+countryCode).val() == ""){
                            $("#"+countryCode).focus();
                            return false;
                        }else if($("#"+countryCode).val() == "+60"){
                            var fcode = $(this).val().substring(0, 1);
                            if(fcode == '3' || fcode == '4' || fcode == '5' || fcode == '6' || fcode == '7' || fcode == '9'){
                                return false;
                                //$("#"+$(this).attr("cuslength-nextid")).focus();
                            }
                            if(fcode == '' && (e.keyCode == 50 || e.keyCode == 48)){
                                return false;
                            }
                            if(fcode == '' && (e.keyCode == 51 || e.keyCode == 52 || e.keyCode == 53 || e.keyCode == 54 || e.keyCode == 55 || e.keyCode == 57)){
                                //$("#"+$(this).attr("cuslength-nextid")).focus();
                            }
                            if(fcode == '1'){
                                var scode = $(this).val().substring(1, 2);
                                if(e.keyCode >= 48 && e.keyCode <= 57 ){
                                    return true;
                                }else{
                                    return false;
                                }
                            }else if(fcode == '8'){
                                if(e.keyCode >= 50 && e.keyCode <= 57 ){
                                    return true;
                                }else{
                                    return false;
                                }
                            }
                        }else{
                            return true;
                        }
                    });*/

                    $(cloneElem).find(".checkbox").click(function(){
                        if($(this).data("checking") == "true"){
                            return;
                        }
                        $(this).data("checking","true");
                        setTimeout(function(curthis){
                            var rname = $(curthis).find("input[type='checkbox']").attr("name");
                            try{
                                rname = rname.replace("[]","");
                            }catch(e){}
                            $("#"+rname+"-error-placeholder").find("label").text("");
                            try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();}catch(e){}
                            $(curthis).data("checking","false");
                        }, common.ui.clickdelay, this);

                    })

                }

                var minClone = parseInt($("."+clonemaster).attr("data-minclone"));
                var cloneList = $("."+clonemaster+"clone");
                if(cloneList.length <= minClone){
                    $("."+clonemaster+"delete").hide();
                }else{
                    $("."+clonemaster+"delete").show();
                }

                var maxclone = parseInt($("."+clonemaster).attr("data-maxclone"));
                var cloneList = $("."+clonemaster+"clone");
                if(cloneList.length >= maxclone){
                    $('[data-addclonemaster="'+clonemaster+'"]').hide();
                }else{
                    $('[data-addclonemaster="'+clonemaster+'"]').show();
                }
                try{
                    Gumby.initialize(['skiplink', 'checkbox', 'radiobtn'], true);

                }catch(e){/*console.log(e);*/}
                if(n>=number){
                    if($('body').hasClass('doneLoading')){
                        try{$('#questionaireform').valid();var validator = $( "#questionaireform" ).validate();$(".cusvaliderror").hide();}catch(e){}
                        try{$('#reg1').valid();var validator = $( "#reg1" ).validate();$(".cusvaliderror").hide();}catch(e){}
                    }

                }
                
                $('input[vcountrycode]').mask('+00');
                $('input[vareacode]').mask('00');


            }
        }
    },
    support : {
        isNull : function (arg){
            if(arg == 'NaN' || arg == 'undefined' || arg == undefined || arg == '' || arg == null || arg == NaN){
                return true;
            }
            return false;
        },
        initformsubmit : function(arg){
            $(arg).attr("autocomplete", "off");
            $(arg).data("submitclick","false")
            $(arg).submit(function( event) {
                $(this).data("submitclick","true");
                $(".errorDiv").removeClass("errorDiv");
                if($(this).valid()){

                    console.log( JSON.stringify($(this).serializeArray(), null, 4) );
                    if($("#TnCAgreement").length >= 1){
                        if(!$("#TnCAgreement").is(":checked")){
                            $("#TnCAgreement-error-placeholder").html($("<label/>").addClass("error").html($("#TnCAgreement").attr("title")));
                            //$("#TnCAgreement-error-placeholder").show();
                            alert($("#TnCAgreement").attr("title"));
                            return false;
                        }
                    }

                    $(".transload").show();
                    common.ui.setDivCenter($(".transload"));
                    common.ui.showOverlay();
                    var actionURL = ($(this).attr("action")).replace("http", "https");
                    $('body').data("fs",'true');
                    $.ajax({
                        url: actionURL,
                        type: $(this).attr("method"),
                        dataType: 'json',
                        cache: false,
                        data : {xmldata : component.xmlGenerator(this)},
                        error: function(jqXHR, textStatus, errorThrown){
                            $(".transload").hide();
                            common.ui.setDivCenter($("#transpopup"));
                            $("#transpopup").show();
                        },
                        context : $(this),
                        success: function(obj){
                            common.support.formProccess(obj, this);
                        }
                    });
                    return false;
                }else{
                    var cusvaliderrorList = $(".cusvaliderror");
                    var errorinput;
                    for(var cvel=0; cvel<cusvaliderrorList.length; cvel++){
                        if($(cusvaliderrorList[cvel]).html() != ""){
                            errorinput = cusvaliderrorList[cvel];
                        }
                    }
                    if($(errorinput).attr("id") == "AuthorisedSignatoryFlag-error"){
                        var msg = $('body').data("signvalidationMsg");;
                        var dataShow = parseInt($("#AuthSignaSignCond option:selected").attr("data-show"));
                        msg = msg.replace("#number#", dataShow);
                        alert(msg);
                    }else{
                        alert(common.ui.alertmsg);
                    }

                }
                return false;
            })

            $(arg).validate({
                submitHandler: function(form) {
                    // console.log('Form submitting...');

                    // #authper
                    var authperEmailInputs = $('#authper input.input-for-emailaddress');
                    var authperEmailInputCount = 0;

                    authperEmailInputCount = authperEmailInputs.filter(function(i, el){
                        if(this.value !== '') {
                            return authperEmailInputs.not(this).filter(function() {
                                return this.value === el.value;
                            }).length !== 0;
                        }
                    }).length;

                    if (authperEmailInputCount > 0) {
                        $('#authper .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Email Address cannot be the same');
                        return false;
                    }

                    // #authuser
                    var authuserEmailInputs = $('#authuser input.input-for-emailaddress');
                    var authuserEmailInputCount = 0;

                    authuserEmailInputCount = authuserEmailInputs.filter(function(i, el){
                        if(this.value !== '') {
                            return authuserEmailInputs.not(this).filter(function() {
                                return this.value === el.value;
                            }).length !== 0;
                        }
                    }).length;

                    if (authuserEmailInputCount > 0) {
                        $('#authuser .accordion-header .section-complete').css('opacity', '0.2').removeClass('section-completedone');
                        alert('Email Address cannot be the same');
                        return false;
                    }


                },
                onsubmit:false,
                ignore: "",
                rules: common.validation.ruleCreator(),
                messages : common.validation.messageCreator(),
                errorPlacement: function(error, element) {
                    //console.log($(element).attr('name')+"-error-placeholder : "+error);
                    if($(element).attr("type") == "radio"){
                        $(error).addClass("cusvaliderrorradio");
                    }
                    $(error).addClass("cusvaliderror");


                    if($(element).attr("data-inputclone") == "authsign"){
                        $("#authsign-error-placeholder").empty();
                        $("#authsign-error-placeholder").append(error);
                        return;
                    }
                    if($(element).attr("data-inputclone") == "authperson"){
                        $("#authperson-error-placeholder").empty();
                        $("#authperson-error-placeholder").append(error);
                        return;
                    }
                    if($(element).attr("data-checkgrpclone") == "false"){
                        $("#"+$(element).attr('data-checkgrpnumber')+"-error-placeholder").empty();
                        error.appendTo($("#"+$(element).attr('data-checkgrpnumber')+"-error-placeholder"));
                        if($(error).html() != ''){
                            $(error).parents().addClass("errorDiv");
                        }

                        return;
                    }
                    error.appendTo($("#"+$(element).attr('name').replace("[]","")+"-error-placeholder"));
                    $(error).parents().addClass("errorDiv");

                },
                validClass: "successCls",
                debug : false,
                onfocusout: function(element,event){
                    //console.log("---"+$(element).attr("name")+"-error"+"---");
                    //console.log("---"+$("#"+$(element).attr("name")+"-error").html()+"---");
                    if(!common.support.isNull($("#"+$(element).attr("name")+"-error").html())){
                        //console.log("---"+$("#"+$(element).attr("name")+"-error").html()+"---");
                       if($($(element).attr("name")+"-error").html() != ""){
                            $(element).parents(".signup-card-section").find(".section-complete").removeClass("section-completedone");
                             $(element).parents(".signup-card-section").find(".section-complete").css("opacity","0.2");

                        }
                    }
                    if($(element).attr("type") == 'text'){
                         $(element).val($(element).val().toUpperCase());
                    }


                    if($(element).attr('id') == 'PICEmailAddress'){
                        registration.event.startAutoSave(true);
                    }

                },
                invalidHandler : function(event, validator){
                    //console.log('invalidHandler...');
                },

                success: function(label) {

                }


            });

            setInterval(function(arg){

            common.support.completeCheck();
                if($('body').hasClass("ie8uifix")){
                    $('body').removeClass('ie8uifix');
                }else{
                    $('body').addClass('ie8uifix');
                }
            }, common.ui.clickdelay+2000);

        },
        completeCheck : function(){
            var list = $('[cusvalid-section]');
            for(var i=0; i<list.length; i++){

                var section = $(list[i]).attr("cusvalid-section");
                //console.log("checking section"+section);
                var errorcheck = $("#"+section).find("[id*='error-placeholder']")
                var b = true;
                
                for(var j=0; j<errorcheck.length; j++){
                    if($(errorcheck[j]).hasClass("cdisabled")){
                        continue;
                    }
                    var inputcheckid = $(errorcheck[j]).attr("id");
                    inputcheckid = inputcheckid.replace("-error-placeholder","");
                    var inputCheck = $("[data-inputclone='"+inputcheckid+"']");
                    //console.log(inputCheck);
                    if(inputCheck.length <= 0){
                        //console.log("reget");
                        inputCheck = $("[name='"+inputcheckid+"']");
                    }
                    //console.log("inputcheckid : "+inputcheckid);
                    //console.log("Check : "+$(inputCheck).attr("data-inputclone"));
                    //console.log("Check name: "+$(inputCheck).attr("name"));
                    
                    //console.log("aaaaa : "+$(inputCheck).attr("cusvalid-cloneerrorholder"));
                    if(!common.support.isNull($(inputCheck).attr("cusvalid-cloneerrorholder")) && $(inputCheck).attr("cusvalid-clone") != "true"){
                        //console.log("Continue : "+$(errorcheck[j]).attr("id"));
                        continue;
                    }
                    if($(inputCheck).hasClass("condrequire")){
                            continue;
                    }
                    if($(errorcheck[j]).find('label').length <= 0){
                        //console.log("skip : "+$(errorcheck[j]).attr("id"));
                        b = false;
                    }
                }

                if(b){
                    for(var j=0; j<errorcheck.length; j++){
                        if($(errorcheck[j]).text() != ""){
                            if($(list[i]).hasClass("section-completedone")){
                                 //console.log("remove "+$(list[i]).attr("cusvalid-section"));
                                 $(list[i]).removeClass("section-completedone");
                                $(list[i]).css("opacity","0.2");
                            }
                            break;
                        }else{
                            if(!$(list[i]).hasClass("section-completedone")){
                                //console.log("add "+$(list[i]).attr("cusvalid-section"));
                                $(list[i]).addClass("section-completedone");
                                $(list[i]).css("opacity","1");
                            }
                        }
                    }
                }
                
            }

        },
        formProccess : function(obj, curthis){

            if(obj["hasError"] == 'true'){
                var validator = $(curthis).validate();

                for (x in obj) {
                    if(x == 'hasError'){
                        continue;
                    }
                    if(x == 'serverSuccess'){
                        continue;
                    }
                    try{
                        var d = {};
                        d[x] = obj[x];
                        validator.showErrors(d);
                    }catch(e){/*console.log(e);*/}
                }
            }else{
                if(obj["serverSuccess"] == "false"){
                    $(".transload").hide();
                    $("#transpopup .transerror").html(obj["wsmsg"]);
                    common.ui.setDivCenter($("#transpopup"));
                    $("#transpopup").show();
                    
                    return;
                }
                window.location.href += "#noback";
                window.location = obj['nextUrl'];
            }

        },
        xmlGenerator : function(form){
            var o = $(form).serializeArray();
            var roottxt = $(form).attr('data-xmlroot');
            var rootxml = "<"+roottxt+">"+common.support.xmlElementGenerator(o)+"</"+roottxt+">";
            //console.log(rootxml);
            return rootxml;
        },
        xmlElementGenerator : function(o){
            var elem = "";
            for (i in o) {
                var t = o[i];
                if(!common.support.isNull(t.name) && !common.support.isNull(t.value)){
                    elem = elem + "<"+t.name+">"+common.support.xmlEscape(t.value)+"</"+t.name+">";
                }
            }
            return elem;
        },
        xmlEscape : function(unsafe){
            if(common.support.isNull(unsafe)){
                return "";
            }
            return unsafe.replace(/[<>&'"]/g, function (c) {
                switch (c) {
                    case '<': return '&lt;';
                    case '>': return '&gt;';
                    case '&': return '&amp;';
                    case '\'': return '&apos;';
                    case '"': return '&quot;';
                }
            });
        },
        xmlDeEscape : function(unsafe){
            if(common.support.isNull(unsafe)){
                return "";
            }
            return unsafe.replace(/(&quot;|&lt;|&gt;|&amp;)/g, function (c) {
                switch (c) {
                    case '&lt;': return '<';
                    case '&gt;': return '>';
                    case '&amp;': return '&';
                    case '&apos;': return '\'';
                    case '&quot;': return '"';
                }
            });
        },
        xmlSubElement : function(arg){
            var xmlstr = "";
            var xmlsubroot = $("["+arg+"]");
            for(var i=0; i<xmlsubroot.length; i++){
                if($(xmlsubroot[i]).attr("xml-clone") == "true"){
                    continue;
                }
                var rootelemstr = $(xmlsubroot[i]).attr(arg);
                var xmlelem = $(xmlsubroot[i]).find("[xml-elem]");
                var subxml = "";
                for(var j=0; j<xmlelem.length; j++){
                    var elem = $(xmlelem[j]).attr("xml-elem");
                    var elemval = $(xmlelem[j]).val();
                    if($(xmlelem[j]).attr("type") == "checkbox"){
                        if($(xmlelem[j]).is(":checked")){
                            elemval = "Y";
                        }else{
                            elemval = "N";
                        }
                    }
                    if(!common.support.isNull($(xmlelem[j]).attr("xml-flatcombineelem"))){
                        var combinefield = $(xmlelem[j]).attr("xml-flatcombineelem").split("|");
                        var combineflag = $(xmlelem[j]).attr("xml-flatcombineelemflag");
                        var elemval = "";
                        for(var a=0; a<combinefield.length; a++){
                            var tem = $('[name="'+combinefield[a]+"-"+(i)+'"]').val();
                            if(common.support.isNull(tem)){
                                tem = $(xmlelem[j]).parent().parent().find('[data-inputclone="'+combinefield[a]+'"]').val();
                            }
                            elemval = elemval + tem;
                            if(a != combinefield.length-1 && $(xmlelem[j]).parent().parent().find('[data-inputclone="'+combinefield[a]+'"]').val().length != 0){
                                elemval = elemval + combineflag;
                            }
                        }
                    }
                    subxml = subxml + "<"+elem+">"+common.support.xmlEscape(elemval)+"</"+elem+">";
                }
                xmlstr = xmlstr + "<"+rootelemstr+">"+subxml+"</"+rootelemstr+">"; 
            }
            return xmlstr;
        }
    },
    validation : {
        ruleCreator : function(){
            var rules = {};
            var ruleElemList = $("[cusvalid-rule]");
            for(var i=0; i<ruleElemList.length; i++){
                var obj = $.parseJSON($(ruleElemList[i]).attr("cusvalid-rule"));
                //console.log($(ruleElemList[i]).attr("name"));
                var name = $(ruleElemList[i]).attr("name");
                var fieldrule = {};
                fieldrule[name] = obj;
                $.extend(rules, fieldrule);
            }
            //console.log(rules);
            return rules;
        },
        messageCreator : function(){
            var msgs = {};
            var msgElemList = $("[cusvalid-msg]");
            for(var i=0; i<msgElemList.length; i++){
                var obj = $.parseJSON($(msgElemList[i]).attr("cusvalid-msg"));
                //console.log($(msgElemList[i]).attr("name"));
                var name = $(msgElemList[i]).attr("name");
                var fieldmsg = {};
                fieldmsg[name] = obj;
                $.extend(msgs, fieldmsg);
            }
            //console.log(msgs);
            return msgs;
        },
        dynamicRule : function(){
            $.validator.addMethod("dynamicrequire", function(value, element) {
            
            if($(element).attr("cusvalid-clone") == "true"){
                if(common.support.isNull(value)){
                    if(!common.support.isNull($(element).attr("temptitle"))){
                        $(element).attr("title",$(element).attr("temptitle"));
                    }
                    return false;
                }else{
                    return true;
                }
            }else{
                return true;
            }

            }, "Require.");
        },
        dynamicminlength : function(){
            $.validator.addMethod("dynamicminlength", function(value, element) {
            
            if($(element).attr("cusvalid-clone") == "true"){
                var minlength = parseInt($(element).attr("cminlength"));
                if($(element).val().length < minlength){
                    if(common.support.isNull($(element).attr("temptitle"))){
                        $(element).attr("temptitle",$(element).attr("title"));
                    }
                    $(element).attr("title",$(element).attr("minlengthmsg"));
                    return false;
                }
                return true;
            }else{
                return true;
            }
                
            },"Min length");
        },
        bsnRule : function(){
            $.validator.addMethod("bsnRule", function(value, element) {


                try{
                    var ruleElemList = $.parseJSON($("#LegalStructure option:selected").attr("data-bsnrule"));
                }catch(e){
                    return true;
                }
                    //console.log(ruleElemList);
                if(!common.support.isNull(ruleElemList)){
                    for(var i=0; i<ruleElemList.length; i++){

                        var format = ruleElemList[i].format;
                        var patt = new RegExp("^"+format+"$");
                        if(patt.test(value)){
                            return true;
                        }

                    }

                    return false;
                }else{
                    return true;
                }



            }, "Bsn.");
        },
        personvalidation : function(){
            $.validator.addMethod("personvalidation", function(value, element) {

                var ch = 0;
                var list = $(".personvalidation");
                for(var i=0; i<list.length; i++){
                    if($(list[i]).is(":checked")){
                        ch++;
                    }
                }

                var dataShow = parseInt($("#AuthPerSignCond option:selected").attr("data-show"));
                if(ch < dataShow){
                    return false;
                }else{
                    return true;
                }

            }, "Require.");
        },
        minlength : function(){
            $.validator.addMethod("minlength", function(value, element) {

                var minlength = parseInt($(element).attr("cminlength"));
                if($(element).val().length < minlength){
                    return false;
                }
                return true;

            }, "Require.");
        },
        signvalidation : function(msg1, msg2){
            $('body').data("signvalidationMsg1", msg1);
            $('body').data("signvalidationMsg2", msg2);
            $.validator.addMethod("signvalidation", function(value, element) {

                var ch = 0;
                var list = $(".signvalidation");
                for(var i=0; i<list.length; i++){
                    if($(list[i]).is(":checked")){
                        ch++;
                    }
                }

                var dataShow = parseInt($("#AuthSignaSignCond option:selected").attr("data-show"));

                //console.log('AuthorisedPersonFlagChecked: ', $('[name="AuthorisedPersonFlag"]').is(":checked"));

                //if(!$('[name="AuthorisedPersonFlag"]').is(":checked")) {
                    //$('body').data("signvalidationMsg",  $('body').data("signvalidationMsg"));
                    //return false;
                //}

                if(ch < dataShow){
                    $('body').data("signvalidationMsg",  $('body').data("signvalidationMsg1"));
                    return false;
                }
                else{
                    var clonemaster1clone = $(".clonemaster1clone");
                    for(var i=0; i<clonemaster1clone.length; i++){
                        //console.log($(clonemaster1clone[i]).find('.signvalidation').is(":checked"));
                        //console.log($(clonemaster1clone[i]).find('.authpersonntxt').is(":checked"));
                        if(!$(clonemaster1clone[i]).find('.signvalidation').is(":checked") && !$(clonemaster1clone[i]).find('.signpersonvalidation').is(":checked")){
                            $('body').data("signvalidationMsg",  $('body').data("signvalidationMsg2"));
                            return false;
                        }
                    }
                    

                    return true;
                }



            }, function(params, element) {
                var msg = $('body').data("signvalidationMsg");
                var dataShow = parseInt($("#AuthSignaSignCond option:selected").attr("data-show"));
                msg = msg.replace("#number#", dataShow);
                return msg;
            });


        },
        authmakercheck : function(msg){
            $.validator.addMethod("authmakercheck", function(value, element) {

                var ch = 0;
                var list = $(".clonemaster3clone");
                if(list.length <= 0){
                    list = $('.clonemaster7clone');
                }
                var isMakerCheck = false;
                var isAuthCheck = false;
                var isUserCheck = false;

                authperCheckOnInput();
                authuserCheckOnInput();

                for(var i=0; i<list.length; i++){
                    // console.log($(list[i]).find("[xml-elem='BizChannelMaker']"));
                    if(!common.support.isNull($(list[i]).find("[xml-elem='BizChannelMaker']"))  && $(list[i]).find("[xml-elem='BizChannelMaker']").length > 0 ){
                        if($(list[i]).find("[xml-elem='BizChannelMaker']").is(":checked")){
                            isMakerCheck = true;
                        }
                    }else{
                        isMakerCheck = true;
                    }
                    // console.log($(list[i]).find("[xml-elem='BizChannelAuthoriser']"));
                    if(!common.support.isNull($(list[i]).find("[xml-elem='BizChannelAuthoriser']")) && $(list[i]).find("[xml-elem='BizChannelAuthoriser']").length > 0){
                        if($(list[i]).find("[xml-elem='BizChannelAuthoriser']").is(":checked")){
                            isAuthCheck = true;
                        }
                    }else{
                        isAuthCheck = true;
                    }


                    if(!common.support.isNull($(list[i]).find("[xml-elem='BizAlertUsers']"))  && $(list[i]).find("[xml-elem='BizAlertUsers']").length > 0){
                        if($(list[i]).find("[xml-elem='BizAlertUsers']").is(":checked")){
                            isUserCheck = true;
                        }
                    }else{
                        isUserCheck = true;
                    }


                }

                if(isMakerCheck && isAuthCheck && isUserCheck){
                    return true;
                }

               return false;

            }, msg);
        },
        checkgrp : function(){
            $.validator.addMethod("checkgrp", function(value, element) {
                //console.log("[data-checkgrpnumber='"+$(element).attr("data-checkgrpnumber")+"']");
                var datacheckgrpnumber = $("[data-checkgrpnumber='"+$(element).attr("data-checkgrpnumber")+"']");
                if(common.support.isNull($(element).attr("data-checkgrpnumber"))){
                    return true;
                }
                for(var i=0; i<datacheckgrpnumber.length; i++){
                    if($(datacheckgrpnumber[i]).attr("data-checkgrpclone")=="false"){
                        //return true;
                    }
                    if($(datacheckgrpnumber[i]).is(":checked")){
                        return true;
                    }
                }

                return false;


            }, "Require");
        },
        dynamicRule3 : function(){
            $.validator.addMethod("dynamicrequire3", function(value, element) {

            var sel = $(element).parents(".clonemaster2clone").find("[xml-elem='LimitOperator']");

            if($(element).attr("cusvalid-clone") == "true"){
                if($("#"+$(sel).attr("id")+" option:selected").attr("no-require") == "true"){
                    return true;
                }else{
                    if(common.support.isNull(value)){
                        return false;
                    }else{
                        return true;
                    }
                }
            }else{
                return true;
            }

            }, "Require.");
        },
        subrequire : function(){
            $.validator.addMethod("subrequire", function(value, element) {

            if(!$("#CorrespondentAddressSameFlag").is(':checked')){
                if(common.support.isNull(value)){
                    return false;
                }else{
                    return true;
                }
            }else{
                return true;
            }

            }, "Require.");
        },
        fatcadynamicrequire : function(){
            $.validator.addMethod("fatcadynamicrequire", function(value, element) {


            if($(element).attr("cusvalid-clone") == "true"){
                if($("#FATCAUSEntity-no").is(':checked')){
                    return true;
                }else{
                    if($("#FATCA25Percent-no").is(':checked')){
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderName"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderPercent"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderTaxNumber"){
                            return true;
                        }
                    }
                    if($("#FATCAUSBeneficiaryOwnerIndicator-no").is(':checked')){
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerName"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDNo"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDExpiryDate"){
                            return true;
                        }
                        if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-2"){
                            return true;
                        }
                        if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-3"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerTaxNumber"){
                            return true;
                        }
                    }

                }
                if(common.support.isNull(value)){
                    return false;
                }else{
                    if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-1"){
                        var n = parseInt(value);
                        if(n < 0 || n > 31){
                            $(element).attr("title",$(element).attr("title2"));
                            return false;
                        }
                    }
                    if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-2"){
                        var n = parseInt(value);
                        if(n < 0 || n > 12){
                            $(element).attr("title",$(element).attr("title2"));
                            return false;
                        }
                    }
                    return true;
                }
            }else{
                return true;
            }

            }, "Require.");
        },
        fatcarequire : function(){
            $.validator.addMethod("fatcarequire", function(value, element) {
                if($("#FATCAUSEntity-no").is(':checked')){
                    return true;
                }else{
                    if($("#FATCA25Percent-no").is(':checked')){
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderName"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderPercent"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderTaxNumber"){
                            return true;
                        }
                    }
                    if($("#FATCAUSBeneficiaryOwnerIndicator-no").is(':checked')){
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerName"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDNo"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDExpiryDate"){
                            return true;
                        }
                        if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-2"){
                            return true;
                        }
                        if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-3"){
                            return true;
                        }
                        if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerTaxNumber"){
                            return true;
                        }
                    }

                }
            if(common.support.isNull(value)){
                return false;
            }else{
                return true;
            }

            }, "Require.");
        },
        dynamicRule4 : function(){
            $.validator.addMethod("dynamicrequire4", function(value, element) {

                if($("#BTOthersFlg").is(":checked")){
                    if($(element).attr("cusvalid-clone") == "true"){
                        if(common.support.isNull(value)){
                            return false;
                        }else{
                            return true;
                        }
                    }else{
                        return true;
                    }
                }else{
                    return true;
                }

            }, "Require.");
        },
        dynamicRule2 : function(){
            $.validator.addMethod("dynamicrequire2", function(value, element) {
            if($("#FATCAUSEntity-no").is(':checked')){
                return true;
            }else{
                if($("#FATCA25Percent-no").is(':checked')){
                    if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderName"){
                        return true;
                    }
                    if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderPercent"){
                        return true;
                    }
                    if($(element).attr("xml-elem") == "FATCAUSDirectorShareholderTaxNumber"){
                        return true;
                    }
                }
                if($("#FATCAUSBeneficiaryOwnerIndicator-no").is(':checked')){
                    if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerName"){
                        return true;
                    }
                    if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDNo"){
                        return true;
                    }
                    if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerIDExpiryDate"){
                        return true;
                    }
                    if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-2"){
                        return true;
                    }
                    if($(element).attr("data-inputclone") == "FATCAUSBeneficiaryOwnerIDExpiryDate-3"){
                        return true;
                    }
                    if($(element).attr("xml-elem") == "FATCAUSBeneficiaryOwnerTaxNumber"){
                        return true;
                    }
                }
            }
            var dp = $(element).attr("cusvalid-dependcheckid");
            if(!$("#"+dp).is(":checked")){
                if(common.support.isNull(value)){
                    return false;
                }else{
                    return true;
                }
            }else{
                return true;
            }
                
            }, "Require.");
        },
        condrequire : function(){
            $.validator.addMethod("condrequire", function(value, element) {
            var n = $(element).attr("name");
            n = n.substring(0, n.length-1);
            if($("#AuthSignaSignCond option:selected").attr("data-area") == "2"){
                return true;
            }

            if($("[name='"+n+"0']").is(':checked')){
                var sel = $(element).parents(".row.condition").find("[xml-elem='LimitOperator']");

                if($("[name='"+$(sel).attr("name")+"'] option:selected").attr("no-require") == "true"){
                    return true;
                }else{
                    if(common.support.isNull(value)){
                        return false;
                    }else{
                        return true;
                    }
                }
            }else{
                return true;
            }
                
            }, "Require.");
        },
        authPerOtherrequire : function(){
            $.validator.addMethod("authPerOtherrequire", function(value, element) {
                var isShow = $(element).attr("cus-isshow");
                if(common.support.isNull(isShow)){
                    return true;
                }else{
                   if(isShow == "true"){
                        if(common.support.isNull(value)){
                            return false;
                        }else{
                            return true;
                        }
                   }else{
                        return true;
                   }
                }
            }, "Require.");
        },
        selrequire : function(){
            $.validator.addMethod("selrequire", function(value, element) {
                var n = $(element).attr("cusvalid-requireselid");
                var shvalue = $("#"+n+" option:selected").attr("data-selectopfieldsh");
                if(!common.support.isNull(shvalue)){
                    if(common.support.isNull(value)){
                        return false;
                    }else{
                        return true;
                    }
                }else{
                    return true;
                }

            }, "Require.");
        },
        dynamicEmail : function(){
            $.validator.addMethod("dynamicEmail", function(value, element) {
                //console.log("DYnamic Email Check "+$.validator.methods.email.call(this, value, element));
                return $.validator.methods.email.call(this, value, element);
                
            }, "invalid format.");
        },
        dynamicRuleAuthperEmailNotEqualTo : function(){
            $.validator.addMethod("authperEmailNotEqualTo", function(value, element, param) {
                return this.optional(element) || value.toLowerCase() != $(param).val().toLowerCase();

            }, "Please enter different email address");
        }
    }
}

var checkstatus = {
    init : function(){
        checkstatus.ui.retrieve();
    },
    ui :{
        retrieve : function(){
            $("#retrieve").click(function(){
                $(".transload").show();
                common.ui.setDivCenter($(".transload"));
                common.ui.showOverlay();
                $(".status-success").hide();
                var actionURL = ($("#stsform").attr("action")).replace("http", "https");
                $.ajax({
                    url: actionURL,
                    type: $("#stsform").attr("method"),
                    dataType: 'json',
                    cache: false,
                    data : $("#stsform").serialize(),
                    error: function(jqXHR, textStatus, errorThrown){},
                    context : $("#stsform"),
                    success: function(obj){
                        $(".transload").hide();
                        $('#tchinitOverlap').remove();
                        if(obj.success == "false"){
                            $("#stserror").html(obj.msg);
                        }else{
                            $("#stsform").hide()
                            $("#listcontent").empty();
                            for(var i=0; i<obj.content.length; i++){
                                var clonemaster = $(".clonemaster11").children().clone();
                                for(x in obj.content[i]){
                                    //console.log(obj.content[i][x]);
                                    $(clonemaster).find("."+x).html(obj.content[i][x]);
                                    $("#listcontent").append(clonemaster);
                                }
                            }
                            
                            $(".status-success").show();
                        }
                    }
                });
            })
            
            $("#bck").click(function(){
                $("#stsform").show();
                $(".status-success").hide();
            })
        }
    }
}

var registration = {
    noback : function(url){
        if(window.location.hash) {
            if(window.location.hash == "#noback"){
                window.location = url;
                //alert(window.location.hash);
            }
        }
    },
    save :{
        auto : "Auto Saving...",
        manual : "Saving...",
        ori : "Save",
        saving : false
    },
    timeout : {
        showalert : 9,
        timeout : 10,
        timeouttimer : '',
        autosave : 5,
        autosavetimer : '',
        counter : 0,
        refreshUrl : "",
        showingalert : false
    },
    msg : {
        idle : "",
        timeout : ""
    },
    init : function(){

        registration.event.editinit();

        if(!common.ui.isRetrieveData){
            common.event.clone.add("clonemaster4", 2,"container4");
            common.event.clone.add("clonemaster5", 2,"container5");
            common.event.clone.add("clonemaster6", 2,"container6");
        }


        registration.event.accordion();
        
        //registration.event.sameaddr();
        registration.event.branchLocation();
        registration.event.ecurrentsubmitbtn();
        common.ui.sameheight("sh1");
        common.ui.sameheight("sh2");
        $("#OtherBeneficiaryOwnerType-error-placeholder").append($("<label/>"));

        try{
            $( "#QGEffectiveDate" ).datepicker({
                onClose : function(){
                    if($( "#QGEffectiveDate" ).val() != ""){
                        $("#QGEffectiveDate-error").attr("data-error",$("#QGEffectiveDate-error").html());
                        $("#QGEffectiveDate-error").html("");
                    }else{
                        $("#QGEffectiveDate-error").html($("#QGEffectiveDate-error").attr("data-error"));
                    }
                }
            });
            $( "#QGExpiryDate" ).datepicker({
                onClose : function(){
                    if($( "#QGExpiryDate" ).val() != ""){
                        $("#QGExpiryDate-error").attr("data-error",$("#QGExpiryDate-error").html());
                        $("#QGExpiryDate-error").html("");
                    }else{
                        $("#QGExpiryDate-error").html($("#QGExpiryDate-error").attr("data-error"));
                    }

                }
            });
        }catch(e){console.log(e)}


        $("#FATCAUSBeneficiaryOwnerIndicator .radio").click(function(){
            registration.event.FATCAUSBeneficiaryOwnerIndicator(this);
        });
        registration.event.FATCAUSBeneficiaryOwnerIndicator($("#FATCAUSBeneficiaryOwnerIndicator .radio"));
        
        $(".jsotherfund").click(function(){
            registration.event.jsotherfund(this);
        })
        registration.event.jsotherfund($(".jsotherfund"));
        
        $("#sameaddr").click(function(){
            registration.event.sameaddr(this);
        });
        registration.event.sameaddr($("#sameaddr"));

        $(".jsauthsigncond").change(function(){
            $("#AuthSignSelected").val($("#AuthSignaSignCond option:selected").attr("data-area"));
            registration.event.authSignChange(this);
        });

        if(!common.ui.isRetrieveData){
            //registration.event.authSignChange($(".jsauthsigncond"));
        }

    },
    event : {
        ecurrentsubmitbtn : function(){
            $("#saveemail").keyup(function() {
                $("#PICEmailAddress").val($(this).val());
            });



            $(".ecurrentsubmitbtn").click(function(){
                if(registration.save.saving){
                    return;
                }
                $('.progresssave').attr("target-form", $(this).attr("target-form"));
                var picEmailAddressC = $("#PICEmailAddress").val();

                $("#saveemail").val("");
                $("#saveemail-error-placeholder").empty();
                $(".popcontent").show();
                $(".popsuccess").hide();
                $(".poperror").hide();
                $(".popalert").hide();
                $(".poptimeout").hide();
                common.ui.setDivCenter($("#savepopup"));
                common.ui.showOverlay();
                $("#savepopup").fadeIn("fast");
                var picEmailAddress = $("#PICEmailAddress").val();
                if(!common.support.isNull(picEmailAddress)){
                    $("#saveemail").val(picEmailAddress);
                    $("#saveemail").attr("readonly","true");
                }else{
                    $("#saveemail").removeAttr("readonly");
                }

                if(common.support.isNull(picEmailAddressC)){
                    $(".popalert").show();
                    $(".popcontent").hide();
                }
                common.ui.setDivCenter($("#savepopup"));
            })


            $(".closepopup").click(function(){
                $("#savepopup").fadeOut("fast");
                $("#transpopup").fadeOut("fast");
                $("#timeoutpopup").fadeOut("fast");
                $('#tchinitOverlap').remove();

            })


            $('.progresssave').click(function(){
                if(registration.save.saving){
                    return;
                }
                registration.save.saving = true;
                $(".saveprogress").css("opacity","0.5");
                $(".saveprogress").val($('body').data("savetxt"));
                $(this).css("opacity","0.5");
                $(this).val($('body').data("savetxt"));
                var tform = $(this).attr("target-form");
                if(common.support.isNull(tform)){
                    tform = "#reg1";
                }else{
                    tform = "#"+tform;
                }
                 var actionURL = ($(this).attr("action")).replace("http", "https");
                if($('#saveemail').valid()){
                    $.ajax({
                        url: actionURL,
                        type: $(this).attr("method"),
                        dataType: 'json',
                        cache: false,
                        data : {xmldata : component.xmlGenerator($(tform)),saveemail:$('#saveemail').val()},
                        error: function(jqXHR, textStatus, errorThrown){
                            console.log(errorThrown);
                        },
                        success: function(obj){
                            $(".saveprogress").css("opacity","1");
                            registration.save.saving = false;
                            $(".saveprogress").val(registration.save.ori);
                            $(".progresssave").css("opacity","1");
                            $(".progresssave").val(registration.save.ori);
                            $('body').data("savetxt",registration.save.manual);
                            $(".popcontent").hide();
                            $('#saveemail').val("");
                            if(obj.success == "true"){
                                $("#returncode").html(obj.code);
                                $(".popsuccess").show();
                            }else{
                                if(obj.sessionTimeout == "true"){
                                    $(".poptimeout").show();
                                }else{
                                    $(".poperror").show();
                                }

                            }
                            common.ui.setDivCenter($("#savepopup"));
                        }
                    });
                }else{
                    registration.save.saving = false;
                    $("#saveemail").removeAttr("readonly");
                }
            })
        },
        bgRefresh : function(){
            var actionURL = registration.timeout.refreshUrl.replace("http", "https");
            $.ajax({
                url: actionURL,
                type: $(this).attr("method"),
                dataType: 'json',
                cache: false,
                error: function(jqXHR, textStatus, errorThrown){
                    //console.log(errorThrown);
                },
                success: function(obj){
                    /*
                    if(obj.session != "true"){
                        $("#timeoutcontent").html(registration.msg.timeout);
                        common.ui.setDivCenter($("#timeoutpopup"));
                        $("#timeoutpopup").fadeIn("fast");
                        registration.timeout.counter = 0;
                        $("#timeOutOk").hide();
                    }else{
                        $(".closepopup").trigger("click");
                        registration.timeout.counter = registration.timeout.timeout * 60;
                        registration.timeout.showingalert = false;
                    }
                    */
                }
            });
        },
        startAutoSave : function(presave){
            if($('#PICEmailAddress').val() != '' && presave){
                $("#saveemail").val($('#PICEmailAddress').val());
                $('body').data("savetxt",registration.save.auto);
                $(".progresssave").trigger("click");
            }
            clearInterval(registration.timeout.autosavetimer);
            registration.timeout.autosavetimer = setInterval(function() {
                if($('body').data("fs") != 'true'){
                    if($('#PICEmailAddress').val() != ''){
                        $("#saveemail").val($('#PICEmailAddress').val());
                        $('body').data("savetxt",registration.save.auto);
                        $(".progresssave").trigger("click");
                    }
                }


            }, registration.timeout.autosave*60*1000);
        },
        sessionTimeOut : function(idle, timeout, refreshUrl){

            $(document.body).bind('mousemove keydown click',function(){
                if(!registration.timeout.showingalert){
                    registration.timeout.counter = registration.timeout.timeout * 60;
                }
            });

            setInterval(function() {
                registration.event.bgRefresh();
            }, registration.timeout.autosave*60*1000);

            registration.timeout.timeouttimer = setInterval(function() {
                registration.timeout.counter--;
                
                if(registration.timeout.counter < 0) {
                    $("#timeoutcontent").html(registration.msg.timeout);
                    clearInterval(registration.timeout.timeouttimer);
                    $("#timeOutOk").hide();
                    $("#timeOutCancel").hide();
                    $("#timeOutOk2").show();
                } else {
                    $("#timeoutcontent").html(registration.msg.idle.replace("#countdown#", registration.timeout.counter));
                }
                
                if((registration.timeout.timeout - registration.timeout.showalert) * 60 == registration.timeout.counter){
                    $("#timeOutOk2").hide();
                    registration.timeout.showingalert = true;
                    common.ui.setDivCenter($("#timeoutpopup"));
                    $("#timeoutpopup").fadeIn("fast");
                    common.ui.showOverlay();
                }
            }, 1000);
            
            $("#timeOutOk").click(function(){
                $(".closepopup").trigger("click");
                registration.timeout.counter = registration.timeout.timeout * 60;
                registration.timeout.showingalert = false;
                //registration.event.bgRefresh();
                
            })
            
            registration.timeout.refreshUrl = refreshUrl;
            registration.timeout.counter = registration.timeout.timeout * 60;
            registration.msg.idle = idle;
            registration.msg.timeout = timeout;
            registration.event.bgRefresh();
        },
        FATCAUSBeneficiaryOwnerIndicator : function(){
            
                setTimeout(function(curthis){
                    registration.event.FATCAUSBeneficiaryOwnerIndicatorLogic($("#FATCAUSBeneficiaryOwnerIndicator .radio"));
                }, common.ui.clickdelay, this);

        },
        FATCAUSBeneficiaryOwnerIndicatorLogic : function(){
            

                    if($("#"+$("#FATCAUSBeneficiaryOwnerIndicator .radio").attr("for")).is(':checked')){
                        $(".esh3").show();
                        if(common.ui.FATCAUSBeneficiaryOwnerIndicator1sttime){
                            common.ui.FATCAUSBeneficiaryOwnerIndicator1sttime = false;
                            //common.event.clone.add("clonemaster6", 2,"container6");
                        }

                    }else{
                        $(".esh3").hide();
                        common.ui.FATCAUSBeneficiaryOwnerIndicator1sttime = true;
                        //$(".container6").empty()
                    }
                    $(".s6").find("[id*='error-placeholder']").find("label").empty();

        },
        editinit : function(){
            if($('.noneditable-form').length >= 1){
                $('.noneditable-form').find('input[type=text]').attr('disabled',true);
                $('.noneditable-form').find('select').attr('disabled',true);
                setTimeout(function(curthis){
                    var rl = $('.noneditable-form').find('input[type="radio"]');
                    for(var i=0; i<rl.length; i++){
                        if($(rl[i]).is(":checked")){
                            $(rl[i]).parent().find(".fakeradio").hide();
                        }else{
                            $(rl[i]).parents("label.radio").hide();
                        }
                    }
                }, common.ui.clickdelay, this);
            }
            var combinelist = $('[data-discombine]');
            for(var cbl=0; cbl<combinelist.length; cbl++){
                var cbfield = $(combinelist[cbl]).attr("data-discombine") ;
                var cbsep = $(combinelist[cbl]).attr("data-discombinesep") ;
                var cbfl = cbfield.split("|");
                var str = ""
                for(var a=0; a<cbfl.length; a++){
                    str = str + $("#"+cbfl[a]).val();
                    $("#"+cbfl[a]).hide();
                    if(a < cbfl.length-1){
                        str =str + cbsep;
                    }
                }
                $(combinelist[cbl]).val(str);
                $(combinelist[cbl]).addClass("fakecombine");
            }
            
            // Validate
        $('.btn-edit-form').click(function(){
            $(".block-checkbox").hide();
            var visibleSaveBtn = $('.btn-save-form').filter(function() {
                return $(this).css('display') !== 'none';
            }).length;

            if( visibleSaveBtn >= 1){
                alert('Please save current active section before editing another section');
            }
            else{
                var rl = $(this).parent().parent().find('input[type="radio"]');
                for(var i=0; i<rl.length; i++){
                        $(rl[i]).parent().find(".fakeradio").show();
                        $(rl[i]).parents("label.radio").show();
                }
                
                $(this).parent().parent().find(".editdynamic").show();
                $(this).parent().parent().find(".editdynamic2").css("display","inline-block");
                $(this).parent().parent().find(".inlinefieldc.hide").removeClass("hide");
                $(this).parent().parent().find('input[type=text]').attr('disabled',false);
                $(this).parent().parent().find('select').attr('disabled',false);
                $(this).parent().parent().removeClass('noneditable-form');
                $(this).parent().parent().addClass('editable-form');
                $(this).hide();
                $(this).parent().find('.btn-save-form').show();
                $(this).find("[data-discombine]").hide();
                
                var combinelist = $(this).parent().parent().find('[data-discombine]');
                for(var cbl=0; cbl<combinelist.length; cbl++){
                    var cbfield = $(combinelist[cbl]).attr("data-discombine") ;
                    var cbfl = cbfield.split("|");
                    for(var a=0; a<cbfl.length; a++){
                        $("#"+cbfl[a]).show();
                    }
                    $(combinelist[cbl]).hide();
                }
            }
        
        })

        $('.btn-save-form').click(function() {

            if ($('#edit').valid()) {
                $(".block-checkbox").show();
                var listcheck = $(this).parent().parent().find("input[type='checkbox']");
                for(var i=0; i<listcheck.length; i++){
                    if($(listcheck[i]).is(":checked")){
                        $(listcheck[i]).parents(".inlinefieldc").css("display","block");
                    }
                }
                var rl = $(this).parent().parent().find('input[type="radio"]');
                for(var i=0; i<rl.length; i++){
                    if($(rl[i]).is(":checked")){
                        $(rl[i]).parent().find(".fakeradio").hide();
                    }else{
                        $(rl[i]).parents("label.radio").hide();
                    }
                }
                $(this).parent().parent().find(".editdynamic").hide();
                $(this).parent().parent().find(".editdynamic2").hide();
                $(this).parent().parent().find(".inlinefieldc").addClass("hide");
                $(this).parent().parent().find('input[type=text]').attr('disabled', true);
                $(this).parent().parent().find('select').attr('disabled', true);
                $(this).parent().parent().addClass('noneditable-form');
                $(this).parent().parent().removeClass('editable-form');
                $(this).hide();
                $(this).parent().find('.btn-edit-form').show();
                
                var combinelist = $(this).parent().parent().find('[data-discombine]');
                for(var cbl=0; cbl<combinelist.length; cbl++){
                    var cbfield = $(combinelist[cbl]).attr("data-discombine") ;
                    var cbsep = $(combinelist[cbl]).attr("data-discombinesep") ;
                    var cbfl = cbfield.split("|");
                    var str = ""
                    for(var a=0; a<cbfl.length; a++){
                        str = str + $("#"+cbfl[a]).val();
                        $("#"+cbfl[a]).hide();
                        if(a < cbfl.length-1){
                            str =str + cbsep;
                        }
                    }
                    $(combinelist[cbl]).show();
                    $(combinelist[cbl]).val(str);
                }

            } else {
                // Checking for errors per section
                var badinput = 0;
                var badlabel = 0;
                var errormsg = 0;
                $(this).parent().parent().find(':text').each(function() {
                    if ($.trim($(this).val()) == "") badinput++;
                });
                $(this).parent().parent().find('select').each(function() {
                    if ($(this).val() == null) badlabel++;
                });
                $(this).parent().parent().find('label.error').each(function() {
                    if ($(this).css('display') == 'block') errormsg++;
                });

                //console.log(errormsg);

                if (badinput > 0 || badlabel > 0 || errormsg > 0) {
                    alert('Please ensure that all fields are filled accordingly');
                } else {
                    $(this).parent().parent().find('input[type=text]').attr('disabled', true);
                    $(this).parent().parent().find('select').attr('disabled', true);
                    $(this).parent().parent().addClass('noneditable-form');
                    $(this).hide();
                    $(this).parent().find('.btn-edit-form').show();
                }
            }

        });
        
        },
        jsotherfund : function(curThis){
            setTimeout(function(curthis){
                if($("#"+$(curThis).attr("for")).is(':checked')){
                    $(".s3").show();
                }else{
                    $(".s3").hide();
                }
                $(".s3").find("[id*='error-placeholder']").find("label").empty();
            }, common.ui.clickdelay, curThis);   

        },
        branchLocation : function(){
            $('body').data("Branch", "false");
            $("#BranchState").change(function(){
                if(common.support.isNull($("#"+$(this).attr("id")+" option:selected").attr("data-pname"))){
                    return;
                }
                $(".BranchAddress").empty();
                var actionURL = ($(this).attr("data-source")).replace("http", "https");
                $.ajax({
                    url: actionURL,
                    type: "GET",
                    dataType: 'html',
                    cache: false,
                    data : {data1 : $("#"+$(this).attr("id")+" option:selected").attr("data-pname")},
                    error: function(jqXHR, textStatus, errorThrown){},
                    context : $(this),
                    success: function(obj){
                        $("#BranchName").empty();
                        $("#BranchName").append(obj);
                        $("#BranchName").trigger("change");
                        $('body').data("Branch", "true");
                    }
                });
            });

            $("#BranchName").change(function(){
                var actionURL = ($(this).attr("data-source")).replace("http", "https");
                $.ajax({
                    url: actionURL,
                    type: "GET",
                    dataType: 'html',
                    cache: false,
                    data : {data1 : $("#BranchState option:selected").attr("data-pname"), data2 : $("#"+$(this).attr("id")+" option:selected").attr("data-pname")},
                    error: function(jqXHR, textStatus, errorThrown){},
                    context : $(this),
                    success: function(obj){
                        $(".BranchAddress").empty();
                        $(".BranchAddress").append(obj);
                        $('body').addClass("chanceBranchName");
                    }
                });
            });

            $("#BranchState").trigger("change");
        },
        sameaddr : function(curThis){
                //console.log("click");
                    $("#MailingAddress1-error").empty();
                    $("#MailingAddress2-error").empty();
                    $("#MailingAddress3-error").empty();
                    $("#MailingCity-error").empty();
                    $("#MailingPostcode-error").empty();
                    $("#MailingState-error").empty();
                    $("#MailingCountry-error").empty();
                setTimeout(function(curthis){
                    //console.log("delay click");


                    if($("#CorrespondentAddressSameFlag").is(':checked')){
                        $("#MailingAddress1").val($("#RegisteredAddress1").val());
                        $("#MailingAddress2").val($("#RegisteredAddress2").val());
                        $("#MailingAddress3").val($("#RegisteredAddress3").val());
                        $("#MailingCity").val($("#City").val());
                        $("#MailingPostcode").val($("#Postcode").val());
                        $("#MailingState").val($("#State").val());
                        $("#MailingCountry").val($("#Country").val());
                        
                        $("#MailingAddress1").attr('readonly', 'readonly');
                        $("#MailingAddress2").attr('readonly', 'readonly');
                        $("#MailingAddress3").attr('readonly', 'readonly');
                        $("#MailingCity").attr('readonly', 'readonly');
                        $("#MailingPostcode").attr('readonly', 'readonly');
                        $("#MailingState").attr('readonly', 'readonly');
                        $("#MailingCountry").attr('readonly', 'readonly');
                        
                        $("#samemailling").hide();
                        $('body').addClass("sameadd");
                    }else{
                        $("#MailingAddress1").val("");
                        $("#MailingAddress2").val("");
                        $("#MailingAddress3").val("");
                        $("#MailingCity").val("");
                        $("#MailingPostcode").val("");
                        $("#MailingState").val("");
                        $("#MailingCountry").val("");
                        
                        $("#MailingAddress1").removeAttr('readonly');
                        $("#MailingAddress2").removeAttr('readonly');
                        $("#MailingAddress3").removeAttr('readonly');
                        $("#MailingCity").removeAttr('readonly');
                        $("#MailingPostcode").removeAttr('readonly');
                        $("#MailingState").removeAttr('readonly');
                        $("#MailingCountry").removeAttr('readonly');
                        $("#samemailling").show();
                        $('body').removeClass("sameadd");
                    }

                }, common.ui.clickdelay, curThis);
        },
        accordion : function() {
            if ($('.accordion-header').length > 0){
                // Accordion
                $('.signup-card-section').find('fieldset').hide()
                $('.signup-card-section:first-child').find('fieldset').slideDown();
                $('.signup-card-section:first-child h2').addClass('active');

                // Click and expand
                $('.signup-card-section h2').click(function(){
                    
                    var cSection = $(this).parent().attr('id');
                    if($('#PICEmailAddress').val() != '' && (cSection == 'maincon' || cSection == 'authuser')){
                        $("#saveemail").val($('#PICEmailAddress').val());
                        $('body').data("savetxt",registration.save.auto);
                        $(".progresssave").trigger("click");
                    }

                    if($(this).parent().find('fieldset').css('display') == 'block'){
                        $(this).parent().find('fieldset').slideUp();
                    }
                    else{
                        $('.signup-card-section fieldset').slideUp();
                        $('.signup-card-section h2').removeClass('active');
                        $(this).parent().find('fieldset').slideDown();
                    }
                    $(this).toggleClass('active');
                })  
            }
        },
        authSignChange : function(curThis){
            
                $(".cloneContainer1").empty();
                $(".dynamicconditioncontainer").empty();
                var dataShow = parseInt($("#"+$(curThis).attr("id")+" option:selected").attr("data-show"));
                var dataarea = parseInt($("#"+$(curThis).attr("id")+" option:selected").attr("data-area"));
                var noaddbtn = $("#"+$(curThis).attr("id")+" option:selected").attr("noaddbtn");
                $(".jsdependauthsigncond").show();
                if(dataShow >= 1){
                    $(".jsdependauthsigncond").show();
                    $(".clonemaster1").attr("data-minclone",dataShow);
                        if(dataShow == 1){
                            common.event.clone.add("clonemaster1", 1, "cloneContainer1");
                        }else{
                            common.event.clone.add("clonemaster1", 3, "cloneContainer1");
                        }
                    $(".headerClone1").show();

                }else{
                    $(".jsdependauthsigncond").hide();
                }

                $(".fixcondition").hide();
                $(".dynamiccondition").hide();
                $(".authsigntxt").hide();

                if(dataarea == "1"){
                    $(".fixcondition").show();
                    $('.jslableforcondition').removeClass("hide");
                    $(".authsigntxt").show();
                }else if(dataarea == "0"){
                    $(".fixcondition").hide();
                    $(".dynamiccondition").hide();
                    $('.jslableforcondition').addClass("hide");
                }else{
                    $('.jslableforcondition').removeClass("hide");
                    $(".dynamiccondition").show();
                    $(".dynamicconditioncontainer").empty();
                    $(".authsigntxt").show();
                    common.event.clone.add("clonemaster2", 1, "dynamicconditioncontainer");
                }

                if(!common.support.isNull(noaddbtn) && noaddbtn == "true"){
                    $(".jsdependauthsigncond").hide();
                }

        }
    }
}


/* Wealth Accumulation Calculator function */

$.fn.calcWealthAccWireUp = function (options)
{
  var element = this;
  var settings = $.extend ({}, options);

  var form_calculate = $(element).find ('.calculator-item');
  var result_calculate = $(element).find ('.calculated-result');
  var btn_calculate = $(element).find ('.calculator-calculate-button');

  var input_desired_amount = $(element).find ('.input-accmt-desired');
  var input_accmt_period = $(element).find ('.input-accmt-period');

  var input_returnrate = $(element).find ('.input-exp-returnrate');
  var input_inflaterate = $(element).find ('.input-exp-inflate');

  var input_delayear = $(element).find ('.input-delay-year');

  var output_lump = $(element).find ('.calc-result.output-lump-amount');
  var output_monthly = $(element).find ('.calc-result.output-monthly-amount');

  var output_lump_need_delay = $(element).find ('.label-summary-delay.output-lumpsum');
  var output_month_need_delay = $(element).find ('.label-summary-delay.output-monthsum');

  var lump;
  var monthly;
  var delay_lump;
  var delay_month;

  var retrate;

  var delayear_timeout;

  function get_returnrate ()
  {
    var returnrate = $(input_returnrate).val ();
    var inflaterate = $(input_inflaterate).val ();
    return returnrate - inflaterate;
  }

  function get_ffv ()
  {
    var accmt_period = $(input_accmt_period).val ();
    return FV (retrate, accmt_period, 0, -1);
  }

  function get_lump ()
  {
    var accmt_period = $(input_accmt_period).val ();
    var desired_lump = $(input_desired_amount).val ();
    return PV (retrate, accmt_period, 0, desired_lump) * -1;
  }

  function get_monthly ()
  {
    var accmt_period = $(input_accmt_period).val ();
    var desired_lump = $(input_desired_amount).val ();
    return (PMT (retrate, accmt_period, 0, desired_lump) * -1) / 12;
  }

  function get_ffv_delayed ()
  {
    var delayear = $(input_delayear).val ();
    var accmt_period = $(input_accmt_period).val ();
    var yearleft = accmt_period - delayear;
    return FV (retrate, yearleft, 0, -1);
  }

  function get_lump_delayed ()
  {
    var delayear = $(input_delayear).val ();
    var accmt_period = $(input_accmt_period).val ();
    var yearleft = accmt_period - delayear;
    var desired_lump = $(input_desired_amount).val ();
    return PV (retrate, yearleft, 0, desired_lump) * -1;
  }

  function get_monthly_delayed ()
  {
    var delayear = $(input_delayear).val ();
    var accmt_period = $(input_accmt_period).val ();
    var yearleft = accmt_period - delayear;
    var desired_lump = $(input_desired_amount).val ();
    return (PMT (retrate, yearleft, 0, desired_lump) * -1) / 12;
  }

  function validate_fields ()
  {
    var result = true;

    $(".calculator-item, .calculated-result").find (".calc-required").filter (":visible").each (function (index, item) {
      if ($(item).val () == "")
      {
        $(item).addClass ("error");
        $(item).parent ().find (".calc-error").show ();
        result = false;
      }
      else
      {
        $(item).removeClass ("error");
        $(item).parent ().find (".calc-error").hide ();
      }
    });

    $(".calculator-item, .calculated-result").find (".calc-minmax").filter (":visible").filter (":not(.calc-required.error)").each (function (index, item) {
      var item_val = $(item).val ();
      var item_min = $(item).attr ('data-val-min');
      var item_max = $(item).attr ('data-val-max');
      var item_min_valid = true;
      var item_max_valid = true;
      
      if ($(item).hasClass ("numeric-only"))
      {
        item_val = Number (item_val);
        item_min = Number (item_min);
        item_max = Number (item_max);
      }

      if (item_min != undefined)
      {
        if (item_val < item_min)
        {
          item_min_valid = false;
          result = false;
        }
      }

      if (item_max != undefined)
      {
        if (item_val > item_max)
        {
          item_max_valid = false;
        }
      }

      if (item_min_valid == false || item_max_valid == false)
      {
        $(item).addClass ("error");
        $(item).parent ().find (".calc-error").show ();
      }
      else
      {
        $(item).removeClass ("error");
        $(item).parent ().find (".calc-error").hide ();
      }
    });

    return result;
  }

  $(form_calculate).find ('.calc-input').each (function (index, item) {
    $(item).on ("keyup.retireInputChange", function (keyvent) {
      if (!$(result_calculate).is (":hidden"))
      {
        $(result_calculate).hide ();
      }
      validate_fields ();
    });
  });

  $(result_calculate).find ('.calc-input').each (function (index, item) {
    $(item).on ("keyup.retireInputChange", function (keyvent) {
      validate_fields ();
    });
  });

  $(btn_calculate).on ("click.retireCalc", function (clickevent) {
    clickevent.preventDefault ();
    if (validate_fields () === false)
    {
      return;
    }

    retrate = get_returnrate () / 100;

    lump = get_lump ();
    monthly = get_monthly ();
    delay_lump = get_lump_delayed ();
    delay_month = get_monthly_delayed ();

    $(output_lump).outputCalcValue (lump);
    $(output_monthly).outputCalcValue (monthly);
    $(output_lump_need_delay).outputCalcValue (delay_lump);
    $(output_month_need_delay).outputCalcValue (delay_month);

    $(result_calculate).show ();
    $(btn_calculate).scrollPageToThis ();
  });

  $(input_delayear).on ("keyup.wealthaccDelayChange", function (keyvent) {
    clearTimeout (delayear_timeout);

    if ($(input_delayear).val () == "")
    {
      return;
    }

    var delayear = $(input_delayear).val ();
    var accmt_period = $(input_accmt_period).val ();
    var yearleft = accmt_period - delayear;
    if (yearleft < 1)
    {
      return;
    }

    if (validate_fields () == false)
    {
      return;
    }

    delayear_timeout = setTimeout (
      function () {
        delay_lump = get_lump_delayed ();
        delay_month = get_monthly_delayed ();
        $(output_lump_need_delay).outputCalcValue (delay_lump);
        $(output_month_need_delay).outputCalcValue (delay_month);
      },
      333
    );

  });

  $(btn_calculate).prop ({ 'disabled': false });

  $(element).addClass ("-calc-wealthacc-wired-");
};

function _calc_wealthacc_disablecalcbutton ()
{
  $('.calc-wealthacc').calcFormDisableButtonFirst ();
}

function _calc_wealthacc_wireup ()
{
  $('.calc-wealthacc').filter (":not(.-calc-wealthacc-wired-)").each (function (index, item) {
    $(item).calcWealthAccWireUp ();
  });
}

$(document).ready (function () {
  _calc_wealthacc_wireup ();
});

_calc_wealthacc_disablecalcbutton ();

/* Retirement Calculator function */

$.fn.calcRetirementWireUp = function (options)
{
  var element = this;
  var settings = $.extend ({}, options);

  var form_calculate = $(element).find ('.calculator-item');
  var result_calculate = $(element).find ('.calculated-result');
  var btn_calculate = $(element).find ('.calculator-calculate-button');

  var input_returnrate = $(element).find ('.input-exp-returnrate');
  var input_inflaterate = $(element).find ('.input-exp-inflate');

  var input_expenditure = $(element).find ('.input-exp-expenditure');

  var input_currage = $(element).find ('.input-curr-age');
  var input_desired_retirage = $(element).find ('.input-desiretire-age');
  var input_retire_period = $(element).find ('.input-retire-period');

  var input_delayear = $(element).find ('.input-delay-year');

  var input_assets_liquidate = $(element).find ('.input-assets-liquidate');

  var output_lump = $(element).find ('.calc-result.output-retire-amount');
  var output_monthly = $(element).find ('.calc-result.output-monthly-income');

  var output_lump_need = $(element).find ('.label-summary.output-lumpsum');
  var output_month_need = $(element).find ('.label-summary.output-monthsum');

  var output_lump_need_delay = $(element).find ('.label-summary-delay.output-lumpsum');
  var output_month_need_delay = $(element).find ('.label-summary-delay.output-monthsum');

  var fv;
  var pv;
  var annual_retirement_income;
  var lump;
  var monthly;
  var amount_needed;
  var pmt;
  var pmt_monthly;
  var delay_lump;
  var delay_month;

  var asst_liquidate;
  var delayear_timeout;

  function get_assets_liquidate()
  {
    var liquidate = $(input_assets_liquidate).val ();
    return liquidate;
 
  }

  function get_returnrate ()
  {
    var returnrate = $(input_returnrate).val ();
    var inflaterate = $(input_inflaterate).val ();
    return returnrate - inflaterate;
  }

  function get_annualexpenditure ()
  {
    var expenditure = $(input_expenditure).val ();
    return (expenditure * 12);
  }

  function get_yearsbeforetire ()
  {
    var desired_retirage = $(input_desired_retirage).val ();
    var curr_age = $(input_currage).val ();
    return desired_retirage - curr_age;
  }

  function get_fv ()
  {
    var inflrate = $(input_inflaterate).val () / 100;
    return FV (inflrate, get_yearsbeforetire (), 0, -1);
  }

  function get_pv ()
  {
    var retrate = get_returnrate () / 100;
    var desired_retireperiod = $(input_retire_period).val ();
    return PV (retrate, desired_retireperiod, -1, 0, 1);
  }

  function get_annual_retirement_income ()
  {
    var inflrate = $(input_inflaterate).val () / 100;
    var yearstoretire = get_yearsbeforetire ();
    var expenditure = $(input_expenditure).val () * 12;
    return FV (inflrate, yearstoretire, 0, expenditure * -1, 0);
  }

  function get_amountneeded ()
  {
    var retrate = get_returnrate () / 100;
    var yearstoretire = get_yearsbeforetire ();
    return PV (retrate, yearstoretire, 0, lump) * -1;
  }

  function get_pmt ()
  {
    var retrate = get_returnrate () / 100;
    var yearstoretire = get_yearsbeforetire ();
    return PMT (retrate, yearstoretire, 0, lump) * -1;
  }

  function calc_delay_lump ()
  {
    var retrate = get_returnrate () / 100;
    var yearstoretire = get_yearsbeforetire ();
    var delayear = $(input_delayear).val ();
    var desired_retireperiod = $(input_retire_period).val ();
    var year_left = yearstoretire - delayear;
    var fpv = PV (retrate, desired_retireperiod, -1, 0, 1);
    var retneed = (fpv * annual_retirement_income) - asst_liquidate;
    return PV(retrate, year_left, 0, retneed) * -1;
  }

  function calc_delay_month ()
  {
    var retrate = get_returnrate () / 100;
    var delayear = $(input_delayear).val ();
    var yearstoretire = get_yearsbeforetire ();
    var desired_retireperiod = $(input_retire_period).val ();
    var year_left = yearstoretire - delayear;
    var fpv = PV (retrate, desired_retireperiod, -1, 0, 1);
    var retneed = (fpv * annual_retirement_income) - asst_liquidate;
    return (PMT(retrate, year_left, 0, retneed) * -1) / 12;
  }

  function validate_fields ()
  {
    var result = true;

    $(".calculator-item, .calculated-result").find (".calc-required").filter (":visible").each (function (index, item) {
      if ($(item).val () == "")
      {
        $(item).addClass ("error");
        $(item).parent ().find (".calc-error").show ();
        result = false;
      }
      else
      {
        $(item).removeClass ("error");
        $(item).parent ().find (".calc-error").hide ();
      }
    });


    $(".calculator-item, .calculated-result").find (".calc-minmax").filter (":visible").filter (":not(.calc-required.error)").each (function (index, item) {
      var item_val = $(item).val ();
      var item_min = $(item).attr ('data-val-min');
      var item_max = $(item).attr ('data-val-max');
      var item_min_valid = true;
      var item_max_valid = true;


      if ($(item).hasClass ("numeric-only"))
      {
        item_val = Number (item_val);
        item_min = Number (item_min);
        item_max = Number (item_max);
        currage_val = Number (currage_val);
        desired_retirage_val = Number (desired_retirage_val);
        delayyear_val = Number (delayyear_val);
        diffRetireNCurrAge = Number (diffRetireNCurrAge);
      }

      if (item_min != undefined)
      {
        if (item_val < item_min)
        {
          item_min_valid = false;
          result = false;
        }
      }

      if (item_max != undefined)
      {
        if (item_val > item_max)
        {
          item_max_valid = false;
        }
      }




      if (item_min_valid == false || item_max_valid == false)
      {
        $(item).addClass ("error");
        $(item).parent ().find (".calc-error").show ();
      }
      else
      {
        $(item).removeClass ("error");
        $(item).parent ().find (".calc-error").hide ();
      }
    });
     
      var currage_val = $('.input-curr-age').val();
      var desired_retirage_val = $('.input-desiretire-age').val();
      var delayyear_val = $('.input-delay-year').val();
      var diffRetireNCurrAge = desired_retirage_val - currage_val;
      var retireperiod = $('.input-retire-period').val();
      retireperiod = Number(retireperiod);
      currage_val = Number (currage_val);
      desired_retirage_val = Number (desired_retirage_val);
      delayyear_val = Number (delayyear_val);
      diffRetireNCurrAge = Number (diffRetireNCurrAge );
      var maxValueRetired = desired_retirage_val + retireperiod;


      // retire age must not elder than current age
      // if (desired_retirage_val < currage_val)
      // {
      //   $(".input-desiretire-age").addClass("error");
      //   $(".input-desiretire-age").parent ().find (".calc-error").show ();
      // } 
      // else
      // {
      //   $(".input-desiretire-age").removeClass ("error");
      //   $(".input-desiretire-age").parent ().find (".calc-error").hide ();
      // }
      console.log(maxValueRetired);
      if (maxValueRetired > 120)
      {
        $(".input-desiretire-age").addClass("error");
        $(".input-desiretire-age").parent ().find (".calc-error").show ();
      } 
      else
      {
        $(".input-desiretire-age").removeClass ("error");
        $(".input-desiretire-age").parent ().find (".calc-error").hide ();
      }

      //Current Age + Expected Retirement Period >= Desired Retirement Age
      // if ((currage_val + retireperiod) >= desired_retirage_val) {
      //     $(".input-retire-period").removeClass ("calc-minmax");

      //     $(".input-retire-period").addClass("error");
      //     $(".input-retire-period").parent ().find (".retire-period").show().html ('Please enter an appropriate value for Expected Retirement Years and try again..');
      //   }

      //Current Age + Expected Retirement Period >= Desired Retirement Age
      //motified by CF
      if ((desired_retirage_val + retireperiod) >= 120) {
          $(".input-retire-period").removeClass ("calc-minmax");

          $(".input-retire-period").addClass("error");
          $(".input-retire-period").parent ().find (".retire-period").show().html ('Please enter an appropriate value for Expected Retirement Years and try again..');
        }  

      // check if input is empty
      if ($('.input-delay-year').val()=='') {
        // to resolve conflict from other js
          $(".input-delay-year").removeClass ("calc-minmax");

        // expected result
          $(".input-delay-year").addClass ("error");
          $(".input-delay-year").parent ().find (".delay-period-error").html ('Please enter a value between 1 and 99 years.');

          output_lump_need_delay.html('-'); 
          output_month_need_delay.html('-');
      }


      $(".input-delay-year").on("keypress", function(e){

            // strictly allow numbers only
            if (e.which < 48 || e.which > 57) 
            { 
              e.preventDefault(); 
            }

          var currentValue = String.fromCharCode(e.which);
          var finalValue = $('.input-delay-year').val() + currentValue;

          var currage_val = $('.input-curr-age').val();
          var desired_retirage_val = $('.input-desiretire-age').val();
          var diffRetireNCurrAge = desired_retirage_val - currage_val;

          if( (finalValue > diffRetireNCurrAge) && (finalValue > 0) )
          {
            // to resolve conflict from other js
              $(".input-delay-year").removeClass ("calc-minmax");

            // expected result
              $(".input-delay-year").addClass("error");
              $(".input-delay-year").parent ().find (".delay-period-error").show().html ('Error: Years of delay exceed the years to retirement.');

              output_lump_need_delay.html('-'); 
              output_month_need_delay.html('-'); 
          }
          else if ( (finalValue < diffRetireNCurrAge) && (finalValue <= 0) )
          {
            // to resolve conflict from other js
              $(".input-delay-year").removeClass ("calc-minmax");

            // expected result
            $(".input-delay-year").addClass ("error");
            $(".input-delay-year").parent ().find (".delay-period-error").show().html ('Please enter a value between 1 and 99 years.');

            output_lump_need_delay.html('-'); 
            output_month_need_delay.html('-');
          }
          else 
          {
            // to resolve conflict from other js
              $(".input-delay-year").addClass ("calc-minmax");

            // expected result
            $(".input-delay-year").removeClass ("error");
            $(".input-delay-year").parent ().find (".delay-period-error").html ('');
          }
 

      });

    return result;

  }

  

  $(form_calculate).find ('.calc-input').each (function (index, item) {
    $(item).on ("keyup.retireInputChange", function (keyvent) {
      if (!$(result_calculate).is (":hidden"))
      {
        $(result_calculate).hide ();
      }
      validate_fields ();
    });
  });

  $(result_calculate).find ('.calc-input').each (function (index, item) {
    $(item).on ("keyup.retireInputChange", function (keyvent) {
      validate_fields ();
    });
  });

  $(btn_calculate).on ("click.retireCalc", function (clickevent) {
    clickevent.preventDefault ();
    if (validate_fields () === false)
    {
      return;
    }

    fv = get_fv ();
    pv = get_pv ();
    asst_liquidate = get_assets_liquidate();

    annual_retirement_income = get_annual_retirement_income ();
    lump = (annual_retirement_income * pv) - asst_liquidate;

    monthly = annual_retirement_income / 12;
    amount_needed = get_amountneeded (lump);
    pmt = get_pmt (lump);
    pmt_monthly = pmt / 12;
    delay_lump = calc_delay_lump ();
    delay_month = calc_delay_month ();
      // // error if result is negative
      //   var output_val = [ lump | monthly | amount_needed | pmt_monthly | delay_lump | delay_month ];

      //   if (output_val < 0) {
      //     alert('Error - number of years delayed is higher than the years to retirement');
      //     return;
      //   }




        delay_lump = isFinite(delay_lump) ? delay_lump : 0.0; 
        delay_month = isFinite(delay_month) ? delay_month : 0.0;
        lump = isFinite(lump) ? lump : 0.0;
        monthly = isFinite(monthly) ? monthly : 0.0;
        amount_needed = isFinite(amount_needed) ? amount_needed : 0.0;
        pmt_monthly = isFinite(pmt_monthly) ? pmt_monthly : 0.0;

    $(output_lump).outputCalcValue (lump);
    $(output_monthly).outputCalcValue (monthly);
    $(output_lump_need).outputCalcValue (amount_needed);
    $(output_month_need).outputCalcValue (pmt_monthly);
    $(output_lump_need_delay).outputCalcValue (delay_lump);
    $(output_month_need_delay).outputCalcValue (delay_month);


    $(result_calculate).show ();
    $(btn_calculate).scrollPageToThis ();
  });

  $(input_delayear).on ("keyup.retireDelayChange", function (keyvent) {
    clearTimeout (delayear_timeout);

    if ($(input_delayear).val () == "")
    {
      return;
    }

    var delayear = $(input_delayear).val ();
    var desired_retireperiod = $(input_retire_period).val ();
    var yearstoretire = get_yearsbeforetire ();
    var year_left = yearstoretire - delayear; 
    if (year_left < 1)
    {
      return;
    }

    if (validate_fields () == false)
    {
      return;
    }

    delayear_timeout = setTimeout (
      function () {
        delay_lump = calc_delay_lump ();
        delay_month = calc_delay_month ();
        $(output_lump_need_delay).outputCalcValue (delay_lump);
        $(output_month_need_delay).outputCalcValue (delay_month);

      },
      333
    );

  });

  $(btn_calculate).prop ({ 'disabled': false });

  $(element).addClass ("-calc-retirement-wired-");
};

function _calc_retirement_disablecalcbutton ()
{
  $('.calc-retirement').calcFormDisableButtonFirst ();
}

function _calc_retirement_wireup ()
{
  $('.calc-retirement').filter (":not(.-calc-retirement-wired-)").each (function (index, item) {
    $(item).calcRetirementWireUp ();
  });
}

$(document).ready (function () {
  _calc_retirement_wireup ();
});

_calc_retirement_disablecalcbutton ();
/* responsive table cells to blocks */
$.fn.tableHeadBody = function ()
{
  var table = this;
  /* provide <thead> if has tr th */
  if ($(table).find ('thead').length == 0)
  {
    var new_thead = $('<thead></thead>');
    $(table).find ('tr').each (function (index, tr) {
      if ($(tr).find ('th').length > 0)
      {
        $(tr).appendTo ($(new_thead));
      }
    });

    if ($(new_thead).children ().length > 0)
    {
      $(new_thead).prependTo ($(table));
    }
  }

  /* wrap tr's in <tbody> but this is already done by default in most browsers */
  if ($(table).find ('tbody').length == 0)
  {
    /* but don't bother if the table is without any tr's */
    if ($(table).find ('tr').length > 0)
    {
      var new_tbody = $('<tbody></tbody>');
      $(table).find ('tr').each (function (index, tr) {
        /* ignore th's -- we are doing the body data here */
        if ($(tr).find ('th').length == 0)
        {
          $(tr).appendTo ($(new_tbody));
        }
      });
      $(new_tbody).appendTo ($(table));
    }
  }

  return table;
}

function _tableToArray (table)
{
  var data = [];
  table.find ('tr').each (function (rowIndex, r) 
  {
    var cols = [];
    $(this).find ('th, td').each (function (colIndex, c) 
    {
      if (parseInt ($(c).attr ('colspan')) > 1)
      {
        for (var i = 0; i < parseInt ($(c).attr ('colspan')); i++)
        {
          cols.push ($(c).html ());
        }
      }
      else
      {
        cols.push ($(c).html ());
      }
    });

    data.push (cols);
  });

  return data;
}

$.fn.tableCellToBlock = function (options) {
  var table = this;
  var table_data = _tableToArray (table);
  var outables = Array ();

  var settings = $.extend ({
    exclude_class: "table-th-to-block",
  }, options);

  $(table).tableHeadBody ();

  if ($(table).find ('thead').length == 1)
  {
    $(table_data[0]).each (function (trindex, trcol) {

      var new_table = $('<table>');
      $(new_table).addClass ($(table).attr ('class'));
      $(new_table).removeClass (settings.exclude_class);
      $(new_table).addClass ("-th-block-");

      /* attach the head first */
      var new_thead = $('<thead>');
      var new_th = $('<th>');
      $(new_th).html (trcol);
      $(new_th).appendTo ($(new_thead));
      $(new_thead).appendTo ($(new_table));

      for (var i = 1; i < table_data.length; i++)
      {
        var new_tr = $('<tr>');
        var new_td = $('<td>');
        $(new_td).html (table_data[i][trindex]);
        $(new_td).appendTo ($(new_tr));
        $(new_tr).appendTo ($(new_table));
      }

      outables.push ($(new_table));
    });

    /* reverse order .after each table */
    for (var i = outables.length - 1; i >= 0; i--)
    {
      $(table).after ($(outables[i]));
    }

  }

  $(table).addClass ("-has-th-block-");
};

function _apply_table_th_to_blocks ()
{
  $('.table-th-to-block').filter (':not(.-has-th-block-)').each (function (index, item) {
    $(item).tableCellToBlock ();
  });
}

$(document).ready (function () {
  _apply_table_th_to_blocks ();
});

$(document).ajaxComplete (function () {
  _apply_table_th_to_blocks ();
});
/* handle ".responsive-position" - THIS FUNCTION IS EXPERIMENTAL */
$.fn.responsivePosition = function () {
  var this_element = this;

  if ($(window).width () >= 768)
  {
    var this_first = $(this_element).find ('.responsive-pos.md-first').first ();
    $(this_first).prependTo ($(this_element));
  }

  if ($(window).width () < 768)
  {
    var this_first = $(this_element).find ('.responsive-pos.xs-first').first ();
    $(this_first).prependTo ($(this_element));
  }
};

function _apply_responsivePosition ()
{
  $('.responsive-pos-wrapper').each (function (index, item) {
    $(item).responsivePosition ();
  });
}

/* document ready functions */
$(document).ready (function () {
  _apply_responsivePosition ();
});

/* AJAX complete functions */
$(document).ajaxComplete (function () {
  _apply_responsivePosition ();
});

/* window resize functions */
$(window).resize (function () {
  if ($('input:focus').length == 0)
  {
    _apply_responsivePosition ();
  }
});
/* http://keith-wood.name/signature.html
   Signature plugin for jQuery UI v1.1.2.
   Requires excanvas.js in IE.
   Written by Keith Wood (kbwood{at}iinet.com.au) April 2012.
   Available under the MIT (http://keith-wood.name/licence.html) license. 
   Please attribute the author if you use it. */

(function($) { // Hide scope, no $ conflict

var signatureOverrides = {

	// Global defaults for signature
	options: {
		distance: 0, // Minimum distance for a drag
		background: '#ffffff', // Colour of the background
		color: '#000000', // Colour of the signature
		thickness: 2, // Thickness of the lines
		guideline: false, // Add a guide line or not?
		guidelineColor: '#a0a0a0', // Guide line colour
		guidelineOffset: 50, // Guide line offset from the bottom
		guidelineIndent: 10, // Guide line indent from the edges
		notAvailable: 'Your browser doesn\'t support signing', // Error message when no canvas
		syncField: null, // Selector for synchronised text field
		change: null // Callback when signature changed
	},

	/* Initialise a new signature area. */
	_create: function() {
		this.element.addClass(this.widgetFullName || this.widgetBaseClass);
		try {
			this.canvas = $('<canvas width="' + this.element.width() + '" height="' +
				this.element.height() + '">' + this.options.notAvailable + '</canvas>')[0];
			this.element.append(this.canvas);
			this.ctx = this.canvas.getContext('2d');
		}
		catch (e) {
			$(this.canvas).remove();
			this.resize = true;
			this.canvas = document.createElement('canvas');
			this.canvas.setAttribute('width', this.element.width());
			this.canvas.setAttribute('height', this.element.height());
			this.canvas.innerHTML = this.options.notAvailable;
			this.element.append(this.canvas);
			if (G_vmlCanvasManager) { // Requires excanvas.js
				G_vmlCanvasManager.initElement(this.canvas);
			}
			this.ctx = this.canvas.getContext('2d');
		}
		this._refresh(true);
		this._mouseInit();
	},

	/* Refresh the appearance of the signature area.
	   @param  init  (boolean, internal) true if initialising */
	_refresh: function(init) {
		if (this.resize) {
			var parent = $(this.canvas);
			$('div', this.canvas).css({width: parent.width(), height: parent.height()});
		}
		this.ctx.fillStyle = this.options.background;
		this.ctx.strokeStyle = this.options.color;
		this.ctx.lineWidth = this.options.thickness;
		this.ctx.lineCap = 'round';
		this.ctx.lineJoin = 'round';
		this.clear(init);
	},

	/* Clear the signature area.
	   @param  init  (boolean, internal) true if initialising */
	clear: function(init) {
		this.ctx.clearRect(0, 0, this.element.width(), this.element.height());
		if (this.options.guideline) {
			this.ctx.save();
			this.ctx.strokeStyle = this.options.guidelineColor;
			this.ctx.lineWidth = 1;
			this.ctx.beginPath();
			this.ctx.moveTo(this.options.guidelineIndent,
				this.element.height() - this.options.guidelineOffset);
			this.ctx.lineTo(this.element.width() - this.options.guidelineIndent,
				this.element.height() - this.options.guidelineOffset);
			this.ctx.stroke();
			this.ctx.restore();
		}
		this.lines = [];
		if (!init) {
			this._changed();
		}
	},

	/* Synchronise changes and trigger change event.
	   @param  event  (Event) the triggering event */
	_changed: function(event) {
		if (this.options.syncField) {
			$(this.options.syncField).val(this.toJSON());
		}
		this._trigger('change', event, {});
	},

	/* Custom options handling.
	   @param  options  (object) the new option values */
	_setOptions: function(options) {
		if (this._superApply) {
			this._superApply(arguments); // Base widget handling
		}
		else {
			$.Widget.prototype._setOptions.apply(this, arguments); // Base widget handling
		}
		this._refresh();
	},

	/* Determine if dragging can start.
	   @param  event  (Event) the triggering mouse event
	   @return  (boolean) true if allowed, false if not */
	_mouseCapture: function(event) {
		return !this.options.disabled;
	},

	/* Start a new line.
	   @param  event  (Event) the triggering mouse event */
	_mouseStart: function(event) {
		this.offset = this.element.offset();
		this.offset.left -= document.documentElement.scrollLeft || document.body.scrollLeft;
		this.offset.top -= document.documentElement.scrollTop || document.body.scrollTop;
		this.lastPoint = [this._round(event.clientX - this.offset.left),
			this._round(event.clientY - this.offset.top)];
		this.curLine = [this.lastPoint];
		this.lines.push(this.curLine);
	},

	/* Track the mouse.
	   @param  event  (Event) the triggering mouse event */
	_mouseDrag: function(event) {
		var point = [this._round(event.clientX - this.offset.left),
			this._round(event.clientY - this.offset.top)];
		this.curLine.push(point);
		this.ctx.beginPath();
		this.ctx.moveTo(this.lastPoint[0], this.lastPoint[1]);
		this.ctx.lineTo(point[0], point[1]);
		this.ctx.stroke();
		this.lastPoint = point;
	},

	/* End a line.
	   @param  event  (Event) the triggering mouse event */
	_mouseStop: function(event) {
		if (this.curLine.length === 1) {
			event.clientY += this.options.thickness;
			this._mouseDrag(event);
		}
		this.lastPoint = null;
		this.curLine = null;
		this._changed(event);
	},

	/* Round to two decimal points.
	   @param  value  (number) the value to round
	   @return  (number) the rounded value */
	_round: function(value) {
		return Math.round(value * 100) / 100;
	},

	/* Convert the captured lines to JSON text.
	   @return  (string) the JSON text version of the lines */
	toJSON: function() {
		return '{"lines":[' + $.map(this.lines, function(line) {
			return '[' + $.map(line, function(point) {
					return '[' + point + ']';
				}) + ']';
		}) + ']}';
	},

	/* Convert the captured lines to SVG text.
	   @return  (string) the SVG text version of the lines */
	toSVG: function() {
		return '<?xml version="1.0"?>\n<!DOCTYPE svg PUBLIC ' +
			'"-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n' +
			'<svg xmlns="http://www.w3.org/2000/svg" width="15cm" height="15cm">\n' +
			'	<g fill="' + this.options.background + '">\n' +
			'		<rect x="0" y="0" width="' + this.canvas.width +
			'" height="' + this.canvas.height + '"/>\n' +
			'		<g fill="none" stroke="' + this.options.color + '" stroke-width="' +
			this.options.thickness + '">\n'+
			$.map(this.lines, function(line) {
				return '			<polyline points="' +
					$.map(line, function(point) { return point + ''; }).join(' ') + '"/>\n';
			}).join('') +
			'		</g>\n	</g>\n</svg>\n';
	},

	/* Draw a signature from its JSON description.
	   @param  sigJSON  (object) object with attribute lines
	                    being an array of arrays of points or
	                    (string) text version of the JSON */
	draw: function(sigJSON) {
		this.clear(true);
		if (typeof sigJSON === 'string') {
			sigJSON = $.parseJSON(sigJSON);
		}
		this.lines = sigJSON.lines || [];
		var ctx = this.ctx;
		$.each(this.lines, function() {
			ctx.beginPath();
			$.each(this, function(i) {
				ctx[i === 0 ? 'moveTo' : 'lineTo'](this[0], this[1]);
			});
			ctx.stroke();
		});
		this._changed();
	},

	/* Determine whether or not any drawing has occurred.
	   @return  (boolean) true if not signed, false if signed */
	isEmpty: function() {
		return this.lines.length === 0;
	},

	/* Remove the signature functionality. */
	_destroy: function() {
		this.element.removeClass(this.widgetFullName || this.widgetBaseClass);
		$(this.canvas).remove();
		this.canvas = this.ctx = this.lines = null;
		this._mouseDestroy();
	}
};

if (!$.Widget.prototype._destroy) {
	$.extend(signatureOverrides, {
		/* Remove the signature functionality. */
		destroy: function() {
			this._destroy();
			$.Widget.prototype.destroy.call(this); // Base widget handling
		}
	});
}

if ($.Widget.prototype._getCreateOptions === $.noop) {
	$.extend(signatureOverrides, {
		/* Restore the metadata functionality. */
		_getCreateOptions: function() {
			return $.metadata && $.metadata.get(this.element[0])[this.widgetName];
		}
	});
}

/* Signature capture and display.
   Depends on jquery.ui.widget, jquery.ui.mouse. */
$.widget('kbw.signature', $.ui.mouse, signatureOverrides);

// Make some things more accessible
$.kbw.signature.options = $.kbw.signature.prototype.options;

})(jQuery);

/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
